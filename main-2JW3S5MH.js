var xv=Object.defineProperty,TT=Object.defineProperties;var xT=Object.getOwnPropertyDescriptors;var Ea=Object.getOwnPropertySymbols;var Iv=Object.prototype.hasOwnProperty,Cv=Object.prototype.propertyIsEnumerable;var Tv=(i,e,t)=>e in i?xv(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,N=(i,e)=>{for(var t in e||={})Iv.call(e,t)&&Tv(i,t,e[t]);if(Ea)for(var t of Ea(e))Cv.call(e,t)&&Tv(i,t,e[t]);return i},Ie=(i,e)=>TT(i,xT(e));var Av=(i,e)=>{var t={};for(var n in i)Iv.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&Ea)for(var n of Ea(i))e.indexOf(n)<0&&Cv.call(i,n)&&(t[n]=i[n]);return t};var Rv=(i,e)=>{for(var t in e)xv(i,t,{get:e[t],enumerable:!0})};var Mv=null;var Xu=1,kv=Symbol("SIGNAL");function ye(i){let e=Mv;return Mv=i,e}var Lv={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function IT(i){if(!(ed(i)&&!i.dirty)&&!(!i.dirty&&i.lastCleanEpoch===Xu)){if(!i.producerMustRecompute(i)&&!Zu(i)){i.dirty=!1,i.lastCleanEpoch=Xu;return}i.producerRecomputeValue(i),i.dirty=!1,i.lastCleanEpoch=Xu}}function Ov(i){return i&&(i.nextProducerIndex=0),ye(i)}function Nv(i,e){if(ye(e),!(!i||i.producerNode===void 0||i.producerIndexOfThis===void 0||i.producerLastReadVersion===void 0)){if(ed(i))for(let t=i.nextProducerIndex;t<i.producerNode.length;t++)Ju(i.producerNode[t],i.producerIndexOfThis[t]);for(;i.producerNode.length>i.nextProducerIndex;)i.producerNode.pop(),i.producerLastReadVersion.pop(),i.producerIndexOfThis.pop()}}function Zu(i){Da(i);for(let e=0;e<i.producerNode.length;e++){let t=i.producerNode[e],n=i.producerLastReadVersion[e];if(n!==t.version||(IT(t),n!==t.version))return!0}return!1}function Pv(i){if(Da(i),ed(i))for(let e=0;e<i.producerNode.length;e++)Ju(i.producerNode[e],i.producerIndexOfThis[e]);i.producerNode.length=i.producerLastReadVersion.length=i.producerIndexOfThis.length=0,i.liveConsumerNode&&(i.liveConsumerNode.length=i.liveConsumerIndexOfThis.length=0)}function Ju(i,e){if(CT(i),Da(i),i.liveConsumerNode.length===1)for(let n=0;n<i.producerNode.length;n++)Ju(i.producerNode[n],i.producerIndexOfThis[n]);let t=i.liveConsumerNode.length-1;if(i.liveConsumerNode[e]=i.liveConsumerNode[t],i.liveConsumerIndexOfThis[e]=i.liveConsumerIndexOfThis[t],i.liveConsumerNode.length--,i.liveConsumerIndexOfThis.length--,e<i.liveConsumerNode.length){let n=i.liveConsumerIndexOfThis[e],r=i.liveConsumerNode[e];Da(r),r.producerIndexOfThis[n]=e}}function ed(i){return i.consumerIsAlwaysLive||(i?.liveConsumerNode?.length??0)>0}function Da(i){i.producerNode??=[],i.producerIndexOfThis??=[],i.producerLastReadVersion??=[]}function CT(i){i.liveConsumerNode??=[],i.liveConsumerIndexOfThis??=[]}function AT(){throw new Error}var RT=AT;function Fv(i){RT=i}function Q(i){return typeof i=="function"}function wr(i){let t=i(n=>{Error.call(n),n.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var wa=wr(i=>function(t){i(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((n,r)=>`${r+1}) ${n.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Ii(i,e){if(i){let t=i.indexOf(e);0<=t&&i.splice(t,1)}}var ke=class i{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:n}=this;if(Q(n))try{n()}catch(s){e=s instanceof wa?s.errors:[s]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let s of r)try{Bv(s)}catch(o){e=e??[],o instanceof wa?e=[...e,...o.errors]:e.push(o)}}if(e)throw new wa(e)}}add(e){var t;if(e&&e!==this)if(this.closed)Bv(e);else{if(e instanceof i){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Ii(t,e)}remove(e){let{_finalizers:t}=this;t&&Ii(t,e),e instanceof i&&e._removeParent(this)}};ke.EMPTY=(()=>{let i=new ke;return i.closed=!0,i})();var td=ke.EMPTY;function Sa(i){return i instanceof ke||i&&"closed"in i&&Q(i.remove)&&Q(i.add)&&Q(i.unsubscribe)}function Bv(i){Q(i)?i():i.unsubscribe()}var Qt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Sr={setTimeout(i,e,...t){let{delegate:n}=Sr;return n?.setTimeout?n.setTimeout(i,e,...t):setTimeout(i,e,...t)},clearTimeout(i){let{delegate:e}=Sr;return(e?.clearTimeout||clearTimeout)(i)},delegate:void 0};function Ta(i){Sr.setTimeout(()=>{let{onUnhandledError:e}=Qt;if(e)e(i);else throw i})}function Ns(){}var Vv=nd("C",void 0,void 0);function Uv(i){return nd("E",void 0,i)}function jv(i){return nd("N",i,void 0)}function nd(i,e,t){return{kind:i,value:e,error:t}}var Ci=null;function Tr(i){if(Qt.useDeprecatedSynchronousErrorHandling){let e=!Ci;if(e&&(Ci={errorThrown:!1,error:null}),i(),e){let{errorThrown:t,error:n}=Ci;if(Ci=null,t)throw n}}else i()}function $v(i){Qt.useDeprecatedSynchronousErrorHandling&&Ci&&(Ci.errorThrown=!0,Ci.error=i)}var Ai=class extends ke{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Sa(e)&&e.add(this)):this.destination=LT}static create(e,t,n){return new Vn(e,t,n)}next(e){this.isStopped?rd(jv(e),this):this._next(e)}error(e){this.isStopped?rd(Uv(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?rd(Vv,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},MT=Function.prototype.bind;function id(i,e){return MT.call(i,e)}var sd=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){xa(n)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){xa(n)}else xa(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){xa(t)}}},Vn=class extends Ai{constructor(e,t,n){super();let r;if(Q(e)||!e)r={next:e??void 0,error:t??void 0,complete:n??void 0};else{let s;this&&Qt.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&id(e.next,s),error:e.error&&id(e.error,s),complete:e.complete&&id(e.complete,s)}):r=e}this.destination=new sd(r)}};function xa(i){Qt.useDeprecatedSynchronousErrorHandling?$v(i):Ta(i)}function kT(i){throw i}function rd(i,e){let{onStoppedNotification:t}=Qt;t&&Sr.setTimeout(()=>t(i,e))}var LT={closed:!0,next:Ns,error:kT,complete:Ns};var xr=typeof Symbol=="function"&&Symbol.observable||"@@observable";function dt(i){return i}function od(...i){return ad(i)}function ad(i){return i.length===0?dt:i.length===1?i[0]:function(t){return i.reduce((n,r)=>r(n),t)}}var re=(()=>{class i{constructor(t){t&&(this._subscribe=t)}lift(t){let n=new i;return n.source=this,n.operator=t,n}subscribe(t,n,r){let s=NT(t)?t:new Vn(t,n,r);return Tr(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return n=Hv(n),new n((r,s)=>{let o=new Vn({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)}[xr](){return this}pipe(...t){return ad(t)(this)}toPromise(t){return t=Hv(t),new t((n,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>n(s))})}}return i.create=e=>new i(e),i})();function Hv(i){var e;return(e=i??Qt.Promise)!==null&&e!==void 0?e:Promise}function OT(i){return i&&Q(i.next)&&Q(i.error)&&Q(i.complete)}function NT(i){return i&&i instanceof Ai||OT(i)&&Sa(i)}function ld(i){return Q(i?.lift)}function le(i){return e=>{if(ld(e))return e.lift(function(t){try{return i(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function se(i,e,t,n,r){return new cd(i,e,t,n,r)}var cd=class extends Ai{constructor(e,t,n,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Ir(){return le((i,e)=>{let t=null;i._refCount++;let n=se(e,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount){t=null;return}let r=i._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});i.subscribe(n),n.closed||(t=i.connect())})}var Cr=class extends re{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,ld(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new ke;let t=this.getSubject();e.add(this.source.subscribe(se(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=ke.EMPTY)}return e}refCount(){return Ir()(this)}};var Gv=wr(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var fe=(()=>{class i extends re{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let n=new Ia(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new Gv}next(t){Tr(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let n of this.currentObservers)n.next(t)}})}error(t){Tr(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){Tr(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:n,isStopped:r,observers:s}=this;return n||r?td:(this.currentObservers=null,s.push(t),new ke(()=>{this.currentObservers=null,Ii(s,t)}))}_checkFinalizedStatuses(t){let{hasError:n,thrownError:r,isStopped:s}=this;n?t.error(r):s&&t.complete()}asObservable(){let t=new re;return t.source=this,t}}return i.create=(e,t)=>new Ia(e,t),i})(),Ia=class extends fe{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.next)===null||n===void 0||n.call(t,e)}error(e){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.error)===null||n===void 0||n.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,n;return(n=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&n!==void 0?n:td}};var Qe=class extends fe{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}};var ud={now(){return(ud.delegate||Date).now()},delegate:void 0};var Ca=class extends ke{constructor(e,t){super()}schedule(e,t=0){return this}};var Ps={setInterval(i,e,...t){let{delegate:n}=Ps;return n?.setInterval?n.setInterval(i,e,...t):setInterval(i,e,...t)},clearInterval(i){let{delegate:e}=Ps;return(e?.clearInterval||clearInterval)(i)},delegate:void 0};var Aa=class extends Ca{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var n;if(this.closed)return this;this.state=e;let r=this.id,s=this.scheduler;return r!=null&&(this.id=this.recycleAsyncId(s,r,t)),this.pending=!0,this.delay=t,this.id=(n=this.id)!==null&&n!==void 0?n:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,n=0){return Ps.setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(n!=null&&this.delay===n&&this.pending===!1)return t;t!=null&&Ps.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let n=this._execute(e,t);if(n)return n;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let n=!1,r;try{this.work(e)}catch(s){n=!0,r=s||new Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:n}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Ii(n,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var Ar=class i{constructor(e,t=i.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,n){return new this.schedulerActionCtor(this,e).schedule(n,t)}};Ar.now=ud.now;var Ra=class extends Ar{constructor(e,t=Ar.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let n;this._active=!0;do if(n=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}};var Fs=new Ra(Aa),zv=Fs;var ht=new re(i=>i.complete());function Ma(i){return i&&Q(i.schedule)}function dd(i){return i[i.length-1]}function ka(i){return Q(dd(i))?i.pop():void 0}function pn(i){return Ma(dd(i))?i.pop():void 0}function Wv(i,e){return typeof dd(i)=="number"?i.pop():e}function Kv(i,e,t,n){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{c(n.next(u))}catch(d){o(d)}}function l(u){try{c(n.throw(u))}catch(d){o(d)}}function c(u){u.done?s(u.value):r(u.value).then(a,l)}c((n=n.apply(i,e||[])).next())})}function qv(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ri(i){return this instanceof Ri?(this.v=i,this):new Ri(i)}function Yv(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(i,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),r[Symbol.asyncIterator]=function(){return this},r;function o(f){return function(p){return Promise.resolve(p).then(f,d)}}function a(f,p){n[f]&&(r[f]=function(m){return new Promise(function(g,y){s.push([f,m,g,y])>1||l(f,m)})},p&&(r[f]=p(r[f])))}function l(f,p){try{c(n[f](p))}catch(m){h(s[0][3],m)}}function c(f){f.value instanceof Ri?Promise.resolve(f.value.v).then(u,d):h(s[0][2],f)}function u(f){l("next",f)}function d(f){l("throw",f)}function h(f,p){f(p),s.shift(),s.length&&l(s[0][0],s[0][1])}}function Qv(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof qv=="function"?qv(i):i[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=i[s]&&function(o){return new Promise(function(a,l){o=i[s](o),r(a,l,o.done,o.value)})}}function r(s,o,a,l){Promise.resolve(l).then(function(c){s({value:c,done:a})},o)}}var Rr=i=>i&&typeof i.length=="number"&&typeof i!="function";function La(i){return Q(i?.then)}function Oa(i){return Q(i[xr])}function Na(i){return Symbol.asyncIterator&&Q(i?.[Symbol.asyncIterator])}function Pa(i){return new TypeError(`You provided ${i!==null&&typeof i=="object"?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function PT(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Fa=PT();function Ba(i){return Q(i?.[Fa])}function Va(i){return Yv(this,arguments,function*(){let t=i.getReader();try{for(;;){let{value:n,done:r}=yield Ri(t.read());if(r)return yield Ri(void 0);yield yield Ri(n)}}finally{t.releaseLock()}})}function Ua(i){return Q(i?.getReader)}function Ce(i){if(i instanceof re)return i;if(i!=null){if(Oa(i))return FT(i);if(Rr(i))return BT(i);if(La(i))return VT(i);if(Na(i))return Xv(i);if(Ba(i))return UT(i);if(Ua(i))return jT(i)}throw Pa(i)}function FT(i){return new re(e=>{let t=i[xr]();if(Q(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function BT(i){return new re(e=>{for(let t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()})}function VT(i){return new re(e=>{i.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Ta)})}function UT(i){return new re(e=>{for(let t of i)if(e.next(t),e.closed)return;e.complete()})}function Xv(i){return new re(e=>{$T(i,e).catch(t=>e.error(t))})}function jT(i){return Xv(Va(i))}function $T(i,e){var t,n,r,s;return Kv(this,void 0,void 0,function*(){try{for(t=Qv(i);n=yield t.next(),!n.done;){let o=n.value;if(e.next(o),e.closed)return}}catch(o){r={error:o}}finally{try{n&&!n.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})}function vt(i,e,t,n=0,r=!1){let s=e.schedule(function(){t(),r?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(s),!r)return s}function ja(i,e=0){return le((t,n)=>{t.subscribe(se(n,r=>vt(n,i,()=>n.next(r),e),()=>vt(n,i,()=>n.complete(),e),r=>vt(n,i,()=>n.error(r),e)))})}function $a(i,e=0){return le((t,n)=>{n.add(i.schedule(()=>t.subscribe(n),e))})}function Zv(i,e){return Ce(i).pipe($a(e),ja(e))}function Jv(i,e){return Ce(i).pipe($a(e),ja(e))}function ey(i,e){return new re(t=>{let n=0;return e.schedule(function(){n===i.length?t.complete():(t.next(i[n++]),t.closed||this.schedule())})})}function ty(i,e){return new re(t=>{let n;return vt(t,e,()=>{n=i[Fa](),vt(t,e,()=>{let r,s;try{({value:r,done:s}=n.next())}catch(o){t.error(o);return}s?t.complete():t.next(r)},0,!0)}),()=>Q(n?.return)&&n.return()})}function Ha(i,e){if(!i)throw new Error("Iterable cannot be null");return new re(t=>{vt(t,e,()=>{let n=i[Symbol.asyncIterator]();vt(t,e,()=>{n.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function ny(i,e){return Ha(Va(i),e)}function iy(i,e){if(i!=null){if(Oa(i))return Zv(i,e);if(Rr(i))return ey(i,e);if(La(i))return Jv(i,e);if(Na(i))return Ha(i,e);if(Ba(i))return ty(i,e);if(Ua(i))return ny(i,e)}throw Pa(i)}function Be(i,e){return e?iy(i,e):Ce(i)}function ne(...i){let e=pn(i);return Be(i,e)}function Mr(i,e){let t=Q(i)?i:()=>i,n=r=>r.error(t());return new re(e?r=>e.schedule(n,0,r):n)}function Bs(i){return!!i&&(i instanceof re||Q(i.lift)&&Q(i.subscribe))}var Un=wr(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"});function ry(i){return i instanceof Date&&!isNaN(i)}function pe(i,e){return le((t,n)=>{let r=0;t.subscribe(se(n,s=>{n.next(i.call(e,s,r++))}))})}var{isArray:HT}=Array;function GT(i,e){return HT(e)?i(...e):i(e)}function kr(i){return pe(e=>GT(i,e))}var{isArray:zT}=Array,{getPrototypeOf:WT,prototype:qT,keys:KT}=Object;function Ga(i){if(i.length===1){let e=i[0];if(zT(e))return{args:e,keys:null};if(YT(e)){let t=KT(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:i,keys:null}}function YT(i){return i&&typeof i=="object"&&WT(i)===qT}function za(i,e){return i.reduce((t,n,r)=>(t[n]=e[r],t),{})}function Lr(...i){let e=pn(i),t=ka(i),{args:n,keys:r}=Ga(i);if(n.length===0)return Be([],e);let s=new re(QT(n,e,r?o=>za(r,o):dt));return t?s.pipe(kr(t)):s}function QT(i,e,t=dt){return n=>{sy(e,()=>{let{length:r}=i,s=new Array(r),o=r,a=r;for(let l=0;l<r;l++)sy(e,()=>{let c=Be(i[l],e),u=!1;c.subscribe(se(n,d=>{s[l]=d,u||(u=!0,a--),a||n.next(t(s.slice()))},()=>{--o||n.complete()}))},n)},n)}}function sy(i,e,t){i?vt(t,i,e):e()}function oy(i,e,t,n,r,s,o,a){let l=[],c=0,u=0,d=!1,h=()=>{d&&!l.length&&!c&&e.complete()},f=m=>c<n?p(m):l.push(m),p=m=>{s&&e.next(m),c++;let g=!1;Ce(t(m,u++)).subscribe(se(e,y=>{r?.(y),s?f(y):e.next(y)},()=>{g=!0},void 0,()=>{if(g)try{for(c--;l.length&&c<n;){let y=l.shift();o?vt(e,o,()=>p(y)):p(y)}h()}catch(y){e.error(y)}}))};return i.subscribe(se(e,f,()=>{d=!0,h()})),()=>{a?.()}}function He(i,e,t=1/0){return Q(e)?He((n,r)=>pe((s,o)=>e(n,s,r,o))(Ce(i(n,r))),t):(typeof e=="number"&&(t=e),le((n,r)=>oy(n,r,i,t)))}function Vs(i=1/0){return He(dt,i)}function ay(){return Vs(1)}function ri(...i){return ay()(Be(i,pn(i)))}function Wa(i){return new re(e=>{Ce(i()).subscribe(e)})}function hd(...i){let e=ka(i),{args:t,keys:n}=Ga(i),r=new re(s=>{let{length:o}=t;if(!o){s.complete();return}let a=new Array(o),l=o,c=o;for(let u=0;u<o;u++){let d=!1;Ce(t[u]).subscribe(se(s,h=>{d||(d=!0,c--),a[u]=h},()=>l--,void 0,()=>{(!l||!d)&&(c||s.next(n?za(n,a):a),s.complete())}))}});return e?r.pipe(kr(e)):r}var XT=["addListener","removeListener"],ZT=["addEventListener","removeEventListener"],JT=["on","off"];function Us(i,e,t,n){if(Q(t)&&(n=t,t=void 0),n)return Us(i,e,t).pipe(kr(n));let[r,s]=nx(i)?ZT.map(o=>a=>i[o](e,a,t)):ex(i)?XT.map(ly(i,e)):tx(i)?JT.map(ly(i,e)):[];if(!r&&Rr(i))return He(o=>Us(o,e,t))(Ce(i));if(!r)throw new TypeError("Invalid event target");return new re(o=>{let a=(...l)=>o.next(1<l.length?l:l[0]);return r(a),()=>s(a)})}function ly(i,e){return t=>n=>i[t](e,n)}function ex(i){return Q(i.addListener)&&Q(i.removeListener)}function tx(i){return Q(i.on)&&Q(i.off)}function nx(i){return Q(i.addEventListener)&&Q(i.removeEventListener)}function cy(i=0,e,t=zv){let n=-1;return e!=null&&(Ma(e)?t=e:n=e),new re(r=>{let s=ry(i)?+i-t.now():i;s<0&&(s=0);let o=0;return t.schedule(function(){r.closed||(r.next(o++),0<=n?this.schedule(void 0,n):r.complete())},s)})}function fd(...i){let e=pn(i),t=Wv(i,1/0),n=i;return n.length?n.length===1?Ce(n[0]):Vs(t)(Be(n,e)):ht}function Je(i,e){return le((t,n)=>{let r=0;t.subscribe(se(n,s=>i.call(e,s,r++)&&n.next(s)))})}function uy(i){return le((e,t)=>{let n=!1,r=null,s=null,o=!1,a=()=>{if(s?.unsubscribe(),s=null,n){n=!1;let c=r;r=null,t.next(c)}o&&t.complete()},l=()=>{s=null,o&&t.complete()};e.subscribe(se(t,c=>{n=!0,r=c,s||Ce(i(c)).subscribe(s=se(t,a,l))},()=>{o=!0,(!n||!s||s.closed)&&t.complete()}))})}function qa(i,e=Fs){return uy(()=>cy(i,e))}function si(i){return le((e,t)=>{let n=null,r=!1,s;n=e.subscribe(se(t,void 0,void 0,o=>{s=Ce(i(o,si(i)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):r=!0})),r&&(n.unsubscribe(),n=null,s.subscribe(t))})}function dy(i,e,t,n,r){return(s,o)=>{let a=t,l=e,c=0;s.subscribe(se(o,u=>{let d=c++;l=a?i(l,u,d):(a=!0,u),n&&o.next(l)},r&&(()=>{a&&o.next(l),o.complete()})))}}function Or(i,e){return Q(e)?He(i,e,1):He(i,1)}function Ka(i,e=Fs){return le((t,n)=>{let r=null,s=null,o=null,a=()=>{if(r){r.unsubscribe(),r=null;let c=s;s=null,n.next(c)}};function l(){let c=o+i,u=e.now();if(u<c){r=this.schedule(void 0,c-u),n.add(r);return}a()}t.subscribe(se(n,c=>{s=c,o=e.now(),r||(r=e.schedule(l,i),n.add(r))},()=>{a(),n.complete()},void 0,()=>{s=r=null}))})}function oi(i){return le((e,t)=>{let n=!1;e.subscribe(se(t,r=>{n=!0,t.next(r)},()=>{n||t.next(i),t.complete()}))})}function Pt(i){return i<=0?()=>ht:le((e,t)=>{let n=0;e.subscribe(se(t,r=>{++n<=i&&(t.next(r),i<=n&&t.complete())}))})}function pd(i){return pe(()=>i)}function Ya(i,e=dt){return i=i??ix,le((t,n)=>{let r,s=!0;t.subscribe(se(n,o=>{let a=e(o);(s||!i(r,a))&&(s=!1,r=a,n.next(o))}))})}function ix(i,e){return i===e}function Qa(i=rx){return le((e,t)=>{let n=!1;e.subscribe(se(t,r=>{n=!0,t.next(r)},()=>n?t.complete():t.error(i())))})}function rx(){return new Un}function js(i){return le((e,t)=>{try{e.subscribe(t)}finally{t.add(i)}})}function mn(i,e){let t=arguments.length>=2;return n=>n.pipe(i?Je((r,s)=>i(r,s,n)):dt,Pt(1),t?oi(e):Qa(()=>new Un))}function Nr(i){return i<=0?()=>ht:le((e,t)=>{let n=[];e.subscribe(se(t,r=>{n.push(r),i<n.length&&n.shift()},()=>{for(let r of n)t.next(r);t.complete()},void 0,()=>{n=null}))})}function md(i,e){let t=arguments.length>=2;return n=>n.pipe(i?Je((r,s)=>i(r,s,n)):dt,Nr(1),t?oi(e):Qa(()=>new Un))}function gd(i,e){return le(dy(i,e,arguments.length>=2,!0))}function yd(i={}){let{connector:e=()=>new fe,resetOnError:t=!0,resetOnComplete:n=!0,resetOnRefCountZero:r=!0}=i;return s=>{let o,a,l,c=0,u=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=l=void 0,u=d=!1},p=()=>{let m=o;f(),m?.unsubscribe()};return le((m,g)=>{c++,!d&&!u&&h();let y=l=l??e();g.add(()=>{c--,c===0&&!d&&!u&&(a=vd(p,r))}),y.subscribe(g),!o&&c>0&&(o=new Vn({next:_=>y.next(_),error:_=>{d=!0,h(),a=vd(f,t,_),y.error(_)},complete:()=>{u=!0,h(),a=vd(f,n),y.complete()}}),Ce(m).subscribe(o))})(s)}}function vd(i,e,...t){if(e===!0){i();return}if(e===!1)return;let n=new Vn({next:()=>{n.unsubscribe(),i()}});return Ce(e(...t)).subscribe(n)}function $s(i){return Je((e,t)=>i<=t)}function Pr(...i){let e=pn(i);return le((t,n)=>{(e?ri(i,t,e):ri(i,t)).subscribe(n)})}function Ft(i,e){return le((t,n)=>{let r=null,s=0,o=!1,a=()=>o&&!r&&n.complete();t.subscribe(se(n,l=>{r?.unsubscribe();let c=0,u=s++;Ce(i(l,u)).subscribe(r=se(n,d=>n.next(e?e(l,d,u,c++):d),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function yt(i){return le((e,t)=>{Ce(i).subscribe(se(t,()=>t.complete(),Ns)),!t.closed&&e.subscribe(t)})}function et(i,e,t){let n=Q(i)||e||t?{next:i,error:e,complete:t}:i;return n?le((r,s)=>{var o;(o=n.subscribe)===null||o===void 0||o.call(n);let a=!0;r.subscribe(se(s,l=>{var c;(c=n.next)===null||c===void 0||c.call(n,l),s.next(l)},()=>{var l;a=!1,(l=n.complete)===null||l===void 0||l.call(n),s.complete()},l=>{var c;a=!1,(c=n.error)===null||c===void 0||c.call(n,l),s.error(l)},()=>{var l,c;a&&((l=n.unsubscribe)===null||l===void 0||l.call(n)),(c=n.finalize)===null||c===void 0||c.call(n)}))}):dt}var ox="https://g.co/ng/security#xss",V=class extends Error{constructor(e,t){super(Sh(e,t)),this.code=e}};function Sh(i,e){return`${`NG0${Math.abs(i)}`}${e?": "+e:""}`}function Tl(i){return{toString:i}.toString()}var Vt=globalThis;function Re(i){for(let e in i)if(i[e]===Re)return e;throw Error("Could not find renamed property on target object.")}function ax(i,e){for(let t in e)e.hasOwnProperty(t)&&!i.hasOwnProperty(t)&&(i[t]=e[t])}function pt(i){if(typeof i=="string")return i;if(Array.isArray(i))return"["+i.map(pt).join(", ")+"]";if(i==null)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;let e=i.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function Od(i,e){return i==null||i===""?e===null?"":e:e==null||e===""?i:i+" "+e}var lx=Re({__forward_ref__:Re});function to(i){return i.__forward_ref__=to,i.toString=function(){return pt(this())},i}function ft(i){return Hy(i)?i():i}function Hy(i){return typeof i=="function"&&i.hasOwnProperty(lx)&&i.__forward_ref__===to}function j(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function _e(i){return{providers:i.providers||[],imports:i.imports||[]}}function xl(i){return hy(i,zy)||hy(i,Wy)}function Gy(i){return xl(i)!==null}function hy(i,e){return i.hasOwnProperty(e)?i[e]:null}function cx(i){let e=i&&(i[zy]||i[Wy]);return e||null}function fy(i){return i&&(i.hasOwnProperty(py)||i.hasOwnProperty(ux))?i[py]:null}var zy=Re({\u0275prov:Re}),py=Re({\u0275inj:Re}),Wy=Re({ngInjectableDef:Re}),ux=Re({ngInjectorDef:Re}),G=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=j({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function qy(i){return i&&!!i.\u0275providers}var dx=Re({\u0275cmp:Re}),hx=Re({\u0275dir:Re}),fx=Re({\u0275pipe:Re}),px=Re({\u0275mod:Re}),sl=Re({\u0275fac:Re}),Hs=Re({__NG_ELEMENT_ID__:Re}),my=Re({__NG_ENV_ID__:Re});function Th(i){return typeof i=="string"?i:i==null?"":String(i)}function mx(i){return typeof i=="function"?i.name||i.toString():typeof i=="object"&&i!=null&&typeof i.type=="function"?i.type.name||i.type.toString():Th(i)}function gx(i,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${i}`:"";throw new V(-200,i)}function xh(i,e){throw new V(-201,!1)}var ge=function(i){return i[i.Default=0]="Default",i[i.Host=1]="Host",i[i.Self=2]="Self",i[i.SkipSelf=4]="SkipSelf",i[i.Optional=8]="Optional",i}(ge||{}),Nd;function Ky(){return Nd}function Bt(i){let e=Nd;return Nd=i,e}function Yy(i,e,t){let n=xl(i);if(n&&n.providedIn=="root")return n.value===void 0?n.value=n.factory():n.value;if(t&ge.Optional)return null;if(e!==void 0)return e;xh(i,"Injector")}var vx={},Gs=vx,yx="__NG_DI_FLAG__",ol="ngTempTokenPath",bx="ngTokenPath",_x=/\n/gm,Ex="\u0275",gy="__source",Ur;function Dx(){return Ur}function ai(i){let e=Ur;return Ur=i,e}function wx(i,e=ge.Default){if(Ur===void 0)throw new V(-203,!1);return Ur===null?Yy(i,void 0,e):Ur.get(i,e&ge.Optional?null:void 0,e)}function C(i,e=ge.Default){return(Ky()||wx)(ft(i),e)}function L(i,e=ge.Default){return C(i,Il(e))}function Il(i){return typeof i>"u"||typeof i=="number"?i:0|(i.optional&&8)|(i.host&&1)|(i.self&&2)|(i.skipSelf&&4)}function Pd(i){let e=[];for(let t=0;t<i.length;t++){let n=ft(i[t]);if(Array.isArray(n)){if(n.length===0)throw new V(900,!1);let r,s=ge.Default;for(let o=0;o<n.length;o++){let a=n[o],l=Sx(a);typeof l=="number"?l===-1?r=a.token:s|=l:r=a}e.push(C(r,s))}else e.push(C(n))}return e}function Sx(i){return i[yx]}function Tx(i,e,t,n){let r=i[ol];throw e[gy]&&r.unshift(e[gy]),i.message=xx(`
`+i.message,r,t,n),i[bx]=r,i[ol]=null,i}function xx(i,e,t,n=null){i=i&&i.charAt(0)===`
`&&i.charAt(1)==Ex?i.slice(2):i;let r=pt(e);if(Array.isArray(e))r=e.map(pt).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):pt(a)))}r=`{${s.join(", ")}}`}return`${t}${n?"("+n+")":""}[${r}]: ${i.replace(_x,`
  `)}`}function $r(i,e){let t=i.hasOwnProperty(sl);return t?i[sl]:null}function Ix(i,e,t){if(i.length!==e.length)return!1;for(let n=0;n<i.length;n++){let r=i[n],s=e[n];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}function Cx(i){return i.flat(Number.POSITIVE_INFINITY)}function Ih(i,e){i.forEach(t=>Array.isArray(t)?Ih(t,e):e(t))}function Qy(i,e,t){e>=i.length?i.push(t):i.splice(e,0,t)}function al(i,e){return e>=i.length-1?i.pop():i.splice(e,1)[0]}function Ax(i,e){let t=[];for(let n=0;n<i;n++)t.push(e);return t}function Rx(i,e,t,n){let r=i.length;if(r==e)i.push(t,n);else if(r===1)i.push(n,i[0]),i[0]=t;else{for(r--,i.push(i[r-1],i[r]);r>e;){let s=r-2;i[r]=i[s],r--}i[e]=t,i[e+1]=n}}function Ch(i,e,t){let n=no(i,e);return n>=0?i[n|1]=t:(n=~n,Rx(i,n,e,t)),n}function bd(i,e){let t=no(i,e);if(t>=0)return i[t|1]}function no(i,e){return Mx(i,e,1)}function Mx(i,e,t){let n=0,r=i.length>>t;for(;r!==n;){let s=n+(r-n>>1),o=i[s<<t];if(e===o)return s<<t;o>e?r=s:n=s+1}return~(r<<t)}var Hr={},bt=[],Gr=new G(""),Xy=new G("",-1),Zy=new G(""),ll=class{get(e,t=Gs){if(t===Gs){let n=new Error(`NullInjectorError: No provider for ${pt(e)}!`);throw n.name="NullInjectorError",n}return t}},Jy=function(i){return i[i.OnPush=0]="OnPush",i[i.Default=1]="Default",i}(Jy||{}),yn=function(i){return i[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",i}(yn||{}),we=function(i){return i[i.None=0]="None",i[i.SignalBased=1]="SignalBased",i[i.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",i}(we||{});function kx(i,e,t){let n=i.length;for(;;){let r=i.indexOf(e,t);if(r===-1)return r;if(r===0||i.charCodeAt(r-1)<=32){let s=e.length;if(r+s===n||i.charCodeAt(r+s)<=32)return r}t=r+1}}function Fd(i,e,t){let n=0;for(;n<t.length;){let r=t[n];if(typeof r=="number"){if(r!==0)break;n++;let s=t[n++],o=t[n++],a=t[n++];i.setAttribute(e,o,a,s)}else{let s=r,o=t[++n];Ox(s)?i.setProperty(e,s,o):i.setAttribute(e,s,o),n++}}return n}function Lx(i){return i===3||i===4||i===6}function Ox(i){return i.charCodeAt(0)===64}function zs(i,e){if(!(e===null||e.length===0))if(i===null||i.length===0)i=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){let r=e[n];typeof r=="number"?t=r:t===0||(t===-1||t===2?vy(i,t,r,null,e[++n]):vy(i,t,r,null,null))}}return i}function vy(i,e,t,n,r){let s=0,o=i.length;if(e===-1)o=-1;else for(;s<i.length;){let a=i[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<i.length;){let a=i[s];if(typeof a=="number")break;if(a===t){if(n===null){r!==null&&(i[s+1]=r);return}else if(n===i[s+1]){i[s+2]=r;return}}s++,n!==null&&s++,r!==null&&s++}o!==-1&&(i.splice(o,0,e),s=o+1),i.splice(s++,0,t),n!==null&&i.splice(s++,0,n),r!==null&&i.splice(s++,0,r)}var e0="ng-template";function Nx(i,e,t,n){let r=0;if(n){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&kx(e[r+1].toLowerCase(),t,0)!==-1)return!0}else if(Ah(i))return!1;if(r=e.indexOf(1,r),r>-1){let s;for(;++r<e.length&&typeof(s=e[r])=="string";)if(s.toLowerCase()===t)return!0}return!1}function Ah(i){return i.type===4&&i.value!==e0}function Px(i,e,t){let n=i.type===4&&!t?e0:i.value;return e===n}function Fx(i,e,t){let n=4,r=i.attrs,s=r!==null?Ux(r):0,o=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!o&&!Xt(n)&&!Xt(l))return!1;if(o&&Xt(l))continue;o=!1,n=l|n&1;continue}if(!o)if(n&4){if(n=2|n&1,l!==""&&!Px(i,l,t)||l===""&&e.length===1){if(Xt(n))return!1;o=!0}}else if(n&8){if(r===null||!Nx(i,r,l,t)){if(Xt(n))return!1;o=!0}}else{let c=e[++a],u=Bx(l,r,Ah(i),t);if(u===-1){if(Xt(n))return!1;o=!0;continue}if(c!==""){let d;if(u>s?d="":d=r[u+1].toLowerCase(),n&2&&c!==d){if(Xt(n))return!1;o=!0}}}}return Xt(n)||o}function Xt(i){return(i&1)===0}function Bx(i,e,t,n){if(e===null)return-1;let r=0;if(n||!t){let s=!1;for(;r<e.length;){let o=e[r];if(o===i)return r;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++r];for(;typeof a=="string";)a=e[++r];continue}else{if(o===4)break;if(o===0){r+=4;continue}}r+=s?1:2}return-1}else return jx(e,i)}function t0(i,e,t=!1){for(let n=0;n<e.length;n++)if(Fx(i,e[n],t))return!0;return!1}function Vx(i){let e=i.attrs;if(e!=null){let t=e.indexOf(5);if(!(t&1))return e[t+1]}return null}function Ux(i){for(let e=0;e<i.length;e++){let t=i[e];if(Lx(t))return e}return i.length}function jx(i,e){let t=i.indexOf(4);if(t>-1)for(t++;t<i.length;){let n=i[t];if(typeof n=="number")return-1;if(n===e)return t;t++}return-1}function $x(i,e){e:for(let t=0;t<e.length;t++){let n=e[t];if(i.length===n.length){for(let r=0;r<i.length;r++)if(i[r]!==n[r])continue e;return!0}}return!1}function yy(i,e){return i?":not("+e.trim()+")":e}function Hx(i){let e=i[0],t=1,n=2,r="",s=!1;for(;t<i.length;){let o=i[t];if(typeof o=="string")if(n&2){let a=i[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else n&8?r+="."+o:n&4&&(r+=" "+o);else r!==""&&!Xt(o)&&(e+=yy(s,r),r=""),n=o,s=s||!Xt(n);t++}return r!==""&&(e+=yy(s,r)),e}function Gx(i){return i.map(Hx).join(",")}function zx(i){let e=[],t=[],n=1,r=2;for(;n<i.length;){let s=i[n];if(typeof s=="string")r===2?s!==""&&e.push(s,i[++n]):r===8&&t.push(s);else{if(!Xt(r))break;r=s}n++}return{attrs:e,classes:t}}function nn(i){return Tl(()=>{let e=o0(i),t=Ie(N({},e),{decls:i.decls,vars:i.vars,template:i.template,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,onPush:i.changeDetection===Jy.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&i.dependencies||null,getStandaloneInjector:null,signals:i.signals??!1,data:i.data||{},encapsulation:i.encapsulation||yn.Emulated,styles:i.styles||bt,_:null,schemas:i.schemas||null,tView:null,id:""});a0(t);let n=i.dependencies;return t.directiveDefs=_y(n,!1),t.pipeDefs=_y(n,!0),t.id=Kx(t),t})}function Wx(i){return Oi(i)||n0(i)}function qx(i){return i!==null}function Ee(i){return Tl(()=>({type:i.type,bootstrap:i.bootstrap||bt,declarations:i.declarations||bt,imports:i.imports||bt,exports:i.exports||bt,transitiveCompileScopes:null,schemas:i.schemas||null,id:i.id||null}))}function by(i,e){if(i==null)return Hr;let t={};for(let n in i)if(i.hasOwnProperty(n)){let r=i[n],s,o,a=we.None;Array.isArray(r)?(a=r[0],s=r[1],o=r[2]??s):(s=r,o=r),e?(t[s]=a!==we.None?[n,a]:n,e[s]=o):t[s]=n}return t}function Le(i){return Tl(()=>{let e=o0(i);return a0(e),e})}function Oi(i){return i[dx]||null}function n0(i){return i[hx]||null}function i0(i){return i[fx]||null}function r0(i){let e=Oi(i)||n0(i)||i0(i);return e!==null?e.standalone:!1}function s0(i,e){let t=i[px]||null;if(!t&&e===!0)throw new Error(`Type ${pt(i)} does not have '\u0275mod' property.`);return t}function o0(i){let e={};return{type:i.type,providersResolver:null,factory:null,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:i.inputs||Hr,exportAs:i.exportAs||null,standalone:i.standalone===!0,signals:i.signals===!0,selectors:i.selectors||bt,viewQuery:i.viewQuery||null,features:i.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:by(i.inputs,e),outputs:by(i.outputs),debugInfo:null}}function a0(i){i.features?.forEach(e=>e(i))}function _y(i,e){if(!i)return null;let t=e?i0:Wx;return()=>(typeof i=="function"?i():i).map(n=>t(n)).filter(qx)}function Kx(i){let e=0,t=[i.selectors,i.ngContentSelectors,i.hostVars,i.hostAttrs,i.consts,i.vars,i.decls,i.encapsulation,i.standalone,i.signals,i.exportAs,JSON.stringify(i.inputs),JSON.stringify(i.outputs),Object.getOwnPropertyNames(i.type.prototype),!!i.contentQueries,!!i.viewQuery].join("|");for(let r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function Cl(i){return{\u0275providers:i}}function Al(...i){return{\u0275providers:l0(!0,i),\u0275fromNgModule:!0}}function l0(i,...e){let t=[],n=new Set,r,s=o=>{t.push(o)};return Ih(e,o=>{let a=o;Bd(a,s,[],n)&&(r||=[],r.push(a))}),r!==void 0&&c0(r,s),t}function c0(i,e){for(let t=0;t<i.length;t++){let{ngModule:n,providers:r}=i[t];Rh(r,s=>{e(s,n)})}}function Bd(i,e,t,n){if(i=ft(i),!i)return!1;let r=null,s=fy(i),o=!s&&Oi(i);if(!s&&!o){let l=i.ngModule;if(s=fy(l),s)r=l;else return!1}else{if(o&&!o.standalone)return!1;r=i}let a=n.has(r);if(o){if(a)return!1;if(n.add(r),o.dependencies){let l=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let c of l)Bd(c,e,t,n)}}else if(s){if(s.imports!=null&&!a){n.add(r);let c;try{Ih(s.imports,u=>{Bd(u,e,t,n)&&(c||=[],c.push(u))})}finally{}c!==void 0&&c0(c,e)}if(!a){let c=$r(r)||(()=>new r);e({provide:r,useFactory:c,deps:bt},r),e({provide:Zy,useValue:r,multi:!0},r),e({provide:Gr,useValue:()=>C(r),multi:!0},r)}let l=s.providers;if(l!=null&&!a){let c=i;Rh(l,u=>{e(u,c)})}}else return!1;return r!==i&&i.providers!==void 0}function Rh(i,e){for(let t of i)qy(t)&&(t=t.\u0275providers),Array.isArray(t)?Rh(t,e):e(t)}var Yx=Re({provide:String,useValue:Re});function u0(i){return i!==null&&typeof i=="object"&&Yx in i}function Qx(i){return!!(i&&i.useExisting)}function Xx(i){return!!(i&&i.useFactory)}function zr(i){return typeof i=="function"}function Zx(i){return!!i.useClass}var Rl=new G(""),Ja={},Jx={},_d;function Mh(){return _d===void 0&&(_d=new ll),_d}var Et=class{},Ws=class extends Et{get destroyed(){return this._destroyed}constructor(e,t,n,r){super(),this.parent=t,this.source=n,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Ud(e,o=>this.processProvider(o)),this.records.set(Xy,Fr(void 0,this)),r.has("environment")&&this.records.set(Et,Fr(void 0,this));let s=this.records.get(Rl);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(Zy,bt,ge.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=ye(null);try{for(let n of this._ngOnDestroyHooks)n.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let n of t)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),ye(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=ai(this),n=Bt(void 0),r;try{return e()}finally{ai(t),Bt(n)}}get(e,t=Gs,n=ge.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(my))return e[my](this);n=Il(n);let r,s=ai(this),o=Bt(void 0);try{if(!(n&ge.SkipSelf)){let l=this.records.get(e);if(l===void 0){let c=rI(e)&&xl(e);c&&this.injectableDefInScope(c)?l=Fr(Vd(e),Ja):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l)}let a=n&ge.Self?Mh():this.parent;return t=n&ge.Optional&&t===Gs?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[ol]=a[ol]||[]).unshift(pt(e)),s)throw a;return Tx(a,e,"R3InjectorError",this.source)}else throw a}finally{Bt(o),ai(s)}}resolveInjectorInitializers(){let e=ye(null),t=ai(this),n=Bt(void 0),r;try{let s=this.get(Gr,bt,ge.Self);for(let o of s)o()}finally{ai(t),Bt(n),ye(e)}}toString(){let e=[],t=this.records;for(let n of t.keys())e.push(pt(n));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new V(205,!1)}processProvider(e){e=ft(e);let t=zr(e)?e:ft(e&&e.provide),n=tI(e);if(!zr(e)&&e.multi===!0){let r=this.records.get(t);r||(r=Fr(void 0,Ja,!0),r.factory=()=>Pd(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,n)}hydrate(e,t){let n=ye(null);try{return t.value===Ja&&(t.value=Jx,t.value=t.factory()),typeof t.value=="object"&&t.value&&iI(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{ye(n)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=ft(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Vd(i){let e=xl(i),t=e!==null?e.factory:$r(i);if(t!==null)return t;if(i instanceof G)throw new V(204,!1);if(i instanceof Function)return eI(i);throw new V(204,!1)}function eI(i){if(i.length>0)throw new V(204,!1);let t=cx(i);return t!==null?()=>t.factory(i):()=>new i}function tI(i){if(u0(i))return Fr(void 0,i.useValue);{let e=d0(i);return Fr(e,Ja)}}function d0(i,e,t){let n;if(zr(i)){let r=ft(i);return $r(r)||Vd(r)}else if(u0(i))n=()=>ft(i.useValue);else if(Xx(i))n=()=>i.useFactory(...Pd(i.deps||[]));else if(Qx(i))n=()=>C(ft(i.useExisting));else{let r=ft(i&&(i.useClass||i.provide));if(nI(i))n=()=>new r(...Pd(i.deps));else return $r(r)||Vd(r)}return n}function Fr(i,e,t=!1){return{factory:i,value:e,multi:t?[]:void 0}}function nI(i){return!!i.deps}function iI(i){return i!==null&&typeof i=="object"&&typeof i.ngOnDestroy=="function"}function rI(i){return typeof i=="function"||typeof i=="object"&&i instanceof G}function Ud(i,e){for(let t of i)Array.isArray(t)?Ud(t,e):t&&qy(t)?Ud(t.\u0275providers,e):e(t)}function Gn(i,e){i instanceof Ws&&i.assertNotDestroyed();let t,n=ai(i),r=Bt(void 0);try{return e()}finally{ai(n),Bt(r)}}function h0(){return Ky()!==void 0||Dx()!=null}function Ml(i){if(!h0())throw new V(-203,!1)}function sI(i){return typeof i=="function"}var Dn=0,ue=1,te=2,st=3,Jt=4,It=5,qs=6,Ks=7,Ut=8,Wr=9,bn=10,We=11,Ys=12,Ey=13,Qr=14,en=15,io=16,Br=17,jn=18,kl=19,f0=20,li=21,Ed=22,Ni=23,jt=25,kh=1;var Pi=7,cl=8,qr=9,_t=10,Lh=function(i){return i[i.None=0]="None",i[i.HasTransplantedViews=2]="HasTransplantedViews",i}(Lh||{});function ki(i){return Array.isArray(i)&&typeof i[kh]=="object"}function zn(i){return Array.isArray(i)&&i[kh]===!0}function p0(i){return(i.flags&4)!==0}function Ll(i){return i.componentOffset>-1}function Oh(i){return(i.flags&1)===1}function $n(i){return!!i.template}function oI(i){return(i[te]&512)!==0}var jd=class{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}};function m0(i,e,t,n){e!==null?e.applyValueToInputSignal(e,n):i[t]=n}function Wn(){return g0}function g0(i){return i.type.prototype.ngOnChanges&&(i.setInput=lI),aI}Wn.ngInherit=!0;function aI(){let i=y0(this),e=i?.current;if(e){let t=i.previous;if(t===Hr)i.previous=e;else for(let n in e)t[n]=e[n];i.current=null,this.ngOnChanges(e)}}function lI(i,e,t,n,r){let s=this.declaredInputs[n],o=y0(i)||cI(i,{previous:Hr,current:null}),a=o.current||(o.current={}),l=o.previous,c=l[s];a[s]=new jd(c&&c.currentValue,t,l===Hr),m0(i,e,r,t)}var v0="__ngSimpleChanges__";function y0(i){return i[v0]||null}function cI(i,e){return i[v0]=e}var Dy=null;var gn=function(i,e,t){Dy?.(i,e,t)},uI="svg",dI="math",hI=!1;function fI(){return hI}function _n(i){for(;Array.isArray(i);)i=i[Dn];return i}function pI(i){for(;Array.isArray(i);){if(typeof i[kh]=="object")return i;i=i[Dn]}return null}function b0(i,e){return _n(e[i])}function $t(i,e){return _n(e[i.index])}function Nh(i,e){return i.data[e]}function mI(i,e){return i[e]}function ui(i,e){let t=e[i];return ki(t)?t:t[Dn]}function gI(i){return(i[te]&4)===4}function Ph(i){return(i[te]&128)===128}function vI(i){return zn(i[st])}function ul(i,e){return e==null?null:i[e]}function _0(i){i[Br]=0}function yI(i){i[te]&1024||(i[te]|=1024,Ph(i)&&Qs(i))}function bI(i,e){for(;i>0;)e=e[Qr],i--;return e}function Fh(i){return!!(i[te]&9216||i[Ni]?.dirty)}function $d(i){i[bn].changeDetectionScheduler?.notify(1),Fh(i)?Qs(i):i[te]&64&&(fI()?(i[te]|=1024,Qs(i)):i[bn].changeDetectionScheduler?.notify())}function Qs(i){i[bn].changeDetectionScheduler?.notify();let e=Xs(i);for(;e!==null&&!(e[te]&8192||(e[te]|=8192,!Ph(e)));)e=Xs(e)}function E0(i,e){if((i[te]&256)===256)throw new V(911,!1);i[li]===null&&(i[li]=[]),i[li].push(e)}function _I(i,e){if(i[li]===null)return;let t=i[li].indexOf(e);t!==-1&&i[li].splice(t,1)}function Xs(i){let e=i[st];return zn(e)?e[st]:e}var ve={lFrame:M0(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function EI(){return ve.lFrame.elementDepthCount}function DI(){ve.lFrame.elementDepthCount++}function wI(){ve.lFrame.elementDepthCount--}function D0(){return ve.bindingsEnabled}function w0(){return ve.skipHydrationRootTNode!==null}function SI(i){return ve.skipHydrationRootTNode===i}function TI(){ve.skipHydrationRootTNode=null}function Se(){return ve.lFrame.lView}function ot(){return ve.lFrame.tView}function wn(i){return ve.lFrame.contextLView=i,i[Ut]}function Sn(i){return ve.lFrame.contextLView=null,i}function Ct(){let i=S0();for(;i!==null&&i.type===64;)i=i.parent;return i}function S0(){return ve.lFrame.currentTNode}function xI(){let i=ve.lFrame,e=i.currentTNode;return i.isParent?e:e.parent}function ro(i,e){let t=ve.lFrame;t.currentTNode=i,t.isParent=e}function T0(){return ve.lFrame.isParent}function x0(){ve.lFrame.isParent=!1}function II(){return ve.lFrame.contextLView}function CI(i){return ve.lFrame.bindingIndex=i}function so(){return ve.lFrame.bindingIndex++}function I0(i){let e=ve.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+i,t}function AI(){return ve.lFrame.inI18n}function RI(i,e){let t=ve.lFrame;t.bindingIndex=t.bindingRootIndex=i,Hd(e)}function MI(){return ve.lFrame.currentDirectiveIndex}function Hd(i){ve.lFrame.currentDirectiveIndex=i}function Bh(i){let e=ve.lFrame.currentDirectiveIndex;return e===-1?null:i[e]}function C0(){return ve.lFrame.currentQueryIndex}function Vh(i){ve.lFrame.currentQueryIndex=i}function kI(i){let e=i[ue];return e.type===2?e.declTNode:e.type===1?i[It]:null}function A0(i,e,t){if(t&ge.SkipSelf){let r=e,s=i;for(;r=r.parent,r===null&&!(t&ge.Host);)if(r=kI(s),r===null||(s=s[Qr],r.type&10))break;if(r===null)return!1;e=r,i=s}let n=ve.lFrame=R0();return n.currentTNode=e,n.lView=i,!0}function Uh(i){let e=R0(),t=i[ue];ve.lFrame=e,e.currentTNode=t.firstChild,e.lView=i,e.tView=t,e.contextLView=i,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function R0(){let i=ve.lFrame,e=i===null?null:i.child;return e===null?M0(i):e}function M0(i){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return i!==null&&(i.child=e),e}function k0(){let i=ve.lFrame;return ve.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}var L0=k0;function jh(){let i=k0();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function LI(i){return(ve.lFrame.contextLView=bI(i,ve.lFrame.contextLView))[Ut]}function Gi(){return ve.lFrame.selectedIndex}function Fi(i){ve.lFrame.selectedIndex=i}function $h(){let i=ve.lFrame;return Nh(i.tView,i.selectedIndex)}function OI(){return ve.lFrame.currentNamespace}var O0=!0;function Hh(){return O0}function Gh(i){O0=i}function NI(i,e,t){let{ngOnChanges:n,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(n){let o=g0(e);(t.preOrderHooks??=[]).push(i,o),(t.preOrderCheckHooks??=[]).push(i,o)}r&&(t.preOrderHooks??=[]).push(0-i,r),s&&((t.preOrderHooks??=[]).push(i,s),(t.preOrderCheckHooks??=[]).push(i,s))}function zh(i,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){let s=i.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=s;o&&(i.contentHooks??=[]).push(-t,o),a&&((i.contentHooks??=[]).push(t,a),(i.contentCheckHooks??=[]).push(t,a)),l&&(i.viewHooks??=[]).push(-t,l),c&&((i.viewHooks??=[]).push(t,c),(i.viewCheckHooks??=[]).push(t,c)),u!=null&&(i.destroyHooks??=[]).push(t,u)}}function el(i,e,t){N0(i,e,3,t)}function tl(i,e,t,n){(i[te]&3)===t&&N0(i,e,t,n)}function Dd(i,e){let t=i[te];(t&3)===e&&(t&=16383,t+=1,i[te]=t)}function N0(i,e,t,n){let r=n!==void 0?i[Br]&65535:0,s=n??-1,o=e.length-1,a=0;for(let l=r;l<o;l++)if(typeof e[l+1]=="number"){if(a=e[l],n!=null&&a>=n)break}else e[l]<0&&(i[Br]+=65536),(a<s||s==-1)&&(PI(i,t,e,l),i[Br]=(i[Br]&4294901760)+l+2),l++}function wy(i,e){gn(4,i,e);let t=ye(null);try{e.call(i)}finally{ye(t),gn(5,i,e)}}function PI(i,e,t,n){let r=t[n]<0,s=t[n+1],o=r?-t[n]:t[n],a=i[o];r?i[te]>>14<i[Br]>>16&&(i[te]&3)===e&&(i[te]+=16384,wy(a,s)):wy(a,s)}var jr=-1,Bi=class{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}};function FI(i){return i instanceof Bi}function BI(i){return(i.flags&8)!==0}function VI(i){return(i.flags&16)!==0}function P0(i){return i!==jr}function dl(i){return i&32767}function UI(i){return i>>16}function hl(i,e){let t=UI(i),n=e;for(;t>0;)n=n[Qr],t--;return n}var Gd=!0;function Sy(i){let e=Gd;return Gd=i,e}var jI=256,F0=jI-1,B0=5,$I=0,vn={};function HI(i,e,t){let n;typeof t=="string"?n=t.charCodeAt(0)||0:t.hasOwnProperty(Hs)&&(n=t[Hs]),n==null&&(n=t[Hs]=$I++);let r=n&F0,s=1<<r;e.data[i+(r>>B0)]|=s}function fl(i,e){let t=V0(i,e);if(t!==-1)return t;let n=e[ue];n.firstCreatePass&&(i.injectorIndex=e.length,wd(n.data,i),wd(e,null),wd(n.blueprint,null));let r=Wh(i,e),s=i.injectorIndex;if(P0(r)){let o=dl(r),a=hl(r,e),l=a[ue].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|l[o+c]}return e[s+8]=r,s}function wd(i,e){i.push(0,0,0,0,0,0,0,0,e)}function V0(i,e){return i.injectorIndex===-1||i.parent&&i.parent.injectorIndex===i.injectorIndex||e[i.injectorIndex+8]===null?-1:i.injectorIndex}function Wh(i,e){if(i.parent&&i.parent.injectorIndex!==-1)return i.parent.injectorIndex;let t=0,n=null,r=e;for(;r!==null;){if(n=G0(r),n===null)return jr;if(t++,r=r[Qr],n.injectorIndex!==-1)return n.injectorIndex|t<<16}return jr}function zd(i,e,t){HI(i,e,t)}function U0(i,e,t){if(t&ge.Optional||i!==void 0)return i;xh(e,"NodeInjector")}function j0(i,e,t,n){if(t&ge.Optional&&n===void 0&&(n=null),!(t&(ge.Self|ge.Host))){let r=i[Wr],s=Bt(void 0);try{return r?r.get(e,n,t&ge.Optional):Yy(e,n,t&ge.Optional)}finally{Bt(s)}}return U0(n,e,t)}function $0(i,e,t,n=ge.Default,r){if(i!==null){if(e[te]&2048&&!(n&ge.Self)){let o=qI(i,e,t,n,vn);if(o!==vn)return o}let s=H0(i,e,t,n,vn);if(s!==vn)return s}return j0(e,t,n,r)}function H0(i,e,t,n,r){let s=zI(t);if(typeof s=="function"){if(!A0(e,i,n))return n&ge.Host?U0(r,t,n):j0(e,t,n,r);try{let o;if(o=s(n),o==null&&!(n&ge.Optional))xh(t);else return o}finally{L0()}}else if(typeof s=="number"){let o=null,a=V0(i,e),l=jr,c=n&ge.Host?e[en][It]:null;for((a===-1||n&ge.SkipSelf)&&(l=a===-1?Wh(i,e):e[a+8],l===jr||!xy(n,!1)?a=-1:(o=e[ue],a=dl(l),e=hl(l,e)));a!==-1;){let u=e[ue];if(Ty(s,a,u.data)){let d=GI(a,e,t,o,n,c);if(d!==vn)return d}l=e[a+8],l!==jr&&xy(n,e[ue].data[a+8]===c)&&Ty(s,a,e)?(o=u,a=dl(l),e=hl(l,e)):a=-1}}return r}function GI(i,e,t,n,r,s){let o=e[ue],a=o.data[i+8],l=n==null?Ll(a)&&Gd:n!=o&&(a.type&3)!==0,c=r&ge.Host&&s===a,u=nl(a,o,t,l,c);return u!==null?Vi(e,o,u,a):vn}function nl(i,e,t,n,r){let s=i.providerIndexes,o=e.data,a=s&1048575,l=i.directiveStart,c=i.directiveEnd,u=s>>20,d=n?a:a+u,h=r?a+u:c;for(let f=d;f<h;f++){let p=o[f];if(f<l&&t===p||f>=l&&p.type===t)return f}if(r){let f=o[l];if(f&&$n(f)&&f.type===t)return l}return null}function Vi(i,e,t,n){let r=i[t],s=e.data;if(FI(r)){let o=r;o.resolving&&gx(mx(s[t]));let a=Sy(o.canSeeViewProviders);o.resolving=!0;let l,c=o.injectImpl?Bt(o.injectImpl):null,u=A0(i,n,ge.Default);try{r=i[t]=o.factory(void 0,s,i,n),e.firstCreatePass&&t>=n.directiveStart&&NI(t,s[t],e)}finally{c!==null&&Bt(c),Sy(a),o.resolving=!1,L0()}}return r}function zI(i){if(typeof i=="string")return i.charCodeAt(0)||0;let e=i.hasOwnProperty(Hs)?i[Hs]:void 0;return typeof e=="number"?e>=0?e&F0:WI:e}function Ty(i,e,t){let n=1<<i;return!!(t[e+(i>>B0)]&n)}function xy(i,e){return!(i&ge.Self)&&!(i&ge.Host&&e)}var Li=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return $0(this._tNode,this._lView,e,Il(n),t)}};function WI(){return new Li(Ct(),Se())}function Xr(i){return Tl(()=>{let e=i.prototype.constructor,t=e[sl]||Wd(e),n=Object.prototype,r=Object.getPrototypeOf(i.prototype).constructor;for(;r&&r!==n;){let s=r[sl]||Wd(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function Wd(i){return Hy(i)?()=>{let e=Wd(ft(i));return e&&e()}:$r(i)}function qI(i,e,t,n,r){let s=i,o=e;for(;s!==null&&o!==null&&o[te]&2048&&!(o[te]&512);){let a=H0(s,o,t,n|ge.Self,vn);if(a!==vn)return a;let l=s.parent;if(!l){let c=o[f0];if(c){let u=c.get(t,vn,n);if(u!==vn)return u}l=G0(o),o=o[Qr]}s=l}return r}function G0(i){let e=i[ue],t=e.type;return t===2?e.declTNode:t===1?i[It]:null}function Iy(i,e=null,t=null,n){let r=z0(i,e,t,n);return r.resolveInjectorInitializers(),r}function z0(i,e=null,t=null,n,r=new Set){let s=[t||bt,Al(i)];return n=n||(typeof i=="object"?void 0:pt(i)),new Ws(s,e||Mh(),n||null,r)}var qe=(()=>{let e=class e{static create(n,r){if(Array.isArray(n))return Iy({name:""},r,n,"");{let s=n.name??"";return Iy({name:s},n.parent,n.providers,s)}}};e.THROW_IF_NOT_FOUND=Gs,e.NULL=new ll,e.\u0275prov=j({token:e,providedIn:"any",factory:()=>C(Xy)}),e.__NG_ELEMENT_ID__=-1;let i=e;return i})();var KI="ngOriginalError";function Sd(i){return i[KI]}var En=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Sd(e);for(;t&&Sd(t);)t=Sd(t);return t||null}},W0=new G("",{providedIn:"root",factory:()=>L(En).handleError.bind(void 0)}),di=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=YI,e.__NG_ENV_ID__=n=>n;let i=e;return i})(),qd=class extends di{constructor(e){super(),this._lView=e}onDestroy(e){return E0(this._lView,e),()=>_I(this._lView,e)}};function YI(){return new qd(Se())}function QI(){return Zr(Ct(),Se())}function Zr(i,e){return new Me($t(i,e))}var Me=(()=>{let e=class e{constructor(n){this.nativeElement=n}};e.__NG_ELEMENT_ID__=QI;let i=e;return i})();function XI(i){return i instanceof Me?i.nativeElement:i}var Kd=class extends fe{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,h0()&&(this.destroyRef=L(di,{optional:!0})??void 0)}emit(e){let t=ye(null);try{super.next(e)}finally{ye(t)}}subscribe(e,t,n){let r=e,s=t||(()=>null),o=n;if(e&&typeof e=="object"){let l=e;r=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=Td(s),r&&(r=Td(r)),o&&(o=Td(o)));let a=super.subscribe({next:r,error:s,complete:o});return e instanceof ke&&e.add(a),a}};function Td(i){return e=>{setTimeout(i,void 0,e)}}var Pe=Kd;function ZI(){return this._results[Symbol.iterator]()}var pl=class i{get changes(){return this._changes??=new Pe}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;let t=i.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=ZI)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let n=Cx(e);(this._changesDetected=!Ix(this._results,n,t))&&(this._results=n,this.length=n.length,this.last=n[this.length-1],this.first=n[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}};function q0(i){return(i.flags&128)===128}var K0=new Map,JI=0;function eC(){return JI++}function tC(i){K0.set(i[kl],i)}function nC(i){K0.delete(i[kl])}var Cy="__ngContext__";function Ui(i,e){ki(e)?(i[Cy]=e[kl],tC(e)):i[Cy]=e}function Y0(i){return X0(i[Ys])}function Q0(i){return X0(i[Jt])}function X0(i){for(;i!==null&&!zn(i);)i=i[Jt];return i}var Yd;function Z0(i){Yd=i}function iC(){if(Yd!==void 0)return Yd;if(typeof document<"u")return document;throw new V(210,!1)}var oo=new G("",{providedIn:"root",factory:()=>rC}),rC="ng",qh=new G(""),qn=new G("",{providedIn:"platform",factory:()=>"unknown"});var Tn=new G(""),ao=new G("",{providedIn:"root",factory:()=>iC().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var sC="h",oC="b";var aC=()=>null;function Kh(i,e,t=!1){return aC(i,e,t)}var J0=!1,lC=new G("",{providedIn:"root",factory:()=>J0});var Qd=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${ox})`}};function Ol(i){return i instanceof Qd?i.changingThisBreaksApplicationSecurity:i}function eb(i){return i instanceof Function?i():i}function tb(i){return(i??L(qe)).get(qn)==="browser"}var Hn=function(i){return i[i.Important=1]="Important",i[i.DashCase=2]="DashCase",i}(Hn||{}),cC;function Yh(i,e){return cC(i,e)}function Vr(i,e,t,n,r){if(n!=null){let s,o=!1;zn(n)?s=n:ki(n)&&(o=!0,n=n[Dn]);let a=_n(n);i===0&&t!==null?r==null?ob(e,t,a):gl(e,t,a,r||null,!0):i===1&&t!==null?gl(e,t,a,r||null,!0):i===2?SC(e,a,o):i===3&&e.destroyNode(a),s!=null&&xC(e,i,s,t,r)}}function uC(i,e){return i.createText(e)}function dC(i,e,t){i.setValue(e,t)}function nb(i,e,t){return i.createElement(e,t)}function hC(i,e){ib(i,e),e[Dn]=null,e[It]=null}function fC(i,e,t,n,r,s){n[Dn]=r,n[It]=e,Nl(i,n,t,1,r,s)}function ib(i,e){e[bn].changeDetectionScheduler?.notify(1),Nl(i,e,e[We],2,null,null)}function pC(i){let e=i[Ys];if(!e)return xd(i[ue],i);for(;e;){let t=null;if(ki(e))t=e[Ys];else{let n=e[_t];n&&(t=n)}if(!t){for(;e&&!e[Jt]&&e!==i;)ki(e)&&xd(e[ue],e),e=e[st];e===null&&(e=i),ki(e)&&xd(e[ue],e),t=e&&e[Jt]}e=t}}function mC(i,e,t,n){let r=_t+n,s=t.length;n>0&&(t[r-1][Jt]=e),n<s-_t?(e[Jt]=t[r],Qy(t,_t+n,e)):(t.push(e),e[Jt]=null),e[st]=t;let o=e[io];o!==null&&t!==o&&gC(o,e);let a=e[jn];a!==null&&a.insertView(i),$d(e),e[te]|=128}function gC(i,e){let t=i[qr],r=e[st][st][en];e[en]!==r&&(i[te]|=Lh.HasTransplantedViews),t===null?i[qr]=[e]:t.push(e)}function rb(i,e){let t=i[qr],n=t.indexOf(e);t.splice(n,1)}function ml(i,e){if(i.length<=_t)return;let t=_t+e,n=i[t];if(n){let r=n[io];r!==null&&r!==i&&rb(r,n),e>0&&(i[t-1][Jt]=n[Jt]);let s=al(i,_t+e);hC(n[ue],n);let o=s[jn];o!==null&&o.detachView(s[ue]),n[st]=null,n[Jt]=null,n[te]&=-129}return n}function Qh(i,e){if(!(e[te]&256)){let t=e[We];t.destroyNode&&Nl(i,e,t,3,null,null),pC(e)}}function xd(i,e){if(e[te]&256)return;let t=ye(null);try{e[te]&=-129,e[te]|=256,e[Ni]&&Pv(e[Ni]),yC(i,e),vC(i,e),e[ue].type===1&&e[We].destroy();let n=e[io];if(n!==null&&zn(e[st])){n!==e[st]&&rb(n,e);let r=e[jn];r!==null&&r.detachView(i)}nC(e)}finally{ye(t)}}function vC(i,e){let t=i.cleanup,n=e[Ks];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?n[o]():n[-o].unsubscribe(),s+=2}else{let o=n[t[s+1]];t[s].call(o)}n!==null&&(e[Ks]=null);let r=e[li];if(r!==null){e[li]=null;for(let s=0;s<r.length;s++){let o=r[s];o()}}}function yC(i,e){let t;if(i!=null&&(t=i.destroyHooks)!=null)for(let n=0;n<t.length;n+=2){let r=e[t[n]];if(!(r instanceof Bi)){let s=t[n+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=r[s[o]],l=s[o+1];gn(4,a,l);try{l.call(a)}finally{gn(5,a,l)}}else{gn(4,r,s);try{s.call(r)}finally{gn(5,r,s)}}}}}function sb(i,e,t){return bC(i,e.parent,t)}function bC(i,e,t){let n=e;for(;n!==null&&n.type&40;)e=n,n=e.parent;if(n===null)return t[Dn];{let{componentOffset:r}=n;if(r>-1){let{encapsulation:s}=i.data[n.directiveStart+r];if(s===yn.None||s===yn.Emulated)return null}return $t(n,t)}}function gl(i,e,t,n,r){i.insertBefore(e,t,n,r)}function ob(i,e,t){i.appendChild(e,t)}function Ay(i,e,t,n,r){n!==null?gl(i,e,t,n,r):ob(i,e,t)}function _C(i,e,t,n){i.removeChild(e,t,n)}function Xh(i,e){return i.parentNode(e)}function EC(i,e){return i.nextSibling(e)}function ab(i,e,t){return wC(i,e,t)}function DC(i,e,t){return i.type&40?$t(i,t):null}var wC=DC,Ry;function Zh(i,e,t,n){let r=sb(i,n,e),s=e[We],o=n.parent||e[It],a=ab(o,n,e);if(r!=null)if(Array.isArray(t))for(let l=0;l<t.length;l++)Ay(s,r,t[l],a,!1);else Ay(s,r,t,a,!1);Ry!==void 0&&Ry(s,n,e,t,r)}function il(i,e){if(e!==null){let t=e.type;if(t&3)return $t(e,i);if(t&4)return Xd(-1,i[e.index]);if(t&8){let n=e.child;if(n!==null)return il(i,n);{let r=i[e.index];return zn(r)?Xd(-1,r):_n(r)}}else{if(t&32)return Yh(e,i)()||_n(i[e.index]);{let n=lb(i,e);if(n!==null){if(Array.isArray(n))return n[0];let r=Xs(i[en]);return il(r,n)}else return il(i,e.next)}}}return null}function lb(i,e){if(e!==null){let n=i[en][It],r=e.projection;return n.projection[r]}return null}function Xd(i,e){let t=_t+i+1;if(t<e.length){let n=e[t],r=n[ue].firstChild;if(r!==null)return il(n,r)}return e[Pi]}function SC(i,e,t){let n=Xh(i,e);n&&_C(i,n,e,t)}function Jh(i,e,t,n,r,s,o){for(;t!=null;){let a=n[t.index],l=t.type;if(o&&e===0&&(a&&Ui(_n(a),n),t.flags|=2),(t.flags&32)!==32)if(l&8)Jh(i,e,t.child,n,r,s,!1),Vr(e,i,r,a,s);else if(l&32){let c=Yh(t,n),u;for(;u=c();)Vr(e,i,r,u,s);Vr(e,i,r,a,s)}else l&16?cb(i,e,n,t,r,s):Vr(e,i,r,a,s);t=o?t.projectionNext:t.next}}function Nl(i,e,t,n,r,s){Jh(t,n,i.firstChild,e,r,s,!1)}function TC(i,e,t){let n=e[We],r=sb(i,t,e),s=t.parent||e[It],o=ab(s,t,e);cb(n,0,e,t,r,o)}function cb(i,e,t,n,r,s){let o=t[en],l=o[It].projection[n.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++){let u=l[c];Vr(e,i,r,u,s)}else{let c=l,u=o[st];q0(n)&&(c.flags|=128),Jh(i,e,c,u,r,s,!0)}}function xC(i,e,t,n,r){let s=t[Pi],o=_n(t);s!==o&&Vr(e,i,n,s,r);for(let a=_t;a<t.length;a++){let l=t[a];Nl(l[ue],l,i,e,n,s)}}function IC(i,e,t,n,r){if(e)r?i.addClass(t,n):i.removeClass(t,n);else{let s=n.indexOf("-")===-1?void 0:Hn.DashCase;r==null?i.removeStyle(t,n,s):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=Hn.Important),i.setStyle(t,n,r,s))}}function CC(i,e,t){i.setAttribute(e,"style",t)}function ub(i,e,t){t===""?i.removeAttribute(e,"class"):i.setAttribute(e,"class",t)}function db(i,e,t){let{mergedAttrs:n,classes:r,styles:s}=t;n!==null&&Fd(i,e,n),r!==null&&ub(i,e,r),s!==null&&CC(i,e,s)}var hi={};function mt(i=1){hb(ot(),Se(),Gi()+i,!1)}function hb(i,e,t,n){if(!n)if((e[te]&3)===3){let s=i.preOrderCheckHooks;s!==null&&el(e,s,t)}else{let s=i.preOrderHooks;s!==null&&tl(e,s,0,t)}Fi(t)}function X(i,e=ge.Default){let t=Se();if(t===null)return C(i,e);let n=Ct();return $0(n,t,ft(i),e)}function ef(){let i="invalid";throw new Error(i)}function fb(i,e,t,n,r,s){let o=ye(null);try{let a=null;r&we.SignalBased&&(a=e[n][kv]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),r&we.HasDecoratorInputTransform&&(s=i.inputTransforms[n].call(e,s)),i.setInput!==null?i.setInput(e,a,s,t,n):m0(e,a,n,s)}finally{ye(o)}}function AC(i,e){let t=i.hostBindingOpCodes;if(t!==null)try{for(let n=0;n<t.length;n++){let r=t[n];if(r<0)Fi(~r);else{let s=r,o=t[++n],a=t[++n];RI(o,s);let l=e[s];a(2,l)}}}finally{Fi(-1)}}function Pl(i,e,t,n,r,s,o,a,l,c,u){let d=e.blueprint.slice();return d[Dn]=r,d[te]=n|4|128|8|64,(c!==null||i&&i[te]&2048)&&(d[te]|=2048),_0(d),d[st]=d[Qr]=i,d[Ut]=t,d[bn]=o||i&&i[bn],d[We]=a||i&&i[We],d[Wr]=l||i&&i[Wr]||null,d[It]=s,d[kl]=eC(),d[qs]=u,d[f0]=c,d[en]=e.type==2?i[en]:d,d}function lo(i,e,t,n,r){let s=i.data[e];if(s===null)s=RC(i,e,t,n,r),AI()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=n,s.attrs=r;let o=xI();s.injectorIndex=o===null?-1:o.injectorIndex}return ro(s,!0),s}function RC(i,e,t,n,r){let s=S0(),o=T0(),a=o?s:s&&s.parent,l=i.data[e]=PC(i,a,t,e,n,r);return i.firstChild===null&&(i.firstChild=l),s!==null&&(o?s.child==null&&l.parent!==null&&(s.child=l):s.next===null&&(s.next=l,l.prev=s)),l}function pb(i,e,t,n){if(t===0)return-1;let r=e.length;for(let s=0;s<t;s++)e.push(n),i.blueprint.push(n),i.data.push(null);return r}function mb(i,e,t,n,r){let s=Gi(),o=n&2;try{Fi(-1),o&&e.length>jt&&hb(i,e,jt,!1),gn(o?2:0,r),t(n,r)}finally{Fi(s),gn(o?3:1,r)}}function gb(i,e,t){if(p0(e)){let n=ye(null);try{let r=e.directiveStart,s=e.directiveEnd;for(let o=r;o<s;o++){let a=i.data[o];if(a.contentQueries){let l=t[o];a.contentQueries(1,l,o)}}}finally{ye(n)}}}function vb(i,e,t){D0()&&($C(i,e,t,$t(t,e)),(t.flags&64)===64&&wb(i,e,t))}function yb(i,e,t=$t){let n=e.localNames;if(n!==null){let r=e.index+1;for(let s=0;s<n.length;s+=2){let o=n[s+1],a=o===-1?t(e,i):i[o];i[r++]=a}}}function bb(i){let e=i.tView;return e===null||e.incompleteFirstPass?i.tView=tf(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts,i.id):e}function tf(i,e,t,n,r,s,o,a,l,c,u){let d=jt+n,h=d+r,f=MC(d,h),p=typeof c=="function"?c():c;return f[ue]={type:i,blueprint:f,template:t,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1,ssrId:u}}function MC(i,e){let t=[];for(let n=0;n<e;n++)t.push(n<i?null:hi);return t}function kC(i,e,t,n){let s=n.get(lC,J0)||t===yn.ShadowDom,o=i.selectRootElement(e,s);return LC(o),o}function LC(i){OC(i)}var OC=()=>null;function NC(i,e,t,n){let r=xb(e);r.push(t),i.firstCreatePass&&Ib(i).push(n,r.length-1)}function PC(i,e,t,n,r,s){let o=e?e.injectorIndex:-1,a=0;return w0()&&(a|=128),{type:t,index:n,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function My(i,e,t,n,r){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;n??={};let a,l=we.None;Array.isArray(o)?(a=o[0],l=o[1]):a=o;let c=s;if(r!==null){if(!r.hasOwnProperty(s))continue;c=r[s]}i===0?ky(n,t,c,a,l):ky(n,t,c,a)}return n}function ky(i,e,t,n,r){let s;i.hasOwnProperty(t)?(s=i[t]).push(e,n):s=i[t]=[e,n],r!==void 0&&s.push(r)}function FC(i,e,t){let n=e.directiveStart,r=e.directiveEnd,s=i.data,o=e.attrs,a=[],l=null,c=null;for(let u=n;u<r;u++){let d=s[u],h=t?t.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;l=My(0,d.inputs,u,l,f),c=My(1,d.outputs,u,c,p);let m=l!==null&&o!==null&&!Ah(e)?JC(l,u,o):null;a.push(m)}l!==null&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}function BC(i){return i==="class"?"className":i==="for"?"htmlFor":i==="formaction"?"formAction":i==="innerHtml"?"innerHTML":i==="readonly"?"readOnly":i==="tabindex"?"tabIndex":i}function _b(i,e,t,n,r,s,o,a){let l=$t(e,t),c=e.inputs,u;!a&&c!=null&&(u=c[n])?(nf(i,t,u,n,r),Ll(e)&&VC(t,e.index)):e.type&3?(n=BC(n),r=o!=null?o(r,e.value||"",n):r,s.setProperty(l,n,r)):e.type&12}function VC(i,e){let t=ui(e,i);t[te]&16||(t[te]|=64)}function Eb(i,e,t,n){if(D0()){let r=n===null?null:{"":-1},s=GC(i,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&Db(i,e,t,o,r,a),r&&zC(t,n,r)}t.mergedAttrs=zs(t.mergedAttrs,t.attrs)}function Db(i,e,t,n,r,s){for(let c=0;c<n.length;c++)zd(fl(t,e),i,n[c].type);qC(t,i.data.length,n.length);for(let c=0;c<n.length;c++){let u=n[c];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,l=pb(i,e,n.length,null);for(let c=0;c<n.length;c++){let u=n[c];t.mergedAttrs=zs(t.mergedAttrs,u.hostAttrs),KC(i,t,e,l,u),WC(l,u,r),u.contentQueries!==null&&(t.flags|=4),(u.hostBindings!==null||u.hostAttrs!==null||u.hostVars!==0)&&(t.flags|=64);let d=u.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((i.preOrderHooks??=[]).push(t.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((i.preOrderCheckHooks??=[]).push(t.index),a=!0),l++}FC(i,t,s)}function UC(i,e,t,n,r){let s=r.hostBindings;if(s){let o=i.hostBindingOpCodes;o===null&&(o=i.hostBindingOpCodes=[]);let a=~e.index;jC(o)!=a&&o.push(a),o.push(t,n,s)}}function jC(i){let e=i.length;for(;e>0;){let t=i[--e];if(typeof t=="number"&&t<0)return t}return 0}function $C(i,e,t,n){let r=t.directiveStart,s=t.directiveEnd;Ll(t)&&YC(e,t,i.data[r+t.componentOffset]),i.firstCreatePass||fl(t,e),Ui(n,e);let o=t.initialInputs;for(let a=r;a<s;a++){let l=i.data[a],c=Vi(e,i,a,t);if(Ui(c,e),o!==null&&ZC(e,a-r,c,l,t,o),$n(l)){let u=ui(t.index,e);u[Ut]=Vi(e,i,a,t)}}}function wb(i,e,t){let n=t.directiveStart,r=t.directiveEnd,s=t.index,o=MI();try{Fi(s);for(let a=n;a<r;a++){let l=i.data[a],c=e[a];Hd(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&HC(l,c)}}finally{Fi(-1),Hd(o)}}function HC(i,e){i.hostBindings!==null&&i.hostBindings(1,e)}function GC(i,e){let t=i.directiveRegistry,n=null,r=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(t0(e,o.selectors,!1))if(n||(n=[]),$n(o))if(o.findHostDirectiveDefs!==null){let a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),n.unshift(...a,o);let l=a.length;Zd(i,e,l)}else n.unshift(o),Zd(i,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,n,r),n.push(o)}return n===null?null:[n,r]}function Zd(i,e,t){e.componentOffset=t,(i.components??=[]).push(e.index)}function zC(i,e,t){if(e){let n=i.localNames=[];for(let r=0;r<e.length;r+=2){let s=t[e[r+1]];if(s==null)throw new V(-301,!1);n.push(e[r],s)}}}function WC(i,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=i;$n(e)&&(t[""]=i)}}function qC(i,e,t){i.flags|=1,i.directiveStart=e,i.directiveEnd=e+t,i.providerIndexes=e}function KC(i,e,t,n,r){i.data[n]=r;let s=r.factory||(r.factory=$r(r.type,!0)),o=new Bi(s,$n(r),X);i.blueprint[n]=o,t[n]=o,UC(i,e,n,pb(i,t,r.hostVars,hi),r)}function YC(i,e,t){let n=$t(e,i),r=bb(t),s=i[bn].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=Fl(i,Pl(i,r,null,o,n,e,null,s.createRenderer(n,t),null,null,null));i[e.index]=a}function QC(i,e,t,n,r,s){let o=$t(i,e);XC(e[We],o,s,i.value,t,n,r)}function XC(i,e,t,n,r,s,o){if(s==null)i.removeAttribute(e,r,t);else{let a=o==null?Th(s):o(s,n||"",r);i.setAttribute(e,r,a,t)}}function ZC(i,e,t,n,r,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let l=o[a++],c=o[a++],u=o[a++],d=o[a++];fb(n,t,l,c,u,d)}}function JC(i,e,t){let n=null,r=0;for(;r<t.length;){let s=t[r];if(s===0){r+=4;continue}else if(s===5){r+=2;continue}if(typeof s=="number")break;if(i.hasOwnProperty(s)){n===null&&(n=[]);let o=i[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){n.push(s,o[a+1],o[a+2],t[r+1]);break}}r+=2}return n}function Sb(i,e,t,n){return[i,!0,0,e,null,n,null,t,null,null]}function Tb(i,e){let t=i.contentQueries;if(t!==null){let n=ye(null);try{for(let r=0;r<t.length;r+=2){let s=t[r],o=t[r+1];if(o!==-1){let a=i.data[o];Vh(s),a.contentQueries(2,e[o],o)}}}finally{ye(n)}}}function Fl(i,e){return i[Ys]?i[Ey][Jt]=e:i[Ys]=e,i[Ey]=e,e}function Jd(i,e,t){Vh(0);let n=ye(null);try{e(i,t)}finally{ye(n)}}function xb(i){return i[Ks]||(i[Ks]=[])}function Ib(i){return i.cleanup||(i.cleanup=[])}function Cb(i,e,t){return(i===null||$n(i))&&(t=pI(t[e.index])),t[We]}function Ab(i,e){let t=i[Wr],n=t?t.get(En,null):null;n&&n.handleError(e)}function nf(i,e,t,n,r){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],l=t[s++],c=e[o],u=i.data[o];fb(u,c,n,a,l,r)}}function eA(i,e,t){let n=b0(e,i);dC(i[We],n,t)}function tA(i,e){let t=ui(e,i),n=t[ue];nA(n,t);let r=t[Dn];r!==null&&t[qs]===null&&(t[qs]=Kh(r,t[Wr])),rf(n,t,t[Ut])}function nA(i,e){for(let t=e.length;t<i.blueprint.length;t++)e.push(i.blueprint[t])}function rf(i,e,t){Uh(e);try{let n=i.viewQuery;n!==null&&Jd(1,n,t);let r=i.template;r!==null&&mb(i,e,r,1,t),i.firstCreatePass&&(i.firstCreatePass=!1),e[jn]?.finishViewCreation(i),i.staticContentQueries&&Tb(i,e),i.staticViewQueries&&Jd(2,i.viewQuery,t);let s=i.components;s!==null&&iA(e,s)}catch(n){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),n}finally{e[te]&=-5,jh()}}function iA(i,e){for(let t=0;t<e.length;t++)tA(i,e[t])}function Rb(i,e,t,n){let r=ye(null);try{let s=e.tView,a=i[te]&4096?4096:16,l=Pl(i,s,t,a,null,e,null,null,n?.injector??null,n?.embeddedViewInjector??null,n?.dehydratedView??null),c=i[e.index];l[io]=c;let u=i[jn];return u!==null&&(l[jn]=u.createEmbeddedView(s)),rf(s,l,t),l}finally{ye(r)}}function rA(i,e){let t=_t+e;if(t<i.length)return i[t]}function eh(i,e){return!e||e.firstChild===null||q0(i)}function Mb(i,e,t,n=!0){let r=e[ue];if(mC(r,e,i,t),n){let o=Xd(t,i),a=e[We],l=Xh(a,i[Pi]);l!==null&&fC(r,i[It],a,e,l,o)}let s=e[qs];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function sA(i,e){let t=ml(i,e);return t!==void 0&&Qh(t[ue],t),t}function vl(i,e,t,n,r=!1){for(;t!==null;){let s=e[t.index];s!==null&&n.push(_n(s)),zn(s)&&oA(s,n);let o=t.type;if(o&8)vl(i,e,t.child,n);else if(o&32){let a=Yh(t,e),l;for(;l=a();)n.push(l)}else if(o&16){let a=lb(e,t);if(Array.isArray(a))n.push(...a);else{let l=Xs(e[en]);vl(l[ue],l,a,n,!0)}}t=r?t.projectionNext:t.next}return n}function oA(i,e){for(let t=_t;t<i.length;t++){let n=i[t],r=n[ue].firstChild;r!==null&&vl(n[ue],n,r,e)}i[Pi]!==i[Dn]&&e.push(i[Pi])}var kb=[];function aA(i){return i[Ni]??lA(i)}function lA(i){let e=kb.pop()??Object.create(uA);return e.lView=i,e}function cA(i){i.lView[Ni]!==i&&(i.lView=null,kb.push(i))}var uA=Ie(N({},Lv),{consumerIsAlwaysLive:!0,consumerMarkedDirty:i=>{Qs(i.lView)},consumerOnSignalRead(){this.lView[Ni]=this}}),Lb=100;function Ob(i,e=!0,t=0){let n=i[bn],r=n.rendererFactory,s=!1;s||r.begin?.();try{dA(i,t)}catch(o){throw e&&Ab(i,o),o}finally{s||(r.end?.(),n.inlineEffectRunner?.flush())}}function dA(i,e){th(i,e);let t=0;for(;Fh(i);){if(t===Lb)throw new V(103,!1);t++,th(i,1)}}function hA(i,e,t,n){let r=e[te];if((r&256)===256)return;let s=!1;!s&&e[bn].inlineEffectRunner?.flush(),Uh(e);let o=null,a=null;!s&&fA(i)&&(a=aA(e),o=Ov(a));try{_0(e),CI(i.bindingStartIndex),t!==null&&mb(i,e,t,2,n);let l=(r&3)===3;if(!s)if(l){let d=i.preOrderCheckHooks;d!==null&&el(e,d,null)}else{let d=i.preOrderHooks;d!==null&&tl(e,d,0,null),Dd(e,0)}if(pA(e),Nb(e,0),i.contentQueries!==null&&Tb(i,e),!s)if(l){let d=i.contentCheckHooks;d!==null&&el(e,d)}else{let d=i.contentHooks;d!==null&&tl(e,d,1),Dd(e,1)}AC(i,e);let c=i.components;c!==null&&Fb(e,c,0);let u=i.viewQuery;if(u!==null&&Jd(2,u,n),!s)if(l){let d=i.viewCheckHooks;d!==null&&el(e,d)}else{let d=i.viewHooks;d!==null&&tl(e,d,2),Dd(e,2)}if(i.firstUpdatePass===!0&&(i.firstUpdatePass=!1),e[Ed]){for(let d of e[Ed])d();e[Ed]=null}s||(e[te]&=-73)}catch(l){throw Qs(e),l}finally{a!==null&&(Nv(a,o),cA(a)),jh()}}function fA(i){return i.type!==2}function Nb(i,e){for(let t=Y0(i);t!==null;t=Q0(t))for(let n=_t;n<t.length;n++){let r=t[n];Pb(r,e)}}function pA(i){for(let e=Y0(i);e!==null;e=Q0(e)){if(!(e[te]&Lh.HasTransplantedViews))continue;let t=e[qr];for(let n=0;n<t.length;n++){let r=t[n],s=r[st];yI(r)}}}function mA(i,e,t){let n=ui(e,i);Pb(n,t)}function Pb(i,e){Ph(i)&&th(i,e)}function th(i,e){let n=i[ue],r=i[te],s=i[Ni],o=!!(e===0&&r&16);if(o||=!!(r&64&&e===0),o||=!!(r&1024),o||=!!(s?.dirty&&Zu(s)),s&&(s.dirty=!1),i[te]&=-9217,o)hA(n,i,n.template,i[Ut]);else if(r&8192){Nb(i,1);let a=n.components;a!==null&&Fb(i,a,1)}}function Fb(i,e,t){for(let n=0;n<e.length;n++)mA(i,e[n],t)}function sf(i){for(i[bn].changeDetectionScheduler?.notify();i;){i[te]|=64;let e=Xs(i);if(oI(i)&&!e)return i;i=e}return null}var ji=class{get rootNodes(){let e=this._lView,t=e[ue];return vl(t,e,t.firstChild,[])}constructor(e,t,n=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=n,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Ut]}set context(e){this._lView[Ut]=e}get destroyed(){return(this._lView[te]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[st];if(zn(e)){let t=e[cl],n=t?t.indexOf(this):-1;n>-1&&(ml(e,n),al(t,n))}this._attachedToViewContainer=!1}Qh(this._lView[ue],this._lView)}onDestroy(e){E0(this._lView,e)}markForCheck(){sf(this._cdRefInjectingView||this._lView)}detach(){this._lView[te]&=-129}reattach(){$d(this._lView),this._lView[te]|=128}detectChanges(){this._lView[te]|=1024,Ob(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new V(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,ib(this._lView[ue],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new V(902,!1);this._appRef=e,$d(this._lView)}},tn=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=yA;let i=e;return i})(),gA=tn,vA=class extends gA{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,n){let r=Rb(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:n});return new ji(r)}};function yA(){return of(Ct(),Se())}function of(i,e){return i.type&4?new vA(e,i,Zr(i,e)):null}var e3=new RegExp(`^(\\d+)*(${oC}|${sC})*(.*)`);var bA=()=>null;function nh(i,e){return bA(i,e)}var Kr=class{},ih=class{},yl=class{};function _A(i){let e=Error(`No component factory found for ${pt(i)}.`);return e[EA]=i,e}var EA="ngComponent";var rh=class{resolveComponentFactory(e){throw _A(e)}},fi=(()=>{let e=class e{};e.NULL=new rh;let i=e;return i})(),$i=class{},Jr=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>DA();let i=e;return i})();function DA(){let i=Se(),e=Ct(),t=ui(e.index,i);return(ki(t)?t:i)[We]}var wA=(()=>{let e=class e{};e.\u0275prov=j({token:e,providedIn:"root",factory:()=>null});let i=e;return i})(),Id={};var Ly=new Set;function es(i){Ly.has(i)||(Ly.add(i),performance?.mark?.("mark_feature_usage",{detail:{feature:i}}))}function Oy(...i){}function SA(){let i=typeof Vt.requestAnimationFrame=="function",e=Vt[i?"requestAnimationFrame":"setTimeout"],t=Vt[i?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){let n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);let r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}var W=class i{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Pe(!1),this.onMicrotaskEmpty=new Pe(!1),this.onStable=new Pe(!1),this.onError=new Pe(!1),typeof Zone>"u")throw new V(908,!1);Zone.assertZonePatched();let r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!n&&t,r.shouldCoalesceRunChangeDetection=n,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=SA().nativeRequestAnimationFrame,IA(r)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!i.isInAngularZone())throw new V(909,!1)}static assertNotInAngularZone(){if(i.isInAngularZone())throw new V(909,!1)}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,r){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,TA,Oy,Oy);try{return s.runTask(o,t,n)}finally{s.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}},TA={};function af(i){if(i._nesting==0&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function xA(i){i.isCheckStableRunning||i.lastRequestAnimationFrameId!==-1||(i.lastRequestAnimationFrameId=i.nativeRequestAnimationFrame.call(Vt,()=>{i.fakeTopEventTask||(i.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{i.lastRequestAnimationFrameId=-1,sh(i),i.isCheckStableRunning=!0,af(i),i.isCheckStableRunning=!1},void 0,()=>{},()=>{})),i.fakeTopEventTask.invoke()}),sh(i))}function IA(i){let e=()=>{xA(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,r,s,o,a)=>{if(CA(a))return t.invokeTask(r,s,o,a);try{return Ny(i),t.invokeTask(r,s,o,a)}finally{(i.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||i.shouldCoalesceRunChangeDetection)&&e(),Py(i)}},onInvoke:(t,n,r,s,o,a,l)=>{try{return Ny(i),t.invoke(r,s,o,a,l)}finally{i.shouldCoalesceRunChangeDetection&&e(),Py(i)}},onHasTask:(t,n,r,s)=>{t.hasTask(r,s),n===r&&(s.change=="microTask"?(i._hasPendingMicrotasks=s.microTask,sh(i),af(i)):s.change=="macroTask"&&(i.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,n,r,s)=>(t.handleError(r,s),i.runOutsideAngular(()=>i.onError.emit(s)),!1)})}function sh(i){i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&i.lastRequestAnimationFrameId!==-1?i.hasPendingMicrotasks=!0:i.hasPendingMicrotasks=!1}function Ny(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function Py(i){i._nesting--,af(i)}function CA(i){return!Array.isArray(i)||i.length!==1?!1:i[0].data?.__ignore_ng_zone__===!0}var Mi=function(i){return i[i.EarlyRead=0]="EarlyRead",i[i.Write=1]="Write",i[i.MixedReadWrite=2]="MixedReadWrite",i[i.Read=3]="Read",i}(Mi||{}),Bb={destroy(){}};function lf(i,e){!e&&Ml(lf);let t=e?.injector??L(qe);if(!tb(t))return Bb;es("NgAfterRender");let n=t.get(Bl),r=n.handler??=new _l,s=e?.phase??Mi.MixedReadWrite,o=()=>{r.unregister(l),a()},a=t.get(di).onDestroy(o),l=Gn(t,()=>new bl(s,i));return r.register(l),{destroy:o}}function co(i,e){!e&&Ml(co);let t=e?.injector??L(qe);if(!tb(t))return Bb;es("NgAfterNextRender");let n=t.get(Bl),r=n.handler??=new _l,s=e?.phase??Mi.MixedReadWrite,o=()=>{r.unregister(l),a()},a=t.get(di).onDestroy(o),l=Gn(t,()=>new bl(s,()=>{o(),i()}));return r.register(l),{destroy:o}}var bl=class{constructor(e,t){this.phase=e,this.callbackFn=t,this.zone=L(W),this.errorHandler=L(En,{optional:!0}),L(Kr,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},_l=class{constructor(){this.executingCallbacks=!1,this.buckets={[Mi.EarlyRead]:new Set,[Mi.Write]:new Set,[Mi.MixedReadWrite]:new Set,[Mi.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let t of e)t.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},Bl=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let n=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let r of n)r()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=j({token:e,providedIn:"root",factory:()=>new e});let i=e;return i})();function oh(i,e,t){let n=t?i.styles:null,r=t?i.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)r=Od(r,a);else if(s==2){let l=a,c=e[++o];n=Od(n,l+": "+c+";")}}t?i.styles=n:i.stylesWithoutHost=n,t?i.classes=r:i.classesWithoutHost=r}var El=class extends fi{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=Oi(e);return new Zs(t,this.ngModule)}};function Fy(i){let e=[];for(let t in i){if(!i.hasOwnProperty(t))continue;let n=i[t];n!==void 0&&e.push({propName:Array.isArray(n)?n[0]:n,templateName:t})}return e}function AA(i){let e=i.toLowerCase();return e==="svg"?uI:e==="math"?dI:null}var ah=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){n=Il(n);let r=this.injector.get(e,Id,n);return r!==Id||t===Id?r:this.parentInjector.get(e,t,n)}},Zs=class extends yl{get inputs(){let e=this.componentDef,t=e.inputTransforms,n=Fy(e.inputs);if(t!==null)for(let r of n)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return n}get outputs(){return Fy(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=Gx(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,n,r){let s=ye(null);try{r=r||this.ngModule;let o=r instanceof Et?r:r?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new ah(e,o):e,l=a.get($i,null);if(l===null)throw new V(407,!1);let c=a.get(wA,null),u=a.get(Bl,null),d=a.get(Kr,null),h={rendererFactory:l,sanitizer:c,inlineEffectRunner:null,afterRenderEventManager:u,changeDetectionScheduler:d},f=l.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",m=n?kC(f,n,this.componentDef.encapsulation,a):nb(f,p,AA(p)),g=512;this.componentDef.signals?g|=4096:this.componentDef.onPush||(g|=16);let y=null;m!==null&&(y=Kh(m,a,!0));let _=tf(0,null,null,1,0,null,null,null,null,null,null),b=Pl(null,_,null,g,null,null,h,f,a,null,y);Uh(b);let S,E;try{let x=this.componentDef,w,R=null;x.findHostDirectiveDefs?(w=[],R=new Map,x.findHostDirectiveDefs(x,w,R),w.push(x)):w=[x];let B=RA(b,m),I=MA(B,m,x,w,b,h,f);E=Nh(_,jt),m&&OA(f,x,m,n),t!==void 0&&NA(E,this.ngContentSelectors,t),S=LA(I,x,w,R,b,[PA]),rf(_,b,null)}finally{jh()}return new lh(this.componentType,S,Zr(E,b),b,E)}finally{ye(s)}}},lh=class extends ih{constructor(e,t,n,r,s){super(),this.location=n,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new ji(r,void 0,!1),this.componentType=e}setInput(e,t){let n=this._tNode.inputs,r;if(n!==null&&(r=n[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;nf(s[ue],s,r,e,t),this.previousInputValues.set(e,t);let o=ui(this._tNode.index,s);sf(o)}}get injector(){return new Li(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function RA(i,e){let t=i[ue],n=jt;return i[n]=e,lo(t,n,2,"#host",null)}function MA(i,e,t,n,r,s,o){let a=r[ue];kA(n,i,e,o);let l=null;e!==null&&(l=Kh(e,r[Wr]));let c=s.rendererFactory.createRenderer(e,t),u=16;t.signals?u=4096:t.onPush&&(u=64);let d=Pl(r,bb(t),null,u,r[i.index],i,s,c,null,null,l);return a.firstCreatePass&&Zd(a,i,n.length-1),Fl(r,d),r[i.index]=d}function kA(i,e,t,n){for(let r of i)e.mergedAttrs=zs(e.mergedAttrs,r.hostAttrs);e.mergedAttrs!==null&&(oh(e,e.mergedAttrs,!0),t!==null&&db(n,t,e))}function LA(i,e,t,n,r,s){let o=Ct(),a=r[ue],l=$t(o,r);Db(a,r,o,t,null,n);for(let u=0;u<t.length;u++){let d=o.directiveStart+u,h=Vi(r,a,d,o);Ui(h,r)}wb(a,r,o),l&&Ui(l,r);let c=Vi(r,a,o.directiveStart+o.componentOffset,o);if(i[Ut]=r[Ut]=c,s!==null)for(let u of s)u(c,e);return gb(a,o,r),c}function OA(i,e,t,n){if(n)Fd(i,t,["ng-version","17.3.12"]);else{let{attrs:r,classes:s}=zx(e.selectors[0]);r&&Fd(i,t,r),s&&s.length>0&&ub(i,t,s.join(" "))}}function NA(i,e,t){let n=i.projection=[];for(let r=0;r<e.length;r++){let s=t[r];n.push(s!=null?Array.from(s):null)}}function PA(){let i=Ct();zh(Se()[ue],i)}var rn=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=FA;let i=e;return i})();function FA(){let i=Ct();return Ub(i,Se())}var BA=rn,Vb=class extends BA{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return Zr(this._hostTNode,this._hostLView)}get injector(){return new Li(this._hostTNode,this._hostLView)}get parentInjector(){let e=Wh(this._hostTNode,this._hostLView);if(P0(e)){let t=hl(e,this._hostLView),n=dl(e),r=t[ue].data[n+8];return new Li(r,t)}else return new Li(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=By(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-_t}createEmbeddedView(e,t,n){let r,s;typeof n=="number"?r=n:n!=null&&(r=n.index,s=n.injector);let o=nh(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,r,eh(this._hostTNode,o)),a}createComponent(e,t,n,r,s){let o=e&&!sI(e),a;if(o)a=t;else{let p=t||{};a=p.index,n=p.injector,r=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let l=o?e:new Zs(Oi(e)),c=n||this.parentInjector;if(!s&&l.ngModule==null){let m=(o?c:this.parentInjector).get(Et,null);m&&(s=m)}let u=Oi(l.componentType??{}),d=nh(this._lContainer,u?.id??null),h=d?.firstChild??null,f=l.create(c,r,h,s);return this.insertImpl(f.hostView,a,eh(this._hostTNode,d)),f}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,n){let r=e._lView;if(vI(r)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=r[st],c=new Vb(l,l[It],l[st]);c.detach(c.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return Mb(o,r,s,n),e.attachToViewContainerRef(),Qy(Cd(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=By(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),n=ml(this._lContainer,t);n&&(al(Cd(this._lContainer),t),Qh(n[ue],n))}detach(e){let t=this._adjustIndex(e,-1),n=ml(this._lContainer,t);return n&&al(Cd(this._lContainer),t)!=null?new ji(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function By(i){return i[cl]}function Cd(i){return i[cl]||(i[cl]=[])}function Ub(i,e){let t,n=e[i.index];return zn(n)?t=n:(t=Sb(n,e,null,i),e[i.index]=t,Fl(e,t)),UA(t,e,i,n),new Vb(t,i,e)}function VA(i,e){let t=i[We],n=t.createComment(""),r=$t(e,i),s=Xh(t,r);return gl(t,s,n,EC(t,r),!1),n}var UA=HA,jA=()=>!1;function $A(i,e,t){return jA(i,e,t)}function HA(i,e,t,n){if(i[Pi])return;let r;t.type&8?r=_n(n):r=VA(e,t),i[Pi]=r}var ch=class i{constructor(e){this.queryList=e,this.matches=null}clone(){return new i(this.queryList)}setDirty(){this.queryList.setDirty()}},uh=class i{constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let n=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let s=0;s<n;s++){let o=t.getByIndex(s),a=this.queries[o.indexInDeclarationView];r.push(a.clone())}return new i(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)cf(e,t).matches!==null&&this.queries[t].setDirty()}},dh=class{constructor(e,t,n=null){this.flags=t,this.read=n,typeof e=="string"?this.predicate=XA(e):this.predicate=e}},hh=class i{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){let r=t!==null?t.length:0,s=this.getByIndex(n).embeddedTView(e,r);s&&(s.indexInDeclarationView=n,t!==null?t.push(s):t=[s])}return t!==null?new i(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},fh=class i{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new i(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,n=e.parent;for(;n!==null&&n.type&8&&n.index!==t;)n=n.parent;return t===(n!==null?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){let s=n[r];this.matchTNodeWithReadOption(e,t,GA(t,s)),this.matchTNodeWithReadOption(e,t,nl(t,e,s,!1,!1))}else n===tn?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,nl(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(n!==null){let r=this.metadata.read;if(r!==null)if(r===Me||r===rn||r===tn&&t.type&4)this.addMatch(t.index,-2);else{let s=nl(t,e,r,!1,!1);s!==null&&this.addMatch(t.index,s)}else this.addMatch(t.index,n)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function GA(i,e){let t=i.localNames;if(t!==null){for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1]}return null}function zA(i,e){return i.type&11?Zr(i,e):i.type&4?of(i,e):null}function WA(i,e,t,n){return t===-1?zA(e,i):t===-2?qA(i,e,n):Vi(i,i[ue],t,e)}function qA(i,e,t){if(t===Me)return Zr(e,i);if(t===tn)return of(e,i);if(t===rn)return Ub(e,i)}function jb(i,e,t,n){let r=e[jn].queries[n];if(r.matches===null){let s=i.data,o=t.matches,a=[];for(let l=0;o!==null&&l<o.length;l+=2){let c=o[l];if(c<0)a.push(null);else{let u=s[c];a.push(WA(e,u,o[l+1],t.metadata.read))}}r.matches=a}return r.matches}function ph(i,e,t,n){let r=i.queries.getByIndex(t),s=r.matches;if(s!==null){let o=jb(i,e,r,t);for(let a=0;a<s.length;a+=2){let l=s[a];if(l>0)n.push(o[a/2]);else{let c=s[a+1],u=e[-l];for(let d=_t;d<u.length;d++){let h=u[d];h[io]===h[st]&&ph(h[ue],h,c,n)}if(u[qr]!==null){let d=u[qr];for(let h=0;h<d.length;h++){let f=d[h];ph(f[ue],f,c,n)}}}}}return n}function KA(i,e){return i[jn].queries[e].queryList}function YA(i,e,t){let n=new pl((t&4)===4);return NC(i,e,n,n.destroy),(e[jn]??=new uh).queries.push(new ch(n))-1}function QA(i,e,t){let n=ot();return n.firstCreatePass&&(ZA(n,new dh(i,e,t),-1),(e&2)===2&&(n.staticViewQueries=!0)),YA(n,Se(),e)}function XA(i){return i.split(",").map(e=>e.trim())}function ZA(i,e,t){i.queries===null&&(i.queries=new hh),i.queries.track(new fh(e,t))}function cf(i,e){return i.queries.getByIndex(e)}function JA(i,e){let t=i[ue],n=cf(t,e);return n.crossesNgTemplate?ph(t,i,e,[]):jb(t,i,n,e)}function eR(i){return Object.getPrototypeOf(i.prototype).constructor}function At(i){let e=eR(i.type),t=!0,n=[i];for(;e;){let r;if($n(i))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new V(903,!1);r=e.\u0275dir}if(r){if(t){n.push(r);let o=i;o.inputs=Xa(i.inputs),o.inputTransforms=Xa(i.inputTransforms),o.declaredInputs=Xa(i.declaredInputs),o.outputs=Xa(i.outputs);let a=r.hostBindings;a&&sR(i,a);let l=r.viewQuery,c=r.contentQueries;if(l&&iR(i,l),c&&rR(i,c),tR(i,r),ax(i.outputs,r.outputs),$n(r)&&r.data.animation){let u=i.data;u.animation=(u.animation||[]).concat(r.data.animation)}}let s=r.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(i),a===At&&(t=!1)}}e=Object.getPrototypeOf(e)}nR(n)}function tR(i,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||i.inputs.hasOwnProperty(t))continue;let n=e.inputs[t];if(n!==void 0&&(i.inputs[t]=n,i.declaredInputs[t]=e.declaredInputs[t],e.inputTransforms!==null)){let r=Array.isArray(n)?n[0]:n;if(!e.inputTransforms.hasOwnProperty(r))continue;i.inputTransforms??={},i.inputTransforms[r]=e.inputTransforms[r]}}}function nR(i){let e=0,t=null;for(let n=i.length-1;n>=0;n--){let r=i[n];r.hostVars=e+=r.hostVars,r.hostAttrs=zs(r.hostAttrs,t=zs(t,r.hostAttrs))}}function Xa(i){return i===Hr?{}:i===bt?[]:i}function iR(i,e){let t=i.viewQuery;t?i.viewQuery=(n,r)=>{e(n,r),t(n,r)}:i.viewQuery=e}function rR(i,e){let t=i.contentQueries;t?i.contentQueries=(n,r,s)=>{e(n,r,s),t(n,r,s)}:i.contentQueries=e}function sR(i,e){let t=i.hostBindings;t?i.hostBindings=(n,r)=>{e(n,r),t(n,r)}:i.hostBindings=e}function pi(i){let e=i.inputConfig,t={};for(let n in e)if(e.hasOwnProperty(n)){let r=e[n];Array.isArray(r)&&r[3]&&(t[n]=r[3])}i.inputTransforms=t}var ci=class{},Js=class{};var mh=class extends ci{constructor(e,t,n){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new El(this);let r=s0(e);this._bootstrapComponents=eb(r.bootstrap),this._r3Injector=z0(e,t,[{provide:ci,useValue:this},{provide:fi,useValue:this.componentFactoryResolver},...n],pt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},gh=class extends Js{constructor(e){super(),this.moduleType=e}create(e){return new mh(this.moduleType,e,[])}};var Dl=class extends ci{constructor(e){super(),this.componentFactoryResolver=new El(this),this.instance=null;let t=new Ws([...e.providers,{provide:ci,useValue:this},{provide:fi,useValue:this.componentFactoryResolver}],e.parent||Mh(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function uf(i,e,t=null){return new Dl({providers:i,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var Vl=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Qe(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function zi(i,e,t){let n=i[e];return Object.is(n,t)?!1:(i[e]=t,!0)}function oR(i){return(i.flags&32)===32}function aR(i,e,t,n,r,s,o,a,l){let c=e.consts,u=lo(e,i,4,o||null,ul(c,a));Eb(e,t,u,ul(c,l)),zh(e,u);let d=u.tView=tf(2,u,n,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return e.queries!==null&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}function Wi(i,e,t,n,r,s,o,a){let l=Se(),c=ot(),u=i+jt,d=c.firstCreatePass?aR(u,c,l,e,t,n,r,s,o):c.data[u];ro(d,!1);let h=lR(c,l,d,i);Hh()&&Zh(c,l,h,d),Ui(h,l);let f=Sb(h,l,h,d);return l[u]=f,Fl(l,f),$A(f,d,l),Oh(d)&&vb(c,l,d),o!=null&&yb(l,d,a),Wi}var lR=cR;function cR(i,e,t,n){return Gh(!0),e[We].createComment("")}function Kn(i,e,t,n){let r=Se(),s=so();if(zi(r,s,e)){let o=ot(),a=$h();QC(a,r,i,e,t,n)}return Kn}function uR(i,e,t,n){return zi(i,so(),t)?e+Th(t)+n:hi}function Za(i,e){return i<<17|e<<2}function Hi(i){return i>>17&32767}function dR(i){return(i&2)==2}function hR(i,e){return i&131071|e<<17}function vh(i){return i|2}function Yr(i){return(i&131068)>>2}function Ad(i,e){return i&-131069|e<<2}function fR(i){return(i&1)===1}function yh(i){return i|1}function pR(i,e,t,n,r,s){let o=s?e.classBindings:e.styleBindings,a=Hi(o),l=Yr(o);i[n]=t;let c=!1,u;if(Array.isArray(t)){let d=t;u=d[1],(u===null||no(d,u)>0)&&(c=!0)}else u=t;if(r)if(l!==0){let h=Hi(i[a+1]);i[n+1]=Za(h,a),h!==0&&(i[h+1]=Ad(i[h+1],n)),i[a+1]=hR(i[a+1],n)}else i[n+1]=Za(a,0),a!==0&&(i[a+1]=Ad(i[a+1],n)),a=n;else i[n+1]=Za(l,0),a===0?a=n:i[l+1]=Ad(i[l+1],n),l=n;c&&(i[n+1]=vh(i[n+1])),Vy(i,u,n,!0),Vy(i,u,n,!1),mR(e,u,i,n,s),o=Za(a,l),s?e.classBindings=o:e.styleBindings=o}function mR(i,e,t,n,r){let s=r?i.residualClasses:i.residualStyles;s!=null&&typeof e=="string"&&no(s,e)>=0&&(t[n+1]=yh(t[n+1]))}function Vy(i,e,t,n){let r=i[t+1],s=e===null,o=n?Hi(r):Yr(r),a=!1;for(;o!==0&&(a===!1||s);){let l=i[o],c=i[o+1];gR(l,e)&&(a=!0,i[o+1]=n?yh(c):vh(c)),o=n?Hi(c):Yr(c)}a&&(i[t+1]=n?vh(r):yh(r))}function gR(i,e){return i===null||e==null||(Array.isArray(i)?i[1]:i)===e?!0:Array.isArray(i)&&typeof e=="string"?no(i,e)>=0:!1}var Zt={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function vR(i){return i.substring(Zt.key,Zt.keyEnd)}function yR(i){return bR(i),$b(i,Hb(i,0,Zt.textEnd))}function $b(i,e){let t=Zt.textEnd;return t===e?-1:(e=Zt.keyEnd=_R(i,Zt.key=e,t),Hb(i,e,t))}function bR(i){Zt.key=0,Zt.keyEnd=0,Zt.value=0,Zt.valueEnd=0,Zt.textEnd=i.length}function Hb(i,e,t){for(;e<t&&i.charCodeAt(e)<=32;)e++;return e}function _R(i,e,t){for(;e<t&&i.charCodeAt(e)>32;)e++;return e}function sn(i,e,t){let n=Se(),r=so();if(zi(n,r,e)){let s=ot(),o=$h();_b(s,o,n,i,e,n[We],t,!1)}return sn}function bh(i,e,t,n,r){let s=e.inputs,o=r?"class":"style";nf(i,t,s[o],o,n)}function Yn(i,e){return DR(i,e,null,!0),Yn}function Gb(i){wR(AR,ER,i,!0)}function ER(i,e){for(let t=yR(e);t>=0;t=$b(e,t))Ch(i,vR(e),!0)}function DR(i,e,t,n){let r=Se(),s=ot(),o=I0(2);if(s.firstUpdatePass&&Wb(s,i,o,n),e!==hi&&zi(r,o,e)){let a=s.data[Gi()];qb(s,a,r,r[We],i,r[o+1]=MR(e,t),n,o)}}function wR(i,e,t,n){let r=ot(),s=I0(2);r.firstUpdatePass&&Wb(r,null,s,n);let o=Se();if(t!==hi&&zi(o,s,t)){let a=r.data[Gi()];if(Kb(a,n)&&!zb(r,s)){let l=n?a.classesWithoutHost:a.stylesWithoutHost;l!==null&&(t=Od(l,t||"")),bh(r,a,o,t,n)}else RR(r,a,o,o[We],o[s+1],o[s+1]=CR(i,e,t),n,s)}}function zb(i,e){return e>=i.expandoStartIndex}function Wb(i,e,t,n){let r=i.data;if(r[t+1]===null){let s=r[Gi()],o=zb(i,t);Kb(s,n)&&e===null&&!o&&(e=!1),e=SR(r,s,e,n),pR(r,s,e,t,o,n)}}function SR(i,e,t,n){let r=Bh(i),s=n?e.residualClasses:e.residualStyles;if(r===null)(n?e.classBindings:e.styleBindings)===0&&(t=Rd(null,i,e,t,n),t=eo(t,e.attrs,n),s=null);else{let o=e.directiveStylingLast;if(o===-1||i[o]!==r)if(t=Rd(r,i,e,t,n),s===null){let l=TR(i,e,n);l!==void 0&&Array.isArray(l)&&(l=Rd(null,i,e,l[1],n),l=eo(l,e.attrs,n),xR(i,e,n,l))}else s=IR(i,e,n)}return s!==void 0&&(n?e.residualClasses=s:e.residualStyles=s),t}function TR(i,e,t){let n=t?e.classBindings:e.styleBindings;if(Yr(n)!==0)return i[Hi(n)]}function xR(i,e,t,n){let r=t?e.classBindings:e.styleBindings;i[Hi(r)]=n}function IR(i,e,t){let n,r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++){let o=i[s].hostAttrs;n=eo(n,o,t)}return eo(n,e.attrs,t)}function Rd(i,e,t,n,r){let s=null,o=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<o&&(s=e[a],n=eo(n,s.hostAttrs,r),s!==i);)a++;return i!==null&&(t.directiveStylingLast=a),n}function eo(i,e,t){let n=t?1:2,r=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?r=o:r===n&&(Array.isArray(i)||(i=i===void 0?[]:["",i]),Ch(i,o,t?!0:e[++s]))}return i===void 0?null:i}function CR(i,e,t){if(t==null||t==="")return bt;let n=[],r=Ol(t);if(Array.isArray(r))for(let s=0;s<r.length;s++)i(n,r[s],!0);else if(typeof r=="object")for(let s in r)r.hasOwnProperty(s)&&i(n,s,r[s]);else typeof r=="string"&&e(n,r);return n}function AR(i,e,t){let n=String(e);n!==""&&!n.includes(" ")&&Ch(i,n,t)}function RR(i,e,t,n,r,s,o,a){r===hi&&(r=bt);let l=0,c=0,u=0<r.length?r[0]:null,d=0<s.length?s[0]:null;for(;u!==null||d!==null;){let h=l<r.length?r[l+1]:void 0,f=c<s.length?s[c+1]:void 0,p=null,m;u===d?(l+=2,c+=2,h!==f&&(p=d,m=f)):d===null||u!==null&&u<d?(l+=2,p=u):(c+=2,p=d,m=f),p!==null&&qb(i,e,t,n,p,m,o,a),u=l<r.length?r[l]:null,d=c<s.length?s[c]:null}}function qb(i,e,t,n,r,s,o,a){if(!(e.type&3))return;let l=i.data,c=l[a+1],u=fR(c)?Uy(l,e,t,r,Yr(c),o):void 0;if(!wl(u)){wl(s)||dR(c)&&(s=Uy(l,null,t,r,a,o));let d=b0(Gi(),t);IC(n,o,d,r,s)}}function Uy(i,e,t,n,r,s){let o=e===null,a;for(;r>0;){let l=i[r],c=Array.isArray(l),u=c?l[1]:l,d=u===null,h=t[r+1];h===hi&&(h=d?bt:void 0);let f=d?bd(h,n):u===n?h:void 0;if(c&&!wl(f)&&(f=bd(l,n)),wl(f)&&(a=f,o))return a;let p=i[r+1];r=o?Hi(p):Yr(p)}if(e!==null){let l=s?e.residualClasses:e.residualStyles;l!=null&&(a=bd(l,n))}return a}function wl(i){return i!==void 0}function MR(i,e){return i==null||i===""||(typeof e=="string"?i=i+e:typeof i=="object"&&(i=pt(Ol(i)))),i}function Kb(i,e){return(i.flags&(e?8:16))!==0}function df(i,e,t){es("NgControlFlow");let n=Se(),r=so(),s=kR(n,jt+i),o=0;if(zi(n,r,e)){let a=ye(null);try{if(sA(s,o),e!==-1){let l=LR(n[ue],jt+e),c=nh(s,l.tView.ssrId),u=Rb(n,l,t,{dehydratedView:c});Mb(s,u,o,eh(l,c))}}finally{ye(a)}}else{let a=rA(s,o);a!==void 0&&(a[Ut]=t)}}function kR(i,e){return i[e]}function LR(i,e){return Nh(i,e)}function OR(i,e,t,n,r,s){let o=e.consts,a=ul(o,r),l=lo(e,i,2,n,a);return Eb(e,t,l,ul(o,s)),l.attrs!==null&&oh(l,l.attrs,!1),l.mergedAttrs!==null&&oh(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function Ue(i,e,t,n){let r=Se(),s=ot(),o=jt+i,a=r[We],l=s.firstCreatePass?OR(o,s,r,e,t,n):s.data[o],c=NR(s,r,l,a,e,i);r[o]=c;let u=Oh(l);return ro(l,!0),db(a,c,l),!oR(l)&&Hh()&&Zh(s,r,c,l),EI()===0&&Ui(c,r),DI(),u&&(vb(s,r,l),gb(s,l,r)),n!==null&&yb(r,l),Ue}function Ge(){let i=Ct();T0()?x0():(i=i.parent,ro(i,!1));let e=i;SI(e)&&TI(),wI();let t=ot();return t.firstCreatePass&&(zh(t,i),p0(i)&&t.queries.elementEnd(i)),e.classesWithoutHost!=null&&BI(e)&&bh(t,e,Se(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&VI(e)&&bh(t,e,Se(),e.stylesWithoutHost,!1),Ge}function Rt(i,e,t,n){return Ue(i,e,t,n),Ge(),Rt}var NR=(i,e,t,n,r,s)=>(Gh(!0),nb(n,r,OI()));function uo(){return Se()}function hf(i,e,t){let n=Se(),r=so();if(zi(n,r,e)){let s=ot(),o=$h(),a=Bh(s.data),l=Cb(a,o,n);_b(s,o,n,i,e,l,t,!0)}return hf}var Sl="en-US";var PR=Sl;function FR(i){typeof i=="string"&&(PR=i.toLowerCase().replace(/_/g,"-"))}function ct(i,e,t,n){let r=Se(),s=ot(),o=Ct();return Yb(s,r,r[We],o,i,e,n),ct}function ff(i,e){let t=Ct(),n=Se(),r=ot(),s=Bh(r.data),o=Cb(s,t,n);return Yb(r,n,o,t,i,e),ff}function BR(i,e,t,n){let r=i.cleanup;if(r!=null)for(let s=0;s<r.length-1;s+=2){let o=r[s];if(o===t&&r[s+1]===n){let a=e[Ks],l=r[s+2];return a.length>l?a[l]:null}typeof o=="string"&&(s+=2)}return null}function Yb(i,e,t,n,r,s,o){let a=Oh(n),c=i.firstCreatePass&&Ib(i),u=e[Ut],d=xb(e),h=!0;if(n.type&3||o){let m=$t(n,e),g=o?o(m):m,y=d.length,_=o?S=>o(_n(S[n.index])):n.index,b=null;if(!o&&a&&(b=BR(i,e,r,n.index)),b!==null){let S=b.__ngLastListenerFn__||b;S.__ngNextListenerFn__=s,b.__ngLastListenerFn__=s,h=!1}else{s=$y(n,e,u,s,!1);let S=t.listen(g,r,s);d.push(s,S),c&&c.push(r,_,y,y+1)}}else s=$y(n,e,u,s,!1);let f=n.outputs,p;if(h&&f!==null&&(p=f[r])){let m=p.length;if(m)for(let g=0;g<m;g+=2){let y=p[g],_=p[g+1],E=e[y][_].subscribe(s),x=d.length;d.push(s,E),c&&c.push(r,n.index,x,-(x+1))}}}function jy(i,e,t,n){let r=ye(null);try{return gn(6,e,t),t(n)!==!1}catch(s){return Ab(i,s),!1}finally{gn(7,e,t),ye(r)}}function $y(i,e,t,n,r){return function s(o){if(o===Function)return n;let a=i.componentOffset>-1?ui(i.index,e):e;sf(a);let l=jy(e,t,n,o),c=s.__ngNextListenerFn__;for(;c;)l=jy(e,t,c,o)&&l,c=c.__ngNextListenerFn__;return r&&l===!1&&o.preventDefault(),l}}function qi(i=1){return LI(i)}function VR(i,e){let t=null,n=Vx(i);for(let r=0;r<e.length;r++){let s=e[r];if(s==="*"){t=r;continue}if(n===null?t0(i,s,!0):$x(n,s))return r}return t}function Ul(i){let e=Se()[en][It];if(!e.projection){let t=i?i.length:1,n=e.projection=Ax(t,null),r=n.slice(),s=e.child;for(;s!==null;){let o=i?VR(s,i):0;o!==null&&(r[o]?r[o].projectionNext=s:n[o]=s,r[o]=s),s=s.next}}}function ts(i,e=0,t){let n=Se(),r=ot(),s=lo(r,jt+i,16,null,t||null);s.projection===null&&(s.projection=e),x0(),(!n[qs]||w0())&&(s.flags&32)!==32&&TC(r,n,s)}function Qn(i,e,t){QA(i,e,t)}function xn(i){let e=Se(),t=ot(),n=C0();Vh(n+1);let r=cf(t,n);if(i.dirty&&gI(e)===((r.metadata.flags&2)===2)){if(r.matches===null)i.reset([]);else{let s=JA(e,n);i.reset(s,XI),i.notifyOnChanges()}return!0}return!1}function In(){return KA(Se(),C0())}function pf(i){let e=II();return mI(e,jt+i)}function Dt(i,e=""){let t=Se(),n=ot(),r=i+jt,s=n.firstCreatePass?lo(n,r,1,e,null):n.data[r],o=UR(n,t,s,e,i);t[r]=o,Hh()&&Zh(n,t,o,s),ro(s,!1)}var UR=(i,e,t,n,r)=>(Gh(!0),uC(e[We],n));function ho(i,e,t){let n=Se(),r=uR(n,i,e,t);return r!==hi&&eA(n,Gi(),r),ho}function jR(i,e,t){let n=ot();if(n.firstCreatePass){let r=$n(i);_h(t,n.data,n.blueprint,r,!0),_h(e,n.data,n.blueprint,r,!1)}}function _h(i,e,t,n,r){if(i=ft(i),Array.isArray(i))for(let s=0;s<i.length;s++)_h(i[s],e,t,n,r);else{let s=ot(),o=Se(),a=Ct(),l=zr(i)?i:ft(i.provide),c=d0(i),u=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(zr(i)||!i.multi){let f=new Bi(c,r,X),p=kd(l,e,r?u:u+h,d);p===-1?(zd(fl(a,o),s,l),Md(s,i,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(f),o.push(f)):(t[p]=f,o[p]=f)}else{let f=kd(l,e,u+h,d),p=kd(l,e,u,u+h),m=f>=0&&t[f],g=p>=0&&t[p];if(r&&!g||!r&&!m){zd(fl(a,o),s,l);let y=GR(r?HR:$R,t.length,r,n,c);!r&&g&&(t[p].providerFactory=y),Md(s,i,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),t.push(y),o.push(y)}else{let y=Qb(t[r?p:f],c,!r&&n);Md(s,i,f>-1?f:p,y)}!r&&n&&g&&t[p].componentProviders++}}}function Md(i,e,t,n){let r=zr(e),s=Zx(e);if(r||s){let l=(s?ft(e.useClass):e).prototype.ngOnDestroy;if(l){let c=i.destroyHooks||(i.destroyHooks=[]);if(!r&&e.multi){let u=c.indexOf(t);u===-1?c.push(t,[n,l]):c[u+1].push(n,l)}else c.push(t,l)}}}function Qb(i,e,t){return t&&i.componentProviders++,i.multi.push(e)-1}function kd(i,e,t,n){for(let r=t;r<n;r++)if(e[r]===i)return r;return-1}function $R(i,e,t,n){return Eh(this.multi,[])}function HR(i,e,t,n){let r=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=Vi(t,t[ue],this.providerFactory.index,n);s=a.slice(0,o),Eh(r,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],Eh(r,s);return s}function Eh(i,e){for(let t=0;t<i.length;t++){let n=i[t];e.push(n())}return e}function GR(i,e,t,n,r){let s=new Bi(i,t,X);return s.multi=[],s.index=e,s.componentProviders=0,Qb(s,r,n&&!t),s}function Ki(i,e=[]){return t=>{t.providersResolver=(n,r)=>jR(n,r?r(i):i,e)}}var zR=(()=>{let e=class e{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){let r=l0(!1,n.type),s=r.length>0?uf([r],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,s)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(let n of this.cachedInjectors.values())n!==null&&n.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=j({token:e,providedIn:"environment",factory:()=>new e(C(Et))});let i=e;return i})();function on(i){es("NgStandalone"),i.getStandaloneInjector=e=>e.get(zR).getOrCreateStandaloneInjector(i)}var jl=(()=>{let e=class e{log(n){console.log(n)}warn(n){console.warn(n)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"platform"});let i=e;return i})();var mf=new G(""),fo=new G(""),$l=(()=>{let e=class e{constructor(n,r,s){this._ngZone=n,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,gf||(WR(s),s.addToWindow(r)),this._watchAngularEvents(),n.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{W.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let n=this._callbacks.pop();clearTimeout(n.timeoutId),n.doneCb()}});else{let n=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>r.updateCb&&r.updateCb(n)?(clearTimeout(r.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(n=>({source:n.source,creationLocation:n.creationLocation,data:n.data})):[]}addCallback(n,r,s){let o=-1;r&&r>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),n()},r)),this._callbacks.push({doneCb:n,timeoutId:o,updateCb:s})}whenStable(n,r,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(n,r,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(n){this.registry.registerApplication(n,this)}unregisterApplication(n){this.registry.unregisterApplication(n)}findProviders(n,r,s){return[]}};e.\u0275fac=function(r){return new(r||e)(C(W),C(Hl),C(fo))},e.\u0275prov=j({token:e,factory:e.\u0275fac});let i=e;return i})(),Hl=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(n,r){this._applications.set(n,r)}unregisterApplication(n){this._applications.delete(n)}unregisterAllApplications(){this._applications.clear()}getTestability(n){return this._applications.get(n)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(n,r=!0){return gf?.findTestabilityInTree(this,n,r)??null}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"platform"});let i=e;return i})();function WR(i){gf=i}var gf;function Yi(i){return!!i&&typeof i.then=="function"}function Xb(i){return!!i&&typeof i.subscribe=="function"}var Zb=new G(""),Jb=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r}),this.appInits=L(Zb,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let n=[];for(let s of this.appInits){let o=s();if(Yi(o))n.push(o);else if(Xb(o)){let a=new Promise((l,c)=>{o.subscribe({complete:l,error:c})});n.push(a)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(s=>{this.reject(s)}),n.length===0&&r(),this.initialized=!0}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),vf=new G("");function qR(){Fv(()=>{throw new V(600,!1)})}function KR(i){return i.isBoundToModule}function YR(i,e,t){try{let n=t();return Yi(n)?n.catch(r=>{throw e.runOutsideAngular(()=>i.handleError(r)),r}):n}catch(n){throw e.runOutsideAngular(()=>i.handleError(n)),n}}var mi=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=L(W0),this.afterRenderEffectManager=L(Bl),this.externalTestViews=new Set,this.beforeRender=new fe,this.afterTick=new fe,this.componentTypes=[],this.components=[],this.isStable=L(Vl).hasPendingTasks.pipe(pe(n=>!n)),this._injector=L(Et)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,r){let s=n instanceof yl;if(!this._injector.get(Jb).done){let f=!s&&r0(n),p=!1;throw new V(405,p)}let a;s?a=n:a=this._injector.get(fi).resolveComponentFactory(n),this.componentTypes.push(a.componentType);let l=KR(a)?void 0:this._injector.get(ci),c=r||a.selector,u=a.create(qe.NULL,[],c,l),d=u.location.nativeElement,h=u.injector.get(mf,null);return h?.registerApplication(d),u.onDestroy(()=>{this.detachView(u.hostView),Ld(this.components,u),h?.unregisterApplication(d)}),this._loadComponent(u),u}tick(){this._tick(!0)}_tick(n){if(this._runningTick)throw new V(101,!1);let r=ye(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(n)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,ye(r)}}detectChangesInAttachedViews(n){let r=0,s=this.afterRenderEffectManager;for(;;){if(r===Lb)throw new V(103,!1);if(n){let o=r===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:l}of this._views)QR(a,o,l)}if(r++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Dh(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Dh(o))))break}}attachView(n){let r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){let r=n;Ld(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);let r=this._injector.get(vf,[]);[...this._bootstrapListeners,...r].forEach(s=>s(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>Ld(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new V(406,!1);let n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function Ld(i,e){let t=i.indexOf(e);t>-1&&i.splice(t,1)}function QR(i,e,t){!e&&!Dh(i)||XR(i,t,e)}function Dh(i){return Fh(i)}function XR(i,e,t){let n;t?(n=0,i[te]|=1024):i[te]&64?n=0:n=1,Ob(i,e,n)}var wh=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},yf=(()=>{let e=class e{compileModuleSync(n){return new gh(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){let r=this.compileModuleSync(n),s=s0(n),o=eb(s.declarations).reduce((a,l)=>{let c=Oi(l);return c&&a.push(new Zs(c)),a},[]);return new wh(r,o)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var ZR=(()=>{let e=class e{constructor(){this.zone=L(W),this.applicationRef=L(mi)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function JR(i){return[{provide:W,useFactory:i},{provide:Gr,multi:!0,useFactory:()=>{let e=L(ZR,{optional:!0});return()=>e.initialize()}},{provide:Gr,multi:!0,useFactory:()=>{let e=L(iM);return()=>{e.initialize()}}},{provide:W0,useFactory:eM}]}function eM(){let i=L(W),e=L(En);return t=>i.runOutsideAngular(()=>e.handleError(t))}function tM(i){let e=JR(()=>new W(nM(i)));return Cl([[],e])}function nM(i){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:i?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:i?.runCoalescing??!1}}var iM=(()=>{let e=class e{constructor(){this.subscription=new ke,this.initialized=!1,this.zone=L(W),this.pendingTasks=L(Vl)}initialize(){if(this.initialized)return;this.initialized=!0;let n=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(n=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{W.assertNotInAngularZone(),queueMicrotask(()=>{n!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(n),n=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{W.assertInAngularZone(),n??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function rM(){return typeof $localize<"u"&&$localize.locale||Sl}var Gl=new G("",{providedIn:"root",factory:()=>L(Gl,ge.Optional|ge.SkipSelf)||rM()});var e_=new G("");var rl=null;function sM(i=[],e){return qe.create({name:e,providers:[{provide:Rl,useValue:"platform"},{provide:e_,useValue:new Set([()=>rl=null])},...i]})}function oM(i=[]){if(rl)return rl;let e=sM(i);return rl=e,qR(),aM(e),e}function aM(i){i.get(qh,null)?.forEach(t=>t())}var an=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=lM;let i=e;return i})();function lM(i){return cM(Ct(),Se(),(i&16)===16)}function cM(i,e,t){if(Ll(i)&&!t){let n=ui(i.index,e);return new ji(n,n)}else if(i.type&47){let n=e[en];return new ji(n,e)}return null}var t_=(()=>{let e=class e{constructor(n){}};e.\u0275fac=function(r){return new(r||e)(C(mi))},e.\u0275mod=Ee({type:e}),e.\u0275inj=_e({});let i=e;return i})();function n_(i){try{let{rootComponent:e,appProviders:t,platformProviders:n}=i,r=oM(n),s=[tM(),...t||[]],a=new Dl({providers:s,parent:r,debugName:"",runEnvironmentInitializers:!1}).injector,l=a.get(W);return l.run(()=>{a.resolveInjectorInitializers();let c=a.get(En,null),u;l.runOutsideAngular(()=>{u=l.onError.subscribe({next:f=>{c.handleError(f)}})});let d=()=>a.destroy(),h=r.get(e_);return h.add(d),a.onDestroy(()=>{u.unsubscribe(),h.delete(d)}),YR(c,l,()=>{let f=a.get(Jb);return f.runInitializers(),f.donePromise.then(()=>{let p=a.get(Gl,Sl);FR(p||Sl);let m=a.get(mi);return e!==void 0&&m.bootstrap(e),m})})})}catch(e){return Promise.reject(e)}}function Ht(i){return typeof i=="boolean"?i:i!=null&&i!=="false"}function zl(i){let e=ye(null);try{return i()}finally{ye(e)}}var o_=null;function Cn(){return o_}function a_(i){o_??=i}var Wl=class{};var de=new G(""),l_=(()=>{let e=class e{historyGo(n){throw new Error("")}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:()=>L(pM),providedIn:"platform"});let i=e;return i})();var pM=(()=>{let e=class e extends l_{constructor(){super(),this._doc=L(de),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Cn().getBaseHref(this._doc)}onPopState(n){let r=Cn().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){let r=Cn().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,r,s){this._history.pushState(n,r,s)}replaceState(n,r,s){this._history.replaceState(n,r,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:()=>new e,providedIn:"platform"});let i=e;return i})();function c_(i,e){if(i.length==0)return e;if(e.length==0)return i;let t=0;return i.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?i+e.substring(1):t==1?i+e:i+"/"+e}function i_(i){let e=i.match(/#|\?|$/),t=e&&e.index||i.length,n=t-(i[t-1]==="/"?1:0);return i.slice(0,n)+i.slice(t)}function Qi(i){return i&&i[0]!=="?"?"?"+i:i}var Yl=(()=>{let e=class e{historyGo(n){throw new Error("")}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:()=>L(u_),providedIn:"root"});let i=e;return i})(),mM=new G(""),u_=(()=>{let e=class e extends Yl{constructor(n,r){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??L(de).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return c_(this._baseHref,n)}path(n=!1){let r=this._platformLocation.pathname+Qi(this._platformLocation.search),s=this._platformLocation.hash;return s&&n?`${r}${s}`:r}pushState(n,r,s,o){let a=this.prepareExternalUrl(s+Qi(o));this._platformLocation.pushState(n,r,a)}replaceState(n,r,s,o){let a=this.prepareExternalUrl(s+Qi(o));this._platformLocation.replaceState(n,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}};e.\u0275fac=function(r){return new(r||e)(C(l_),C(mM,8))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var Xi=(()=>{let e=class e{constructor(n){this._subject=new Pe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;let r=this._locationStrategy.getBaseHref();this._basePath=yM(i_(r_(r))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+Qi(r))}normalize(n){return e.stripTrailingSlash(vM(this._basePath,r_(n)))}prepareExternalUrl(n){return n&&n[0]!=="/"&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,r="",s=null){this._locationStrategy.pushState(s,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Qi(r)),s)}replaceState(n,r="",s=null){this._locationStrategy.replaceState(s,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Qi(r)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(s=>s(n,r))}subscribe(n,r,s){return this._subject.subscribe({next:n,error:r,complete:s})}};e.normalizeQueryParams=Qi,e.joinWithSlash=c_,e.stripTrailingSlash=i_,e.\u0275fac=function(r){return new(r||e)(C(Yl))},e.\u0275prov=j({token:e,factory:()=>gM(),providedIn:"root"});let i=e;return i})();function gM(){return new Xi(C(Yl))}function vM(i,e){if(!i||!e.startsWith(i))return e;let t=e.substring(i.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function r_(i){return i.replace(/\/index.html$/,"")}function yM(i){if(new RegExp("^(https?:)?//").test(i)){let[,t]=i.split(/\/\/[^\/]+/);return t}return i}function d_(i,e){e=encodeURIComponent(e);for(let t of i.split(";")){let n=t.indexOf("="),[r,s]=n==-1?[t,""]:[t.slice(0,n),t.slice(n+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}var h_=(()=>{let e=class e{constructor(n,r){this._viewContainer=n,this._context=new bf,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){s_("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){s_("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,r){return!0}};e.\u0275fac=function(r){return new(r||e)(X(rn),X(tn))},e.\u0275dir=Le({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let i=e;return i})(),bf=class{constructor(){this.$implicit=null,this.ngIf=null}};function s_(i,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${i} must be a TemplateRef, but received '${pt(e)}'.`)}var Ql=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ee({type:e}),e.\u0275inj=_e({});let i=e;return i})(),_f="browser",bM="server";function f_(i){return i===_f}function Ef(i){return i===bM}var ql=class{};var Sf=class extends Wl{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Tf=class i extends Sf{static makeCurrent(){a_(new i)}onAndCancel(e,t,n){return e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=EM();return t==null?null:DM(t)}resetBaseElement(){po=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return d_(document.cookie,e)}},po=null;function EM(){return po=po||document.querySelector("base"),po?po.getAttribute("href"):null}function DM(i){return new URL(i,document.baseURI).pathname}var xf=class{addToWindow(e){Vt.getAngularTestability=(n,r=!0)=>{let s=e.findTestabilityInTree(n,r);if(s==null)throw new V(5103,!1);return s},Vt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Vt.getAllAngularRootElements=()=>e.getAllRootElements();let t=n=>{let r=Vt.getAllAngularTestabilities(),s=r.length,o=function(){s--,s==0&&n()};r.forEach(a=>{a.whenStable(o)})};Vt.frameworkStabilizers||(Vt.frameworkStabilizers=[]),Vt.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,n){if(t==null)return null;let r=e.getTestability(t);return r??(n?Cn().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},wM=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:e.\u0275fac});let i=e;return i})(),If=new G(""),v_=(()=>{let e=class e{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(s=>{s.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,r,s){return this._findPluginFor(r).addEventListener(n,r,s)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(o=>o.supports(n)),!r)throw new V(5101,!1);return this._eventNameToPlugin.set(n,r),r}};e.\u0275fac=function(r){return new(r||e)(C(If),C(W))},e.\u0275prov=j({token:e,factory:e.\u0275fac});let i=e;return i})(),Xl=class{constructor(e){this._doc=e}},Df="ng-app-id",y_=(()=>{let e=class e{constructor(n,r,s,o={}){this.doc=n,this.appId=r,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Ef(o),this.resetHostNodes()}addStyles(n){for(let r of n)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(n){for(let r of n)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let n=this.styleNodesInDOM;n&&(n.forEach(r=>r.remove()),n.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(let r of this.getAllStyles())this.addStyleToHost(n,r)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(let r of this.hostNodes)this.addStyleToHost(r,n)}onStyleRemoved(n){let r=this.styleRef;r.get(n)?.elements?.forEach(s=>s.remove()),r.delete(n)}collectServerRenderedStyles(){let n=this.doc.head?.querySelectorAll(`style[${Df}="${this.appId}"]`);if(n?.length){let r=new Map;return n.forEach(s=>{s.textContent!=null&&r.set(s.textContent,s)}),r}return null}changeUsageCount(n,r){let s=this.styleRef;if(s.has(n)){let o=s.get(n);return o.usage+=r,o.usage}return s.set(n,{usage:r,elements:[]}),r}getStyleElement(n,r){let s=this.styleNodesInDOM,o=s?.get(r);if(o?.parentNode===n)return s.delete(r),o.removeAttribute(Df),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=r,this.platformIsServer&&a.setAttribute(Df,this.appId),n.appendChild(a),a}}addStyleToHost(n,r){let s=this.getStyleElement(n,r),o=this.styleRef,a=o.get(r)?.elements;a?a.push(s):o.set(r,{elements:[s],usage:1})}resetHostNodes(){let n=this.hostNodes;n.clear(),n.add(this.doc.head)}};e.\u0275fac=function(r){return new(r||e)(C(de),C(oo),C(ao,8),C(qn))},e.\u0275prov=j({token:e,factory:e.\u0275fac});let i=e;return i})(),wf={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Af=/%COMP%/g,b_="%COMP%",SM=`_nghost-${b_}`,TM=`_ngcontent-${b_}`,xM=!0,IM=new G("",{providedIn:"root",factory:()=>xM});function CM(i){return TM.replace(Af,i)}function AM(i){return SM.replace(Af,i)}function __(i,e){return e.map(t=>t.replace(Af,i))}var Zl=(()=>{let e=class e{constructor(n,r,s,o,a,l,c,u=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=l,this.ngZone=c,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=Ef(l),this.defaultRenderer=new mo(n,a,c,this.platformIsServer)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===yn.ShadowDom&&(r=Ie(N({},r),{encapsulation:yn.Emulated}));let s=this.getOrCreateRenderer(n,r);return s instanceof Jl?s.applyToHost(n):s instanceof go&&s.applyStyles(),s}getOrCreateRenderer(n,r){let s=this.rendererByCompId,o=s.get(r.id);if(!o){let a=this.doc,l=this.ngZone,c=this.eventManager,u=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(r.encapsulation){case yn.Emulated:o=new Jl(c,u,r,this.appId,d,a,l,h);break;case yn.ShadowDom:return new Cf(c,u,n,r,a,l,this.nonce,h);default:o=new go(c,u,r,d,a,l,h);break}s.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(r){return new(r||e)(C(v_),C(y_),C(oo),C(IM),C(de),C(qn),C(W),C(ao))},e.\u0275prov=j({token:e,factory:e.\u0275fac});let i=e;return i})(),mo=class{constructor(e,t,n,r){this.eventManager=e,this.doc=t,this.ngZone=n,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(wf[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(m_(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(m_(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n=typeof e=="string"?this.doc.querySelector(e):e;if(!n)throw new V(-5104,!1);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;let s=wf[r];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){let r=wf[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(Hn.DashCase|Hn.Important)?e.style.setProperty(t,n,r&Hn.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&Hn.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e!=null&&(e[t]=n)}setValue(e,t){e.nodeValue=t}listen(e,t,n){if(typeof e=="string"&&(e=Cn().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(n))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function m_(i){return i.tagName==="TEMPLATE"&&i.content!==void 0}var Cf=class extends mo{constructor(e,t,n,r,s,o,a,l){super(e,s,o,l),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=__(r.id,r.styles);for(let u of c){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},go=class extends mo{constructor(e,t,n,r,s,o,a,l){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=l?__(l,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Jl=class extends go{constructor(e,t,n,r,s,o,a,l){let c=r+"-"+n.id;super(e,t,n,s,o,a,l,c),this.contentAttr=CM(c),this.hostAttr=AM(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}},RM=(()=>{let e=class e extends Xl{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,s){return n.addEventListener(r,s,!1),()=>this.removeEventListener(n,r,s)}removeEventListener(n,r,s){return n.removeEventListener(r,s)}};e.\u0275fac=function(r){return new(r||e)(C(de))},e.\u0275prov=j({token:e,factory:e.\u0275fac});let i=e;return i})(),g_=["alt","control","meta","shift"],MM={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},kM={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey},LM=(()=>{let e=class e extends Xl{constructor(n){super(n)}supports(n){return e.parseEventName(n)!=null}addEventListener(n,r,s){let o=e.parseEventName(r),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Cn().onAndCancel(n,o.domEventName,a))}static parseEventName(n){let r=n.toLowerCase().split("."),s=r.shift();if(r.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(r.pop()),a="",l=r.indexOf("code");if(l>-1&&(r.splice(l,1),a="code."),g_.forEach(u=>{let d=r.indexOf(u);d>-1&&(r.splice(d,1),a+=u+".")}),a+=o,r.length!=0||o.length===0)return null;let c={};return c.domEventName=s,c.fullKey=a,c}static matchEventFullKeyCode(n,r){let s=MM[n.key]||n.key,o="";return r.indexOf("code.")>-1&&(s=n.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),g_.forEach(a=>{if(a!==s){let l=kM[a];l(n)&&(o+=a+".")}}),o+=s,o===r)}static eventCallback(n,r,s){return o=>{e.matchEventFullKeyCode(o,n)&&s.runGuarded(()=>r(o))}}static _normalizeKey(n){return n==="esc"?"escape":n}};e.\u0275fac=function(r){return new(r||e)(C(de))},e.\u0275prov=j({token:e,factory:e.\u0275fac});let i=e;return i})();function E_(i,e){return n_(N({rootComponent:i},OM(e)))}function OM(i){return{appProviders:[...D_,...i?.providers??[]],platformProviders:BM}}function NM(){Tf.makeCurrent()}function PM(){return new En}function FM(){return Z0(document),document}var BM=[{provide:qn,useValue:_f},{provide:qh,useValue:NM,multi:!0},{provide:de,useFactory:FM,deps:[]}];var VM=new G(""),UM=[{provide:fo,useClass:xf,deps:[]},{provide:mf,useClass:$l,deps:[W,Hl,fo]},{provide:$l,useClass:$l,deps:[W,Hl,fo]}],D_=[{provide:Rl,useValue:"root"},{provide:En,useFactory:PM,deps:[]},{provide:If,useClass:RM,multi:!0,deps:[de,W,qn]},{provide:If,useClass:LM,multi:!0,deps:[de]},Zl,y_,v_,{provide:$i,useExisting:Zl},{provide:ql,useClass:wM,deps:[]},[]],w_=(()=>{let e=class e{constructor(n){}static withServerTransition(n){return{ngModule:e,providers:[{provide:oo,useValue:n.appId}]}}};e.\u0275fac=function(r){return new(r||e)(C(VM,12))},e.\u0275mod=Ee({type:e}),e.\u0275inj=_e({providers:[...D_,...UM],imports:[Ql,t_]});let i=e;return i})();var S_=(()=>{let e=class e{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}};e.\u0275fac=function(r){return new(r||e)(C(de))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var he="primary",Mo=Symbol("RouteTitle"),Of=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function os(i){return new Of(i)}function $M(i,e,t){let n=t.path.split("/");if(n.length>i.length||t.pathMatch==="full"&&(e.hasChildren()||n.length<i.length))return null;let r={};for(let s=0;s<n.length;s++){let o=n[s],a=i[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:i.slice(0,n.length),posParams:r}}function HM(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;++t)if(!An(i[t],e[t]))return!1;return!0}function An(i,e){let t=i?Nf(i):void 0,n=e?Nf(e):void 0;if(!t||!n||t.length!=n.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!R_(i[r],e[r]))return!1;return!0}function Nf(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}function R_(i,e){if(Array.isArray(i)&&Array.isArray(e)){if(i.length!==e.length)return!1;let t=[...i].sort(),n=[...e].sort();return t.every((r,s)=>n[s]===r)}else return i===e}function M_(i){return i.length>0?i[i.length-1]:null}function bi(i){return Bs(i)?i:Yi(i)?Be(Promise.resolve(i)):ne(i)}var GM={exact:L_,subset:O_},k_={exact:zM,subset:WM,ignored:()=>!0};function T_(i,e,t){return GM[t.paths](i.root,e.root,t.matrixParams)&&k_[t.queryParams](i.queryParams,e.queryParams)&&!(t.fragment==="exact"&&i.fragment!==e.fragment)}function zM(i,e){return An(i,e)}function L_(i,e,t){if(!Ji(i.segments,e.segments)||!nc(i.segments,e.segments,t)||i.numberOfChildren!==e.numberOfChildren)return!1;for(let n in e.children)if(!i.children[n]||!L_(i.children[n],e.children[n],t))return!1;return!0}function WM(i,e){return Object.keys(e).length<=Object.keys(i).length&&Object.keys(e).every(t=>R_(i[t],e[t]))}function O_(i,e,t){return N_(i,e,e.segments,t)}function N_(i,e,t,n){if(i.segments.length>t.length){let r=i.segments.slice(0,t.length);return!(!Ji(r,t)||e.hasChildren()||!nc(r,t,n))}else if(i.segments.length===t.length){if(!Ji(i.segments,t)||!nc(i.segments,t,n))return!1;for(let r in e.children)if(!i.children[r]||!O_(i.children[r],e.children[r],n))return!1;return!0}else{let r=t.slice(0,i.segments.length),s=t.slice(i.segments.length);return!Ji(i.segments,r)||!nc(i.segments,r,n)||!i.children[he]?!1:N_(i.children[he],e,s,n)}}function nc(i,e,t){return e.every((n,r)=>k_[t](i[r].parameters,n.parameters))}var gi=class{constructor(e=new Te([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap??=os(this.queryParams),this._queryParamMap}toString(){return YM.serialize(this)}},Te=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ic(this)}},Zi=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=os(this.parameters),this._parameterMap}toString(){return F_(this)}};function qM(i,e){return Ji(i,e)&&i.every((t,n)=>An(t.parameters,e[n].parameters))}function Ji(i,e){return i.length!==e.length?!1:i.every((t,n)=>t.path===e[n].path)}function KM(i,e){let t=[];return Object.entries(i.children).forEach(([n,r])=>{n===he&&(t=t.concat(e(r,n)))}),Object.entries(i.children).forEach(([n,r])=>{n!==he&&(t=t.concat(e(r,n)))}),t}var ap=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:()=>new sc,providedIn:"root"});let i=e;return i})(),sc=class{parse(e){let t=new Ff(e);return new gi(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${vo(e.root,!0)}`,n=ZM(e.queryParams),r=typeof e.fragment=="string"?`#${QM(e.fragment)}`:"";return`${t}${n}${r}`}},YM=new sc;function ic(i){return i.segments.map(e=>F_(e)).join("/")}function vo(i,e){if(!i.hasChildren())return ic(i);if(e){let t=i.children[he]?vo(i.children[he],!1):"",n=[];return Object.entries(i.children).forEach(([r,s])=>{r!==he&&n.push(`${r}:${vo(s,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}else{let t=KM(i,(n,r)=>r===he?[vo(i.children[he],!1)]:[`${r}:${vo(n,!1)}`]);return Object.keys(i.children).length===1&&i.children[he]!=null?`${ic(i)}/${t[0]}`:`${ic(i)}/(${t.join("//")})`}}function P_(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ec(i){return P_(i).replace(/%3B/gi,";")}function QM(i){return encodeURI(i)}function Pf(i){return P_(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function rc(i){return decodeURIComponent(i)}function x_(i){return rc(i.replace(/\+/g,"%20"))}function F_(i){return`${Pf(i.path)}${XM(i.parameters)}`}function XM(i){return Object.entries(i).map(([e,t])=>`;${Pf(e)}=${Pf(t)}`).join("")}function ZM(i){let e=Object.entries(i).map(([t,n])=>Array.isArray(n)?n.map(r=>`${ec(t)}=${ec(r)}`).join("&"):`${ec(t)}=${ec(n)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var JM=/^[^\/()?;#]+/;function Rf(i){let e=i.match(JM);return e?e[0]:""}var ek=/^[^\/()?;=#]+/;function tk(i){let e=i.match(ek);return e?e[0]:""}var nk=/^[^=?&#]+/;function ik(i){let e=i.match(nk);return e?e[0]:""}var rk=/^[^&#]+/;function sk(i){let e=i.match(rk);return e?e[0]:""}var Ff=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Te([],{}):new Te([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[he]=new Te(e,t)),n}parseSegment(){let e=Rf(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new V(4009,!1);return this.capture(e),new Zi(rc(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=tk(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let r=Rf(this.remaining);r&&(n=r,this.capture(n))}e[rc(t)]=rc(n)}parseQueryParam(e){let t=ik(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let o=sk(this.remaining);o&&(n=o,this.capture(n))}let r=x_(t),s=x_(n);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let n=Rf(this.remaining),r=this.remaining[n.length];if(r!=="/"&&r!==")"&&r!==";")throw new V(4010,!1);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=he);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[he]:new Te([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new V(4011,!1)}};function B_(i){return i.segments.length>0?new Te([],{[he]:i}):i}function V_(i){let e={};for(let[n,r]of Object.entries(i.children)){let s=V_(r);if(n===he&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[n]=s)}let t=new Te(i.segments,e);return ok(t)}function ok(i){if(i.numberOfChildren===1&&i.children[he]){let e=i.children[he];return new Te(i.segments.concat(e.segments),e.children)}return i}function as(i){return i instanceof gi}function ak(i,e,t=null,n=null){let r=U_(i);return j_(r,e,t,n)}function U_(i){let e;function t(s){let o={};for(let l of s.children){let c=t(l);o[l.outlet]=c}let a=new Te(s.url,o);return s===i&&(e=a),a}let n=t(i.root),r=B_(n);return e??r}function j_(i,e,t,n){let r=i;for(;r.parent;)r=r.parent;if(e.length===0)return Mf(r,r,r,t,n);let s=lk(e);if(s.toRoot())return Mf(r,r,new Te([],{}),t,n);let o=ck(s,r,i),a=o.processChildren?_o(o.segmentGroup,o.index,s.commands):H_(o.segmentGroup,o.index,s.commands);return Mf(r,o.segmentGroup,a,t,n)}function oc(i){return typeof i=="object"&&i!=null&&!i.outlets&&!i.segmentPath}function wo(i){return typeof i=="object"&&i!=null&&i.outlets}function Mf(i,e,t,n,r){let s={};n&&Object.entries(n).forEach(([l,c])=>{s[l]=Array.isArray(c)?c.map(u=>`${u}`):`${c}`});let o;i===e?o=t:o=$_(i,e,t);let a=B_(V_(o));return new gi(a,s,r)}function $_(i,e,t){let n={};return Object.entries(i.children).forEach(([r,s])=>{s===e?n[r]=t:n[r]=$_(s,e,t)}),new Te(i.segments,n)}var ac=class{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&oc(n[0]))throw new V(4003,!1);let r=n.find(wo);if(r&&r!==M_(n))throw new V(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function lk(i){if(typeof i[0]=="string"&&i.length===1&&i[0]==="/")return new ac(!0,0,i);let e=0,t=!1,n=i.reduce((r,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([l,c])=>{a[l]=typeof c=="string"?c.split("/"):c}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return typeof s!="string"?[...r,s]:o===0?(s.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?t=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,s]},[]);return new ac(t,e,n)}var rs=class{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}};function ck(i,e,t){if(i.isAbsolute)return new rs(e,!0,0);if(!t)return new rs(e,!1,NaN);if(t.parent===null)return new rs(t,!0,0);let n=oc(i.commands[0])?0:1,r=t.segments.length-1+n;return uk(t,r,i.numberOfDoubleDots)}function uk(i,e,t){let n=i,r=e,s=t;for(;s>r;){if(s-=r,n=n.parent,!n)throw new V(4005,!1);r=n.segments.length}return new rs(n,!1,r-s)}function dk(i){return wo(i[0])?i[0].outlets:{[he]:i}}function H_(i,e,t){if(i??=new Te([],{}),i.segments.length===0&&i.hasChildren())return _o(i,e,t);let n=hk(i,e,t),r=t.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){let s=new Te(i.segments.slice(0,n.pathIndex),{});return s.children[he]=new Te(i.segments.slice(n.pathIndex),i.children),_o(s,0,r)}else return n.match&&r.length===0?new Te(i.segments,{}):n.match&&!i.hasChildren()?Bf(i,e,t):n.match?_o(i,0,r):Bf(i,e,t)}function _o(i,e,t){if(t.length===0)return new Te(i.segments,{});{let n=dk(t),r={};if(Object.keys(n).some(s=>s!==he)&&i.children[he]&&i.numberOfChildren===1&&i.children[he].segments.length===0){let s=_o(i.children[he],e,t);return new Te(i.segments,s.children)}return Object.entries(n).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(r[s]=H_(i.children[s],e,o))}),Object.entries(i.children).forEach(([s,o])=>{n[s]===void 0&&(r[s]=o)}),new Te(i.segments,r)}}function hk(i,e,t){let n=0,r=e,s={match:!1,pathIndex:0,commandIndex:0};for(;r<i.segments.length;){if(n>=t.length)return s;let o=i.segments[r],a=t[n];if(wo(a))break;let l=`${a}`,c=n<t.length-1?t[n+1]:null;if(r>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!C_(l,c,o))return s;n+=2}else{if(!C_(l,{},o))return s;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}function Bf(i,e,t){let n=i.segments.slice(0,e),r=0;for(;r<t.length;){let s=t[r];if(wo(s)){let l=fk(s.outlets);return new Te(n,l)}if(r===0&&oc(t[0])){let l=i.segments[e];n.push(new Zi(l.path,I_(t[0]))),r++;continue}let o=wo(s)?s.outlets[he]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&oc(a)?(n.push(new Zi(o,I_(a))),r+=2):(n.push(new Zi(o,{})),r++)}return new Te(n,{})}function fk(i){let e={};return Object.entries(i).forEach(([t,n])=>{typeof n=="string"&&(n=[n]),n!==null&&(e[t]=Bf(new Te([],{}),0,n))}),e}function I_(i){let e={};return Object.entries(i).forEach(([t,n])=>e[t]=`${n}`),e}function C_(i,e,t){return i==t.path&&An(e,t.parameters)}var Eo="imperative",at=function(i){return i[i.NavigationStart=0]="NavigationStart",i[i.NavigationEnd=1]="NavigationEnd",i[i.NavigationCancel=2]="NavigationCancel",i[i.NavigationError=3]="NavigationError",i[i.RoutesRecognized=4]="RoutesRecognized",i[i.ResolveStart=5]="ResolveStart",i[i.ResolveEnd=6]="ResolveEnd",i[i.GuardsCheckStart=7]="GuardsCheckStart",i[i.GuardsCheckEnd=8]="GuardsCheckEnd",i[i.RouteConfigLoadStart=9]="RouteConfigLoadStart",i[i.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",i[i.ChildActivationStart=11]="ChildActivationStart",i[i.ChildActivationEnd=12]="ChildActivationEnd",i[i.ActivationStart=13]="ActivationStart",i[i.ActivationEnd=14]="ActivationEnd",i[i.Scroll=15]="Scroll",i[i.NavigationSkipped=16]="NavigationSkipped",i}(at||{}),Gt=class{constructor(e,t){this.id=e,this.url=t}},So=class extends Gt{constructor(e,t,n="imperative",r=null){super(e,t),this.type=at.NavigationStart,this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},er=class extends Gt{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=at.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},kt=function(i){return i[i.Redirect=0]="Redirect",i[i.SupersededByNewNavigation=1]="SupersededByNewNavigation",i[i.NoDataFromResolver=2]="NoDataFromResolver",i[i.GuardRejected=3]="GuardRejected",i}(kt||{}),Vf=function(i){return i[i.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",i[i.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",i}(Vf||{}),vi=class extends Gt{constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r,this.type=at.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},tr=class extends Gt{constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r,this.type=at.NavigationSkipped}},To=class extends Gt{constructor(e,t,n,r){super(e,t),this.error=n,this.target=r,this.type=at.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},lc=class extends Gt{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=at.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Uf=class extends Gt{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=at.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},jf=class extends Gt{constructor(e,t,n,r,s){super(e,t),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=s,this.type=at.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},$f=class extends Gt{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=at.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Hf=class extends Gt{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=at.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Gf=class{constructor(e){this.route=e,this.type=at.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},zf=class{constructor(e){this.route=e,this.type=at.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Wf=class{constructor(e){this.snapshot=e,this.type=at.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},qf=class{constructor(e){this.snapshot=e,this.type=at.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Kf=class{constructor(e){this.snapshot=e,this.type=at.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Yf=class{constructor(e){this.snapshot=e,this.type=at.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var xo=class{},Io=class{constructor(e){this.url=e}};var Qf=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new pc,this.attachRef=null}},pc=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(n,r){let s=this.getOrCreateContext(n);s.outlet=r,this.contexts.set(n,s)}onChildOutletDestroyed(n){let r=this.getContext(n);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let r=this.getContext(n);return r||(r=new Qf,this.contexts.set(n,r)),r}getContext(n){return this.contexts.get(n)||null}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),cc=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=Xf(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){let t=Xf(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Zf(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return Zf(e,this._root).map(t=>t.value)}};function Xf(i,e){if(i===e.value)return e;for(let t of e.children){let n=Xf(i,t);if(n)return n}return null}function Zf(i,e){if(i===e.value)return[e];for(let t of e.children){let n=Zf(i,t);if(n.length)return n.unshift(e),n}return[]}var Mt=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function is(i){let e={};return i&&i.children.forEach(t=>e[t.value.outlet]=t),e}var uc=class extends cc{constructor(e,t){super(e),this.snapshot=t,cp(this,e)}toString(){return this.snapshot.toString()}};function G_(i){let e=pk(i),t=new Qe([new Zi("",{})]),n=new Qe({}),r=new Qe({}),s=new Qe({}),o=new Qe(""),a=new yi(t,n,s,o,r,he,i,e.root);return a.snapshot=e.root,new uc(new Mt(a,[]),e)}function pk(i){let e={},t={},n={},r="",s=new Co([],e,n,r,t,he,i,null,{});return new dc("",new Mt(s,[]))}var yi=class{constructor(e,t,n,r,s,o,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=n,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(pe(c=>c[Mo]))??ne(void 0),this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(pe(e=>os(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(pe(e=>os(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function lp(i,e,t="emptyOnly"){let n,{routeConfig:r}=i;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?n={params:N(N({},e.params),i.params),data:N(N({},e.data),i.data),resolve:N(N(N(N({},i.data),e.data),r?.data),i._resolvedData)}:n={params:N({},i.params),data:N({},i.data),resolve:N(N({},i.data),i._resolvedData??{})},r&&W_(r)&&(n.resolve[Mo]=r.title),n}var Co=class{get title(){return this.data?.[Mo]}constructor(e,t,n,r,s,o,a,l,c){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=os(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=os(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(n=>n.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},dc=class extends cc{constructor(e,t){super(t),this.url=e,cp(this,t)}toString(){return z_(this._root)}};function cp(i,e){e.value._routerState=i,e.children.forEach(t=>cp(i,t))}function z_(i){let e=i.children.length>0?` { ${i.children.map(z_).join(", ")} } `:"";return`${i.value}${e}`}function kf(i){if(i.snapshot){let e=i.snapshot,t=i._futureSnapshot;i.snapshot=t,An(e.queryParams,t.queryParams)||i.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&i.fragmentSubject.next(t.fragment),An(e.params,t.params)||i.paramsSubject.next(t.params),HM(e.url,t.url)||i.urlSubject.next(t.url),An(e.data,t.data)||i.dataSubject.next(t.data)}else i.snapshot=i._futureSnapshot,i.dataSubject.next(i._futureSnapshot.data)}function Jf(i,e){let t=An(i.params,e.params)&&qM(i.url,e.url),n=!i.parent!=!e.parent;return t&&!n&&(!i.parent||Jf(i.parent,e.parent))}function W_(i){return typeof i.title=="string"||i.title===null}var mk=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=he,this.activateEvents=new Pe,this.deactivateEvents=new Pe,this.attachEvents=new Pe,this.detachEvents=new Pe,this.parentContexts=L(pc),this.location=L(rn),this.changeDetector=L(an),this.environmentInjector=L(Et),this.inputBinder=L(up,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){let{firstChange:r,previousValue:s}=n.name;if(r)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new V(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new V(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new V(4012,!1);this.location.detach();let n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){let n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new V(4013,!1);this._activatedRoute=n;let s=this.location,a=n.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,c=new ep(n,l,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:c,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Le({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Wn]});let i=e;return i})(),ep=class i{__ngOutletInjector(e){return new i(this.route,this.childContexts,e)}constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===yi?this.route:e===pc?this.childContexts:this.parent.get(e,t)}},up=new G("");function gk(i,e,t){let n=Ao(i,e._root,t?t._root:void 0);return new uc(n,e)}function Ao(i,e,t){if(t&&i.shouldReuseRoute(e.value,t.value.snapshot)){let n=t.value;n._futureSnapshot=e.value;let r=vk(i,e,t);return new Mt(n,r)}else{if(i.shouldAttach(e.value)){let s=i.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Ao(i,a)),o}}let n=yk(e.value),r=e.children.map(s=>Ao(i,s));return new Mt(n,r)}}function vk(i,e,t){return e.children.map(n=>{for(let r of t.children)if(i.shouldReuseRoute(n.value,r.value.snapshot))return Ao(i,n,r);return Ao(i,n)})}function yk(i){return new yi(new Qe(i.url),new Qe(i.params),new Qe(i.queryParams),new Qe(i.fragment),new Qe(i.data),i.outlet,i.component,i)}var q_="ngNavigationCancelingError";function K_(i,e){let{redirectTo:t,navigationBehaviorOptions:n}=as(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=Y_(!1,kt.Redirect);return r.url=t,r.navigationBehaviorOptions=n,r}function Y_(i,e){let t=new Error(`NavigationCancelingError: ${i||""}`);return t[q_]=!0,t.cancellationCode=e,t}function bk(i){return Q_(i)&&as(i.url)}function Q_(i){return!!i&&i[q_]}var _k=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=nn({type:e,selectors:[["ng-component"]],standalone:!0,features:[on],decls:1,vars:0,template:function(r,s){r&1&&Rt(0,"router-outlet")},dependencies:[mk],encapsulation:2});let i=e;return i})();function Ek(i,e){return i.providers&&!i._injector&&(i._injector=uf(i.providers,e,`Route: ${i.path}`)),i._injector??e}function dp(i){let e=i.children&&i.children.map(dp),t=e?Ie(N({},i),{children:e}):N({},i);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==he&&(t.component=_k),t}function Rn(i){return i.outlet||he}function Dk(i,e){let t=i.filter(n=>Rn(n)===e);return t.push(...i.filter(n=>Rn(n)!==e)),t}function ko(i){if(!i)return null;if(i.routeConfig?._injector)return i.routeConfig._injector;for(let e=i.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var wk=(i,e,t,n)=>pe(r=>(new tp(e,r.targetRouterState,r.currentRouterState,t,n).activate(i),r)),tp=class{constructor(e,t,n,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),kf(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){let r=is(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,r[o],n),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){let r=e.value,s=t?t.value:null;if(r===s)if(r.component){let o=n.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=is(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);if(n&&n.outlet){let o=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=is(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,t,n){let r=is(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],n),this.forwardEvent(new Yf(s.value.snapshot))}),e.children.length&&this.forwardEvent(new qf(e.value.snapshot))}activateRoutes(e,t,n){let r=e.value,s=t?t.value:null;if(kf(r),r===s)if(r.component){let o=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(r.component){let o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),kf(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=ko(r.snapshot);o.attachRef=null,o.route=r,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}},hc=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},ss=class{constructor(e,t){this.component=e,this.route=t}};function Sk(i,e,t){let n=i._root,r=e?e._root:null;return yo(n,r,t,[n.value])}function Tk(i){let e=i.routeConfig?i.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:i,guards:e}}function cs(i,e){let t=Symbol(),n=e.get(i,t);return n===t?typeof i=="function"&&!Gy(i)?i:e.get(i):n}function yo(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=is(e);return i.children.forEach(o=>{xk(o,s[o.value.outlet],t,n.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Do(a,t.getContext(o),r)),r}function xk(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=i.value,o=e?e.value:null,a=t?t.getContext(i.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let l=Ik(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new hc(n)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?yo(i,e,a?a.children:null,n,r):yo(i,e,t,n,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new ss(a.outlet.component,o))}else o&&Do(e,a,r),r.canActivateChecks.push(new hc(n)),s.component?yo(i,null,a?a.children:null,n,r):yo(i,null,t,n,r);return r}function Ik(i,e,t){if(typeof t=="function")return t(i,e);switch(t){case"pathParamsChange":return!Ji(i.url,e.url);case"pathParamsOrQueryParamsChange":return!Ji(i.url,e.url)||!An(i.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Jf(i,e)||!An(i.queryParams,e.queryParams);case"paramsChange":default:return!Jf(i,e)}}function Do(i,e,t){let n=is(i),r=i.value;Object.entries(n).forEach(([s,o])=>{r.component?e?Do(o,e.children.getContext(s),t):Do(o,null,t):Do(o,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new ss(e.outlet.component,r)):t.canDeactivateChecks.push(new ss(null,r)):t.canDeactivateChecks.push(new ss(null,r))}function Lo(i){return typeof i=="function"}function Ck(i){return typeof i=="boolean"}function Ak(i){return i&&Lo(i.canLoad)}function Rk(i){return i&&Lo(i.canActivate)}function Mk(i){return i&&Lo(i.canActivateChild)}function kk(i){return i&&Lo(i.canDeactivate)}function Lk(i){return i&&Lo(i.canMatch)}function X_(i){return i instanceof Un||i?.name==="EmptyError"}var tc=Symbol("INITIAL_VALUE");function ls(){return Ft(i=>Lr(i.map(e=>e.pipe(Pt(1),Pr(tc)))).pipe(pe(e=>{for(let t of e)if(t!==!0){if(t===tc)return tc;if(t===!1||t instanceof gi)return t}return!0}),Je(e=>e!==tc),Pt(1)))}function Ok(i,e){return He(t=>{let{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?ne(Ie(N({},t),{guardsResult:!0})):Nk(o,n,r,i).pipe(He(a=>a&&Ck(a)?Pk(n,s,i,e):ne(a)),pe(a=>Ie(N({},t),{guardsResult:a})))})}function Nk(i,e,t,n){return Be(i).pipe(He(r=>jk(r.component,r.route,t,e,n)),mn(r=>r!==!0,!0))}function Pk(i,e,t,n){return Be(e).pipe(Or(r=>ri(Bk(r.route.parent,n),Fk(r.route,n),Uk(i,r.path,t),Vk(i,r.route,t))),mn(r=>r!==!0,!0))}function Fk(i,e){return i!==null&&e&&e(new Kf(i)),ne(!0)}function Bk(i,e){return i!==null&&e&&e(new Wf(i)),ne(!0)}function Vk(i,e,t){let n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||n.length===0)return ne(!0);let r=n.map(s=>Wa(()=>{let o=ko(e)??t,a=cs(s,o),l=Rk(a)?a.canActivate(e,i):Gn(o,()=>a(e,i));return bi(l).pipe(mn())}));return ne(r).pipe(ls())}function Uk(i,e,t){let n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>Tk(o)).filter(o=>o!==null).map(o=>Wa(()=>{let a=o.guards.map(l=>{let c=ko(o.node)??t,u=cs(l,c),d=Mk(u)?u.canActivateChild(n,i):Gn(c,()=>u(n,i));return bi(d).pipe(mn())});return ne(a).pipe(ls())}));return ne(s).pipe(ls())}function jk(i,e,t,n,r){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return ne(!0);let o=s.map(a=>{let l=ko(e)??r,c=cs(a,l),u=kk(c)?c.canDeactivate(i,e,t,n):Gn(l,()=>c(i,e,t,n));return bi(u).pipe(mn())});return ne(o).pipe(ls())}function $k(i,e,t,n){let r=e.canLoad;if(r===void 0||r.length===0)return ne(!0);let s=r.map(o=>{let a=cs(o,i),l=Ak(a)?a.canLoad(e,t):Gn(i,()=>a(e,t));return bi(l)});return ne(s).pipe(ls(),Z_(n))}function Z_(i){return od(et(e=>{if(as(e))throw K_(i,e)}),pe(e=>e===!0))}function Hk(i,e,t,n){let r=e.canMatch;if(!r||r.length===0)return ne(!0);let s=r.map(o=>{let a=cs(o,i),l=Lk(a)?a.canMatch(e,t):Gn(i,()=>a(e,t));return bi(l)});return ne(s).pipe(ls(),Z_(n))}var Ro=class{constructor(e){this.segmentGroup=e||null}},fc=class extends Error{constructor(e){super(),this.urlTree=e}};function ns(i){return Mr(new Ro(i))}function Gk(i){return Mr(new V(4e3,!1))}function zk(i){return Mr(Y_(!1,kt.GuardRejected))}var np=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let n=[],r=t.root;for(;;){if(n=n.concat(r.segments),r.numberOfChildren===0)return ne(n);if(r.numberOfChildren>1||!r.children[he])return Gk(e.redirectTo);r=r.children[he]}}applyRedirectCommands(e,t,n){let r=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n);if(t.startsWith("/"))throw new fc(r);return r}applyRedirectCreateUrlTree(e,t,n,r){let s=this.createSegmentGroup(e,t.root,n,r);return new gi(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let n={};return Object.entries(e).forEach(([r,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);n[r]=t[a]}else n[r]=s}),n}createSegmentGroup(e,t,n,r){let s=this.createSegments(e,t.segments,n,r),o={};return Object.entries(t.children).forEach(([a,l])=>{o[a]=this.createSegmentGroup(e,l,n,r)}),new Te(s,o)}createSegments(e,t,n,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,n))}findPosParam(e,t,n){let r=n[t.path.substring(1)];if(!r)throw new V(4001,!1);return r}findOrReturn(e,t){let n=0;for(let r of t){if(r.path===e.path)return t.splice(n),r;n++}return e}},ip={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Wk(i,e,t,n,r){let s=hp(i,e,t);return s.matched?(n=Ek(e,n),Hk(n,e,t,r).pipe(pe(o=>o===!0?s:N({},ip)))):ne(s)}function hp(i,e,t){if(e.path==="**")return qk(t);if(e.path==="")return e.pathMatch==="full"&&(i.hasChildren()||t.length>0)?N({},ip):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||$M)(t,i,e);if(!r)return N({},ip);let s={};Object.entries(r.posParams??{}).forEach(([a,l])=>{s[a]=l.path});let o=r.consumed.length>0?N(N({},s),r.consumed[r.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function qk(i){return{matched:!0,parameters:i.length>0?M_(i).parameters:{},consumedSegments:i,remainingSegments:[],positionalParamSegments:{}}}function A_(i,e,t,n){return t.length>0&&Qk(i,t,n)?{segmentGroup:new Te(e,Yk(n,new Te(t,i.children))),slicedSegments:[]}:t.length===0&&Xk(i,t,n)?{segmentGroup:new Te(i.segments,Kk(i,t,n,i.children)),slicedSegments:t}:{segmentGroup:new Te(i.segments,i.children),slicedSegments:t}}function Kk(i,e,t,n){let r={};for(let s of t)if(mc(i,e,s)&&!n[Rn(s)]){let o=new Te([],{});r[Rn(s)]=o}return N(N({},n),r)}function Yk(i,e){let t={};t[he]=e;for(let n of i)if(n.path===""&&Rn(n)!==he){let r=new Te([],{});t[Rn(n)]=r}return t}function Qk(i,e,t){return t.some(n=>mc(i,e,n)&&Rn(n)!==he)}function Xk(i,e,t){return t.some(n=>mc(i,e,n))}function mc(i,e,t){return(i.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function Zk(i,e,t,n){return Rn(i)!==n&&(n===he||!mc(e,t,i))?!1:hp(e,i,t).matched}function Jk(i,e,t){return e.length===0&&!i.children[t]}var rp=class{};function eL(i,e,t,n,r,s,o="emptyOnly"){return new sp(i,e,t,n,r,o,s).recognize()}var tL=31,sp=class{constructor(e,t,n,r,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=n,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new np(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new V(4002,`'${e.segmentGroup}'`)}recognize(){let e=A_(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(pe(t=>{let n=new Co([],Object.freeze({}),Object.freeze(N({},this.urlTree.queryParams)),this.urlTree.fragment,{},he,this.rootComponentType,null,{}),r=new Mt(n,t),s=new dc("",r),o=ak(n,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,he).pipe(si(n=>{if(n instanceof fc)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof Ro?this.noMatchError(n):n}))}inheritParamsAndData(e,t){let n=e.value,r=lp(n,t,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(s=>this.inheritParamsAndData(s,n))}processSegmentGroup(e,t,n,r){return n.segments.length===0&&n.hasChildren()?this.processChildren(e,t,n):this.processSegment(e,t,n,n.segments,r,!0).pipe(pe(s=>s instanceof Mt?[s]:[]))}processChildren(e,t,n){let r=[];for(let s of Object.keys(n.children))s==="primary"?r.unshift(s):r.push(s);return Be(r).pipe(Or(s=>{let o=n.children[s],a=Dk(t,s);return this.processSegmentGroup(e,a,o,s)}),gd((s,o)=>(s.push(...o),s)),oi(null),md(),He(s=>{if(s===null)return ns(n);let o=J_(s);return nL(o),ne(o)}))}processSegment(e,t,n,r,s,o){return Be(t).pipe(Or(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,n,r,s,o).pipe(si(l=>{if(l instanceof Ro)return ne(null);throw l}))),mn(a=>!!a),si(a=>{if(X_(a))return Jk(n,r,s)?ne(new rp):ns(n);throw a}))}processSegmentAgainstRoute(e,t,n,r,s,o,a){return Zk(n,r,s,o)?n.redirectTo===void 0?this.matchSegmentAgainstRoute(e,r,n,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,n,s,o):ns(r):ns(r)}expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o){let{matched:a,consumedSegments:l,positionalParamSegments:c,remainingSegments:u}=hp(t,r,s);if(!a)return ns(t);r.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>tL&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(l,r.redirectTo,c);return this.applyRedirects.lineralizeSegments(r,d).pipe(He(h=>this.processSegment(e,n,t,h.concat(u),o,!1)))}matchSegmentAgainstRoute(e,t,n,r,s){let o=Wk(t,n,r,e,this.urlSerializer);return n.path==="**"&&(t.children={}),o.pipe(Ft(a=>a.matched?(e=n._injector??e,this.getChildConfig(e,n,r).pipe(Ft(({routes:l})=>{let c=n._loadedInjector??e,{consumedSegments:u,remainingSegments:d,parameters:h}=a,f=new Co(u,h,Object.freeze(N({},this.urlTree.queryParams)),this.urlTree.fragment,rL(n),Rn(n),n.component??n._loadedComponent??null,n,sL(n)),{segmentGroup:p,slicedSegments:m}=A_(t,u,d,l);if(m.length===0&&p.hasChildren())return this.processChildren(c,l,p).pipe(pe(y=>y===null?null:new Mt(f,y)));if(l.length===0&&m.length===0)return ne(new Mt(f,[]));let g=Rn(n)===s;return this.processSegment(c,l,p,m,g?he:s,!0).pipe(pe(y=>new Mt(f,y instanceof Mt?[y]:[])))}))):ns(t)))}getChildConfig(e,t,n){return t.children?ne({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?ne({routes:t._loadedRoutes,injector:t._loadedInjector}):$k(e,t,n,this.urlSerializer).pipe(He(r=>r?this.configLoader.loadChildren(e,t).pipe(et(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):zk(t))):ne({routes:[],injector:e})}};function nL(i){i.sort((e,t)=>e.value.outlet===he?-1:t.value.outlet===he?1:e.value.outlet.localeCompare(t.value.outlet))}function iL(i){let e=i.value.routeConfig;return e&&e.path===""}function J_(i){let e=[],t=new Set;for(let n of i){if(!iL(n)){e.push(n);continue}let r=e.find(s=>n.value.routeConfig===s.value.routeConfig);r!==void 0?(r.children.push(...n.children),t.add(r)):e.push(n)}for(let n of t){let r=J_(n.children);e.push(new Mt(n.value,r))}return e.filter(n=>!t.has(n))}function rL(i){return i.data||{}}function sL(i){return i.resolve||{}}function oL(i,e,t,n,r,s){return He(o=>eL(i,e,t,n,o.extractedUrl,r,s).pipe(pe(({state:a,tree:l})=>Ie(N({},o),{targetSnapshot:a,urlAfterRedirects:l}))))}function aL(i,e){return He(t=>{let{targetSnapshot:n,guards:{canActivateChecks:r}}=t;if(!r.length)return ne(t);let s=new Set(r.map(l=>l.route)),o=new Set;for(let l of s)if(!o.has(l))for(let c of eE(l))o.add(c);let a=0;return Be(o).pipe(Or(l=>s.has(l)?lL(l,n,i,e):(l.data=lp(l,l.parent,i).resolve,ne(void 0))),et(()=>a++),Nr(1),He(l=>a===o.size?ne(t):ht))})}function eE(i){let e=i.children.map(t=>eE(t)).flat();return[i,...e]}function lL(i,e,t,n){let r=i.routeConfig,s=i._resolve;return r?.title!==void 0&&!W_(r)&&(s[Mo]=r.title),cL(s,i,e,n).pipe(pe(o=>(i._resolvedData=o,i.data=lp(i,i.parent,t).resolve,null)))}function cL(i,e,t,n){let r=Nf(i);if(r.length===0)return ne({});let s={};return Be(r).pipe(He(o=>uL(i[o],e,t,n).pipe(mn(),et(a=>{s[o]=a}))),Nr(1),pd(s),si(o=>X_(o)?ht:Mr(o)))}function uL(i,e,t,n){let r=ko(e)??n,s=cs(i,r),o=s.resolve?s.resolve(e,t):Gn(r,()=>s(e,t));return bi(o)}function Lf(i){return Ft(e=>{let t=i(e);return t?Be(t).pipe(pe(()=>e)):ne(e)})}var tE=(()=>{let e=class e{buildTitle(n){let r,s=n.root;for(;s!==void 0;)r=this.getResolvedTitleForRoute(s)??r,s=s.children.find(o=>o.outlet===he);return r}getResolvedTitleForRoute(n){return n.data[Mo]}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:()=>L(dL),providedIn:"root"});let i=e;return i})(),dL=(()=>{let e=class e extends tE{constructor(n){super(),this.title=n}updateTitle(n){let r=this.buildTitle(n);r!==void 0&&this.title.setTitle(r)}};e.\u0275fac=function(r){return new(r||e)(C(S_))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),fp=new G("",{providedIn:"root",factory:()=>({})}),pp=new G(""),hL=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=L(yf)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return ne(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);let r=bi(n.loadComponent()).pipe(pe(nE),et(o=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=o}),js(()=>{this.componentLoaders.delete(n)})),s=new Cr(r,()=>new fe).pipe(Ir());return this.componentLoaders.set(n,s),s}loadChildren(n,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return ne({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=fL(r,this.compiler,n,this.onLoadEndListener).pipe(js(()=>{this.childrenLoaders.delete(r)})),a=new Cr(o,()=>new fe).pipe(Ir());return this.childrenLoaders.set(r,a),a}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function fL(i,e,t,n){return bi(i.loadChildren()).pipe(pe(nE),He(r=>r instanceof Js||Array.isArray(r)?ne(r):Be(e.compileModuleAsync(r))),pe(r=>{n&&n(i);let s,o,a=!1;return Array.isArray(r)?(o=r,a=!0):(s=r.create(t).injector,o=s.get(pp,[],{optional:!0,self:!0}).flat()),{routes:o.map(dp),injector:s}}))}function pL(i){return i&&typeof i=="object"&&"default"in i}function nE(i){return pL(i)?i.default:i}var mp=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:()=>L(mL),providedIn:"root"});let i=e;return i})(),mL=(()=>{let e=class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,r){return n}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),gL=new G("");var vL=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new fe,this.transitionAbortSubject=new fe,this.configLoader=L(hL),this.environmentInjector=L(Et),this.urlSerializer=L(ap),this.rootContexts=L(pc),this.location=L(Xi),this.inputBindingEnabled=L(up,{optional:!0})!==null,this.titleStrategy=L(tE),this.options=L(fp,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=L(mp),this.createViewTransition=L(gL,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>ne(void 0),this.rootComponentType=null;let n=s=>this.events.next(new Gf(s)),r=s=>this.events.next(new zf(s));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=n}complete(){this.transitions?.complete()}handleNavigationRequest(n){let r=++this.navigationId;this.transitions?.next(Ie(N(N({},this.transitions.value),n),{id:r}))}setupNavigations(n,r,s){return this.transitions=new Qe({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Eo,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Je(o=>o.id!==0),pe(o=>Ie(N({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Ft(o=>{let a=!1,l=!1;return ne(o).pipe(Ft(c=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",kt.SupersededByNewNavigation),ht;this.currentTransition=o,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?Ie(N({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let u=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=c.extras.onSameUrlNavigation??n.onSameUrlNavigation;if(!u&&d!=="reload"){let h="";return this.events.next(new tr(c.id,this.urlSerializer.serialize(c.rawUrl),h,Vf.IgnoredSameUrlNavigation)),c.resolve(null),ht}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return ne(c).pipe(Ft(h=>{let f=this.transitions?.getValue();return this.events.next(new So(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?ht:Promise.resolve(h)}),oL(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),et(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=Ie(N({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new lc(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:m,extras:g}=c,y=new So(h,this.urlSerializer.serialize(f),p,m);this.events.next(y);let _=G_(this.rootComponentType).snapshot;return this.currentTransition=o=Ie(N({},c),{targetSnapshot:_,urlAfterRedirects:f,extras:Ie(N({},g),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,ne(o)}else{let h="";return this.events.next(new tr(c.id,this.urlSerializer.serialize(c.extractedUrl),h,Vf.IgnoredByUrlHandlingStrategy)),c.resolve(null),ht}}),et(c=>{let u=new Uf(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}),pe(c=>(this.currentTransition=o=Ie(N({},c),{guards:Sk(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),Ok(this.environmentInjector,c=>this.events.next(c)),et(c=>{if(o.guardsResult=c.guardsResult,as(c.guardsResult))throw K_(this.urlSerializer,c.guardsResult);let u=new jf(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(u)}),Je(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",kt.GuardRejected),!1)),Lf(c=>{if(c.guards.canActivateChecks.length)return ne(c).pipe(et(u=>{let d=new $f(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}),Ft(u=>{let d=!1;return ne(u).pipe(aL(this.paramsInheritanceStrategy,this.environmentInjector),et({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(u,"",kt.NoDataFromResolver)}}))}),et(u=>{let d=new Hf(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}))}),Lf(c=>{let u=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(et(f=>{d.component=f}),pe(()=>{})));for(let f of d.children)h.push(...u(f));return h};return Lr(u(c.targetSnapshot.root)).pipe(oi(null),Pt(1))}),Lf(()=>this.afterPreactivation()),Ft(()=>{let{currentSnapshot:c,targetSnapshot:u}=o,d=this.createViewTransition?.(this.environmentInjector,c.root,u.root);return d?Be(d).pipe(pe(()=>o)):ne(o)}),pe(c=>{let u=gk(n.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=Ie(N({},c),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,o}),et(()=>{this.events.next(new xo)}),wk(this.rootContexts,n.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Pt(1),et({next:c=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new er(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{a=!0}}),yt(this.transitionAbortSubject.pipe(et(c=>{throw c}))),js(()=>{!a&&!l&&this.cancelNavigationTransition(o,"",kt.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),si(c=>{if(l=!0,Q_(c))this.events.next(new vi(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),bk(c)?this.events.next(new Io(c.url)):o.resolve(!1);else{this.events.next(new To(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0));try{o.resolve(n.errorHandler(c))}catch(u){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(u)}}return ht}))}))}cancelNavigationTransition(n,r,s){let o=new vi(n.id,this.urlSerializer.serialize(n.extractedUrl),r,s);this.events.next(o),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function yL(i){return i!==Eo}var bL=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:()=>L(_L),providedIn:"root"});let i=e;return i})(),op=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},_L=(()=>{let e=class e extends op{};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=Xr(e)))(s||e)}})(),e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),iE=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:()=>L(EL),providedIn:"root"});let i=e;return i})(),EL=(()=>{let e=class e extends iE{constructor(){super(...arguments),this.location=L(Xi),this.urlSerializer=L(ap),this.options=L(fp,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=L(mp),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new gi,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=G_(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(r=>{r.type==="popstate"&&n(r.url,r.state)})}handleRouterEvent(n,r){if(n instanceof So)this.stateMemento=this.createStateMemento();else if(n instanceof tr)this.rawUrlTree=r.initialUrl;else if(n instanceof lc){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(s,r)}}else n instanceof xo?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r))):n instanceof vi&&(n.code===kt.GuardRejected||n.code===kt.NoDataFromResolver)?this.restoreHistory(r):n instanceof To?this.restoreHistory(r,!0):n instanceof er&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,r){let s=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(s)||r.extras.replaceUrl){let o=this.browserPageId,a=N(N({},r.extras.state),this.generateNgRouterState(r.id,o));this.location.replaceState(s,"",a)}else{let o=N(N({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(n,r=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===n.finalUrl&&o===0&&(this.resetState(n),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,r){return this.canceledNavigationResolution==="computed"?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=Xr(e)))(s||e)}})(),e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),bo=function(i){return i[i.COMPLETE=0]="COMPLETE",i[i.FAILED=1]="FAILED",i[i.REDIRECTING=2]="REDIRECTING",i}(bo||{});function DL(i,e){i.events.pipe(Je(t=>t instanceof er||t instanceof vi||t instanceof To||t instanceof tr),pe(t=>t instanceof er||t instanceof tr?bo.COMPLETE:(t instanceof vi?t.code===kt.Redirect||t.code===kt.SupersededByNewNavigation:!1)?bo.REDIRECTING:bo.FAILED),Je(t=>t!==bo.REDIRECTING),Pt(1)).subscribe(()=>{e()})}function wL(i){throw i}var SL={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},TL={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},gc=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=L(jl),this.stateManager=L(iE),this.options=L(fp,{optional:!0})||{},this.pendingTasks=L(Vl),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=L(vL),this.urlSerializer=L(ap),this.location=L(Xi),this.urlHandlingStrategy=L(mp),this._events=new fe,this.errorHandler=this.options.errorHandler||wL,this.navigated=!1,this.routeReuseStrategy=L(bL),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=L(pp,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!L(up,{optional:!0}),this.eventsSubscription=new ke,this.isNgZoneEnabled=L(W)instanceof W&&W.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let n=this.navigationTransitions.events.subscribe(r=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof vi&&r.code!==kt.Redirect&&r.code!==kt.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof er)this.navigated=!0;else if(r instanceof Io){let a=this.urlHandlingStrategy.merge(r.url,s.currentRawUrl),l={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||yL(s.source)};this.scheduleNavigation(a,Eo,null,l,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}IL(r)&&this._events.next(r)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Eo,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(n,"popstate",r)},0)})}navigateToSyncWithBrowser(n,r,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let c=N({},s);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let l=this.parseUrl(n);this.scheduleNavigation(l,r,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(dp),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,r={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:l,preserveFragment:c}=r,u=c?this.currentUrlTree.fragment:a,d=null;switch(l){case"merge":d=N(N({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=U_(f)}catch{(typeof n[0]!="string"||!n[0].startsWith("/"))&&(n=[]),h=this.currentUrlTree.root}return j_(h,n,d,u??null)}navigateByUrl(n,r={skipLocationChange:!1}){let s=as(n)?n:this.parseUrl(n),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,Eo,null,r)}navigate(n,r={skipLocationChange:!1}){return xL(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,r){let s;if(r===!0?s=N({},SL):r===!1?s=N({},TL):s=r,as(n))return T_(this.currentUrlTree,n,s);let o=this.parseUrl(n);return T_(this.currentUrlTree,o,s)}removeEmptyProps(n){return Object.entries(n).reduce((r,[s,o])=>(o!=null&&(r[s]=o),r),{})}scheduleNavigation(n,r,s,o,a){if(this.disposed)return Promise.resolve(!1);let l,c,u;a?(l=a.resolve,c=a.reject,u=a.promise):u=new Promise((h,f)=>{l=h,c=f});let d=this.pendingTasks.add();return DL(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:o,resolve:l,reject:c,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(h=>Promise.reject(h))}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function xL(i){for(let e=0;e<i.length;e++)if(i[e]==null)throw new V(4008,!1)}function IL(i){return!(i instanceof xo)&&!(i instanceof Io)}var CL=new G("");function rE(i,...e){return Cl([{provide:pp,multi:!0,useValue:i},[],{provide:yi,useFactory:AL,deps:[gc]},{provide:vf,multi:!0,useFactory:RL},e.map(t=>t.\u0275providers)])}function AL(i){return i.routerState.root}function RL(){let i=L(qe);return e=>{let t=i.get(mi);if(e!==t.components[0])return;let n=i.get(gc),r=i.get(ML);i.get(kL)===1&&n.initialNavigation(),i.get(LL,null,ge.Optional)?.setUpPreloading(),i.get(CL,null,ge.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var ML=new G("",{factory:()=>new fe}),kL=new G("",{providedIn:"root",factory:()=>1});var LL=new G("");var sE=[];var Ap={};Rv(Ap,{Manager:()=>sr,Socket:()=>ir,connect:()=>or,default:()=>or,io:()=>or,protocol:()=>Ip});var ln=Object.create(null);ln.open="0";ln.close="1";ln.ping="2";ln.pong="3";ln.message="4";ln.upgrade="5";ln.noop="6";var Oo=Object.create(null);Object.keys(ln).forEach(i=>{Oo[ln[i]]=i});var No={type:"error",data:"parser error"};var lE=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",cE=typeof ArrayBuffer=="function",uE=i=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(i):i&&i.buffer instanceof ArrayBuffer,Po=({type:i,data:e},t,n)=>lE&&e instanceof Blob?t?n(e):oE(e,n):cE&&(e instanceof ArrayBuffer||uE(e))?t?n(e):oE(new Blob([e]),n):n(ln[i]+(e||"")),oE=(i,e)=>{let t=new FileReader;return t.onload=function(){let n=t.result.split(",")[1];e("b"+(n||""))},t.readAsDataURL(i)};function aE(i){return i instanceof Uint8Array?i:i instanceof ArrayBuffer?new Uint8Array(i):new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}var gp;function dE(i,e){if(lE&&i.data instanceof Blob)return i.data.arrayBuffer().then(aE).then(e);if(cE&&(i.data instanceof ArrayBuffer||uE(i.data)))return e(aE(i.data));Po(i,!1,t=>{gp||(gp=new TextEncoder),e(gp.encode(t))})}var hE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Fo=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let i=0;i<hE.length;i++)Fo[hE.charCodeAt(i)]=i;var fE=i=>{let e=i.length*.75,t=i.length,n,r=0,s,o,a,l;i[i.length-1]==="="&&(e--,i[i.length-2]==="="&&e--);let c=new ArrayBuffer(e),u=new Uint8Array(c);for(n=0;n<t;n+=4)s=Fo[i.charCodeAt(n)],o=Fo[i.charCodeAt(n+1)],a=Fo[i.charCodeAt(n+2)],l=Fo[i.charCodeAt(n+3)],u[r++]=s<<2|o>>4,u[r++]=(o&15)<<4|a>>2,u[r++]=(a&3)<<6|l&63;return c};var OL=typeof ArrayBuffer=="function",Bo=(i,e)=>{if(typeof i!="string")return{type:"message",data:pE(i,e)};let t=i.charAt(0);return t==="b"?{type:"message",data:NL(i.substring(1),e)}:Oo[t]?i.length>1?{type:Oo[t],data:i.substring(1)}:{type:Oo[t]}:No},NL=(i,e)=>{if(OL){let t=fE(i);return pE(t,e)}else return{base64:!0,data:i}},pE=(i,e)=>{switch(e){case"blob":return i instanceof Blob?i:new Blob([i]);case"arraybuffer":default:return i instanceof ArrayBuffer?i:i.buffer}};var mE="",gE=(i,e)=>{let t=i.length,n=new Array(t),r=0;i.forEach((s,o)=>{Po(s,!1,a=>{n[o]=a,++r===t&&e(n.join(mE))})})},vE=(i,e)=>{let t=i.split(mE),n=[];for(let r=0;r<t.length;r++){let s=Bo(t[r],e);if(n.push(s),s.type==="error")break}return n};function yE(){return new TransformStream({transform(i,e){dE(i,t=>{let n=t.length,r;if(n<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,n);else if(n<65536){r=new Uint8Array(3);let s=new DataView(r.buffer);s.setUint8(0,126),s.setUint16(1,n)}else{r=new Uint8Array(9);let s=new DataView(r.buffer);s.setUint8(0,127),s.setBigUint64(1,BigInt(n))}i.data&&typeof i.data!="string"&&(r[0]|=128),e.enqueue(r),e.enqueue(t)})}})}var vp;function vc(i){return i.reduce((e,t)=>e+t.length,0)}function yc(i,e){if(i[0].length===e)return i.shift();let t=new Uint8Array(e),n=0;for(let r=0;r<e;r++)t[r]=i[0][n++],n===i[0].length&&(i.shift(),n=0);return i.length&&n<i[0].length&&(i[0]=i[0].slice(n)),t}function bE(i,e){vp||(vp=new TextDecoder);let t=[],n=0,r=-1,s=!1;return new TransformStream({transform(o,a){for(t.push(o);;){if(n===0){if(vc(t)<1)break;let l=yc(t,1);s=(l[0]&128)===128,r=l[0]&127,r<126?n=3:r===126?n=1:n=2}else if(n===1){if(vc(t)<2)break;let l=yc(t,2);r=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),n=3}else if(n===2){if(vc(t)<8)break;let l=yc(t,8),c=new DataView(l.buffer,l.byteOffset,l.length),u=c.getUint32(0);if(u>Math.pow(2,21)-1){a.enqueue(No);break}r=u*Math.pow(2,32)+c.getUint32(4),n=3}else{if(vc(t)<r)break;let l=yc(t,r);a.enqueue(Bo(s?l:vp.decode(l),e)),n=0}if(r===0||r>i){a.enqueue(No);break}}}})}var yp=4;function Oe(i){if(i)return PL(i)}function PL(i){for(var e in Oe.prototype)i[e]=Oe.prototype[e];return i}Oe.prototype.on=Oe.prototype.addEventListener=function(i,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+i]=this._callbacks["$"+i]||[]).push(e),this};Oe.prototype.once=function(i,e){function t(){this.off(i,t),e.apply(this,arguments)}return t.fn=e,this.on(i,t),this};Oe.prototype.off=Oe.prototype.removeListener=Oe.prototype.removeAllListeners=Oe.prototype.removeEventListener=function(i,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+i];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+i],this;for(var n,r=0;r<t.length;r++)if(n=t[r],n===e||n.fn===e){t.splice(r,1);break}return t.length===0&&delete this._callbacks["$"+i],this};Oe.prototype.emit=function(i){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+i],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(t){t=t.slice(0);for(var n=0,r=t.length;n<r;++n)t[n].apply(this,e)}return this};Oe.prototype.emitReserved=Oe.prototype.emit;Oe.prototype.listeners=function(i){return this._callbacks=this._callbacks||{},this._callbacks["$"+i]||[]};Oe.prototype.hasListeners=function(i){return!!this.listeners(i).length};var ut=typeof self<"u"?self:typeof window<"u"?window:Function("return this")();function bc(i,...e){return e.reduce((t,n)=>(i.hasOwnProperty(n)&&(t[n]=i[n]),t),{})}var FL=ut.setTimeout,BL=ut.clearTimeout;function Xn(i,e){e.useNativeTimers?(i.setTimeoutFn=FL.bind(ut),i.clearTimeoutFn=BL.bind(ut)):(i.setTimeoutFn=ut.setTimeout.bind(ut),i.clearTimeoutFn=ut.clearTimeout.bind(ut))}var VL=1.33;function _E(i){return typeof i=="string"?UL(i):Math.ceil((i.byteLength||i.size)*VL)}function UL(i){let e=0,t=0;for(let n=0,r=i.length;n<r;n++)e=i.charCodeAt(n),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(n++,t+=4);return t}function EE(i){let e="";for(let t in i)i.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(i[t]));return e}function DE(i){let e={},t=i.split("&");for(let n=0,r=t.length;n<r;n++){let s=t[n].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}var _c=class extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}},Zn=class extends Oe{constructor(e){super(),this.writable=!1,Xn(this,e),this.opts=e,this.query=e.query,this.socket=e.socket}onError(e,t,n){return super.emitReserved("error",new _c(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){let t=Bo(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){let e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){let t=EE(e);return t.length?"?"+t:""}};var xE="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),bp=64,jL={},wE=0,Ec=0,SE;function TE(i){let e="";do e=xE[i%bp]+e,i=Math.floor(i/bp);while(i>0);return e}function Dc(){let i=TE(+new Date);return i!==SE?(wE=0,SE=i):i+"."+TE(wE++)}for(;Ec<bp;Ec++)jL[xE[Ec]]=Ec;var IE=!1;try{IE=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}var CE=IE;function _p(i){let e=i.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||CE))return new XMLHttpRequest}catch{}if(!e)try{return new ut[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function $L(){}var HL=function(){return new _p({xdomain:!1}).responseType!=null}(),Sc=class extends Zn{constructor(e){if(super(e),this.polling=!1,typeof location<"u"){let n=location.protocol==="https:",r=location.port;r||(r=n?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||r!==e.port}let t=e&&e.forceBase64;this.supportsBinary=HL&&!t,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";let t=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let n=0;this.polling&&(n++,this.once("pollComplete",function(){--n||t()})),this.writable||(n++,this.once("drain",function(){--n||t()}))}else t()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){let t=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};vE(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){let e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,gE(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Dc()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}request(e={}){return Object.assign(e,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new wc(this.uri(),e)}doWrite(e,t){let n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(r,s)=>{this.onError("xhr post error",r,s)})}doPoll(){let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,n)=>{this.onError("xhr poll error",t,n)}),this.pollXhr=e}},wc=(()=>{class i extends Oe{constructor(t,n){super(),Xn(this,n),this.opts=n,this.method=n.method||"GET",this.uri=t,this.data=n.data!==void 0?n.data:null,this.create()}create(){var t;let n=bc(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this.opts.xd;let r=this.xhr=new _p(n);try{r.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let s in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(s)&&r.setRequestHeader(s,this.opts.extraHeaders[s])}}catch{}if(this.method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(t=this.opts.cookieJar)===null||t===void 0||t.addCookies(r),"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),r.onreadystatechange=()=>{var s;r.readyState===3&&((s=this.opts.cookieJar)===null||s===void 0||s.parseCookies(r)),r.readyState===4&&(r.status===200||r.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof r.status=="number"?r.status:0)},0))},r.send(this.data)}catch(s){this.setTimeoutFn(()=>{this.onError(s)},0);return}typeof document<"u"&&(this.index=i.requestsCount++,i.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(!0)}cleanup(t){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=$L,t)try{this.xhr.abort()}catch{}typeof document<"u"&&delete i.requests[this.index],this.xhr=null}}onLoad(){let t=this.xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}return i.requestsCount=0,i.requests={},i})();if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",AE);else if(typeof addEventListener=="function"){let i="onpagehide"in ut?"pagehide":"unload";addEventListener(i,AE,!1)}}function AE(){for(let i in wc.requests)wc.requests.hasOwnProperty(i)&&wc.requests[i].abort()}var nr=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),Vo=ut.WebSocket||ut.MozWebSocket,Tc=!0,RE="arraybuffer";var ME=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",xc=class extends Zn{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let e=this.uri(),t=this.opts.protocols,n=ME?{}:bc(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=Tc&&!ME?t?new Vo(e,t):new Vo(e):new Vo(e,t,n)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let n=e[t],r=t===e.length-1;Po(n,this.supportsBinary,s=>{let o={};Tc||(n.options&&(o.compress=n.options.compress),this.opts.perMessageDeflate&&(typeof s=="string"?Buffer.byteLength(s):s.length)<this.opts.perMessageDeflate.threshold&&(o.compress=!1));try{Tc?this.ws.send(s):this.ws.send(s,o)}catch{}r&&nr(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Dc()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}check(){return!!Vo}};var Ic=class extends Zn{get name(){return"webtransport"}doOpen(){typeof WebTransport=="function"&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(e=>{let t=bE(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),r=yE();r.readable.pipeTo(e.writable),this.writer=r.writable.getWriter();let s=()=>{n.read().then(({done:a,value:l})=>{a||(this.onPacket(l),s())}).catch(a=>{})};s();let o={type:"open"};this.query.sid&&(o.data=`{"sid":"${this.query.sid}"}`),this.writer.write(o).then(()=>this.onOpen())})}))}write(e){this.writable=!1;for(let t=0;t<e.length;t++){let n=e[t],r=t===e.length-1;this.writer.write(n).then(()=>{r&&nr(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this.transport)===null||e===void 0||e.close()}};var Ep={websocket:xc,webtransport:Ic,polling:Sc};var GL=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,zL=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function us(i){if(i.length>2e3)throw"URI too long";let e=i,t=i.indexOf("["),n=i.indexOf("]");t!=-1&&n!=-1&&(i=i.substring(0,t)+i.substring(t,n).replace(/:/g,";")+i.substring(n,i.length));let r=GL.exec(i||""),s={},o=14;for(;o--;)s[zL[o]]=r[o]||"";return t!=-1&&n!=-1&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=WL(s,s.path),s.queryKey=qL(s,s.query),s}function WL(i,e){let t=/\/{2,9}/g,n=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function qL(i,e){let t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,r,s){r&&(t[r]=s)}),t}var Cc=(()=>{class i extends Oe{constructor(t,n={}){super(),this.binaryType=RE,this.writeBuffer=[],t&&typeof t=="object"&&(n=t,t=null),t?(t=us(t),n.hostname=t.host,n.secure=t.protocol==="https"||t.protocol==="wss",n.port=t.port,t.query&&(n.query=t.query)):n.host&&(n.hostname=us(n.host).host),Xn(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=n.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=DE(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){let n=Object.assign({},this.opts.query);n.EIO=yp,n.transport=t,this.id&&(n.sid=this.id);let r=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new Ep[t](r)}open(){let t;if(this.opts.rememberUpgrade&&i.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)t="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else t=this.transports[0];this.readyState="opening";try{t=this.createTransport(t)}catch{this.transports.shift(),this.open();return}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",n=>this.onClose("transport close",n))}probe(t){let n=this.createTransport(t),r=!1;i.priorWebsocketSuccess=!1;let s=()=>{r||(n.send([{type:"ping",data:"probe"}]),n.once("packet",h=>{if(!r)if(h.type==="pong"&&h.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;i.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(d(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{let f=new Error("probe error");f.transport=n.name,this.emitReserved("upgradeError",f)}}))};function o(){r||(r=!0,d(),n.close(),n=null)}let a=h=>{let f=new Error("probe error: "+h);f.transport=n.name,o(),this.emitReserved("upgradeError",f)};function l(){a("transport closed")}function c(){a("socket closed")}function u(h){n&&h.name!==n.name&&o()}let d=()=>{n.removeListener("open",s),n.removeListener("error",a),n.removeListener("close",l),this.off("close",c),this.off("upgrading",u)};n.once("open",s),n.once("error",a),n.once("close",l),this.once("close",c),this.once("upgrading",u),this.upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{r||n.open()},200):n.open()}onOpen(){if(this.readyState="open",i.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let t=0,n=this.upgrades.length;for(;t<n;t++)this.probe(this.upgrades[t])}}onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),this.resetPingTimeout(),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":let n=new Error("server error");n.code=t.data,this.onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let t=this.getWritablePackets();this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let r=0;r<this.writeBuffer.length;r++){let s=this.writeBuffer[r].data;if(s&&(n+=_E(s)),r>0&&n>this.maxPayload)return this.writeBuffer.slice(0,r);n+=2}return this.writeBuffer}write(t,n,r){return this.sendPacket("message",t,n,r),this}send(t,n,r){return this.sendPacket("message",t,n,r),this}sendPacket(t,n,r,s){if(typeof n=="function"&&(s=n,n=void 0),typeof r=="function"&&(s=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;let o={type:t,data:n,options:r};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),s&&this.once("flush",s),this.flush()}close(){let t=()=>{this.onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),t()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():t()}):this.upgrading?r():t()),this}onError(t){i.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,n){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){let n=[],r=0,s=t.length;for(;r<s;r++)~this.transports.indexOf(t[r])&&n.push(t[r]);return n}}return i.protocol=yp,i})();var Iz=Cc.protocol;function kE(i,e="",t){let n=i;t=t||typeof location<"u"&&location,i==null&&(i=t.protocol+"//"+t.host),typeof i=="string"&&(i.charAt(0)==="/"&&(i.charAt(1)==="/"?i=t.protocol+i:i=t.host+i),/^(https?|wss?):\/\//.test(i)||(typeof t<"u"?i=t.protocol+"//"+i:i="https://"+i),n=us(i)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";let s=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port+e,n.href=n.protocol+"://"+s+(t&&t.port===n.port?"":":"+n.port),n}var Cp={};Rv(Cp,{Decoder:()=>Tp,Encoder:()=>Sp,PacketType:()=>be,protocol:()=>Ip});var KL=typeof ArrayBuffer=="function",YL=i=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(i):i.buffer instanceof ArrayBuffer,LE=Object.prototype.toString,QL=typeof Blob=="function"||typeof Blob<"u"&&LE.call(Blob)==="[object BlobConstructor]",XL=typeof File=="function"||typeof File<"u"&&LE.call(File)==="[object FileConstructor]";function jo(i){return KL&&(i instanceof ArrayBuffer||YL(i))||QL&&i instanceof Blob||XL&&i instanceof File}function Uo(i,e){if(!i||typeof i!="object")return!1;if(Array.isArray(i)){for(let t=0,n=i.length;t<n;t++)if(Uo(i[t]))return!0;return!1}if(jo(i))return!0;if(i.toJSON&&typeof i.toJSON=="function"&&arguments.length===1)return Uo(i.toJSON(),!0);for(let t in i)if(Object.prototype.hasOwnProperty.call(i,t)&&Uo(i[t]))return!0;return!1}function OE(i){let e=[],t=i.data,n=i;return n.data=Dp(t,e),n.attachments=e.length,{packet:n,buffers:e}}function Dp(i,e){if(!i)return i;if(jo(i)){let t={_placeholder:!0,num:e.length};return e.push(i),t}else if(Array.isArray(i)){let t=new Array(i.length);for(let n=0;n<i.length;n++)t[n]=Dp(i[n],e);return t}else if(typeof i=="object"&&!(i instanceof Date)){let t={};for(let n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=Dp(i[n],e));return t}return i}function NE(i,e){return i.data=wp(i.data,e),delete i.attachments,i}function wp(i,e){if(!i)return i;if(i&&i._placeholder===!0){if(typeof i.num=="number"&&i.num>=0&&i.num<e.length)return e[i.num];throw new Error("illegal attachments")}else if(Array.isArray(i))for(let t=0;t<i.length;t++)i[t]=wp(i[t],e);else if(typeof i=="object")for(let t in i)Object.prototype.hasOwnProperty.call(i,t)&&(i[t]=wp(i[t],e));return i}var ZL=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Ip=5,be=function(i){return i[i.CONNECT=0]="CONNECT",i[i.DISCONNECT=1]="DISCONNECT",i[i.EVENT=2]="EVENT",i[i.ACK=3]="ACK",i[i.CONNECT_ERROR=4]="CONNECT_ERROR",i[i.BINARY_EVENT=5]="BINARY_EVENT",i[i.BINARY_ACK=6]="BINARY_ACK",i}(be||{}),Sp=class{constructor(e){this.replacer=e}encode(e){return(e.type===be.EVENT||e.type===be.ACK)&&Uo(e)?this.encodeAsBinary({type:e.type===be.EVENT?be.BINARY_EVENT:be.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===be.BINARY_EVENT||e.type===be.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){let t=OE(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}};function PE(i){return Object.prototype.toString.call(i)==="[object Object]"}var Tp=class i extends Oe{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);let n=t.type===be.BINARY_EVENT;n||t.type===be.BINARY_ACK?(t.type=n?be.EVENT:be.ACK,this.reconstructor=new xp(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(jo(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0,n={type:Number(e.charAt(0))};if(be[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===be.BINARY_EVENT||n.type===be.BINARY_ACK){let s=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);let o=e.substring(s,t);if(o!=Number(o)||e.charAt(t)!=="-")throw new Error("Illegal attachments");n.attachments=Number(o)}if(e.charAt(t+1)==="/"){let s=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););n.nsp=e.substring(s,t)}else n.nsp="/";let r=e.charAt(t+1);if(r!==""&&Number(r)==r){let s=t+1;for(;++t;){let o=e.charAt(t);if(o==null||Number(o)!=o){--t;break}if(t===e.length)break}n.id=Number(e.substring(s,t+1))}if(e.charAt(++t)){let s=this.tryParse(e.substr(t));if(i.isPayloadValid(n.type,s))n.data=s;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case be.CONNECT:return PE(t);case be.DISCONNECT:return t===void 0;case be.CONNECT_ERROR:return typeof t=="string"||PE(t);case be.EVENT:case be.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&ZL.indexOf(t[0])===-1);case be.ACK:case be.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}},xp=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let t=NE(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};function Lt(i,e,t){return i.on(e,t),function(){i.off(e,t)}}var JL=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),ir=class extends Oe{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let e=this.io;this.subs=[Lt(e,"open",this.onopen.bind(this)),Lt(e,"packet",this.onpacket.bind(this)),Lt(e,"error",this.onerror.bind(this)),Lt(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(JL.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;let n={type:be.EVENT,data:t};if(n.options={},n.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){let o=this.ids++,a=t.pop();this._registerAckCallback(o,a),n.id=o}let r=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!r||!this.connected)||(this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(e,t){var n;let r=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(r===void 0){this.acks[e]=t;return}let s=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===e&&this.sendBuffer.splice(a,1);t.call(this,new Error("operation has timed out"))},r),o=(...a)=>{this.io.clearTimeoutFn(s),t.apply(this,a)};o.withError=!0,this.acks[e]=o}emitWithAck(e,...t){return new Promise((n,r)=>{let s=(o,a)=>o?r(o):n(a);s.withError=!0,t.push(s),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());let n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((r,...s)=>n!==this._queue[0]?void 0:(r!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(r)):(this._queue.shift(),t&&t(null,...s)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;let t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:be.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){let n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case be.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case be.EVENT:case be.BINARY_EVENT:this.onevent(e);break;case be.ACK:case be.BINARY_ACK:this.onack(e);break;case be.DISCONNECT:this.ondisconnect();break;case be.CONNECT_ERROR:this.destroy();let n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){let t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let t=this._anyListeners.slice();for(let n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){let t=this,n=!1;return function(...r){n||(n=!0,t.packet({type:be.ACK,id:e,data:r}))}}onack(e){let t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:be.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){let t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let t=this._anyOutgoingListeners.slice();for(let n of t)n.apply(this,e.data)}}};function rr(i){i=i||{},this.ms=i.min||100,this.max=i.max||1e4,this.factor=i.factor||2,this.jitter=i.jitter>0&&i.jitter<=1?i.jitter:0,this.attempts=0}rr.prototype.duration=function(){var i=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*i);i=Math.floor(e*10)&1?i+t:i-t}return Math.min(i,this.max)|0};rr.prototype.reset=function(){this.attempts=0};rr.prototype.setMin=function(i){this.ms=i};rr.prototype.setMax=function(i){this.max=i};rr.prototype.setJitter=function(i){this.jitter=i};var sr=class extends Oe{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Xn(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((n=t.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new rr({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;let r=t.parser||Cp;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Cc(this.uri,this.opts);let t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;let r=Lt(t,"open",function(){n.onopen(),e&&e()}),s=a=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",a),e?e(a):this.maybeReconnectOnOpen()},o=Lt(t,"error",s);if(this._timeout!==!1){let a=this._timeout,l=this.setTimeoutFn(()=>{r(),s(new Error("timeout")),t.close()},a);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(r),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(Lt(e,"ping",this.onping.bind(this)),Lt(e,"data",this.ondata.bind(this)),Lt(e,"error",this.onerror.bind(this)),Lt(e,"close",this.onclose.bind(this)),Lt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){nr(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new ir(this,e,t),this.nsps[e]=n),n}_destroy(e){let t=Object.keys(this.nsps);for(let n of t)if(this.nsps[n].active)return;this._close()}_packet(e){let t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let t=this.backoff.duration();this._reconnecting=!0;let n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},t);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}};var $o={};function or(i,e){typeof i=="object"&&(e=i,i=void 0),e=e||{};let t=kE(i,e.path||"/socket.io"),n=t.source,r=t.id,s=t.path,o=$o[r]&&s in $o[r].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||o,l;return a?l=new sr(n,e):($o[r]||($o[r]=new sr(n,e)),l=$o[r]),t.query&&!e.query&&(e.query=t.queryKey),l.socket(t.path,e)}Object.assign(or,{Manager:sr,Socket:ir,io:or,connect:or});var Ac=class{config;subscribersCounter={};eventObservables$={};ioSocket;emptyConfig={url:"",options:{}};constructor(e){this.config=e,e===void 0&&(e=this.emptyConfig);let t=e.url,n=e.options,r=or?or:Ap;this.ioSocket=r(t,n)}of(e){this.ioSocket.of(e)}on(e,t){this.ioSocket.on(e,t)}once(e,t){this.ioSocket.once(e,t)}connect(e){return this.ioSocket.connect(e)}disconnect(e){return this.ioSocket.disconnect.apply(this.ioSocket,arguments)}emit(e,...t){return this.ioSocket.emit.apply(this.ioSocket,arguments)}removeListener(e,t){return this.ioSocket.removeListener.apply(this.ioSocket,arguments)}removeAllListeners(e){return this.ioSocket.removeAllListeners.apply(this.ioSocket,arguments)}fromEvent(e){return this.subscribersCounter[e]||(this.subscribersCounter[e]=0),this.subscribersCounter[e]++,this.eventObservables$[e]||(this.eventObservables$[e]=new re(t=>{let n=r=>{t.next(r)};return this.ioSocket.on(e,n),()=>{this.subscribersCounter[e]--,this.subscribersCounter[e]===0&&(this.ioSocket.removeListener(e,n),delete this.eventObservables$[e])}}).pipe(yd())),this.eventObservables$[e]}fromOneTimeEvent(e){return new Promise(t=>this.once(e,t))}listeners(e){return this.ioSocket.listeners(e)}listenersAny(){return this.ioSocket.listenersAny()}listenersAnyOutgoing(){return this.ioSocket.listenersAnyOutgoing()}off(e,t){return e?e&&!t?this.ioSocket.off(e):this.ioSocket.off(e,t):this.ioSocket.offAny()}onAny(e){return this.ioSocket.onAny(e)}onAnyOutgoing(e){return this.ioSocket.onAnyOutgoing(e)}prependAny(e){return this.ioSocket.prependAny(e)}prependAnyOutgoing(e){return this.ioSocket.prependAnyOutgoing(e)}timeout(e){return this.ioSocket.timeout(e)}volatile(){return this.ioSocket.volatile}};function eO(i){return new Ac(i)}var FE=new G("__SOCKET_IO_CONFIG__"),BE=(()=>{class i{static forRoot(t){return{ngModule:i,providers:[{provide:FE,useValue:t},{provide:Ac,useFactory:eO,deps:[FE]}]}}static \u0275fac=function(n){return new(n||i)};static \u0275mod=Ee({type:i});static \u0275inj=_e({})}return i})();var ce=function(i){return i[i.State=0]="State",i[i.Transition=1]="Transition",i[i.Sequence=2]="Sequence",i[i.Group=3]="Group",i[i.Animate=4]="Animate",i[i.Keyframes=5]="Keyframes",i[i.Style=6]="Style",i[i.Trigger=7]="Trigger",i[i.Reference=8]="Reference",i[i.AnimateChild=9]="AnimateChild",i[i.AnimateRef=10]="AnimateRef",i[i.Query=11]="Query",i[i.Stagger=12]="Stagger",i}(ce||{}),Mn="*";function VE(i,e){return{type:ce.Trigger,name:i,definitions:e,options:{}}}function Rp(i,e=null){return{type:ce.Animate,styles:e,timings:i}}function UE(i,e=null){return{type:ce.Sequence,steps:i,options:e}}function ar(i){return{type:ce.Style,styles:i,offset:null}}function Mp(i,e,t){return{type:ce.State,name:i,styles:e,options:t}}function kp(i,e,t=null){return{type:ce.Transition,expr:i,animation:e,options:t}}var _i=class{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){let t=e=="start"?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}},Ho=class{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,r=0,s=this.players.length;s==0?queueMicrotask(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++t==s&&this._onFinish()}),o.onDestroy(()=>{++n==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){let t=e*this.totalTime;this.players.forEach(n=>{let r=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(r)})}getPosition(){let e=this.players.reduce((t,n)=>t===null||n.totalTime>t.totalTime?n:t,null);return e!=null?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){let t=e=="start"?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}},Rc="!";function jE(i){return new V(3e3,!1)}function tO(){return new V(3100,!1)}function nO(){return new V(3101,!1)}function iO(i){return new V(3001,!1)}function rO(i){return new V(3003,!1)}function sO(i){return new V(3004,!1)}function oO(i,e){return new V(3005,!1)}function aO(){return new V(3006,!1)}function lO(){return new V(3007,!1)}function cO(i,e){return new V(3008,!1)}function uO(i){return new V(3002,!1)}function dO(i,e,t,n,r){return new V(3010,!1)}function hO(){return new V(3011,!1)}function fO(){return new V(3012,!1)}function pO(){return new V(3200,!1)}function mO(){return new V(3202,!1)}function gO(){return new V(3013,!1)}function vO(i){return new V(3014,!1)}function yO(i){return new V(3015,!1)}function bO(i){return new V(3016,!1)}function _O(i,e){return new V(3404,!1)}function EO(i){return new V(3502,!1)}function DO(i){return new V(3503,!1)}function wO(){return new V(3300,!1)}function SO(i){return new V(3504,!1)}function TO(i){return new V(3301,!1)}function xO(i,e){return new V(3302,!1)}function IO(i){return new V(3303,!1)}function CO(i,e){return new V(3400,!1)}function AO(i){return new V(3401,!1)}function RO(i){return new V(3402,!1)}function MO(i,e){return new V(3505,!1)}function Ei(i){switch(i.length){case 0:return new _i;case 1:return i[0];default:return new Ho(i)}}function tD(i,e,t=new Map,n=new Map){let r=[],s=[],o=-1,a=null;if(e.forEach(l=>{let c=l.get("offset"),u=c==o,d=u&&a||new Map;l.forEach((h,f)=>{let p=f,m=h;if(f!=="offset")switch(p=i.normalizePropertyName(p,r),m){case Rc:m=t.get(f);break;case Mn:m=n.get(f);break;default:m=i.normalizeStyleValue(f,p,m,r);break}d.set(p,m)}),u||s.push(d),a=d,o=c}),r.length)throw EO(r);return s}function tm(i,e,t,n){switch(e){case"start":i.onStart(()=>n(t&&Lp(t,"start",i)));break;case"done":i.onDone(()=>n(t&&Lp(t,"done",i)));break;case"destroy":i.onDestroy(()=>n(t&&Lp(t,"destroy",i)));break}}function Lp(i,e,t){let n=t.totalTime,r=!!t.disabled,s=nm(i.element,i.triggerName,i.fromState,i.toState,e||i.phaseName,n??i.totalTime,r),o=i._data;return o!=null&&(s._data=o),s}function nm(i,e,t,n,r="",s=0,o){return{element:i,triggerName:e,fromState:t,toState:n,phaseName:r,totalTime:s,disabled:!!o}}function Nt(i,e,t){let n=i.get(e);return n||i.set(e,n=t),n}function $E(i){let e=i.indexOf(":"),t=i.substring(1,e),n=i.slice(e+1);return[t,n]}var kO=typeof document>"u"?null:document.documentElement;function im(i){let e=i.parentNode||i.host||null;return e===kO?null:e}function LO(i){return i.substring(1,6)=="ebkit"}var lr=null,HE=!1;function OO(i){lr||(lr=NO()||{},HE=lr.style?"WebkitAppearance"in lr.style:!1);let e=!0;return lr.style&&!LO(i)&&(e=i in lr.style,!e&&HE&&(e="Webkit"+i.charAt(0).toUpperCase()+i.slice(1)in lr.style)),e}function NO(){return typeof document<"u"?document.body:null}function nD(i,e){for(;e;){if(e===i)return!0;e=im(e)}return!1}function iD(i,e,t){if(t)return Array.from(i.querySelectorAll(e));let n=i.querySelector(e);return n?[n]:[]}var rm=(()=>{let e=class e{validateStyleProperty(n){return OO(n)}matchesElement(n,r){return!1}containsElement(n,r){return nD(n,r)}getParentElement(n){return im(n)}query(n,r,s){return iD(n,r,s)}computeStyle(n,r,s){return s||""}animate(n,r,s,o,a,l=[],c){return new _i(s,o)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:e.\u0275fac});let i=e;return i})(),lm=class lm{};lm.NOOP=new rm;var dr=lm,hr=class{};var PO=1e3,rD="{{",FO="}}",sD="ng-enter",Vp="ng-leave",Mc="ng-trigger",Pc=".ng-trigger",GE="ng-animating",Up=".ng-animating";function Jn(i){if(typeof i=="number")return i;let e=i.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:jp(parseFloat(e[1]),e[2])}function jp(i,e){switch(e){case"s":return i*PO;default:return i}}function Fc(i,e,t){return i.hasOwnProperty("duration")?i:BO(i,e,t)}function BO(i,e,t){let n=/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i,r,s=0,o="";if(typeof i=="string"){let a=i.match(n);if(a===null)return e.push(jE(i)),{duration:0,delay:0,easing:""};r=jp(parseFloat(a[1]),a[2]);let l=a[3];l!=null&&(s=jp(parseFloat(l),a[4]));let c=a[5];c&&(o=c)}else r=i;if(!t){let a=!1,l=e.length;r<0&&(e.push(tO()),a=!0),s<0&&(e.push(nO()),a=!0),a&&e.splice(l,0,jE(i))}return{duration:r,delay:s,easing:o}}function VO(i){return i.length?i[0]instanceof Map?i:i.map(e=>new Map(Object.entries(e))):[]}function kn(i,e,t){e.forEach((n,r)=>{let s=sm(r);t&&!t.has(r)&&t.set(r,i.style[s]),i.style[s]=n})}function ur(i,e){e.forEach((t,n)=>{let r=sm(n);i.style[r]=""})}function Go(i){return Array.isArray(i)?i.length==1?i[0]:UE(i):i}function UO(i,e,t){let n=e.params||{},r=oD(i);r.length&&r.forEach(s=>{n.hasOwnProperty(s)||t.push(iO(s))})}var $p=new RegExp(`${rD}\\s*(.+?)\\s*${FO}`,"g");function oD(i){let e=[];if(typeof i=="string"){let t;for(;t=$p.exec(i);)e.push(t[1]);$p.lastIndex=0}return e}function Wo(i,e,t){let n=`${i}`,r=n.replace($p,(s,o)=>{let a=e[o];return a==null&&(t.push(rO(o)),a=""),a.toString()});return r==n?i:r}var jO=/-+([a-z0-9])/g;function sm(i){return i.replace(jO,(...e)=>e[1].toUpperCase())}function $O(i,e){return i===0||e===0}function HO(i,e,t){if(t.size&&e.length){let n=e[0],r=[];if(t.forEach((s,o)=>{n.has(o)||r.push(o),n.set(o,s)}),r.length)for(let s=1;s<e.length;s++){let o=e[s];r.forEach(a=>o.set(a,om(i,a)))}}return e}function Ot(i,e,t){switch(e.type){case ce.Trigger:return i.visitTrigger(e,t);case ce.State:return i.visitState(e,t);case ce.Transition:return i.visitTransition(e,t);case ce.Sequence:return i.visitSequence(e,t);case ce.Group:return i.visitGroup(e,t);case ce.Animate:return i.visitAnimate(e,t);case ce.Keyframes:return i.visitKeyframes(e,t);case ce.Style:return i.visitStyle(e,t);case ce.Reference:return i.visitReference(e,t);case ce.AnimateChild:return i.visitAnimateChild(e,t);case ce.AnimateRef:return i.visitAnimateRef(e,t);case ce.Query:return i.visitQuery(e,t);case ce.Stagger:return i.visitStagger(e,t);default:throw sO(e.type)}}function om(i,e){return window.getComputedStyle(i)[e]}var GO=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]),Bc=class extends hr{normalizePropertyName(e,t){return sm(e)}normalizeStyleValue(e,t,n,r){let s="",o=n.toString().trim();if(GO.has(t)&&n!==0&&n!=="0")if(typeof n=="number")s="px";else{let a=n.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&a[1].length==0&&r.push(oO(e,n))}return o+s}};var Vc="*";function zO(i,e){let t=[];return typeof i=="string"?i.split(/\s*,\s*/).forEach(n=>WO(n,t,e)):t.push(i),t}function WO(i,e,t){if(i[0]==":"){let l=qO(i,t);if(typeof l=="function"){e.push(l);return}i=l}let n=i.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(n==null||n.length<4)return t.push(yO(i)),e;let r=n[1],s=n[2],o=n[3];e.push(zE(r,o));let a=r==Vc&&o==Vc;s[0]=="<"&&!a&&e.push(zE(o,r))}function qO(i,e){switch(i){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(bO(i)),"* => *"}}var kc=new Set(["true","1"]),Lc=new Set(["false","0"]);function zE(i,e){let t=kc.has(i)||Lc.has(i),n=kc.has(e)||Lc.has(e);return(r,s)=>{let o=i==Vc||i==r,a=e==Vc||e==s;return!o&&t&&typeof r=="boolean"&&(o=r?kc.has(i):Lc.has(i)),!a&&n&&typeof s=="boolean"&&(a=s?kc.has(e):Lc.has(e)),o&&a}}var aD=":self",KO=new RegExp(`s*${aD}s*,?`,"g");function lD(i,e,t,n){return new Hp(i).build(e,t,n)}var WE="",Hp=class{constructor(e){this._driver=e}build(e,t,n){let r=new Gp(t);return this._resetContextStyleTimingState(r),Ot(this,Go(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector=WE,e.collectedStyles=new Map,e.collectedStyles.set(WE,new Map),e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,r=t.depCount=0,s=[],o=[];return e.name.charAt(0)=="@"&&t.errors.push(aO()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),a.type==ce.State){let l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(u=>{l.name=u,s.push(this.visitState(l,t))}),l.name=c}else if(a.type==ce.Transition){let l=this.visitTransition(a,t);n+=l.queryCount,r+=l.depCount,o.push(l)}else t.errors.push(lO())}),{type:ce.Trigger,name:e.name,states:s,transitions:o,queryCount:n,depCount:r,options:null}}visitState(e,t){let n=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(n.containsDynamicStyles){let s=new Set,o=r||{};n.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{oD(l).forEach(c=>{o.hasOwnProperty(c)||s.add(c)})})}),s.size&&t.errors.push(cO(e.name,[...s.values()]))}return{type:ce.State,name:e.name,style:n,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;let n=Ot(this,Go(e.animation),t),r=zO(e.expr,t.errors);return{type:ce.Transition,matchers:r,animation:n,queryCount:t.queryCount,depCount:t.depCount,options:cr(e.options)}}visitSequence(e,t){return{type:ce.Sequence,steps:e.steps.map(n=>Ot(this,n,t)),options:cr(e.options)}}visitGroup(e,t){let n=t.currentTime,r=0,s=e.steps.map(o=>{t.currentTime=n;let a=Ot(this,o,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:ce.Group,steps:s,options:cr(e.options)}}visitAnimate(e,t){let n=ZO(e.timings,t.errors);t.currentAnimateTimings=n;let r,s=e.styles?e.styles:ar({});if(s.type==ce.Keyframes)r=this.visitKeyframes(s,t);else{let o=e.styles,a=!1;if(!o){a=!0;let c={};n.easing&&(c.easing=n.easing),o=ar(c)}t.currentTime+=n.duration+n.delay;let l=this.visitStyle(o,t);l.isEmptyStep=a,r=l}return t.currentAnimateTimings=null,{type:ce.Animate,timings:n,style:r,options:null}}visitStyle(e,t){let n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){let n=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of r)typeof a=="string"?a===Mn?n.push(a):t.errors.push(uO(a)):n.push(new Map(Object.entries(a)));let s=!1,o=null;return n.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(o=a.get("easing"),a.delete("easing")),!s)){for(let l of a.values())if(l.toString().indexOf(rD)>=0){s=!0;break}}}),{type:ce.Style,styles:n,easing:o,offset:e.offset,containsDynamicStyles:s,options:null}}_validateStyleAst(e,t){let n=t.currentAnimateTimings,r=t.currentTime,s=t.currentTime;n&&s>0&&(s-=n.duration+n.delay),e.styles.forEach(o=>{typeof o!="string"&&o.forEach((a,l)=>{let c=t.collectedStyles.get(t.currentQuerySelector),u=c.get(l),d=!0;u&&(s!=r&&s>=u.startTime&&r<=u.endTime&&(t.errors.push(dO(l,u.startTime,u.endTime,s,r)),d=!1),s=u.startTime),d&&c.set(l,{startTime:s,endTime:r}),t.options&&UO(a,t.options,t.errors)})})}visitKeyframes(e,t){let n={type:ce.Keyframes,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(hO()),n;let r=1,s=0,o=[],a=!1,l=!1,c=0,u=e.steps.map(y=>{let _=this._makeStyleAst(y,t),b=_.offset!=null?_.offset:XO(_.styles),S=0;return b!=null&&(s++,S=_.offset=b),l=l||S<0||S>1,a=a||S<c,c=S,o.push(S),_});l&&t.errors.push(fO()),a&&t.errors.push(pO());let d=e.steps.length,h=0;s>0&&s<d?t.errors.push(mO()):s==0&&(h=r/(d-1));let f=d-1,p=t.currentTime,m=t.currentAnimateTimings,g=m.duration;return u.forEach((y,_)=>{let b=h>0?_==f?1:h*_:o[_],S=b*g;t.currentTime=p+m.delay+S,m.duration=S,this._validateStyleAst(y,t),y.offset=b,n.styles.push(y)}),n}visitReference(e,t){return{type:ce.Reference,animation:Ot(this,Go(e.animation),t),options:cr(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:ce.AnimateChild,options:cr(e.options)}}visitAnimateRef(e,t){return{type:ce.AnimateRef,animation:this.visitReference(e.animation,t),options:cr(e.options)}}visitQuery(e,t){let n=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;let[s,o]=YO(e.selector);t.currentQuerySelector=n.length?n+" "+s:s,Nt(t.collectedStyles,t.currentQuerySelector,new Map);let a=Ot(this,Go(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:ce.Query,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:e.selector,options:cr(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(gO());let n=e.timings==="full"?{duration:0,delay:0,easing:"full"}:Fc(e.timings,t.errors,!0);return{type:ce.Stagger,animation:Ot(this,Go(e.animation),t),timings:n,options:null}}};function YO(i){let e=!!i.split(/\s*,\s*/).find(t=>t==aD);return e&&(i=i.replace(KO,"")),i=i.replace(/@\*/g,Pc).replace(/@\w+/g,t=>Pc+"-"+t.slice(1)).replace(/:animating/g,Up),[i,e]}function QO(i){return i?N({},i):null}var Gp=class{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}};function XO(i){if(typeof i=="string")return null;let e=null;if(Array.isArray(i))i.forEach(t=>{if(t instanceof Map&&t.has("offset")){let n=t;e=parseFloat(n.get("offset")),n.delete("offset")}});else if(i instanceof Map&&i.has("offset")){let t=i;e=parseFloat(t.get("offset")),t.delete("offset")}return e}function ZO(i,e){if(i.hasOwnProperty("duration"))return i;if(typeof i=="number"){let s=Fc(i,e).duration;return Op(s,0,"")}let t=i;if(t.split(/\s+/).some(s=>s.charAt(0)=="{"&&s.charAt(1)=="{")){let s=Op(0,0,"");return s.dynamic=!0,s.strValue=t,s}let r=Fc(t,e);return Op(r.duration,r.delay,r.easing)}function cr(i){return i?(i=N({},i),i.params&&(i.params=QO(i.params))):i={},i}function Op(i,e,t){return{duration:i,delay:e,easing:t}}function am(i,e,t,n,r,s,o=null,a=!1){return{type:1,element:i,keyframes:e,preStyleProps:t,postStyleProps:n,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}var qo=class{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}},JO=1,eN=":enter",tN=new RegExp(eN,"g"),nN=":leave",iN=new RegExp(nN,"g");function cD(i,e,t,n,r,s=new Map,o=new Map,a,l,c=[]){return new zp().buildKeyframes(i,e,t,n,r,s,o,a,l,c)}var zp=class{buildKeyframes(e,t,n,r,s,o,a,l,c,u=[]){c=c||new qo;let d=new Wp(e,t,c,r,s,u,[]);d.options=l;let h=l.delay?Jn(l.delay):0;d.currentTimeline.delayNextStep(h),d.currentTimeline.setStyles([o],null,d.errors,l),Ot(this,n,d);let f=d.timelines.filter(p=>p.containsAnimation());if(f.length&&a.size){let p;for(let m=f.length-1;m>=0;m--){let g=f[m];if(g.element===t){p=g;break}}p&&!p.allowOnlyTimelineStyles()&&p.setStyles([a],null,d.errors,l)}return f.length?f.map(p=>p.buildKeyframes()):[am(t,[],[],[],0,h,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){let n=t.subInstructions.get(t.element);if(n){let r=t.createSubContext(e.options),s=t.currentTimeline.currentTime,o=this._visitSubInstructions(n,r,r.options);s!=o&&t.transformIntoNewTimeline(o)}t.previousNode=e}visitAnimateRef(e,t){let n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,n),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,n){for(let r of e){let s=r?.delay;if(s){let o=typeof s=="number"?s:Jn(Wo(s,r?.params??{},t.errors));n.delayNextStep(o)}}}_visitSubInstructions(e,t,n){let s=t.currentTimeline.currentTime,o=n.duration!=null?Jn(n.duration):null,a=n.delay!=null?Jn(n.delay):null;return o!==0&&e.forEach(l=>{let c=t.appendInstructionToTimeline(l,o,a);s=Math.max(s,c.duration+c.delay)}),s}visitReference(e,t){t.updateOptions(e.options,!0),Ot(this,e.animation,t),t.previousNode=e}visitSequence(e,t){let n=t.subContextCount,r=t,s=e.options;if(s&&(s.params||s.delay)&&(r=t.createSubContext(s),r.transformIntoNewTimeline(),s.delay!=null)){r.previousNode.type==ce.Style&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Uc);let o=Jn(s.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(o=>Ot(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>n&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){let n=[],r=t.currentTimeline.currentTime,s=e.options&&e.options.delay?Jn(e.options.delay):0;e.steps.forEach(o=>{let a=t.createSubContext(e.options);s&&a.delayNextStep(s),Ot(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(o=>t.currentTimeline.mergeTimelineCollectedStyles(o)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){let n=e.strValue,r=t.params?Wo(n,t.params,t.errors):n;return Fc(r,t.errors)}else return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){let n=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),r.snapshotCurrentStyles());let s=e.style;s.type==ce.Keyframes?this.visitKeyframes(s,t):(t.incrementTime(n.duration),this.visitStyle(s,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){let n=t.currentTimeline,r=t.currentAnimateTimings;!r&&n.hasCurrentStyleProperties()&&n.forwardFrame();let s=r&&r.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(s):n.setStyles(e.styles,s,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){let n=t.currentAnimateTimings,r=t.currentTimeline.duration,s=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(l=>{let c=l.offset||0;a.forwardTime(c*s),a.setStyles(l.styles,l.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(r+s),t.previousNode=e}visitQuery(e,t){let n=t.currentTimeline.currentTime,r=e.options||{},s=r.delay?Jn(r.delay):0;s&&(t.previousNode.type===ce.Style||n==0&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=Uc);let o=n,a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=a.length;let l=null;a.forEach((c,u)=>{t.currentQueryIndex=u;let d=t.createSubContext(e.options,c);s&&d.delayNextStep(s),c===t.element&&(l=d.currentTimeline),Ot(this,e.animation,d),d.currentTimeline.applyStylesToKeyframe();let h=d.currentTimeline.currentTime;o=Math.max(o,h)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){let n=t.parentContext,r=t.currentTimeline,s=e.timings,o=Math.abs(s.duration),a=o*(t.currentQueryTotal-1),l=o*t.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":l=a-l;break;case"full":l=n.currentStaggerTime;break}let u=t.currentTimeline;l&&u.delayNextStep(l);let d=u.currentTime;Ot(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=r.currentTime-d+(r.startTime-n.currentTimeline.startTime)}},Uc={},Wp=class i{constructor(e,t,n,r,s,o,a,l){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Uc,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new jc(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;let n=e,r=this.options;n.duration!=null&&(r.duration=Jn(n.duration)),n.delay!=null&&(r.delay=Jn(n.delay));let s=n.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!t||!o.hasOwnProperty(a))&&(o[a]=Wo(s[a],o,this.errors))})}}_copyOptions(){let e={};if(this.options){let t=this.options.params;if(t){let n=e.params={};Object.keys(t).forEach(r=>{n[r]=t[r]})}}return e}createSubContext(e=null,t,n){let r=t||this.element,s=new i(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,n||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(e),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(e){return this.previousNode=Uc,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){let r={duration:t??e.duration,delay:this.currentTimeline.currentTime+(n??0)+e.delay,easing:""},s=new qp(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,r,s,o){let a=[];if(r&&a.push(this.element),e.length>0){e=e.replace(tN,"."+this._enterClassName),e=e.replace(iN,"."+this._leaveClassName);let l=n!=1,c=this._driver.query(this.element,e,l);n!==0&&(c=n<0?c.slice(c.length+n,c.length):c.slice(0,n)),a.push(...c)}return!s&&a.length==0&&o.push(vO(t)),a}},jc=class i{constructor(e,t,n,r){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){let t=this._keyframes.size===1&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new i(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=JO,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,n]of this._globalTimelineStyles)this._backFill.set(t,n||Mn),this._currentKeyframe.set(t,Mn);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,r){t&&this._previousKeyframe.set("easing",t);let s=r&&r.params||{},o=rN(e,this._globalTimelineStyles);for(let[a,l]of o){let c=Wo(l,s,n);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??Mn),this._updateStyle(a,c)}}applyStylesToKeyframe(){this._pendingStyles.size!=0&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){let e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,n)=>{let r=this._styleSummary.get(n);(!r||t.time>r.time)&&this._updateStyle(n,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();let e=new Set,t=new Set,n=this._keyframes.size===1&&this.duration===0,r=[];this._keyframes.forEach((a,l)=>{let c=new Map([...this._backFill,...a]);c.forEach((u,d)=>{u===Rc?e.add(d):u===Mn&&t.add(d)}),n||c.set("offset",l/this.duration),r.push(c)});let s=[...e.values()],o=[...t.values()];if(n){let a=r[0],l=new Map(a);a.set("offset",0),l.set("offset",1),r=[a,l]}return am(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}},qp=class extends jc{constructor(e,t,n,r,s,o,a=!1){super(e,t,o.delay),this.keyframes=n,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){let s=[],o=n+t,a=t/o,l=new Map(e[0]);l.set("offset",0),s.push(l);let c=new Map(e[0]);c.set("offset",qE(a)),s.push(c);let u=e.length-1;for(let d=1;d<=u;d++){let h=new Map(e[d]),f=h.get("offset"),p=t+f*n;h.set("offset",qE(p/o)),s.push(h)}n=o,t=0,r="",e=s}return am(this.element,e,this.preStyleProps,this.postStyleProps,n,t,r,!0)}};function qE(i,e=3){let t=Math.pow(10,e-1);return Math.round(i*t)/t}function rN(i,e){let t=new Map,n;return i.forEach(r=>{if(r==="*"){n??=e.keys();for(let s of n)t.set(s,Mn)}else for(let[s,o]of r)t.set(s,o)}),t}function KE(i,e,t,n,r,s,o,a,l,c,u,d,h){return{type:0,element:i,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:s,toState:n,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:d,errors:h}}var Np={},$c=class{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,r){return sN(this.ast.matchers,e,t,n,r)}buildStyles(e,t,n){let r=this._stateStyles.get("*");return e!==void 0&&(r=this._stateStyles.get(e?.toString())||r),r?r.buildStyles(t,n):new Map}build(e,t,n,r,s,o,a,l,c,u){let d=[],h=this.ast.options&&this.ast.options.params||Np,f=a&&a.params||Np,p=this.buildStyles(n,f,d),m=l&&l.params||Np,g=this.buildStyles(r,m,d),y=new Set,_=new Map,b=new Map,S=r==="void",E={params:uD(m,h),delay:this.ast.options?.delay},x=u?[]:cD(e,t,this.ast.animation,s,o,p,g,E,c,d),w=0;return x.forEach(R=>{w=Math.max(R.duration+R.delay,w)}),d.length?KE(t,this._triggerName,n,r,S,p,g,[],[],_,b,w,d):(x.forEach(R=>{let B=R.element,I=Nt(_,B,new Set);R.preStyleProps.forEach(Y=>I.add(Y));let O=Nt(b,B,new Set);R.postStyleProps.forEach(Y=>O.add(Y)),B!==t&&y.add(B)}),KE(t,this._triggerName,n,r,S,p,g,x,[...y.values()],_,b,w))}};function sN(i,e,t,n,r){return i.some(s=>s(e,t,n,r))}function uD(i,e){let t=N({},e);return Object.entries(i).forEach(([n,r])=>{r!=null&&(t[n]=r)}),t}var Kp=class{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){let n=new Map,r=uD(e,this.defaultParams);return this.styles.styles.forEach(s=>{typeof s!="string"&&s.forEach((o,a)=>{o&&(o=Wo(o,r,t));let l=this.normalizer.normalizePropertyName(a,t);o=this.normalizer.normalizeStyleValue(a,l,o,t),n.set(a,o)})}),n}};function oN(i,e,t){return new Yp(i,e,t)}var Yp=class{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{let s=r.options&&r.options.params||{};this.states.set(r.name,new Kp(r.style,s,n))}),YE(this.states,"true","1"),YE(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new $c(e,r,this.states))}),this.fallbackTransition=aN(e,this.states,this._normalizer)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,r){return this.transitionFactories.find(o=>o.match(e,t,n,r))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}};function aN(i,e,t){let n=[(o,a)=>!0],r={type:ce.Sequence,steps:[],options:null},s={type:ce.Transition,animation:r,matchers:n,options:null,queryCount:0,depCount:0};return new $c(i,s,e)}function YE(i,e,t){i.has(e)?i.has(t)||i.set(t,i.get(e)):i.has(t)&&i.set(e,i.get(t))}var lN=new qo,Qp=class{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){let n=[],r=[],s=lD(this._driver,t,n,r);if(n.length)throw DO(n);r.length&&void 0,this._animations.set(e,s)}_buildPlayer(e,t,n){let r=e.element,s=tD(this._normalizer,e.keyframes,t,n);return this._driver.animate(r,s,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){let r=[],s=this._animations.get(e),o,a=new Map;if(s?(o=cD(this._driver,t,s,sD,Vp,new Map,new Map,n,lN,r),o.forEach(u=>{let d=Nt(a,u.element,new Map);u.postStyleProps.forEach(h=>d.set(h,null))})):(r.push(wO()),o=[]),r.length)throw SO(r);a.forEach((u,d)=>{u.forEach((h,f)=>{u.set(f,this._driver.computeStyle(d,f,Mn))})});let l=o.map(u=>{let d=a.get(u.element);return this._buildPlayer(u,new Map,d)}),c=Ei(l);return this._playersById.set(e,c),c.onDestroy(()=>this.destroy(e)),this.players.push(c),c}destroy(e){let t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);let n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){let t=this._playersById.get(e);if(!t)throw TO(e);return t}listen(e,t,n,r){let s=nm(t,"","","");return tm(this._getPlayer(e),n,s,r),()=>{}}command(e,t,n,r){if(n=="register"){this.register(e,r[0]);return}if(n=="create"){let o=r[0]||{};this.create(e,t,o);return}let s=this._getPlayer(e);switch(n){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e);break}}},QE="ng-animate-queued",cN=".ng-animate-queued",Pp="ng-animate-disabled",uN=".ng-animate-disabled",dN="ng-star-inserted",hN=".ng-star-inserted",fN=[],dD={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},pN={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},cn="__ng_removed",Ko=class{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;let n=e&&e.hasOwnProperty("value"),r=n?e.value:e;if(this.value=gN(r),n){let s=e,{value:o}=s,a=Av(s,["value"]);this.options=a}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){let t=e.params;if(t){let n=this.options.params;Object.keys(t).forEach(r=>{n[r]==null&&(n[r]=t[r])})}}},zo="void",Fp=new Ko(zo),Xp=class{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,zt(t,this._hostClassName)}listen(e,t,n,r){if(!this._triggers.has(t))throw xO(n,t);if(n==null||n.length==0)throw IO(t);if(!vN(n))throw CO(n,t);let s=Nt(this._elementListeners,e,[]),o={name:t,phase:n,callback:r};s.push(o);let a=Nt(this._engine.statesByElement,e,new Map);return a.has(t)||(zt(e,Mc),zt(e,Mc+"-"+t),a.set(t,Fp)),()=>{this._engine.afterFlush(()=>{let l=s.indexOf(o);l>=0&&s.splice(l,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return this._triggers.has(e)?!1:(this._triggers.set(e,t),!0)}_getTrigger(e){let t=this._triggers.get(e);if(!t)throw AO(e);return t}trigger(e,t,n,r=!0){let s=this._getTrigger(t),o=new Yo(this.id,t,e),a=this._engine.statesByElement.get(e);a||(zt(e,Mc),zt(e,Mc+"-"+t),this._engine.statesByElement.set(e,a=new Map));let l=a.get(t),c=new Ko(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(t,c),l||(l=Fp),!(c.value===zo)&&l.value===c.value){if(!_N(l.params,c.params)){let m=[],g=s.matchStyles(l.value,l.params,m),y=s.matchStyles(c.value,c.params,m);m.length?this._engine.reportError(m):this._engine.afterFlush(()=>{ur(e,g),kn(e,y)})}return}let h=Nt(this._engine.playersByElement,e,[]);h.forEach(m=>{m.namespaceId==this.id&&m.triggerName==t&&m.queued&&m.destroy()});let f=s.matchTransition(l.value,c.value,e,c.params),p=!1;if(!f){if(!r)return;f=s.fallbackTransition,p=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:f,fromState:l,toState:c,player:o,isFallbackTransition:p}),p||(zt(e,QE),o.onStart(()=>{ds(e,QE)})),o.onDone(()=>{let m=this.players.indexOf(o);m>=0&&this.players.splice(m,1);let g=this._engine.playersByElement.get(e);if(g){let y=g.indexOf(o);y>=0&&g.splice(y,1)}}),this.players.push(o),h.push(o),o}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);let t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){let n=this._engine.driver.query(e,Pc,!0);n.forEach(r=>{if(r[cn])return;let s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,n,r){let s=this._engine.statesByElement.get(e),o=new Map;if(s){let a=[];if(s.forEach((l,c)=>{if(o.set(c,l.value),this._triggers.has(c)){let u=this.trigger(e,c,zo,r);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,o),n&&Ei(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){let t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){let r=new Set;t.forEach(s=>{let o=s.name;if(r.has(o))return;r.add(o);let l=this._triggers.get(o).fallbackTransition,c=n.get(o)||Fp,u=new Ko(zo),d=new Yo(this.id,o,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:o,transition:l,fromState:c,toState:u,player:d,isFallbackTransition:!0})})}}removeNode(e,t){let n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(n.totalAnimations){let s=n.players.length?n.playersByQueriedElement.get(e):[];if(s&&s.length)r=!0;else{let o=e;for(;o=o.parentNode;)if(n.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)n.markElementAsRemoved(this.id,e,!1,t);else{let s=e[cn];(!s||s===dD)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){zt(e,this._hostClassName)}drainQueuedTransitions(e){let t=[];return this._queue.forEach(n=>{let r=n.player;if(r.destroyed)return;let s=n.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==n.triggerName){let l=nm(s,n.triggerName,n.fromState.value,n.toState.value);l._data=e,tm(n.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(n)}),this._queue=[],t.sort((n,r)=>{let s=n.transition.ast.depCount,o=r.transition.ast.depCount;return s==0||o==0?s-o:this._engine.driver.containsElement(n.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}},Zp=class{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,n,r){this.bodyNode=e,this.driver=t,this._normalizer=n,this.scheduler=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,o)=>{}}get queuedPlayers(){let e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){let n=new Xp(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){let n=this._namespaceList,r=this.namespacesByHostElement;if(n.length-1>=0){let o=!1,a=this.driver.getParentElement(t);for(;a;){let l=r.get(a);if(l){let c=n.indexOf(l);n.splice(c+1,0,e),o=!0;break}a=this.driver.getParentElement(a)}o||n.unshift(e)}else n.push(e);return r.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let r=this._namespaceLookup[e];r&&r.register(t,n)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{let n=this._fetchNamespace(e);this.namespacesByHostElement.delete(n.hostElement);let r=this._namespaceList.indexOf(n);r>=0&&this._namespaceList.splice(r,1),n.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){let t=new Set,n=this.statesByElement.get(e);if(n){for(let r of n.values())if(r.namespaceId){let s=this._fetchNamespace(r.namespaceId);s&&t.add(s)}}return t}trigger(e,t,n,r){if(Oc(t)){let s=this._fetchNamespace(e);if(s)return s.trigger(t,n,r),!0}return!1}insertNode(e,t,n,r){if(!Oc(t))return;let s=t[cn];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;let o=this.collectedLeaveElements.indexOf(t);o>=0&&this.collectedLeaveElements.splice(o,1)}if(e){let o=this._fetchNamespace(e);o&&o.insertNode(t,n)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),zt(e,Pp)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),ds(e,Pp))}removeNode(e,t,n){if(Oc(t)){this.scheduler?.notify();let r=e?this._fetchNamespace(e):null;r?r.removeNode(t,n):this.markElementAsRemoved(e,t,!1,n);let s=this.namespacesByHostElement.get(t);s&&s.id!==e&&s.removeNode(t,n)}else this._onRemovalComplete(t,n)}markElementAsRemoved(e,t,n,r,s){this.collectedLeaveElements.push(t),t[cn]={namespaceId:e,setForRemoval:r,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:s}}listen(e,t,n,r,s){return Oc(t)?this._fetchNamespace(e).listen(t,n,r,s):()=>{}}_buildInstruction(e,t,n,r,s){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,r,e.fromState.options,e.toState.options,t,s)}destroyInnerAnimations(e){let t=this.driver.query(e,Pc,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),this.playersByQueriedElement.size!=0&&(t=this.driver.query(e,Up,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){let t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){let t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Ei(this.players).onDone(()=>e());e()})}processLeaveNode(e){let t=e[cn];if(t&&t.setForRemoval){if(e[cn]=dD,t.namespaceId){this.destroyInnerAnimations(e);let n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(Pp)&&this.markElementAsDisabled(e,!1),this.driver.query(e,uN,!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,r)=>this._balanceNamespaceList(n,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++){let r=this.collectedEnterElements[n];zt(r,dN)}if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){let n=[];try{t=this._flushAnimations(n,e)}finally{for(let r=0;r<n.length;r++)n[r]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++){let r=this.collectedLeaveElements[n];this.processLeaveNode(r)}if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){let n=this._whenQuietFns;this._whenQuietFns=[],t.length?Ei(t).onDone(()=>{n.forEach(r=>r())}):n.forEach(r=>r())}}reportError(e){throw RO(e)}_flushAnimations(e,t){let n=new qo,r=[],s=new Map,o=[],a=new Map,l=new Map,c=new Map,u=new Set;this.disabledNodes.forEach(A=>{u.add(A);let F=this.driver.query(A,cN,!0);for(let U=0;U<F.length;U++)u.add(F[U])});let d=this.bodyNode,h=Array.from(this.statesByElement.keys()),f=JE(h,this.collectedEnterElements),p=new Map,m=0;f.forEach((A,F)=>{let U=sD+m++;p.set(F,U),A.forEach(k=>zt(k,U))});let g=[],y=new Set,_=new Set;for(let A=0;A<this.collectedLeaveElements.length;A++){let F=this.collectedLeaveElements[A],U=F[cn];U&&U.setForRemoval&&(g.push(F),y.add(F),U.hasAnimation?this.driver.query(F,hN,!0).forEach(k=>y.add(k)):_.add(F))}let b=new Map,S=JE(h,Array.from(y));S.forEach((A,F)=>{let U=Vp+m++;b.set(F,U),A.forEach(k=>zt(k,U))}),e.push(()=>{f.forEach((A,F)=>{let U=p.get(F);A.forEach(k=>ds(k,U))}),S.forEach((A,F)=>{let U=b.get(F);A.forEach(k=>ds(k,U))}),g.forEach(A=>{this.processLeaveNode(A)})});let E=[],x=[];for(let A=this._namespaceList.length-1;A>=0;A--)this._namespaceList[A].drainQueuedTransitions(t).forEach(U=>{let k=U.player,P=U.element;if(E.push(k),this.collectedEnterElements.length){let xe=P[cn];if(xe&&xe.setForMove){if(xe.previousTriggersValues&&xe.previousTriggersValues.has(U.triggerName)){let xt=xe.previousTriggersValues.get(U.triggerName),lt=this.statesByElement.get(U.element);if(lt&&lt.has(U.triggerName)){let _a=lt.get(U.triggerName);_a.value=xt,lt.set(U.triggerName,_a)}}k.destroy();return}}let ae=!d||!this.driver.containsElement(d,P),z=b.get(P),me=p.get(P),ie=this._buildInstruction(U,n,me,z,ae);if(ie.errors&&ie.errors.length){x.push(ie);return}if(ae){k.onStart(()=>ur(P,ie.fromStyles)),k.onDestroy(()=>kn(P,ie.toStyles)),r.push(k);return}if(U.isFallbackTransition){k.onStart(()=>ur(P,ie.fromStyles)),k.onDestroy(()=>kn(P,ie.toStyles)),r.push(k);return}let $e=[];ie.timelines.forEach(xe=>{xe.stretchStartingKeyframe=!0,this.disabledNodes.has(xe.element)||$e.push(xe)}),ie.timelines=$e,n.append(P,ie.timelines);let Ye={instruction:ie,player:k,element:P};o.push(Ye),ie.queriedElements.forEach(xe=>Nt(a,xe,[]).push(k)),ie.preStyleProps.forEach((xe,xt)=>{if(xe.size){let lt=l.get(xt);lt||l.set(xt,lt=new Set),xe.forEach((_a,Qu)=>lt.add(Qu))}}),ie.postStyleProps.forEach((xe,xt)=>{let lt=c.get(xt);lt||c.set(xt,lt=new Set),xe.forEach((_a,Qu)=>lt.add(Qu))})});if(x.length){let A=[];x.forEach(F=>{A.push(MO(F.triggerName,F.errors))}),E.forEach(F=>F.destroy()),this.reportError(A)}let w=new Map,R=new Map;o.forEach(A=>{let F=A.element;n.has(F)&&(R.set(F,F),this._beforeAnimationBuild(A.player.namespaceId,A.instruction,w))}),r.forEach(A=>{let F=A.element;this._getPreviousPlayers(F,!1,A.namespaceId,A.triggerName,null).forEach(k=>{Nt(w,F,[]).push(k),k.destroy()})});let B=g.filter(A=>eD(A,l,c)),I=new Map;ZE(I,this.driver,_,c,Mn).forEach(A=>{eD(A,l,c)&&B.push(A)});let Y=new Map;f.forEach((A,F)=>{ZE(Y,this.driver,new Set(A),l,Rc)}),B.forEach(A=>{let F=I.get(A),U=Y.get(A);I.set(A,new Map([...F?.entries()??[],...U?.entries()??[]]))});let $=[],ee=[],J={};o.forEach(A=>{let{element:F,player:U,instruction:k}=A;if(n.has(F)){if(u.has(F)){U.onDestroy(()=>kn(F,k.toStyles)),U.disabled=!0,U.overrideTotalTime(k.totalTime),r.push(U);return}let P=J;if(R.size>1){let z=F,me=[];for(;z=z.parentNode;){let ie=R.get(z);if(ie){P=ie;break}me.push(z)}me.forEach(ie=>R.set(ie,P))}let ae=this._buildAnimation(U.namespaceId,k,w,s,Y,I);if(U.setRealPlayer(ae),P===J)$.push(U);else{let z=this.playersByElement.get(P);z&&z.length&&(U.parentPlayer=Ei(z)),r.push(U)}}else ur(F,k.fromStyles),U.onDestroy(()=>kn(F,k.toStyles)),ee.push(U),u.has(F)&&r.push(U)}),ee.forEach(A=>{let F=s.get(A.element);if(F&&F.length){let U=Ei(F);A.setRealPlayer(U)}}),r.forEach(A=>{A.parentPlayer?A.syncPlayerEvents(A.parentPlayer):A.destroy()});for(let A=0;A<g.length;A++){let F=g[A],U=F[cn];if(ds(F,Vp),U&&U.hasAnimation)continue;let k=[];if(a.size){let ae=a.get(F);ae&&ae.length&&k.push(...ae);let z=this.driver.query(F,Up,!0);for(let me=0;me<z.length;me++){let ie=a.get(z[me]);ie&&ie.length&&k.push(...ie)}}let P=k.filter(ae=>!ae.destroyed);P.length?yN(this,F,P):this.processLeaveNode(F)}return g.length=0,$.forEach(A=>{this.players.push(A),A.onDone(()=>{A.destroy();let F=this.players.indexOf(A);this.players.splice(F,1)}),A.play()}),$}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,r,s){let o=[];if(t){let a=this.playersByQueriedElement.get(e);a&&(o=a)}else{let a=this.playersByElement.get(e);if(a){let l=!s||s==zo;a.forEach(c=>{c.queued||!l&&c.triggerName!=r||o.push(c)})}}return(n||r)&&(o=o.filter(a=>!(n&&n!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(e,t,n){let r=t.triggerName,s=t.element,o=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:r;for(let l of t.timelines){let c=l.element,u=c!==s,d=Nt(n,c,[]);this._getPreviousPlayers(c,u,o,a,t.toState).forEach(f=>{let p=f.getRealPlayer();p.beforeDestroy&&p.beforeDestroy(),f.destroy(),d.push(f)})}ur(s,t.fromStyles)}_buildAnimation(e,t,n,r,s,o){let a=t.triggerName,l=t.element,c=[],u=new Set,d=new Set,h=t.timelines.map(p=>{let m=p.element;u.add(m);let g=m[cn];if(g&&g.removedBeforeQueried)return new _i(p.duration,p.delay);let y=m!==l,_=bN((n.get(m)||fN).map(w=>w.getRealPlayer())).filter(w=>{let R=w;return R.element?R.element===m:!1}),b=s.get(m),S=o.get(m),E=tD(this._normalizer,p.keyframes,b,S),x=this._buildPlayer(p,E,_);if(p.subTimeline&&r&&d.add(m),y){let w=new Yo(e,a,m);w.setRealPlayer(x),c.push(w)}return x});c.forEach(p=>{Nt(this.playersByQueriedElement,p.element,[]).push(p),p.onDone(()=>mN(this.playersByQueriedElement,p.element,p))}),u.forEach(p=>zt(p,GE));let f=Ei(h);return f.onDestroy(()=>{u.forEach(p=>ds(p,GE)),kn(l,t.toStyles)}),d.forEach(p=>{Nt(r,p,[]).push(f)}),f}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new _i(e.duration,e.delay)}},Yo=class{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new _i,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,n)=>{t.forEach(r=>tm(e,n,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){let t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Nt(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return this.queued?!1:this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){let t=this._player;t.triggerCallback&&t.triggerCallback(e)}};function mN(i,e,t){let n=i.get(e);if(n){if(n.length){let r=n.indexOf(t);n.splice(r,1)}n.length==0&&i.delete(e)}return n}function gN(i){return i??null}function Oc(i){return i&&i.nodeType===1}function vN(i){return i=="start"||i=="done"}function XE(i,e){let t=i.style.display;return i.style.display=e??"none",t}function ZE(i,e,t,n,r){let s=[];t.forEach(l=>s.push(XE(l)));let o=[];n.forEach((l,c)=>{let u=new Map;l.forEach(d=>{let h=e.computeStyle(c,d,r);u.set(d,h),(!h||h.length==0)&&(c[cn]=pN,o.push(c))}),i.set(c,u)});let a=0;return t.forEach(l=>XE(l,s[a++])),o}function JE(i,e){let t=new Map;if(i.forEach(a=>t.set(a,[])),e.length==0)return t;let n=1,r=new Set(e),s=new Map;function o(a){if(!a)return n;let l=s.get(a);if(l)return l;let c=a.parentNode;return t.has(c)?l=c:r.has(c)?l=n:l=o(c),s.set(a,l),l}return e.forEach(a=>{let l=o(a);l!==n&&t.get(l).push(a)}),t}function zt(i,e){i.classList?.add(e)}function ds(i,e){i.classList?.remove(e)}function yN(i,e,t){Ei(t).onDone(()=>i.processLeaveNode(e))}function bN(i){let e=[];return hD(i,e),e}function hD(i,e){for(let t=0;t<i.length;t++){let n=i[t];n instanceof Ho?hD(n.players,e):e.push(n)}}function _N(i,e){let t=Object.keys(i),n=Object.keys(e);if(t.length!=n.length)return!1;for(let r=0;r<t.length;r++){let s=t[r];if(!e.hasOwnProperty(s)||i[s]!==e[s])return!1}return!0}function eD(i,e,t){let n=t.get(i);if(!n)return!1;let r=e.get(i);return r?n.forEach(s=>r.add(s)):e.set(i,n),t.delete(i),!0}var fs=class{constructor(e,t,n,r){this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(s,o)=>{},this._transitionEngine=new Zp(e.body,t,n,r),this._timelineEngine=new Qp(e.body,t,n),this._transitionEngine.onRemovalComplete=(s,o)=>this.onRemovalComplete(s,o)}registerTrigger(e,t,n,r,s){let o=e+"-"+r,a=this._triggerCache[o];if(!a){let l=[],c=[],u=lD(this._driver,s,l,c);if(l.length)throw _O(r,l);c.length&&void 0,a=oN(r,u,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(t,r,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,r){this._transitionEngine.insertNode(e,t,n,r)}onRemove(e,t,n){this._transitionEngine.removeNode(e,t,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,r){if(n.charAt(0)=="@"){let[s,o]=$E(n),a=r;this._timelineEngine.command(s,t,o,a)}else this._transitionEngine.trigger(e,t,n,r)}listen(e,t,n,r,s){if(n.charAt(0)=="@"){let[o,a]=$E(n);return this._timelineEngine.listen(o,t,a,s)}return this._transitionEngine.listen(e,t,n,r,s)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}};function EN(i,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=Bp(e[0]),e.length>1&&(n=Bp(e[e.length-1]))):e instanceof Map&&(t=Bp(e)),t||n?new Jp(i,t,n):null}var hs=class hs{constructor(e,t,n){this._element=e,this._startStyles=t,this._endStyles=n,this._state=0;let r=hs.initialStylesByElement.get(e);r||hs.initialStylesByElement.set(e,r=new Map),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&kn(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(kn(this._element,this._initialStyles),this._endStyles&&(kn(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(hs.initialStylesByElement.delete(this._element),this._startStyles&&(ur(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(ur(this._element,this._endStyles),this._endStyles=null),kn(this._element,this._initialStyles),this._state=3)}};hs.initialStylesByElement=new WeakMap;var Jp=hs;function Bp(i){let e=null;return i.forEach((t,n)=>{DN(n)&&(e=e||new Map,e.set(n,t))}),e}function DN(i){return i==="display"||i==="position"}var Hc=class{constructor(e,t,n,r){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;let e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map;let t=()=>this._onFinish();this.domPlayer.addEventListener("finish",t),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",t)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){let t=[];return e.forEach(n=>{t.push(Object.fromEntries(n))}),t}_triggerWebAnimation(e,t,n){return e.animate(this._convertKeyframesToObject(t),n)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){this.domPlayer===void 0&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){let e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,r)=>{r!=="offset"&&e.set(r,this._finished?n:om(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){let t=e==="start"?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}},Gc=class{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return nD(e,t)}getParentElement(e){return im(e)}query(e,t,n){return iD(e,t,n)}computeStyle(e,t,n){return om(e,t)}animate(e,t,n,r,s,o=[]){let a=r==0?"both":"forwards",l={duration:n,delay:r,fill:a};s&&(l.easing=s);let c=new Map,u=o.filter(f=>f instanceof Hc);$O(n,r)&&u.forEach(f=>{f.currentSnapshot.forEach((p,m)=>c.set(m,p))});let d=VO(t).map(f=>new Map(f));d=HO(e,d,c);let h=EN(e,d);return new Hc(e,d,l,h)}};var Nc="@",fD="@.disabled",zc=class{constructor(e,t,n,r){this.namespaceId=e,this.delegate=t,this.engine=n,this._onDestroy=r,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,r=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,r){this.delegate.setAttribute(e,t,n,r)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,r){this.delegate.setStyle(e,t,n,r)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){t.charAt(0)==Nc&&t==fD?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}},em=class extends zc{constructor(e,t,n,r,s){super(t,n,r,s),this.factory=e,this.namespaceId=t}setProperty(e,t,n){t.charAt(0)==Nc?t.charAt(1)=="."&&t==fD?(n=n===void 0?!0:!!n,this.disableAnimations(e,n)):this.engine.process(this.namespaceId,e,t.slice(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if(t.charAt(0)==Nc){let r=wN(e),s=t.slice(1),o="";return s.charAt(0)!=Nc&&([s,o]=SN(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{let l=a._data||-1;this.factory.scheduleListenerCallback(l,n,a)})}return this.delegate.listen(e,t,n)}};function wN(i){switch(i){case"body":return document.body;case"document":return document;case"window":return window;default:return i}}function SN(i){let e=i.indexOf("."),t=i.substring(0,e),n=i.slice(e+1);return[t,n]}var Wc=class{constructor(e,t,n){this.delegate=e,this.engine=t,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,t.onRemovalComplete=(r,s)=>{let o=s?.parentNode(r);o&&s.removeChild(o,r)}}createRenderer(e,t){let n="",r=this.delegate.createRenderer(e,t);if(!e||!t?.data?.animation){let c=this._rendererCache,u=c.get(r);if(!u){let d=()=>c.delete(r);u=new zc(n,r,this.engine,d),c.set(r,u)}return u}let s=t.id,o=t.id+"-"+this._currentId;this._currentId++,this.engine.register(o,e);let a=c=>{Array.isArray(c)?c.forEach(a):this.engine.registerTrigger(s,o,e,c.name,c)};return t.data.animation.forEach(a),new em(this,o,r,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,t,n){if(e>=0&&e<this._microtaskId){this._zone.run(()=>t(n));return}let r=this._animationCallbacksBuffer;r.length==0&&queueMicrotask(()=>{this._zone.run(()=>{r.forEach(s=>{let[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),r.push([t,n])}end(){this._cdRecurDepth--,this._cdRecurDepth==0&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}};var xN=(()=>{let e=class e extends fs{constructor(n,r,s){super(n,r,s,L(Kr,{optional:!0}))}ngOnDestroy(){this.flush()}};e.\u0275fac=function(r){return new(r||e)(C(de),C(dr),C(hr))},e.\u0275prov=j({token:e,factory:e.\u0275fac});let i=e;return i})();function IN(){return new Bc}function CN(i,e,t){return new Wc(i,e,t)}var mD=[{provide:hr,useFactory:IN},{provide:fs,useClass:xN},{provide:$i,useFactory:CN,deps:[Zl,fs,W]}],pD=[{provide:dr,useFactory:()=>new Gc},{provide:Tn,useValue:"BrowserAnimations"},...mD],AN=[{provide:dr,useClass:rm},{provide:Tn,useValue:"NoopAnimations"},...mD],gD=(()=>{let e=class e{static withConfig(n){return{ngModule:e,providers:n.disableAnimations?AN:pD}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ee({type:e}),e.\u0275inj=_e({providers:pD,imports:[w_]});let i=e;return i})();var RN={url:"https://video-sync-app.vercel.app",options:{}},vD={providers:[rE(sE),Al(BE.forRoot(RN)),Al([gD])]};var TD=(()=>{let e=class e{constructor(n,r){this._renderer=n,this._elementRef=r,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(n,r){this._renderer.setProperty(this._elementRef.nativeElement,n,r)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}};e.\u0275fac=function(r){return new(r||e)(X(Jr),X(Me))},e.\u0275dir=Le({type:e});let i=e;return i})(),MN=(()=>{let e=class e extends TD{};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=Xr(e)))(s||e)}})(),e.\u0275dir=Le({type:e,features:[At]});let i=e;return i})(),xD=new G("");var kN={provide:xD,useExisting:to(()=>Qc),multi:!0};function LN(){let i=Cn()?Cn().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}var ON=new G(""),Qc=(()=>{let e=class e extends TD{constructor(n,r,s){super(n,r),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!LN())}writeValue(n){let r=n??"";this.setProperty("value",r)}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}};e.\u0275fac=function(r){return new(r||e)(X(Jr),X(Me),X(ON,8))},e.\u0275dir=Le({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,s){r&1&&ct("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[Ki([kN]),At]});let i=e;return i})();var NN=new G(""),PN=new G("");function ID(i){return i!=null}function CD(i){return Yi(i)?Be(i):i}function AD(i){let e={};return i.forEach(t=>{e=t!=null?N(N({},e),t):e}),Object.keys(e).length===0?null:e}function RD(i,e){return e.map(t=>t(i))}function FN(i){return!i.validate}function MD(i){return i.map(e=>FN(e)?e:t=>e.validate(t))}function BN(i){if(!i)return null;let e=i.filter(ID);return e.length==0?null:function(t){return AD(RD(t,e))}}function kD(i){return i!=null?BN(MD(i)):null}function VN(i){if(!i)return null;let e=i.filter(ID);return e.length==0?null:function(t){let n=RD(t,e).map(CD);return hd(n).pipe(pe(AD))}}function LD(i){return i!=null?VN(MD(i)):null}function yD(i,e){return i===null?[e]:Array.isArray(i)?[...i,e]:[i,e]}function UN(i){return i._rawValidators}function jN(i){return i._rawAsyncValidators}function cm(i){return i?Array.isArray(i)?i:[i]:[]}function Kc(i,e){return Array.isArray(i)?i.includes(e):i===e}function bD(i,e){let t=cm(e);return cm(i).forEach(r=>{Kc(t,r)||t.push(r)}),t}function _D(i,e){return cm(e).filter(t=>!Kc(i,t))}var Yc=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=kD(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=LD(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},um=class extends Yc{get formDirective(){return null}get path(){return null}},Zo=class extends Yc{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},dm=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},$N={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},HW=Ie(N({},$N),{"[class.ng-submitted]":"isSubmitted"}),OD=(()=>{let e=class e extends dm{constructor(n){super(n)}};e.\u0275fac=function(r){return new(r||e)(X(Zo,2))},e.\u0275dir=Le({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,s){r&2&&Yn("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[At]});let i=e;return i})();var Qo="VALID",qc="INVALID",ps="PENDING",Xo="DISABLED";function HN(i){return(Xc(i)?i.validators:i)||null}function GN(i){return Array.isArray(i)?kD(i):i||null}function zN(i,e){return(Xc(e)?e.asyncValidators:i)||null}function WN(i){return Array.isArray(i)?LD(i):i||null}function Xc(i){return i!=null&&!Array.isArray(i)&&typeof i=="object"}var hm=class{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Qo}get invalid(){return this.status===qc}get pending(){return this.status==ps}get disabled(){return this.status===Xo}get enabled(){return this.status!==Xo}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(bD(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(bD(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(_D(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(_D(e,this._rawAsyncValidators))}hasValidator(e){return Kc(this._rawValidators,e)}hasAsyncValidator(e){return Kc(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=ps,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Xo,this.errors=null,this._forEachChild(n=>{n.disable(Ie(N({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Ie(N({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Qo,this._forEachChild(n=>{n.enable(Ie(N({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Ie(N({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Qo||this.status===ps)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Xo:Qo}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=ps,this._hasOwnPendingAsyncValidator=!0;let t=CD(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((n,r)=>n&&n._find(r),this)}getError(e,t){let n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Pe,this.statusChanges=new Pe}_calculateStatus(){return this._allControlsDisabled()?Xo:this.errors?qc:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ps)?ps:this._anyControlsHaveStatus(qc)?qc:Qo}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Xc(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=GN(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=WN(this._rawAsyncValidators)}};var ND=new G("CallSetDisabledState",{providedIn:"root",factory:()=>fm}),fm="always";function qN(i,e){return[...e.path,i]}function KN(i,e,t=fm){QN(i,e),e.valueAccessor.writeValue(i.value),(i.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(i.disabled),XN(i,e),JN(i,e),ZN(i,e),YN(i,e)}function ED(i,e){i.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function YN(i,e){if(e.valueAccessor.setDisabledState){let t=n=>{e.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(t),e._registerOnDestroy(()=>{i._unregisterOnDisabledChange(t)})}}function QN(i,e){let t=UN(i);e.validator!==null?i.setValidators(yD(t,e.validator)):typeof t=="function"&&i.setValidators([t]);let n=jN(i);e.asyncValidator!==null?i.setAsyncValidators(yD(n,e.asyncValidator)):typeof n=="function"&&i.setAsyncValidators([n]);let r=()=>i.updateValueAndValidity();ED(e._rawValidators,r),ED(e._rawAsyncValidators,r)}function XN(i,e){e.valueAccessor.registerOnChange(t=>{i._pendingValue=t,i._pendingChange=!0,i._pendingDirty=!0,i.updateOn==="change"&&PD(i,e)})}function ZN(i,e){e.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,i.updateOn==="blur"&&i._pendingChange&&PD(i,e),i.updateOn!=="submit"&&i.markAsTouched()})}function PD(i,e){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function JN(i,e){let t=(n,r)=>{e.valueAccessor.writeValue(n),r&&e.viewToModelUpdate(n)};i.registerOnChange(t),e._registerOnDestroy(()=>{i._unregisterOnChange(t)})}function eP(i,e){if(!i.hasOwnProperty("model"))return!1;let t=i.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function tP(i){return Object.getPrototypeOf(i.constructor)===MN}function nP(i,e){if(!e)return null;Array.isArray(e);let t,n,r;return e.forEach(s=>{s.constructor===Qc?t=s:tP(s)?n=s:r=s}),r||n||t||null}function DD(i,e){let t=i.indexOf(e);t>-1&&i.splice(t,1)}function wD(i){return typeof i=="object"&&i!==null&&Object.keys(i).length===2&&"value"in i&&"disabled"in i}var iP=class extends hm{constructor(e=null,t,n){super(HN(t),zN(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Xc(t)&&(t.nonNullable||t.initialValueIsDefault)&&(wD(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){DD(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){DD(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){wD(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var rP={provide:Zo,useExisting:to(()=>pm)},SD=Promise.resolve(),pm=(()=>{let e=class e extends Zo{constructor(n,r,s,o,a,l){super(),this._changeDetectorRef=a,this.callSetDisabledState=l,this.control=new iP,this._registered=!1,this.name="",this.update=new Pe,this._parent=n,this._setValidators(r),this._setAsyncValidators(s),this.valueAccessor=nP(this,o)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){let r=n.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),eP(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){KN(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(n){SD.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){let r=n.isDisabled.currentValue,s=r!==0&&Ht(r);SD.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?qN(n,this._parent):[n]}};e.\u0275fac=function(r){return new(r||e)(X(um,9),X(NN,10),X(PN,10),X(xD,10),X(an,8),X(ND,8))},e.\u0275dir=Le({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[we.None,"disabled","isDisabled"],model:[we.None,"ngModel","model"],options:[we.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Ki([rP]),At,Wn]});let i=e;return i})();var sP=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ee({type:e}),e.\u0275inj=_e({});let i=e;return i})();var FD=(()=>{let e=class e{static withConfig(n){return{ngModule:e,providers:[{provide:ND,useValue:n.callSetDisabledState??fm}]}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ee({type:e}),e.\u0275inj=_e({imports:[sP]});let i=e;return i})();function aP(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var Lw={exports:{}};(function(i,e){(function(t){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,a={buildAbsoluteURL:function(l,c,u){if(u=u||{},l=l.trim(),c=c.trim(),!c){if(!u.alwaysNormalize)return l;var d=a.parseURL(l);if(!d)throw new Error("Error trying to parse base URL.");return d.path=a.normalizePath(d.path),a.buildURLFromParts(d)}var h=a.parseURL(c);if(!h)throw new Error("Error trying to parse relative URL.");if(h.scheme)return u.alwaysNormalize?(h.path=a.normalizePath(h.path),a.buildURLFromParts(h)):c;var f=a.parseURL(l);if(!f)throw new Error("Error trying to parse base URL.");if(!f.netLoc&&f.path&&f.path[0]!=="/"){var p=r.exec(f.path);f.netLoc=p[1],f.path=p[2]}f.netLoc&&!f.path&&(f.path="/");var m={scheme:f.scheme,netLoc:h.netLoc,path:null,params:h.params,query:h.query,fragment:h.fragment};if(!h.netLoc&&(m.netLoc=f.netLoc,h.path[0]!=="/"))if(!h.path)m.path=f.path,h.params||(m.params=f.params,h.query||(m.query=f.query));else{var g=f.path,y=g.substring(0,g.lastIndexOf("/")+1)+h.path;m.path=a.normalizePath(y)}return m.path===null&&(m.path=u.alwaysNormalize?a.normalizePath(h.path):h.path),a.buildURLFromParts(m)},parseURL:function(l){var c=n.exec(l);return c?{scheme:c[1]||"",netLoc:c[2]||"",path:c[3]||"",params:c[4]||"",query:c[5]||"",fragment:c[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(s,"");l.length!==(l=l.replace(o,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};i.exports=a})()})(Lw);var $g=Lw.exports;function BD(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function rt(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?BD(Object(t),!0).forEach(function(n){uP(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):BD(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function lP(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function cP(i){var e=lP(i,"string");return typeof e=="symbol"?e:String(e)}function uP(i,e,t){return e=cP(e),e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Ke(){return Ke=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},Ke.apply(this,arguments)}var H=Number.isFinite||function(i){return typeof i=="number"&&isFinite(i)},dP=Number.isSafeInteger||function(i){return typeof i=="number"&&Math.abs(i)<=hP},hP=Number.MAX_SAFE_INTEGER||9007199254740991,v=function(i){return i.MEDIA_ATTACHING="hlsMediaAttaching",i.MEDIA_ATTACHED="hlsMediaAttached",i.MEDIA_DETACHING="hlsMediaDetaching",i.MEDIA_DETACHED="hlsMediaDetached",i.BUFFER_RESET="hlsBufferReset",i.BUFFER_CODECS="hlsBufferCodecs",i.BUFFER_CREATED="hlsBufferCreated",i.BUFFER_APPENDING="hlsBufferAppending",i.BUFFER_APPENDED="hlsBufferAppended",i.BUFFER_EOS="hlsBufferEos",i.BUFFER_FLUSHING="hlsBufferFlushing",i.BUFFER_FLUSHED="hlsBufferFlushed",i.MANIFEST_LOADING="hlsManifestLoading",i.MANIFEST_LOADED="hlsManifestLoaded",i.MANIFEST_PARSED="hlsManifestParsed",i.LEVEL_SWITCHING="hlsLevelSwitching",i.LEVEL_SWITCHED="hlsLevelSwitched",i.LEVEL_LOADING="hlsLevelLoading",i.LEVEL_LOADED="hlsLevelLoaded",i.LEVEL_UPDATED="hlsLevelUpdated",i.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",i.LEVELS_UPDATED="hlsLevelsUpdated",i.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",i.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",i.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",i.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",i.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",i.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",i.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",i.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",i.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",i.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",i.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",i.CUES_PARSED="hlsCuesParsed",i.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",i.INIT_PTS_FOUND="hlsInitPtsFound",i.FRAG_LOADING="hlsFragLoading",i.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",i.FRAG_LOADED="hlsFragLoaded",i.FRAG_DECRYPTED="hlsFragDecrypted",i.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",i.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",i.FRAG_PARSING_METADATA="hlsFragParsingMetadata",i.FRAG_PARSED="hlsFragParsed",i.FRAG_BUFFERED="hlsFragBuffered",i.FRAG_CHANGED="hlsFragChanged",i.FPS_DROP="hlsFpsDrop",i.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",i.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",i.ERROR="hlsError",i.DESTROYING="hlsDestroying",i.KEY_LOADING="hlsKeyLoading",i.KEY_LOADED="hlsKeyLoaded",i.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",i.BACK_BUFFER_REACHED="hlsBackBufferReached",i.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",i}({}),Z=function(i){return i.NETWORK_ERROR="networkError",i.MEDIA_ERROR="mediaError",i.KEY_SYSTEM_ERROR="keySystemError",i.MUX_ERROR="muxError",i.OTHER_ERROR="otherError",i}({}),T=function(i){return i.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",i.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",i.KEY_SYSTEM_NO_SESSION="keySystemNoSession",i.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",i.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",i.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",i.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",i.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",i.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",i.MANIFEST_LOAD_ERROR="manifestLoadError",i.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",i.MANIFEST_PARSING_ERROR="manifestParsingError",i.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",i.LEVEL_EMPTY_ERROR="levelEmptyError",i.LEVEL_LOAD_ERROR="levelLoadError",i.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",i.LEVEL_PARSING_ERROR="levelParsingError",i.LEVEL_SWITCH_ERROR="levelSwitchError",i.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",i.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",i.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",i.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",i.FRAG_LOAD_ERROR="fragLoadError",i.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",i.FRAG_DECRYPT_ERROR="fragDecryptError",i.FRAG_PARSING_ERROR="fragParsingError",i.FRAG_GAP="fragGap",i.REMUX_ALLOC_ERROR="remuxAllocError",i.KEY_LOAD_ERROR="keyLoadError",i.KEY_LOAD_TIMEOUT="keyLoadTimeOut",i.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",i.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",i.BUFFER_APPEND_ERROR="bufferAppendError",i.BUFFER_APPENDING_ERROR="bufferAppendingError",i.BUFFER_STALLED_ERROR="bufferStalledError",i.BUFFER_FULL_ERROR="bufferFullError",i.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",i.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",i.INTERNAL_EXCEPTION="internalException",i.INTERNAL_ABORTED="aborted",i.UNKNOWN="unknown",i}({}),pr=function(){},Om={trace:pr,debug:pr,log:pr,warn:pr,info:pr,error:pr},ta=Om;function fP(i){let e=self.console[i];return e?e.bind(self.console,`[${i}] >`):pr}function pP(i,...e){e.forEach(function(t){ta[t]=i[t]?i[t].bind(i):fP(t)})}function mP(i,e){if(typeof console=="object"&&i===!0||typeof i=="object"){pP(i,"debug","log","info","warn","error");try{ta.log(`Debug logs enabled for "${e}" in hls.js version 1.5.15`)}catch{ta=Om}}else ta=Om}var D=ta,gP=/^(\d+)x(\d+)$/,VD=/(.+?)=(".*?"|.*?)(?:,|$)/g,Ve=class i{constructor(e){typeof e=="string"&&(e=i.parseAttrList(e)),Ke(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){let t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;let n=new Uint8Array(t.length/2);for(let r=0;r<t.length/2;r++)n[r]=parseInt(t.slice(r*2,r*2+2),16);return n}else return null}hexadecimalIntegerAsNumber(e){let t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){let n=this[e];return n?parseFloat(n):t}enumeratedString(e){return this[e]}bool(e){return this[e]==="YES"}decimalResolution(e){let t=gP.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t,n={},r='"';for(VD.lastIndex=0;(t=VD.exec(e))!==null;){let s=t[2];s.indexOf(r)===0&&s.lastIndexOf(r)===s.length-1&&(s=s.slice(1,-1));let o=t[1].trim();n[o]=s}return n}};function vP(i){return i!=="ID"&&i!=="CLASS"&&i!=="START-DATE"&&i!=="DURATION"&&i!=="END-DATE"&&i!=="END-ON-NEXT"}function yP(i){return i==="SCTE35-OUT"||i==="SCTE35-IN"}var mu=class{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){let n=t.attr;for(let r in n)if(Object.prototype.hasOwnProperty.call(e,r)&&e[r]!==n[r]){D.warn(`DATERANGE tag attribute: "${r}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=r;break}e=Ke(new Ve({}),n,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){let n=new Date(this.attr["END-DATE"]);H(n.getTime())&&(this._endDate=n)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;let e=this.duration;return e!==null?new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){let e=this.attr.decimalFloatingPoint("DURATION");if(H(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&H(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}},Ts=class{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},Ae={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"},gu=class{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[Ae.AUDIO]:null,[Ae.VIDEO]:null,[Ae.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){let n=e.split("@",2),r;n.length===1?r=t?.byteRangeEndOffset||0:r=parseInt(n[1]),this._byteRange=[r,parseInt(n[0])+r]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=$g.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}},na=class extends gu{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new Ts,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get decryptdata(){let{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){let t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{let n=Object.keys(this.levelkeys);if(n.length===1)return this._decryptdata=this.levelkeys[n[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!H(this.programDateTime))return null;let e=H(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){let t=Object.keys(this.levelkeys),n=t.length;if(n>1||n===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){let t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,n,r,s,o=!1){let{elementaryStreams:a}=this,l=a[e];if(!l){a[e]={startPTS:t,endPTS:n,startDTS:r,endDTS:s,partial:o};return}l.startPTS=Math.min(l.startPTS,t),l.endPTS=Math.max(l.endPTS,n),l.startDTS=Math.min(l.startDTS,r),l.endDTS=Math.max(l.endDTS,s)}clearElementaryStreamInfo(){let{elementaryStreams:e}=this;e[Ae.AUDIO]=null,e[Ae.VIDEO]=null,e[Ae.AUDIOVIDEO]=null}},Nm=class extends gu{constructor(e,t,n,r,s){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new Ts,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=r;let o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,s),s&&(this.fragOffset=s.fragOffset+s.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){let{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}},bP=10,Pm=class{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}let t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?H(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||bP}get drift(){let e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}};function Hg(i){return Uint8Array.from(atob(i),e=>e.charCodeAt(0))}function _P(i){let e=Fm(i).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function EP(i){let e=function(n,r,s){let o=n[r];n[r]=n[s],n[s]=o};e(i,0,3),e(i,1,2),e(i,4,5),e(i,6,7)}function DP(i){let e=i.split(":"),t=null;if(e[0]==="data"&&e.length===2){let n=e[1].split(";"),r=n[n.length-1].split(",");if(r.length===2){let s=r[0]==="base64",o=r[1];s?(n.splice(-1,1),t=Hg(o)):t=_P(o)}}return t}function Fm(i){return Uint8Array.from(unescape(encodeURIComponent(i)),e=>e.charCodeAt(0))}var xs=typeof self<"u"?self:void 0,Ne={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Tt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function UD(i){switch(i){case Tt.FAIRPLAY:return Ne.FAIRPLAY;case Tt.PLAYREADY:return Ne.PLAYREADY;case Tt.WIDEVINE:return Ne.WIDEVINE;case Tt.CLEARKEY:return Ne.CLEARKEY}}var ea={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",FAIRPLAY:"94ce86fb07ff4f43adb893d2fa968ca2",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function jD(i){if(i===ea.WIDEVINE)return Ne.WIDEVINE;if(i===ea.PLAYREADY)return Ne.PLAYREADY;if(i===ea.CENC||i===ea.CLEARKEY)return Ne.CLEARKEY}function $D(i){switch(i){case Ne.FAIRPLAY:return Tt.FAIRPLAY;case Ne.PLAYREADY:return Tt.PLAYREADY;case Ne.WIDEVINE:return Tt.WIDEVINE;case Ne.CLEARKEY:return Tt.CLEARKEY}}function mm(i){let{drmSystems:e,widevineLicenseUrl:t}=i,n=e?[Ne.FAIRPLAY,Ne.WIDEVINE,Ne.PLAYREADY,Ne.CLEARKEY].filter(r=>!!e[r]):[];return!n[Ne.WIDEVINE]&&t&&n.push(Ne.WIDEVINE),n}var Ow=function(i){return xs!=null&&(i=xs.navigator)!=null&&i.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function wP(i,e,t,n){let r;switch(i){case Ne.FAIRPLAY:r=["cenc","sinf"];break;case Ne.WIDEVINE:case Ne.PLAYREADY:r=["cenc"];break;case Ne.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${i}`)}return SP(r,e,t,n)}function SP(i,e,t,n){return[{initDataTypes:i,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(s=>({contentType:`audio/mp4; codecs="${s}"`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:t.map(s=>({contentType:`video/mp4; codecs="${s}"`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function gr(i,e,t){return Uint8Array.prototype.slice?i.slice(e,t):new Uint8Array(Array.prototype.slice.call(i,e,t))}var Gg=(i,e)=>e+10<=i.length&&i[e]===73&&i[e+1]===68&&i[e+2]===51&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128,Nw=(i,e)=>e+10<=i.length&&i[e]===51&&i[e+1]===68&&i[e+2]===73&&i[e+3]<255&&i[e+4]<255&&i[e+6]<128&&i[e+7]<128&&i[e+8]<128&&i[e+9]<128,ra=(i,e)=>{let t=e,n=0;for(;Gg(i,e);){n+=10;let r=ju(i,e+6);n+=r,Nw(i,e+10)&&(n+=10),e+=n}if(n>0)return i.subarray(t,t+n)},ju=(i,e)=>{let t=0;return t=(i[e]&127)<<21,t|=(i[e+1]&127)<<14,t|=(i[e+2]&127)<<7,t|=i[e+3]&127,t},TP=(i,e)=>Gg(i,e)&&ju(i,e+6)+10<=i.length-e,zg=i=>{let e=Fw(i);for(let t=0;t<e.length;t++){let n=e[t];if(Pw(n))return MP(n)}},Pw=i=>i&&i.key==="PRIV"&&i.info==="com.apple.streaming.transportStreamTimestamp",xP=i=>{let e=String.fromCharCode(i[0],i[1],i[2],i[3]),t=ju(i,4),n=10;return{type:e,size:t,data:i.subarray(n,n+t)}},Fw=i=>{let e=0,t=[];for(;Gg(i,e);){let n=ju(i,e+6);e+=10;let r=e+n;for(;e+8<r;){let s=xP(i.subarray(e)),o=IP(s);o&&t.push(o),e+=s.size+10}Nw(i,e)&&(e+=10)}return t},IP=i=>i.type==="PRIV"?CP(i):i.type[0]==="W"?RP(i):AP(i),CP=i=>{if(i.size<2)return;let e=Fn(i.data,!0),t=new Uint8Array(i.data.subarray(e.length+1));return{key:i.type,info:e,data:t.buffer}},AP=i=>{if(i.size<2)return;if(i.type==="TXXX"){let t=1,n=Fn(i.data.subarray(t),!0);t+=n.length+1;let r=Fn(i.data.subarray(t));return{key:i.type,info:n,data:r}}let e=Fn(i.data.subarray(1));return{key:i.type,data:e}},RP=i=>{if(i.type==="WXXX"){if(i.size<2)return;let t=1,n=Fn(i.data.subarray(t),!0);t+=n.length+1;let r=Fn(i.data.subarray(t));return{key:i.type,info:n,data:r}}let e=Fn(i.data);return{key:i.type,data:e}},MP=i=>{if(i.data.byteLength===8){let e=new Uint8Array(i.data),t=e[3]&1,n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,t&&(n+=4772185884e-2),Math.round(n)}},Fn=(i,e=!1)=>{let t=kP();if(t){let c=t.decode(i);if(e){let u=c.indexOf("\0");return u!==-1?c.substring(0,u):c}return c.replace(/\0/g,"")}let n=i.length,r,s,o,a="",l=0;for(;l<n;){if(r=i[l++],r===0&&e)return a;if(r===0||r===3)continue;switch(r>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(r);break;case 12:case 13:s=i[l++],a+=String.fromCharCode((r&31)<<6|s&63);break;case 14:s=i[l++],o=i[l++],a+=String.fromCharCode((r&15)<<12|(s&63)<<6|(o&63)<<0);break}}return a},gm;function kP(){if(!navigator.userAgent.includes("PlayStation 4"))return!gm&&typeof self.TextDecoder<"u"&&(gm=new self.TextDecoder("utf-8")),gm}var On={hexDump:function(i){let e="";for(let t=0;t<i.length;t++){let n=i[t].toString(16);n.length<2&&(n="0"+n),e+=n}return e}},vu=Math.pow(2,32)-1,LP=[].push,Bw={video:1,audio:2,id3:3,text:4};function Ze(i){return String.fromCharCode.apply(null,i)}function Vw(i,e){let t=i[e]<<8|i[e+1];return t<0?65536+t:t}function q(i,e){let t=Uw(i,e);return t<0?4294967296+t:t}function HD(i,e){let t=q(i,e);return t*=Math.pow(2,32),t+=q(i,e+4),t}function Uw(i,e){return i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}function vm(i,e,t){i[e]=t>>24,i[e+1]=t>>16&255,i[e+2]=t>>8&255,i[e+3]=t&255}function OP(i){let e=i.byteLength;for(let t=0;t<e;){let n=q(i,t);if(n>8&&i[t+4]===109&&i[t+5]===111&&i[t+6]===111&&i[t+7]===102)return!0;t=n>1?t+n:e}return!1}function oe(i,e){let t=[];if(!e.length)return t;let n=i.byteLength;for(let r=0;r<n;){let s=q(i,r),o=Ze(i.subarray(r+4,r+8)),a=s>1?r+s:n;if(o===e[0])if(e.length===1)t.push(i.subarray(r+8,a));else{let l=oe(i.subarray(r+8,a),e.slice(1));l.length&&LP.apply(t,l)}r=a}return t}function NP(i){let e=[],t=i[0],n=8,r=q(i,n);n+=4;let s=0,o=0;t===0?(s=q(i,n),o=q(i,n+4),n+=8):(s=HD(i,n),o=HD(i,n+8),n+=16),n+=2;let a=i.length+o,l=Vw(i,n);n+=2;for(let c=0;c<l;c++){let u=n,d=q(i,u);u+=4;let h=d&2147483647;if((d&2147483648)>>>31===1)return D.warn("SIDX has hierarchical references (not supported)"),null;let p=q(i,u);u+=4,e.push({referenceSize:h,subsegmentDuration:p,info:{duration:p/r,start:a,end:a+h-1}}),a+=h,u+=4,n=u}return{earliestPresentationTime:s,timescale:r,version:t,referencesCount:l,references:e}}function jw(i){let e=[],t=oe(i,["moov","trak"]);for(let r=0;r<t.length;r++){let s=t[r],o=oe(s,["tkhd"])[0];if(o){let a=o[0],l=q(o,a===0?12:20),c=oe(s,["mdia","mdhd"])[0];if(c){a=c[0];let u=q(c,a===0?12:20),d=oe(s,["mdia","hdlr"])[0];if(d){let h=Ze(d.subarray(8,12)),f={soun:Ae.AUDIO,vide:Ae.VIDEO}[h];if(f){let p=oe(s,["mdia","minf","stbl","stsd"])[0],m=PP(p);e[l]={timescale:u,type:f},e[f]=rt({timescale:u,id:l},m)}}}}}return oe(i,["moov","mvex","trex"]).forEach(r=>{let s=q(r,4),o=e[s];o&&(o.default={duration:q(r,12),flags:q(r,20)})}),e}function PP(i){let e=i.subarray(8),t=e.subarray(86),n=Ze(e.subarray(4,8)),r=n,s=n==="enca"||n==="encv";if(s){let a=oe(e,[n])[0].subarray(n==="enca"?28:78);oe(a,["sinf"]).forEach(c=>{let u=oe(c,["schm"])[0];if(u){let d=Ze(u.subarray(4,8));if(d==="cbcs"||d==="cenc"){let h=oe(c,["frma"])[0];h&&(r=Ze(h))}}})}switch(r){case"avc1":case"avc2":case"avc3":case"avc4":{let o=oe(t,["avcC"])[0];r+="."+Zc(o[1])+Zc(o[2])+Zc(o[3]);break}case"mp4a":{let o=oe(e,[n])[0],a=oe(o.subarray(28),["esds"])[0];if(a&&a.length>12){let l=4;if(a[l++]!==3)break;l=ym(a,l),l+=2;let c=a[l++];if(c&128&&(l+=2),c&64&&(l+=a[l++]),a[l++]!==4)break;l=ym(a,l);let u=a[l++];if(u===64)r+="."+Zc(u);else break;if(l+=12,a[l++]!==5)break;l=ym(a,l);let d=a[l++],h=(d&248)>>3;h===31&&(h+=1+((d&7)<<3)+((a[l]&224)>>5)),r+="."+h}break}case"hvc1":case"hev1":{let o=oe(t,["hvcC"])[0],a=o[1],l=["","A","B","C"][a>>6],c=a&31,u=q(o,2),d=(a&32)>>5?"H":"L",h=o[12],f=o.subarray(6,12);r+="."+l+c,r+="."+u.toString(16).toUpperCase(),r+="."+d+h;let p="";for(let m=f.length;m--;){let g=f[m];(g||p)&&(p="."+g.toString(16).toUpperCase()+p)}r+=p;break}case"dvh1":case"dvhe":{let o=oe(t,["dvcC"])[0],a=o[2]>>1&127,l=o[2]<<5&32|o[3]>>3&31;r+="."+Ln(a)+"."+Ln(l);break}case"vp09":{let o=oe(t,["vpcC"])[0],a=o[4],l=o[5],c=o[6]>>4&15;r+="."+Ln(a)+"."+Ln(l)+"."+Ln(c);break}case"av01":{let o=oe(t,["av1C"])[0],a=o[1]>>>5,l=o[1]&31,c=o[2]>>>7?"H":"M",u=(o[2]&64)>>6,d=(o[2]&32)>>5,h=a===2&&u?d?12:10:u?10:8,f=(o[2]&16)>>4,p=(o[2]&8)>>3,m=(o[2]&4)>>2,g=o[2]&3;r+="."+a+"."+Ln(l)+c+"."+Ln(h)+"."+f+"."+p+m+g+"."+Ln(1)+"."+Ln(1)+"."+Ln(1)+"."+0;break}}return{codec:r,encrypted:s}}function ym(i,e){let t=e+5;for(;i[e++]&128&&e<t;);return e}function Zc(i){return("0"+i.toString(16).toUpperCase()).slice(-2)}function Ln(i){return(i<10?"0":"")+i}function FP(i,e){if(!i||!e)return i;let t=e.keyId;return t&&e.isCommonEncryption&&oe(i,["moov","trak"]).forEach(r=>{let o=oe(r,["mdia","minf","stbl","stsd"])[0].subarray(8),a=oe(o,["enca"]),l=a.length>0;l||(a=oe(o,["encv"])),a.forEach(c=>{let u=l?c.subarray(28):c.subarray(78);oe(u,["sinf"]).forEach(h=>{let f=$w(h);if(f){let p=f.subarray(8,24);p.some(m=>m!==0)||(D.log(`[eme] Patching keyId in 'enc${l?"a":"v"}>sinf>>tenc' box: ${On.hexDump(p)} -> ${On.hexDump(t)}`),f.set(t,8))}})})}),i}function $w(i){let e=oe(i,["schm"])[0];if(e){let t=Ze(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return oe(i,["schi","tenc"])[0]}return null}function BP(i,e){return oe(e,["moof","traf"]).reduce((t,n)=>{let r=oe(n,["tfdt"])[0],s=r[0],o=oe(n,["tfhd"]).reduce((a,l)=>{let c=q(l,4),u=i[c];if(u){let d=q(r,4);if(s===1){if(d===vu)return D.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),a;d*=vu+1,d+=q(r,8)}let h=u.timescale||9e4,f=d/h;if(H(f)&&(a===null||f<a))return f}return a},null);return o!==null&&H(o)&&(t===null||o<t)?o:t},null)}function VP(i,e){let t=0,n=0,r=0,s=oe(i,["moof","traf"]);for(let o=0;o<s.length;o++){let a=s[o],l=oe(a,["tfhd"])[0],c=q(l,4),u=e[c];if(!u)continue;let d=u.default,h=q(l,0)|d?.flags,f=d?.duration;h&8&&(h&2?f=q(l,12):f=q(l,8));let p=u.timescale||9e4,m=oe(a,["trun"]);for(let g=0;g<m.length;g++){if(t=UP(m[g]),!t&&f){let y=q(m[g],4);t=f*y}u.type===Ae.VIDEO?n+=t/p:u.type===Ae.AUDIO&&(r+=t/p)}}if(n===0&&r===0){let o=1/0,a=0,l=0,c=oe(i,["sidx"]);for(let u=0;u<c.length;u++){let d=NP(c[u]);if(d!=null&&d.references){o=Math.min(o,d.earliestPresentationTime/d.timescale);let h=d.references.reduce((f,p)=>f+p.info.duration||0,0);a=Math.max(a,h+d.earliestPresentationTime/d.timescale),l=a-o}}if(l&&H(l))return l}return n||r}function UP(i){let e=q(i,0),t=8;e&1&&(t+=4),e&4&&(t+=4);let n=0,r=q(i,4);for(let s=0;s<r;s++){if(e&256){let o=q(i,t);n+=o,t+=4}e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4)}return n}function jP(i,e,t){oe(e,["moof","traf"]).forEach(n=>{oe(n,["tfhd"]).forEach(r=>{let s=q(r,4),o=i[s];if(!o)return;let a=o.timescale||9e4;oe(n,["tfdt"]).forEach(l=>{let c=l[0],u=t*a;if(u){let d=q(l,4);if(c===0)d-=u,d=Math.max(d,0),vm(l,4,d);else{d*=Math.pow(2,32),d+=q(l,8),d-=u,d=Math.max(d,0);let h=Math.floor(d/(vu+1)),f=Math.floor(d%(vu+1));vm(l,4,h),vm(l,8,f)}}})})})}function $P(i){let e={valid:null,remainder:null},t=oe(i,["moof"]);if(t.length<2)return e.remainder=i,e;let n=t[t.length-1];return e.valid=gr(i,0,n.byteOffset-8),e.remainder=gr(i,n.byteOffset-8),e}function qt(i,e){let t=new Uint8Array(i.length+e.length);return t.set(i),t.set(e,i.length),t}function GD(i,e){let t=[],n=e.samples,r=e.timescale,s=e.id,o=!1;return oe(n,["moof"]).map(l=>{let c=l.byteOffset-8;oe(l,["traf"]).map(d=>{let h=oe(d,["tfdt"]).map(f=>{let p=f[0],m=q(f,4);return p===1&&(m*=Math.pow(2,32),m+=q(f,8)),m/r})[0];return h!==void 0&&(i=h),oe(d,["tfhd"]).map(f=>{let p=q(f,4),m=q(f,0)&16777215,g=(m&1)!==0,y=(m&2)!==0,_=(m&8)!==0,b=0,S=(m&16)!==0,E=0,x=(m&32)!==0,w=8;p===s&&(g&&(w+=8),y&&(w+=4),_&&(b=q(f,w),w+=4),S&&(E=q(f,w),w+=4),x&&(w+=4),e.type==="video"&&(o=HP(e.codec)),oe(d,["trun"]).map(R=>{let B=R[0],I=q(R,0)&16777215,O=(I&1)!==0,Y=0,$=(I&4)!==0,ee=(I&256)!==0,J=0,A=(I&512)!==0,F=0,U=(I&1024)!==0,k=(I&2048)!==0,P=0,ae=q(R,4),z=8;O&&(Y=q(R,z),z+=4),$&&(z+=4);let me=Y+c;for(let ie=0;ie<ae;ie++){if(ee?(J=q(R,z),z+=4):J=b,A?(F=q(R,z),z+=4):F=E,U&&(z+=4),k&&(B===0?P=q(R,z):P=Uw(R,z),z+=4),e.type===Ae.VIDEO){let $e=0;for(;$e<F;){let Ye=q(n,me);if(me+=4,GP(o,n[me])){let xe=n.subarray(me,me+Ye);Hw(xe,o?2:1,i+P/r,t)}me+=Ye,$e+=Ye+4}}i+=J/r}}))})})}),t}function HP(i){if(!i)return!1;let e=i.indexOf("."),t=e<0?i:i.substring(0,e);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function GP(i,e){if(i){let t=e>>1&63;return t===39||t===40}else return(e&31)===6}function Hw(i,e,t,n){let r=Gw(i),s=0;s+=e;let o=0,a=0,l=0;for(;s<r.length;){o=0;do{if(s>=r.length)break;l=r[s++],o+=l}while(l===255);a=0;do{if(s>=r.length)break;l=r[s++],a+=l}while(l===255);let c=r.length-s,u=s;if(a<c)s+=a;else if(a>c){D.error(`Malformed SEI payload. ${a} is too small, only ${c} bytes left to parse.`);break}if(o===4){if(r[u++]===181){let h=Vw(r,u);if(u+=2,h===49){let f=q(r,u);if(u+=4,f===1195456820){let p=r[u++];if(p===3){let m=r[u++],g=31&m,y=64&m,_=y?2+g*3:0,b=new Uint8Array(_);if(y){b[0]=m;for(let S=1;S<_;S++)b[S]=r[u++]}n.push({type:p,payloadType:o,pts:t,bytes:b})}}}}}else if(o===5&&a>16){let d=[];for(let p=0;p<16;p++){let m=r[u++].toString(16);d.push(m.length==1?"0"+m:m),(p===3||p===5||p===7||p===9)&&d.push("-")}let h=a-16,f=new Uint8Array(h);for(let p=0;p<h;p++)f[p]=r[u++];n.push({payloadType:o,pts:t,uuid:d.join(""),userData:Fn(f),userDataBytes:f})}}}function Gw(i){let e=i.byteLength,t=[],n=1;for(;n<e-2;)i[n]===0&&i[n+1]===0&&i[n+2]===3?(t.push(n+2),n+=2):n++;if(t.length===0)return i;let r=e-t.length,s=new Uint8Array(r),o=0;for(n=0;n<r;o++,n++)o===t[0]&&(o++,t.shift()),s[n]=i[o];return s}function zP(i){let e=i[0],t="",n="",r=0,s=0,o=0,a=0,l=0,c=0;if(e===0){for(;Ze(i.subarray(c,c+1))!=="\0";)t+=Ze(i.subarray(c,c+1)),c+=1;for(t+=Ze(i.subarray(c,c+1)),c+=1;Ze(i.subarray(c,c+1))!=="\0";)n+=Ze(i.subarray(c,c+1)),c+=1;n+=Ze(i.subarray(c,c+1)),c+=1,r=q(i,12),s=q(i,16),a=q(i,20),l=q(i,24),c=28}else if(e===1){c+=4,r=q(i,c),c+=4;let d=q(i,c);c+=4;let h=q(i,c);for(c+=4,o=2**32*d+h,dP(o)||(o=Number.MAX_SAFE_INTEGER,D.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),a=q(i,c),c+=4,l=q(i,c),c+=4;Ze(i.subarray(c,c+1))!=="\0";)t+=Ze(i.subarray(c,c+1)),c+=1;for(t+=Ze(i.subarray(c,c+1)),c+=1;Ze(i.subarray(c,c+1))!=="\0";)n+=Ze(i.subarray(c,c+1)),c+=1;n+=Ze(i.subarray(c,c+1)),c+=1}let u=i.subarray(c,i.byteLength);return{schemeIdUri:t,value:n,timeScale:r,presentationTime:o,presentationTimeDelta:s,eventDuration:a,id:l,payload:u}}function WP(i,...e){let t=e.length,n=8,r=t;for(;r--;)n+=e[r].byteLength;let s=new Uint8Array(n);for(s[0]=n>>24&255,s[1]=n>>16&255,s[2]=n>>8&255,s[3]=n&255,s.set(i,4),r=0,n=8;r<t;r++)s.set(e[r],n),n+=e[r].byteLength;return s}function qP(i,e,t){if(i.byteLength!==16)throw new RangeError("Invalid system id");let n,r;if(e){n=1,r=new Uint8Array(e.length*16);for(let a=0;a<e.length;a++){let l=e[a];if(l.byteLength!==16)throw new RangeError("Invalid key");r.set(l,a*16)}}else n=0,r=new Uint8Array;let s;n>0?(s=new Uint8Array(4),e.length>0&&new DataView(s.buffer).setUint32(0,e.length,!1)):s=new Uint8Array;let o=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(o.buffer).setUint32(0,t.byteLength,!1),WP([112,115,115,104],new Uint8Array([n,0,0,0]),i,s,r,o,t||new Uint8Array)}function KP(i){let e=[];if(i instanceof ArrayBuffer){let t=i.byteLength,n=0;for(;n+32<t;){let r=new DataView(i,n),s=YP(r);e.push(s),n+=s.size}}return e}function YP(i){let e=i.getUint32(0),t=i.byteOffset,n=i.byteLength;if(n<e)return{offset:t,size:n};if(i.getUint32(4)!==1886614376)return{offset:t,size:e};let s=i.getUint32(8)>>>24;if(s!==0&&s!==1)return{offset:t,size:e};let o=i.buffer,a=On.hexDump(new Uint8Array(o,t+12,16)),l=i.getUint32(28),c=null,u=null;if(s===0){if(e-32<l||l<22)return{offset:t,size:e};u=new Uint8Array(o,t+32,l)}else if(s===1){if(!l||n<t+32+l*16+16)return{offset:t,size:e};c=[];for(let d=0;d<l;d++)c.push(new Uint8Array(o,t+32+d*16,16))}return{version:s,systemId:a,kids:c,data:u,offset:t,size:e}}var Jc={},sa=class i{static clearKeyUriToKeyIdMap(){Jc={}}constructor(e,t,n,r=[1],s=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=n,this.keyFormatVersions=r,this.iv=s,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&e!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Tt.FAIRPLAY:case Tt.WIDEVINE:case Tt.PLAYREADY:case Tt.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof e!="number"&&(this.method==="AES-128"&&!this.iv&&D.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);let n=QP(e);return new i(this.method,this.uri,"identity",this.keyFormatVersions,n)}let t=DP(this.uri);if(t)switch(this.keyFormat){case Tt.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case Tt.PLAYREADY:{let n=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=qP(n,null,t);let r=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),s=String.fromCharCode.apply(null,Array.from(r)),o=s.substring(s.indexOf("<"),s.length),c=new DOMParser().parseFromString(o,"text/xml").getElementsByTagName("KID")[0];if(c){let u=c.childNodes[0]?c.childNodes[0].nodeValue:c.getAttribute("VALUE");if(u){let d=Hg(u).subarray(0,16);EP(d),this.keyId=d}}break}default:{let n=t.subarray(0,16);if(n.length!==16){let r=new Uint8Array(16);r.set(n,16-n.length),n=r}this.keyId=n;break}}if(!this.keyId||this.keyId.byteLength!==16){let n=Jc[this.uri];if(!n){let r=Object.keys(Jc).length%Number.MAX_SAFE_INTEGER;n=new Uint8Array(16),new DataView(n.buffer,12,4).setUint32(0,r),Jc[this.uri]=n}this.keyId=n}return this}};function QP(i){let e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=i>>8*(15-t)&255;return e}var zw=/\{\$([a-zA-Z0-9-_]+)\}/g;function zD(i){return zw.test(i)}function wt(i,e,t){if(i.variableList!==null||i.hasVariableRefs)for(let n=t.length;n--;){let r=t[n],s=e[r];s&&(e[r]=Bm(i,s))}}function Bm(i,e){if(i.variableList!==null||i.hasVariableRefs){let t=i.variableList;return e.replace(zw,n=>{let r=n.substring(2,n.length-1),s=t?.[r];return s===void 0?(i.playlistParsingError||(i.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),n):s})}return e}function WD(i,e,t){let n=i.variableList;n||(i.variableList=n={});let r,s;if("QUERYPARAM"in e){r=e.QUERYPARAM;try{let o=new self.URL(t).searchParams;if(o.has(r))s=o.get(r);else throw new Error(`"${r}" does not match any query parameter in URI: "${t}"`)}catch(o){i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else r=e.NAME,s=e.VALUE;r in n?i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):n[r]=s||""}function XP(i,e,t){let n=e.IMPORT;if(t&&n in t){let r=i.variableList;r||(i.variableList=r={}),r[n]=t[n]}else i.playlistParsingError||(i.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}function vr(i=!0){return typeof self>"u"?void 0:(i||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function ZP(i){return typeof self<"u"&&i===self.ManagedMediaSource}var yu={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function JP(i,e){let t=yu[e];return!!t&&!!t[i.slice(0,4)]}function bm(i,e,t=!0){return!i.split(",").some(n=>!Ww(n,e,t))}function Ww(i,e,t=!0){var n;let r=vr(t);return(n=r?.isTypeSupported(oa(i,e)))!=null?n:!1}function oa(i,e){return`${e}/mp4;codecs="${i}"`}function qD(i){if(i){let e=i.substring(0,4);return yu.video[e]}return 2}function bu(i){return i.split(",").reduce((e,t)=>{let n=yu.video[t];return n?(n*2+e)/(e?3:2):(yu.audio[t]+e)/(e?2:1)},0)}var _m={};function eF(i,e=!0){if(_m[i])return _m[i];let t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[i];for(let n=0;n<t.length;n++)if(Ww(t[n],"audio",e))return _m[i]=t[n],t[n];return i}var tF=/flac|opus/i;function _u(i,e=!0){return i.replace(tF,t=>eF(t.toLowerCase(),e))}function KD(i,e){return i&&i!=="mp4a"?i:e&&e.split(",")[0]}function nF(i){let e=i.split(",");for(let t=0;t<e.length;t++){let n=e[t].split(".");if(n.length>2){let r=n.shift()+".";r+=parseInt(n.shift()).toString(16),r+=("000"+parseInt(n.shift()).toString(16)).slice(-4),e[t]=r}}return e.join(",")}var YD=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,QD=/#EXT-X-MEDIA:(.*)/g,iF=/^#EXT(?:INF|-X-TARGETDURATION):/m,XD=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),rF=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),mr=class i{static findGroup(e,t){for(let n=0;n<e.length;n++){let r=e[n];if(r.id===t)return r}}static resolve(e,t){return $g.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return iF.test(e)}static parseMasterPlaylist(e,t){let n=zD(e),r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},s=[];YD.lastIndex=0;let o;for(;(o=YD.exec(e))!=null;)if(o[1]){var a;let c=new Ve(o[1]);wt(r,c,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);let u=Bm(r,o[2]),d={attrs:c,bitrate:c.decimalInteger("BANDWIDTH")||c.decimalInteger("AVERAGE-BANDWIDTH"),name:c.NAME,url:i.resolve(u,t)},h=c.decimalResolution("RESOLUTION");h&&(d.width=h.width,d.height=h.height),sF(c.CODECS,d),(a=d.unknownCodecs)!=null&&a.length||s.push(d),r.levels.push(d)}else if(o[3]){let c=o[3],u=o[4];switch(c){case"SESSION-DATA":{let d=new Ve(u);wt(r,d,["DATA-ID","LANGUAGE","VALUE","URI"]);let h=d["DATA-ID"];h&&(r.sessionData===null&&(r.sessionData={}),r.sessionData[h]=d);break}case"SESSION-KEY":{let d=ZD(u,t,r);d.encrypted&&d.isSupported()?(r.sessionKeys===null&&(r.sessionKeys=[]),r.sessionKeys.push(d)):D.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${u}"`);break}case"DEFINE":{{let d=new Ve(u);wt(r,d,["NAME","VALUE","QUERYPARAM"]),WD(r,d,t)}break}case"CONTENT-STEERING":{let d=new Ve(u);wt(r,d,["SERVER-URI","PATHWAY-ID"]),r.contentSteering={uri:i.resolve(d["SERVER-URI"],t),pathwayId:d["PATHWAY-ID"]||"."};break}case"START":{r.startTimeOffset=JD(u);break}}}let l=s.length>0&&s.length<r.levels.length;return r.levels=l?s:r.levels,r.levels.length===0&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(e,t,n){let r,s={},o=n.levels,a={AUDIO:o.map(c=>({id:c.attrs.AUDIO,audioCodec:c.audioCodec})),SUBTITLES:o.map(c=>({id:c.attrs.SUBTITLES,textCodec:c.textCodec})),"CLOSED-CAPTIONS":[]},l=0;for(QD.lastIndex=0;(r=QD.exec(e))!==null;){let c=new Ve(r[1]),u=c.TYPE;if(u){let d=a[u],h=s[u]||[];s[u]=h,wt(n,c,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);let f=c.LANGUAGE,p=c["ASSOC-LANGUAGE"],m=c.CHANNELS,g=c.CHARACTERISTICS,y=c["INSTREAM-ID"],_={attrs:c,bitrate:0,id:l++,groupId:c["GROUP-ID"]||"",name:c.NAME||f||"",type:u,default:c.bool("DEFAULT"),autoselect:c.bool("AUTOSELECT"),forced:c.bool("FORCED"),lang:f,url:c.URI?i.resolve(c.URI,t):""};if(p&&(_.assocLang=p),m&&(_.channels=m),g&&(_.characteristics=g),y&&(_.instreamId=y),d!=null&&d.length){let b=i.findGroup(d,_.groupId)||d[0];ew(_,b,"audioCodec"),ew(_,b,"textCodec")}h.push(_)}}return s}static parseLevelPlaylist(e,t,n,r,s,o){let a=new Pm(t),l=a.fragments,c=null,u=0,d=0,h=0,f=0,p=null,m=new na(r,t),g,y,_,b=-1,S=!1,E=null;for(XD.lastIndex=0,a.m3u8=e,a.hasVariableRefs=zD(e);(g=XD.exec(e))!==null;){S&&(S=!1,m=new na(r,t),m.start=h,m.sn=u,m.cc=f,m.level=n,c&&(m.initSegment=c,m.rawProgramDateTime=c.rawProgramDateTime,c.rawProgramDateTime=null,E&&(m.setByteRange(E),E=null)));let B=g[1];if(B){m.duration=parseFloat(B);let I=(" "+g[2]).slice(1);m.title=I||null,m.tagList.push(I?["INF",B,I]:["INF",B])}else if(g[3]){if(H(m.duration)){m.start=h,_&&iw(m,_,a),m.sn=u,m.level=n,m.cc=f,l.push(m);let I=(" "+g[3]).slice(1);m.relurl=Bm(a,I),tw(m,p),p=m,h+=m.duration,u++,d=0,S=!0}}else if(g[4]){let I=(" "+g[4]).slice(1);p?m.setByteRange(I,p):m.setByteRange(I)}else if(g[5])m.rawProgramDateTime=(" "+g[5]).slice(1),m.tagList.push(["PROGRAM-DATE-TIME",m.rawProgramDateTime]),b===-1&&(b=l.length);else{if(g=g[0].match(rF),!g){D.warn("No matches on slow regex match for level playlist!");continue}for(y=1;y<g.length&&!(typeof g[y]<"u");y++);let I=(" "+g[y]).slice(1),O=(" "+g[y+1]).slice(1),Y=g[y+2]?(" "+g[y+2]).slice(1):"";switch(I){case"PLAYLIST-TYPE":a.type=O.toUpperCase();break;case"MEDIA-SEQUENCE":u=a.startSN=parseInt(O);break;case"SKIP":{let $=new Ve(O);wt(a,$,["RECENTLY-REMOVED-DATERANGES"]);let ee=$.decimalInteger("SKIPPED-SEGMENTS");if(H(ee)){a.skippedSegments=ee;for(let A=ee;A--;)l.unshift(null);u+=ee}let J=$.enumeratedString("RECENTLY-REMOVED-DATERANGES");J&&(a.recentlyRemovedDateranges=J.split("	"));break}case"TARGETDURATION":a.targetduration=Math.max(parseInt(O),1);break;case"VERSION":a.version=parseInt(O);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":a.live=!1;break;case"#":(O||Y)&&m.tagList.push(Y?[O,Y]:[O]);break;case"DISCONTINUITY":f++,m.tagList.push(["DIS"]);break;case"GAP":m.gap=!0,m.tagList.push([I]);break;case"BITRATE":m.tagList.push([I,O]);break;case"DATERANGE":{let $=new Ve(O);wt(a,$,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),wt(a,$,$.clientAttrs);let ee=new mu($,a.dateRanges[$.ID]);ee.isValid||a.skippedSegments?a.dateRanges[ee.id]=ee:D.warn(`Ignoring invalid DATERANGE tag: "${O}"`),m.tagList.push(["EXT-X-DATERANGE",O]);break}case"DEFINE":{{let $=new Ve(O);wt(a,$,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in $?XP(a,$,o):WD(a,$,t)}break}case"DISCONTINUITY-SEQUENCE":f=parseInt(O);break;case"KEY":{let $=ZD(O,t,a);if($.isSupported()){if($.method==="NONE"){_=void 0;break}_||(_={}),_[$.keyFormat]&&(_=Ke({},_)),_[$.keyFormat]=$}else D.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${O}"`);break}case"START":a.startTimeOffset=JD(O);break;case"MAP":{let $=new Ve(O);if(wt(a,$,["BYTERANGE","URI"]),m.duration){let ee=new na(r,t);nw(ee,$,n,_),c=ee,m.initSegment=c,c.rawProgramDateTime&&!m.rawProgramDateTime&&(m.rawProgramDateTime=c.rawProgramDateTime)}else{let ee=m.byteRangeEndOffset;if(ee){let J=m.byteRangeStartOffset;E=`${ee-J}@${J}`}else E=null;nw(m,$,n,_),c=m,S=!0}break}case"SERVER-CONTROL":{let $=new Ve(O);a.canBlockReload=$.bool("CAN-BLOCK-RELOAD"),a.canSkipUntil=$.optionalFloat("CAN-SKIP-UNTIL",0),a.canSkipDateRanges=a.canSkipUntil>0&&$.bool("CAN-SKIP-DATERANGES"),a.partHoldBack=$.optionalFloat("PART-HOLD-BACK",0),a.holdBack=$.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{let $=new Ve(O);a.partTarget=$.decimalFloatingPoint("PART-TARGET");break}case"PART":{let $=a.partList;$||($=a.partList=[]);let ee=d>0?$[$.length-1]:void 0,J=d++,A=new Ve(O);wt(a,A,["BYTERANGE","URI"]);let F=new Nm(A,m,t,J,ee);$.push(F),m.duration+=F.duration;break}case"PRELOAD-HINT":{let $=new Ve(O);wt(a,$,["URI"]),a.preloadHint=$;break}case"RENDITION-REPORT":{let $=new Ve(O);wt(a,$,["URI"]),a.renditionReports=a.renditionReports||[],a.renditionReports.push($);break}default:D.warn(`line parsed but not handled: ${g}`);break}}}p&&!p.relurl?(l.pop(),h-=p.duration,a.partList&&(a.fragmentHint=p)):a.partList&&(tw(m,p),m.cc=f,a.fragmentHint=m,_&&iw(m,_,a));let x=l.length,w=l[0],R=l[x-1];if(h+=a.skippedSegments*a.targetduration,h>0&&x&&R){a.averagetargetduration=h/x;let B=R.sn;a.endSN=B!=="initSegment"?B:0,a.live||(R.endList=!0),w&&(a.startCC=w.cc)}else a.endSN=0,a.startCC=0;return a.fragmentHint&&(h+=a.fragmentHint.duration),a.totalduration=h,a.endCC=f,b>0&&oF(l,b),a}};function ZD(i,e,t){var n,r;let s=new Ve(i);wt(t,s,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);let o=(n=s.METHOD)!=null?n:"",a=s.URI,l=s.hexadecimalInteger("IV"),c=s.KEYFORMATVERSIONS,u=(r=s.KEYFORMAT)!=null?r:"identity";a&&s.IV&&!l&&D.error(`Invalid IV: ${s.IV}`);let d=a?mr.resolve(a,e):"",h=(c||"1").split("/").map(Number).filter(Number.isFinite);return new sa(o,d,u,h,l)}function JD(i){let t=new Ve(i).decimalFloatingPoint("TIME-OFFSET");return H(t)?t:null}function sF(i,e){let t=(i||"").split(/[ ,]+/).filter(n=>n);["video","audio","text"].forEach(n=>{let r=t.filter(s=>JP(s,n));r.length&&(e[`${n}Codec`]=r.join(","),t=t.filter(s=>r.indexOf(s)===-1))}),e.unknownCodecs=t}function ew(i,e,t){let n=e[t];n&&(i[t]=n)}function oF(i,e){let t=i[e];for(let n=e;n--;){let r=i[n];if(!r)return;r.programDateTime=t.programDateTime-r.duration*1e3,t=r}}function tw(i,e){i.rawProgramDateTime?i.programDateTime=Date.parse(i.rawProgramDateTime):e!=null&&e.programDateTime&&(i.programDateTime=e.endProgramDateTime),H(i.programDateTime)||(i.programDateTime=null,i.rawProgramDateTime=null)}function nw(i,e,t,n){i.relurl=e.URI,e.BYTERANGE&&i.setByteRange(e.BYTERANGE),i.level=t,i.sn="initSegment",n&&(i.levelkeys=n),i.initSegment=null}function iw(i,e,t){i.levelkeys=e;let{encryptedFragments:n}=t;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(r=>e[r].isCommonEncryption)&&n.push(i)}var De={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},K={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function rw(i){let{type:e}=i;switch(e){case De.AUDIO_TRACK:return K.AUDIO;case De.SUBTITLE_TRACK:return K.SUBTITLE;default:return K.MAIN}}function Em(i,e){let t=i.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}var Vm=class{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){let{hls:e}=this;e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.LEVEL_LOADING,this.onLevelLoading,this),e.on(v.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(v.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){let{hls:e}=this;e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.LEVEL_LOADING,this.onLevelLoading,this),e.off(v.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(v.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){let t=this.hls.config,n=t.pLoader,r=t.loader,s=n||r,o=new s(t);return this.loaders[e.type]=o,o}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(let e in this.loaders){let t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){let{url:n}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:De.MANIFEST,url:n,deliveryDirectives:null})}onLevelLoading(e,t){let{id:n,level:r,pathwayId:s,url:o,deliveryDirectives:a}=t;this.load({id:n,level:r,pathwayId:s,responseType:"text",type:De.LEVEL,url:o,deliveryDirectives:a})}onAudioTrackLoading(e,t){let{id:n,groupId:r,url:s,deliveryDirectives:o}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:De.AUDIO_TRACK,url:s,deliveryDirectives:o})}onSubtitleTrackLoading(e,t){let{id:n,groupId:r,url:s,deliveryDirectives:o}=t;this.load({id:n,groupId:r,level:null,responseType:"text",type:De.SUBTITLE_TRACK,url:s,deliveryDirectives:o})}load(e){var t;let n=this.hls.config,r=this.getInternalLoader(e);if(r){let c=r.context;if(c&&c.url===e.url&&c.level===e.level){D.trace("[playlist-loader]: playlist request ongoing");return}D.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}let s;if(e.type===De.MANIFEST?s=n.manifestLoadPolicy.default:s=Ke({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),H((t=e.deliveryDirectives)==null?void 0:t.part)){let c;if(e.type===De.LEVEL&&e.level!==null?c=this.hls.levels[e.level].details:e.type===De.AUDIO_TRACK&&e.id!==null?c=this.hls.audioTracks[e.id].details:e.type===De.SUBTITLE_TRACK&&e.id!==null&&(c=this.hls.subtitleTracks[e.id].details),c){let u=c.partTarget,d=c.targetduration;if(u&&d){let h=Math.max(u*3,d*.8)*1e3;s=Ke({},s,{maxTimeToFirstByteMs:Math.min(h,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(h,s.maxTimeToFirstByteMs)})}}}let o=s.errorRetry||s.timeoutRetry||{},a={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},l={onSuccess:(c,u,d,h)=>{let f=this.getInternalLoader(d);this.resetInternalLoader(d.type);let p=c.data;if(p.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(c,d,new Error("no EXTM3U delimiter"),h||null,u);return}u.parsing.start=performance.now(),mr.isMediaPlaylist(p)?this.handleTrackOrLevelPlaylist(c,u,d,h||null,f):this.handleMasterPlaylist(c,u,d,h)},onError:(c,u,d,h)=>{this.handleNetworkError(u,d,!1,c,h)},onTimeout:(c,u,d)=>{this.handleNetworkError(u,d,!0,void 0,c)}};r.load(e,a,l)}handleMasterPlaylist(e,t,n,r){let s=this.hls,o=e.data,a=Em(e,n),l=mr.parseMasterPlaylist(o,a);if(l.playlistParsingError){this.handleManifestParsingError(e,n,l.playlistParsingError,r,t);return}let{contentSteering:c,levels:u,sessionData:d,sessionKeys:h,startTimeOffset:f,variableList:p}=l;this.variableList=p;let{AUDIO:m=[],SUBTITLES:g,"CLOSED-CAPTIONS":y}=mr.parseMasterPlaylistMedia(o,a,l);m.length&&!m.some(b=>!b.url)&&u[0].audioCodec&&!u[0].attrs.AUDIO&&(D.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),m.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Ve({}),bitrate:0,url:""})),s.trigger(v.MANIFEST_LOADED,{levels:u,audioTracks:m,subtitles:g,captions:y,contentSteering:c,url:a,stats:t,networkDetails:r,sessionData:d,sessionKeys:h,startTimeOffset:f,variableList:p})}handleTrackOrLevelPlaylist(e,t,n,r,s){let o=this.hls,{id:a,level:l,type:c}=n,u=Em(e,n),d=0,h=H(l)?l:H(a)?a:0,f=rw(n),p=mr.parseLevelPlaylist(e.data,u,h,f,d,this.variableList);if(c===De.MANIFEST){let m={attrs:new Ve({}),bitrate:0,details:p,name:"",url:u};o.trigger(v.MANIFEST_LOADED,{levels:[m],audioTracks:[],url:u,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),n.levelDetails=p,this.handlePlaylistLoaded(p,e,t,n,r,s)}handleManifestParsingError(e,t,n,r,s){this.hls.trigger(v.ERROR,{type:Z.NETWORK_ERROR,details:T.MANIFEST_PARSING_ERROR,fatal:t.type===De.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:t,networkDetails:r,stats:s})}handleNetworkError(e,t,n=!1,r,s){let o=`A network ${n?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${e.type}`;e.type===De.LEVEL?o+=`: ${e.level} id: ${e.id}`:(e.type===De.AUDIO_TRACK||e.type===De.SUBTITLE_TRACK)&&(o+=` id: ${e.id} group-id: "${e.groupId}"`);let a=new Error(o);D.warn(`[playlist-loader]: ${o}`);let l=T.UNKNOWN,c=!1,u=this.getInternalLoader(e);switch(e.type){case De.MANIFEST:l=n?T.MANIFEST_LOAD_TIMEOUT:T.MANIFEST_LOAD_ERROR,c=!0;break;case De.LEVEL:l=n?T.LEVEL_LOAD_TIMEOUT:T.LEVEL_LOAD_ERROR,c=!1;break;case De.AUDIO_TRACK:l=n?T.AUDIO_TRACK_LOAD_TIMEOUT:T.AUDIO_TRACK_LOAD_ERROR,c=!1;break;case De.SUBTITLE_TRACK:l=n?T.SUBTITLE_TRACK_LOAD_TIMEOUT:T.SUBTITLE_LOAD_ERROR,c=!1;break}u&&this.resetInternalLoader(e.type);let d={type:Z.NETWORK_ERROR,details:l,fatal:c,url:e.url,loader:u,context:e,error:a,networkDetails:t,stats:s};if(r){let h=t?.url||e.url;d.response=rt({url:h,data:void 0},r)}this.hls.trigger(v.ERROR,d)}handlePlaylistLoaded(e,t,n,r,s,o){let a=this.hls,{type:l,level:c,id:u,groupId:d,deliveryDirectives:h}=r,f=Em(t,r),p=rw(r),m=typeof r.level=="number"&&p===K.MAIN?c:void 0;if(!e.fragments.length){let y=new Error("No Segments found in Playlist");a.trigger(v.ERROR,{type:Z.NETWORK_ERROR,details:T.LEVEL_EMPTY_ERROR,fatal:!1,url:f,error:y,reason:y.message,response:t,context:r,level:m,parent:p,networkDetails:s,stats:n});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));let g=e.playlistParsingError;if(g){a.trigger(v.ERROR,{type:Z.NETWORK_ERROR,details:T.LEVEL_PARSING_ERROR,fatal:!1,url:f,error:g,reason:g.message,response:t,context:r,level:m,parent:p,networkDetails:s,stats:n});return}switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case De.MANIFEST:case De.LEVEL:a.trigger(v.LEVEL_LOADED,{details:e,level:m||0,id:u||0,stats:n,networkDetails:s,deliveryDirectives:h});break;case De.AUDIO_TRACK:a.trigger(v.AUDIO_TRACK_LOADED,{details:e,id:u||0,groupId:d||"",stats:n,networkDetails:s,deliveryDirectives:h});break;case De.SUBTITLE_TRACK:a.trigger(v.SUBTITLE_TRACK_LOADED,{details:e,id:u||0,groupId:d||"",stats:n,networkDetails:s,deliveryDirectives:h});break}}};function qw(i,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=i,e.dispatchEvent(t)}function Kw(i,e){let t=i.mode;if(t==="disabled"&&(i.mode="hidden"),i.cues&&!i.cues.getCueById(e.id))try{if(i.addCue(e),!i.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){D.debug(`[texttrack-utils]: ${n}`);try{let r=new self.TextTrackCue(e.startTime,e.endTime,e.text);r.id=e.id,i.addCue(r)}catch(r){D.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${r}`)}}t==="disabled"&&(i.mode=t)}function _s(i){let e=i.mode;if(e==="disabled"&&(i.mode="hidden"),i.cues)for(let t=i.cues.length;t--;)i.removeCue(i.cues[t]);e==="disabled"&&(i.mode=e)}function Um(i,e,t,n){let r=i.mode;if(r==="disabled"&&(i.mode="hidden"),i.cues&&i.cues.length>0){let s=lF(i.cues,e,t);for(let o=0;o<s.length;o++)(!n||n(s[o]))&&i.removeCue(s[o])}r==="disabled"&&(i.mode=r)}function aF(i,e){if(e<i[0].startTime)return 0;let t=i.length-1;if(e>i[t].endTime)return-1;let n=0,r=t;for(;n<=r;){let s=Math.floor((r+n)/2);if(e<i[s].startTime)r=s-1;else if(e>i[s].startTime&&n<t)n=s+1;else return s}return i[n].startTime-e<e-i[r].startTime?n:r}function lF(i,e,t){let n=[],r=aF(i,e);if(r>-1)for(let s=r,o=i.length;s<o;s++){let a=i[s];if(a.startTime>=e&&a.endTime<=t)n.push(a);else if(a.startTime>t)return n}return n}function lu(i){let e=[];for(let t=0;t<i.length;t++){let n=i[t];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(i[t])}return e}var fn={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"},cF=.25;function jm(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function sw(i,e,t,n,r){let s=new i(e,t,"");try{s.value=n,r&&(s.type=r)}catch{s=new i(e,t,JSON.stringify(r?rt({type:r},n):n))}return s}var eu=(()=>{let i=jm();try{i&&new i(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function Dm(i,e){return i.getTime()/1e3-e}function uF(i){return Uint8Array.from(i.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}var $m=class{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){let{hls:e}=this;e.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(v.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(v.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){let{hls:e}=this;e.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(v.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(v.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(_s(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){let t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){let n=e[t];if(n.kind==="metadata"&&n.label==="id3")return qw(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;let{hls:{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:r}}}=this;if(!n&&!r)return;let{samples:s}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));let o=jm();if(o)for(let a=0;a<s.length;a++){let l=s[a].type;if(l===fn.emsg&&!n||!r)continue;let c=Fw(s[a].data);if(c){let u=s[a].pts,d=u+s[a].duration;d>eu&&(d=eu),d-u<=0&&(d=u+cF);for(let f=0;f<c.length;f++){let p=c[f];if(!Pw(p)){this.updateId3CueEnds(u,l);let m=sw(o,u,d,p,l);m&&this.id3Track.addCue(m)}}}}}updateId3CueEnds(e,t){var n;let r=(n=this.id3Track)==null?void 0:n.cues;if(r)for(let s=r.length;s--;){let o=r[s];o.type===t&&o.startTime<e&&o.endTime===eu&&(o.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:n,type:r}){let{id3Track:s,hls:o}=this;if(!o)return;let{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:l}}=o;if(s&&(a||l)){let c;r==="audio"?c=u=>u.type===fn.audioId3&&l:r==="video"?c=u=>u.type===fn.emsg&&a:c=u=>u.type===fn.audioId3&&l||u.type===fn.emsg&&a,Um(s,t,n,c)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;let{dateRangeCuesAppended:n,id3Track:r}=this,{dateRanges:s}=t,o=Object.keys(s);if(r){let u=Object.keys(n).filter(d=>!o.includes(d));for(let d=u.length;d--;){let h=u[d];Object.keys(n[h].cues).forEach(f=>{r.removeCue(n[h].cues[f])}),delete n[h]}}let a=t.fragments[t.fragments.length-1];if(o.length===0||!H(a?.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));let l=a.programDateTime/1e3-a.start,c=jm();for(let u=0;u<o.length;u++){let d=o[u],h=s[d],f=Dm(h.startDate,l),p=n[d],m=p?.cues||{},g=p?.durationKnown||!1,y=eu,_=h.endDate;if(_)y=Dm(_,l),g=!0;else if(h.endOnNext&&!g){let S=o.reduce((E,x)=>{if(x!==h.id){let w=s[x];if(w.class===h.class&&w.startDate>h.startDate&&(!E||h.startDate<E.startDate))return w}return E},null);S&&(y=Dm(S.startDate,l),g=!0)}let b=Object.keys(h.attr);for(let S=0;S<b.length;S++){let E=b[S];if(!vP(E))continue;let x=m[E];if(x)g&&!p.durationKnown&&(x.endTime=y);else if(c){let w=h.attr[E];yP(E)&&(w=uF(w));let R=sw(c,f,y,{key:E,data:w},fn.dateRange);R&&(R.id=d,this.id3Track.addCue(R),m[E]=R)}}n[d]={cues:m,dateRange:h,durationKnown:g}}}},Hm=class{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){let{config:e,levelDetails:t}=this;return e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){let{levelDetails:e}=this;if(e===null)return null;let{holdBack:t,partHoldBack:n,targetduration:r}=e,{liveSyncDuration:s,liveSyncDurationCount:o,lowLatencyMode:a}=this.config,l=this.hls.userConfig,c=a&&n||t;(l.liveSyncDuration||l.liveSyncDurationCount||c===0)&&(c=s!==void 0?s:o*r);let u=r;return c+Math.min(this.stallCount*1,u)}get liveSyncPosition(){let e=this.estimateLiveEdge(),t=this.targetLatency,n=this.levelDetails;if(e===null||t===null||n===null)return null;let r=n.edge,s=e-t-this.edgeStalled,o=r-n.totalduration,a=r-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(o,s),a)}get drift(){let{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){let{levelDetails:e}=this;if(e===null)return 0;let t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){let{media:e,levelDetails:t}=this;if(!e||!t)return 0;let n=e.buffered.length;return(n?e.buffered.end(n-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(v.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(v.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(v.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(v.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(v.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(v.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var n;t.details===T.BUFFER_STALLED_ERROR&&(this.stallCount++,(n=this.levelDetails)!=null&&n.live&&D.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){let{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;let n=this.computeLatency();if(n===null)return;this._latency=n;let{lowLatencyMode:r,maxLiveSyncPlaybackRate:s}=this.config;if(!r||s===1||!t.live)return;let o=this.targetLatency;if(o===null)return;let a=n-o,l=Math.min(this.maxLatency,o+t.targetduration);if(a<l&&a>.05&&this.forwardBufferLength>1){let u=Math.min(2,Math.max(1,s)),d=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20;e.playbackRate=Math.min(u,Math.max(1,d))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){let{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){let e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}},Gm=["NONE","TYPE-0","TYPE-1",null];function dF(i){return Gm.indexOf(i)>-1}var Eu=["SDR","PQ","HLG"];function hF(i){return!!i&&Eu.indexOf(i)>-1}var cu={No:"",Yes:"YES",v2:"v2"};function ow(i){let{canSkipUntil:e,canSkipDateRanges:t,age:n}=i,r=n<e/2;return e&&r?t?cu.v2:cu.Yes:cu.No}var Du=class{constructor(e,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=n}addDirectives(e){let t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}},Si=class{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>!!t).map(t=>t.substring(0,4)).join(","),this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return aw(this._audioGroups,e)}hasSubtitleGroup(e){return aw(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let n=this._audioGroups;n||(n=this._audioGroups=[]),n.indexOf(t)===-1&&n.push(t)}else if(e==="text"){let n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),n.indexOf(t)===-1&&n.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}};function aw(i,e){return!e||!i?!1:i.indexOf(e)!==-1}function wm(i,e){let t=e.startPTS;if(H(t)){let n=0,r;e.sn>i.sn?(n=t-i.start,r=i):(n=i.start-t,r=e),r.duration!==n&&(r.duration=n)}else e.sn>i.sn?i.cc===e.cc&&i.minEndPTS?e.start=i.start+(i.minEndPTS-i.start):e.start=i.start+i.duration:e.start=Math.max(i.start-e.duration,0)}function Yw(i,e,t,n,r,s){n-t<=0&&(D.warn("Fragment should have a positive duration",e),n=t+e.duration,s=r+e.duration);let a=t,l=n,c=e.startPTS,u=e.endPTS;if(H(c)){let g=Math.abs(c-t);H(e.deltaPTS)?e.deltaPTS=Math.max(g,e.deltaPTS):e.deltaPTS=g,a=Math.max(t,c),t=Math.min(t,c),r=Math.min(r,e.startDTS),l=Math.min(n,u),n=Math.max(n,u),s=Math.max(s,e.endDTS)}let d=t-e.start;e.start!==0&&(e.start=t),e.duration=n-e.start,e.startPTS=t,e.maxStartPTS=a,e.startDTS=r,e.endPTS=n,e.minEndPTS=l,e.endDTS=s;let h=e.sn;if(!i||h<i.startSN||h>i.endSN)return 0;let f,p=h-i.startSN,m=i.fragments;for(m[p]=e,f=p;f>0;f--)wm(m[f],m[f-1]);for(f=p;f<m.length-1;f++)wm(m[f],m[f+1]);return i.fragmentHint&&wm(m[m.length-1],i.fragmentHint),i.PTSKnown=i.alignedSliding=!0,d}function fF(i,e){let t=null,n=i.fragments;for(let l=n.length-1;l>=0;l--){let c=n[l].initSegment;if(c){t=c;break}}i.fragmentHint&&delete i.fragmentHint.endPTS;let r=0,s;if(gF(i,e,(l,c)=>{l.relurl&&(r=l.cc-c.cc),H(l.startPTS)&&H(l.endPTS)&&(c.start=c.startPTS=l.startPTS,c.startDTS=l.startDTS,c.maxStartPTS=l.maxStartPTS,c.endPTS=l.endPTS,c.endDTS=l.endDTS,c.minEndPTS=l.minEndPTS,c.duration=l.endPTS-l.startPTS,c.duration&&(s=c),e.PTSKnown=e.alignedSliding=!0),c.elementaryStreams=l.elementaryStreams,c.loader=l.loader,c.stats=l.stats,l.initSegment&&(c.initSegment=l.initSegment,t=l.initSegment)}),t&&(e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments).forEach(c=>{var u;c&&(!c.initSegment||c.initSegment.relurl===((u=t)==null?void 0:u.relurl))&&(c.initSegment=t)}),e.skippedSegments)if(e.deltaUpdateFailed=e.fragments.some(l=>!l),e.deltaUpdateFailed){D.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let l=e.skippedSegments;l--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}else e.canSkipDateRanges&&(e.dateRanges=pF(i.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));let o=e.fragments;if(r){D.warn("discontinuity sliding from playlist, take drift into account");for(let l=0;l<o.length;l++)o[l].cc+=r}e.skippedSegments&&(e.startCC=e.fragments[0].cc),mF(i.partList,e.partList,(l,c)=>{c.elementaryStreams=l.elementaryStreams,c.stats=l.stats}),s?Yw(e,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):Qw(i,e),o.length&&(e.totalduration=e.edge-o[0].start),e.driftStartTime=i.driftStartTime,e.driftStart=i.driftStart;let a=e.advancedDateTime;if(e.advanced&&a){let l=e.edge;e.driftStart||(e.driftStartTime=a,e.driftStart=l),e.driftEndTime=a,e.driftEnd=l}else e.driftEndTime=i.driftEndTime,e.driftEnd=i.driftEnd,e.advancedDateTime=i.advancedDateTime}function pF(i,e,t){let n=Ke({},i);return t&&t.forEach(r=>{delete n[r]}),Object.keys(e).forEach(r=>{let s=new mu(e[r].attr,n[r]);s.isValid?n[r]=s:D.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[r].attr)}"`)}),n}function mF(i,e,t){if(i&&e){let n=0;for(let r=0,s=i.length;r<=s;r++){let o=i[r],a=e[r+n];o&&a&&o.index===a.index&&o.fragment.sn===a.fragment.sn?t(o,a):n--}}}function gF(i,e,t){let n=e.skippedSegments,r=Math.max(i.startSN,e.startSN)-e.startSN,s=(i.fragmentHint?1:0)+(n?e.endSN:Math.min(i.endSN,e.endSN))-e.startSN,o=e.startSN-i.startSN,a=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=i.fragmentHint?i.fragments.concat(i.fragmentHint):i.fragments;for(let c=r;c<=s;c++){let u=l[o+c],d=a[c];n&&!d&&c<n&&(d=e.fragments[c]=u),u&&d&&t(u,d)}}function Qw(i,e){let t=e.startSN+e.skippedSegments-i.startSN,n=i.fragments;t<0||t>=n.length||zm(e,n[t].start)}function zm(i,e){if(e){let t=i.fragments;for(let n=i.skippedSegments;n<t.length;n++)t[n].start+=e;i.fragmentHint&&(i.fragmentHint.start+=e)}}function vF(i,e=1/0){let t=1e3*i.targetduration;if(i.updated){let n=i.fragments;if(n.length&&t*4>e){let s=n[n.length-1].duration*1e3;s<t&&(t=s)}}else t/=2;return Math.round(t)}function yF(i,e,t){if(!(i!=null&&i.details))return null;let n=i.details,r=n.fragments[e-n.startSN];return r||(r=n.fragmentHint,r&&r.sn===e)?r:e<n.startSN&&t&&t.sn===e?t:null}function lw(i,e,t){var n;return i!=null&&i.details?Xw((n=i.details)==null?void 0:n.partList,e,t):null}function Xw(i,e,t){if(i)for(let n=i.length;n--;){let r=i[n];if(r.index===t&&r.fragment.sn===e)return r}return null}function Zw(i){i.forEach((e,t)=>{let{details:n}=e;n!=null&&n.fragments&&n.fragments.forEach(r=>{r.level=t})})}function wu(i){switch(i.details){case T.FRAG_LOAD_TIMEOUT:case T.KEY_LOAD_TIMEOUT:case T.LEVEL_LOAD_TIMEOUT:case T.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function cw(i,e){let t=wu(e);return i.default[`${t?"timeout":"error"}Retry`]}function Wg(i,e){let t=i.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*i.retryDelayMs,i.maxRetryDelayMs)}function uw(i){return rt(rt({},i),{errorRetry:null,timeoutRetry:null})}function Su(i,e,t,n){if(!i)return!1;let r=n?.code,s=e<i.maxNumRetry&&(bF(r)||!!t);return i.shouldRetry?i.shouldRetry(i,e,t,n,s):s}function bF(i){return i===0&&navigator.onLine===!1||!!i&&(i<400||i>499)}var Jw={search:function(i,e){let t=0,n=i.length-1,r=null,s=null;for(;t<=n;){r=(t+n)/2|0,s=i[r];let o=e(s);if(o>0)t=r+1;else if(o<0)n=r-1;else return s}return null}};function _F(i,e,t){if(e===null||!Array.isArray(i)||!i.length||!H(e))return null;let n=i[0].programDateTime;if(e<(n||0))return null;let r=i[i.length-1].endProgramDateTime;if(e>=(r||0))return null;t=t||0;for(let s=0;s<i.length;++s){let o=i[s];if(DF(e,t,o))return o}return null}function Tu(i,e,t=0,n=0,r=.005){let s=null;if(i){s=e[i.sn-e[0].sn+1]||null;let a=i.endDTS-t;a>0&&a<15e-7&&(t+=15e-7)}else t===0&&e[0].start===0&&(s=e[0]);if(s&&((!i||i.level===s.level)&&Wm(t,n,s)===0||EF(s,i,Math.min(r,n))))return s;let o=Jw.search(e,Wm.bind(null,t,n));return o&&(o!==i||!s)?o:s}function EF(i,e,t){if(e&&e.start===0&&e.level<i.level&&(e.endPTS||0)>0){let n=e.tagList.reduce((r,s)=>(s[0]==="INF"&&(r+=parseFloat(s[1])),r),t);return i.start<=n}return!1}function Wm(i=0,e=0,t){if(t.start<=i&&t.start+t.duration>i)return 0;let n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=i?1:t.start-n>i&&t.start?-1:0}function DF(i,e,t){let n=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-n>i}function wF(i,e){return Jw.search(i,t=>t.cc<e?1:t.cc>e?-1:0)}var nt={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},un={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4},qm=class{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=D.log.bind(D,"[info]:"),this.warn=D.warn.bind(D,"[warning]:"),this.error=D.error.bind(D,"[error]:"),this.registerListeners()}registerListeners(){let e=this.hls;e.on(v.ERROR,this.onError,this),e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){let e=this.hls;e&&(e.off(v.ERROR,this.onError,this),e.off(v.ERROR,this.onErrorOut,this),e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return e?.type===K.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var n,r;if(t.fatal)return;let s=this.hls,o=t.context;switch(t.details){case T.FRAG_LOAD_ERROR:case T.FRAG_LOAD_TIMEOUT:case T.KEY_LOAD_ERROR:case T.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case T.FRAG_PARSING_ERROR:if((n=t.frag)!=null&&n.gap){t.errorAction={action:nt.DoNothing,flags:un.None};return}case T.FRAG_GAP:case T.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=nt.SendAlternateToPenaltyBox;return}case T.LEVEL_EMPTY_ERROR:case T.LEVEL_PARSING_ERROR:{var a,l;let c=t.parent===K.MAIN?t.level:s.loadLevel;t.details===T.LEVEL_EMPTY_ERROR&&((a=t.context)!=null&&(l=a.levelDetails)!=null&&l.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,c):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,c))}return;case T.LEVEL_LOAD_ERROR:case T.LEVEL_LOAD_TIMEOUT:typeof o?.level=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o.level));return;case T.AUDIO_TRACK_LOAD_ERROR:case T.AUDIO_TRACK_LOAD_TIMEOUT:case T.SUBTITLE_LOAD_ERROR:case T.SUBTITLE_TRACK_LOAD_TIMEOUT:if(o){let c=s.levels[s.loadLevel];if(c&&(o.type===De.AUDIO_TRACK&&c.hasAudioGroup(o.groupId)||o.type===De.SUBTITLE_TRACK&&c.hasSubtitleGroup(o.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.loadLevel),t.errorAction.action=nt.SendAlternateToPenaltyBox,t.errorAction.flags=un.MoveAllAlternatesMatchingHost;return}}return;case T.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{let c=s.levels[s.loadLevel],u=c?.attrs["HDCP-LEVEL"];u?t.errorAction={action:nt.SendAlternateToPenaltyBox,flags:un.MoveAllAlternatesMatchingHDCP,hdcpLevel:u}:this.keySystemError(t)}return;case T.BUFFER_ADD_CODEC_ERROR:case T.REMUX_ALLOC_ERROR:case T.BUFFER_APPEND_ERROR:t.errorAction=this.getLevelSwitchAction(t,(r=t.level)!=null?r:s.loadLevel);return;case T.INTERNAL_EXCEPTION:case T.BUFFER_APPENDING_ERROR:case T.BUFFER_FULL_ERROR:case T.LEVEL_SWITCH_ERROR:case T.BUFFER_STALLED_ERROR:case T.BUFFER_SEEK_OVER_HOLE:case T.BUFFER_NUDGE_ON_STALL:t.errorAction={action:nt.DoNothing,flags:un.None};return}t.type===Z.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){let t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){let n=this.hls,r=cw(n.config.playlistLoadPolicy,e),s=this.playlistError++;if(Su(r,s,wu(e),e.response))return{action:nt.RetryRequest,flags:un.None,retryConfig:r,retryCount:s};let a=this.getLevelSwitchAction(e,t);return r&&(a.retryConfig=r,a.retryCount=s),a}getFragRetryOrSwitchAction(e){let t=this.hls,n=this.getVariantLevelIndex(e.frag),r=t.levels[n],{fragLoadPolicy:s,keyLoadPolicy:o}=t.config,a=cw(e.details.startsWith("key")?o:s,e),l=t.levels.reduce((u,d)=>u+d.fragmentError,0);if(r&&(e.details!==T.FRAG_GAP&&r.fragmentError++,Su(a,l,wu(e),e.response)))return{action:nt.RetryRequest,flags:un.None,retryConfig:a,retryCount:l};let c=this.getLevelSwitchAction(e,n);return a&&(c.retryConfig=a,c.retryCount=l),c}getLevelSwitchAction(e,t){let n=this.hls;t==null&&(t=n.loadLevel);let r=this.hls.levels[t];if(r){var s,o;let c=e.details;r.loadError++,c===T.BUFFER_APPEND_ERROR&&r.fragmentError++;let u=-1,{levels:d,loadLevel:h,minAutoLevel:f,maxAutoLevel:p}=n;n.autoLevelEnabled||(n.loadLevel=-1);let m=(s=e.frag)==null?void 0:s.type,y=(m===K.AUDIO&&c===T.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(c===T.BUFFER_ADD_CODEC_ERROR||c===T.BUFFER_APPEND_ERROR))&&d.some(({audioCodec:x})=>r.audioCodec!==x),b=e.sourceBufferName==="video"&&(c===T.BUFFER_ADD_CODEC_ERROR||c===T.BUFFER_APPEND_ERROR)&&d.some(({codecSet:x,audioCodec:w})=>r.codecSet!==x&&r.audioCodec===w),{type:S,groupId:E}=(o=e.context)!=null?o:{};for(let x=d.length;x--;){let w=(x+h)%d.length;if(w!==h&&w>=f&&w<=p&&d[w].loadError===0){var a,l;let R=d[w];if(c===T.FRAG_GAP&&m===K.MAIN&&e.frag){let B=d[w].details;if(B){let I=Tu(e.frag,B.fragments,e.frag.start);if(I!=null&&I.gap)continue}}else{if(S===De.AUDIO_TRACK&&R.hasAudioGroup(E)||S===De.SUBTITLE_TRACK&&R.hasSubtitleGroup(E))continue;if(m===K.AUDIO&&(a=r.audioGroups)!=null&&a.some(B=>R.hasAudioGroup(B))||m===K.SUBTITLE&&(l=r.subtitleGroups)!=null&&l.some(B=>R.hasSubtitleGroup(B))||y&&r.audioCodec===R.audioCodec||!y&&r.audioCodec!==R.audioCodec||b&&r.codecSet===R.codecSet)continue}u=w;break}}if(u>-1&&n.loadLevel!==u)return e.levelRetry=!0,this.playlistError=0,{action:nt.SendAlternateToPenaltyBox,flags:un.None,nextAutoLevel:u}}return{action:nt.SendAlternateToPenaltyBox,flags:un.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var n;switch((n=t.errorAction)==null?void 0:n.action){case nt.DoNothing:break;case nt.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==T.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break;case nt.RetryRequest:break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){let t=this.hls,n=e.errorAction;if(!n)return;let{flags:r,hdcpLevel:s,nextAutoLevel:o}=n;switch(r){case un.None:this.switchLevel(e,o);break;case un.MoveAllAlternatesMatchingHDCP:s&&(t.maxHdcpLevel=Gm[Gm.indexOf(s)-1],n.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}n.resolved||this.switchLevel(e,o)}switchLevel(e,t){t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}},aa=class{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=D.log.bind(D,`${t}:`),this.warn=D.warn.bind(D,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,n){let r=t?.renditionReports;if(r){let s=-1;for(let o=0;o<r.length;o++){let a=r[o],l;try{l=new self.URL(a.URI,t.url).href}catch(c){D.warn(`Could not construct new URL for Rendition Report: ${c}`),l=a.URI||""}if(l===e){s=o;break}else l===e.substring(0,l.length)&&(s=o)}if(s!==-1){let o=r[s],a=parseInt(o["LAST-MSN"])||t?.lastPartSn,l=parseInt(o["LAST-PART"])||t?.lastPartIndex;if(this.hls.config.lowLatencyMode){let u=Math.min(t.age-t.partTarget,t.targetduration);l>=0&&u>t.partTarget&&(l+=1)}let c=n&&ow(n);return new Du(a,l>=0?l:void 0,c)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,n){let{details:r,stats:s}=t,o=self.performance.now(),a=s.loading.first?Math.max(0,o-s.loading.first):0;if(r.advancedDateTime=Date.now()-a,r.live||n!=null&&n.live){if(r.reloaded(n),n&&this.log(`live playlist ${e} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:r.updated?"UPDATED":"MISSED"}`),n&&r.fragments.length>0&&fF(n,r),!this.canLoad||!r.live)return;let l,c,u;if(r.canBlockReload&&r.endSN&&r.advanced){let g=this.hls.config.lowLatencyMode,y=r.lastPartSn,_=r.endSN,b=r.lastPartIndex,S=b!==-1,E=y===_,x=g?0:b;S?(c=E?_+1:y,u=E?x:b+1):c=_+1;let w=r.age,R=w+r.ageHeader,B=Math.min(R-r.partTarget,r.targetduration*1.5);if(B>0){if(n&&B>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${B} with playlist age: ${r.age}`),B=0;else{let I=Math.floor(B/r.targetduration);if(c+=I,u!==void 0){let O=Math.round(B%r.targetduration/r.partTarget);u+=O}this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${w.toFixed(2)}s goal: ${B} skip sn ${I} to part ${u}`)}r.tuneInGoal=B}if(l=this.getDeliveryDirectives(r,t.deliveryDirectives,c,u),g||!E){this.loadPlaylist(l);return}}else(r.canBlockReload||r.canSkipUntil)&&(l=this.getDeliveryDirectives(r,t.deliveryDirectives,c,u));let d=this.hls.mainForwardBufferInfo,h=d?d.end-d.len:0,f=(r.edge-h)*1e3,p=vF(r,f);r.updated&&o>this.requestScheduled+p&&(this.requestScheduled=s.loading.start),c!==void 0&&r.canBlockReload?this.requestScheduled=s.loading.first+p-(r.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+p<o?this.requestScheduled=o:this.requestScheduled-o<=0&&(this.requestScheduled+=p);let m=this.requestScheduled-o;m=Math.max(0,m),this.log(`reload live playlist ${e} in ${Math.round(m)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(l),m)}else this.clearTimer()}getDeliveryDirectives(e,t,n,r){let s=ow(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(n=t.msn,r=t.part,s=cu.No),new Du(n,r,s)}checkRetry(e){let t=e.details,n=wu(e),r=e.errorAction,{action:s,retryCount:o=0,retryConfig:a}=r||{},l=!!r&&!!a&&(s===nt.RetryRequest||!r.resolved&&s===nt.SendAlternateToPenaltyBox);if(l){var c;if(this.requestScheduled=-1,o>=a.maxNumRetry)return!1;if(n&&(c=e.context)!=null&&c.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{let u=Wg(a,o);this.timer=self.setTimeout(()=>this.loadPlaylist(),u),this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" in ${u}ms`)}e.levelRetry=!0,r.resolved=!0}return l}},wi=class{constructor(e,t=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=n}sample(e,t){let n=Math.pow(this.alpha_,e);this.estimate_=t*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){let e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}},Km=class{constructor(e,t,n,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new wi(e),this.fast_=new wi(t),this.defaultTTFB_=r,this.ttfb_=new wi(e)}update(e,t){let{slow_:n,fast_:r,ttfb_:s}=this;n.halfLife!==e&&(this.slow_=new wi(e,n.getEstimate(),n.getTotalWeight())),r.halfLife!==t&&(this.fast_=new wi(t,r.getEstimate(),r.getTotalWeight())),s.halfLife!==e&&(this.ttfb_=new wi(e,s.getEstimate(),s.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);let n=8*t,r=e/1e3,s=n/r;this.fast_.sample(r,s),this.slow_.sample(r,s)}sampleTTFB(e){let t=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}},eS={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},dw={};function SF(i,e,t,n,r,s){let o=i.audioCodec?i.audioGroups:null,a=s?.audioCodec,l=s?.channels,c=l?parseInt(l):a?1/0:2,u=null;if(o!=null&&o.length)try{o.length===1&&o[0]?u=e.groups[o[0]].channels:u=o.reduce((d,h)=>{if(h){let f=e.groups[h];if(!f)throw new Error(`Audio track group ${h} not found`);Object.keys(f.channels).forEach(p=>{d[p]=(d[p]||0)+f.channels[p]})}return d},{2:0})}catch{return!0}return i.videoCodec!==void 0&&(i.width>1920&&i.height>1088||i.height>1920&&i.width>1088||i.frameRate>Math.max(n,30)||i.videoRange!=="SDR"&&i.videoRange!==t||i.bitrate>Math.max(r,8e6))||!!u&&H(c)&&Object.keys(u).some(d=>parseInt(d)>c)}function TF(i,e,t){let n=i.videoCodec,r=i.audioCodec;if(!n||!r||!t)return Promise.resolve(eS);let s={width:i.width,height:i.height,bitrate:Math.ceil(Math.max(i.bitrate*.9,i.averageBitrate)),framerate:i.frameRate||30},o=i.videoRange;o!=="SDR"&&(s.transferFunction=o.toLowerCase());let a=n.split(",").map(l=>({type:"media-source",video:rt(rt({},s),{},{contentType:oa(l,"video")})}));return r&&i.audioGroups&&i.audioGroups.forEach(l=>{var c;l&&((c=e.groups[l])==null||c.tracks.forEach(u=>{if(u.groupId===l){let d=u.channels||"",h=parseFloat(d);H(h)&&h>2&&a.push.apply(a,r.split(",").map(f=>({type:"media-source",audio:{contentType:oa(f,"audio"),channels:""+h}})))}}))}),Promise.all(a.map(l=>{let c=xF(l);return dw[c]||(dw[c]=t.decodingInfo(l))})).then(l=>({supported:!l.some(c=>!c.supported),configurations:a,decodingInfoResults:l})).catch(l=>({supported:!1,configurations:a,decodingInfoResults:[],error:l}))}function xF(i){let{audio:e,video:t}=i,n=t||e;if(n){let r=n.contentType.split('"')[1];if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${r}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${r}`}return""}function IF(){if(typeof matchMedia=="function"){let i=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(i.media!==e.media)return i.matches===!0}return!1}function CF(i,e){let t=!1,n=[];return i&&(t=i!=="SDR",n=[i]),e&&(n=e.allowedVideoRanges||Eu.slice(0),t=e.preferHDR!==void 0?e.preferHDR:IF(),t?n=n.filter(r=>r!=="SDR"):n=["SDR"]),{preferHDR:t,allowedVideoRanges:n}}function AF(i,e,t,n,r){let s=Object.keys(i),o=n?.channels,a=n?.audioCodec,l=o&&parseInt(o)===2,c=!0,u=!1,d=1/0,h=1/0,f=1/0,p=0,m=[],{preferHDR:g,allowedVideoRanges:y}=CF(e,r);for(let E=s.length;E--;){let x=i[s[E]];c=x.channels[2]>0,d=Math.min(d,x.minHeight),h=Math.min(h,x.minFramerate),f=Math.min(f,x.minBitrate);let w=y.filter(R=>x.videoRanges[R]>0);w.length>0&&(u=!0,m=w)}d=H(d)?d:0,h=H(h)?h:0;let _=Math.max(1080,d),b=Math.max(30,h);return f=H(f)?f:t,t=Math.max(f,t),u||(e=void 0,m=[]),{codecSet:s.reduce((E,x)=>{let w=i[x];if(x===E)return E;if(w.minBitrate>t)return ei(x,`min bitrate of ${w.minBitrate} > current estimate of ${t}`),E;if(!w.hasDefaultAudio)return ei(x,"no renditions with default or auto-select sound found"),E;if(a&&x.indexOf(a.substring(0,4))%5!==0)return ei(x,`audio codec preference "${a}" not found`),E;if(o&&!l){if(!w.channels[o])return ei(x,`no renditions with ${o} channel sound found (channels options: ${Object.keys(w.channels)})`),E}else if((!a||l)&&c&&w.channels[2]===0)return ei(x,"no renditions with stereo sound found"),E;return w.minHeight>_?(ei(x,`min resolution of ${w.minHeight} > maximum of ${_}`),E):w.minFramerate>b?(ei(x,`min framerate of ${w.minFramerate} > maximum of ${b}`),E):m.some(R=>w.videoRanges[R]>0)?w.maxScore<p?(ei(x,`max score of ${w.maxScore} < selected max of ${p}`),E):E&&(bu(x)>=bu(E)||w.fragmentError>i[E].fragmentError)?E:(p=w.maxScore,x):(ei(x,`no variants with VIDEO-RANGE of ${JSON.stringify(m)} found`),E)},void 0),videoRanges:m,preferHDR:g,minFramerate:h,minBitrate:f}}function ei(i,e){D.log(`[abr] start candidates with "${i}" ignored because ${e}`)}function RF(i){return i.reduce((e,t)=>{let n=e.groups[t.groupId];n||(n=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(t);let r=t.channels||"2";return n.channels[r]=(n.channels[r]||0)+1,n.hasDefault=n.hasDefault||t.default,n.hasAutoSelect=n.hasAutoSelect||t.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function MF(i,e,t,n){return i.slice(t,n+1).reduce((r,s)=>{if(!s.codecSet)return r;let o=s.audioGroups,a=r[s.codecSet];a||(r[s.codecSet]=a={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!o,fragmentError:0}),a.minBitrate=Math.min(a.minBitrate,s.bitrate);let l=Math.min(s.height,s.width);return a.minHeight=Math.min(a.minHeight,l),a.minFramerate=Math.min(a.minFramerate,s.frameRate),a.maxScore=Math.max(a.maxScore,s.score),a.fragmentError+=s.fragmentError,a.videoRanges[s.videoRange]=(a.videoRanges[s.videoRange]||0)+1,o&&o.forEach(c=>{if(!c)return;let u=e.groups[c];u&&(a.hasDefaultAudio=a.hasDefaultAudio||e.hasDefaultAudio?u.hasDefault:u.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(u.channels).forEach(d=>{a.channels[d]=(a.channels[d]||0)+u.channels[d]}))}),r},{})}function Pn(i,e,t){if("attrs"in i){let n=e.indexOf(i);if(n!==-1)return n}for(let n=0;n<e.length;n++){let r=e[n];if(ws(i,r,t))return n}return-1}function ws(i,e,t){let{groupId:n,name:r,lang:s,assocLang:o,characteristics:a,default:l}=i,c=i.forced;return(n===void 0||e.groupId===n)&&(r===void 0||e.name===r)&&(s===void 0||e.lang===s)&&(s===void 0||e.assocLang===o)&&(l===void 0||e.default===l)&&(c===void 0||e.forced===c)&&(a===void 0||kF(a,e.characteristics))&&(t===void 0||t(i,e))}function kF(i,e=""){let t=i.split(","),n=e.split(",");return t.length===n.length&&!t.some(r=>n.indexOf(r)===-1)}function ms(i,e){let{audioCodec:t,channels:n}=i;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(n===void 0||n===(e.channels||"2"))}function LF(i,e,t,n,r){let s=e[n],a=e.reduce((h,f,p)=>{let m=f.uri;return(h[m]||(h[m]=[])).push(p),h},{})[s.uri];a.length>1&&(n=Math.max.apply(Math,a));let l=s.videoRange,c=s.frameRate,u=s.codecSet.substring(0,4),d=hw(e,n,h=>{if(h.videoRange!==l||h.frameRate!==c||h.codecSet.substring(0,4)!==u)return!1;let f=h.audioGroups,p=t.filter(m=>!f||f.indexOf(m.groupId)!==-1);return Pn(i,p,r)>-1});return d>-1?d:hw(e,n,h=>{let f=h.audioGroups,p=t.filter(m=>!f||f.indexOf(m.groupId)!==-1);return Pn(i,p,r)>-1})}function hw(i,e,t){for(let n=e;n;n--)if(t(i[n]))return n;for(let n=e+1;n<i.length;n++)if(t(i[n]))return n;return-1}var Ym=class{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{let{fragCurrent:t,partCurrent:n,hls:r}=this,{autoLevelEnabled:s,media:o}=r;if(!t||!o)return;let a=performance.now(),l=n?n.stats:t.stats,c=n?n.duration:t.duration,u=a-l.loading.start,d=r.minAutoLevel;if(l.aborted||l.loaded&&l.loaded===l.total||t.level<=d){this.clearTimer(),this._nextAutoLevel=-1;return}if(!s||o.paused||!o.playbackRate||!o.readyState)return;let h=r.mainForwardBufferInfo;if(h===null)return;let f=this.bwEstimator.getEstimateTTFB(),p=Math.abs(o.playbackRate);if(u<=Math.max(f,1e3*(c/(p*2))))return;let m=h.len/p,g=l.loading.first?l.loading.first-l.loading.start:-1,y=l.loaded&&g>-1,_=this.getBwEstimate(),b=r.levels,S=b[t.level],E=l.total||Math.max(l.loaded,Math.round(c*S.averageBitrate/8)),x=y?u-g:u;x<1&&y&&(x=Math.min(u,l.loaded*8/_));let w=y?l.loaded*1e3/x:0,R=w?(E-l.loaded)/w:E*8/_+f/1e3;if(R<=m)return;let B=w?w*8:_,I=Number.POSITIVE_INFINITY,O;for(O=t.level-1;O>d;O--){let $=b[O].maxBitrate;if(I=this.getTimeToLoadFrag(f/1e3,B,c*$,!b[O].details),I<m)break}if(I>=R||I>c*10)return;r.nextLoadLevel=r.nextAutoLevel=O,y?this.bwEstimator.sample(u-Math.min(f,g),l.loaded):this.bwEstimator.sampleTTFB(u);let Y=b[O].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>Y&&this.resetEstimator(Y),this.clearTimer(),D.warn(`[abr] Fragment ${t.sn}${n?" part "+n.index:""} of level ${t.level} is loading too slowly;
      Time to underbuffer: ${m.toFixed(3)} s
      Estimated load time for current fragment: ${R.toFixed(3)} s
      Estimated load time for down switch fragment: ${I.toFixed(3)} s
      TTFB estimate: ${g|0} ms
      Current BW estimate: ${H(_)?_|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${O} @ ${Y|0} bps`),r.trigger(v.FRAG_LOAD_EMERGENCY_ABORTED,{frag:t,part:n,stats:l})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(D.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){let e=this.hls.config;return new Km(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){let{hls:e}=this;e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.FRAG_LOADING,this.onFragLoading,this),e.on(v.FRAG_LOADED,this.onFragLoaded,this),e.on(v.FRAG_BUFFERED,this.onFragBuffered,this),e.on(v.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(v.LEVEL_LOADED,this.onLevelLoaded,this),e.on(v.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(v.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(v.ERROR,this.onError,this)}unregisterListeners(){let{hls:e}=this;e&&(e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.FRAG_LOADING,this.onFragLoading,this),e.off(v.FRAG_LOADED,this.onFragLoaded,this),e.off(v.FRAG_BUFFERED,this.onFragBuffered,this),e.off(v.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(v.LEVEL_LOADED,this.onLevelLoaded,this),e.off(v.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(v.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(v.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){let n=t.frag;if(!this.ignoreFragment(n)){if(!n.bitrateTest){var r;this.fragCurrent=n,this.partCurrent=(r=t.part)!=null?r:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case T.BUFFER_ADD_CODEC_ERROR:case T.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case T.FRAG_LOAD_TIMEOUT:{let n=t.frag,{fragCurrent:r,partCurrent:s}=this;if(n&&r&&n.sn===r.sn&&n.level===r.level){let o=performance.now(),a=s?s.stats:n.stats,l=o-a.loading.start,c=a.loading.first?a.loading.first-a.loading.start:-1;if(a.loaded&&c>-1){let d=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(l-Math.min(d,c),a.loaded)}else this.bwEstimator.sampleTTFB(l)}break}}}getTimeToLoadFrag(e,t,n,r){let s=e+n/t,o=r?this.lastLevelLoadSec:0;return s+o}onLevelLoaded(e,t){let n=this.hls.config,{loading:r}=t.stats,s=r.end-r.start;H(s)&&(this.lastLevelLoadSec=s/1e3),t.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD)}onFragLoaded(e,{frag:t,part:n}){let r=n?n.stats:t.stats;if(t.type===K.MAIN&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){let s=n?n.duration:t.duration,o=this.hls.levels[t.level],a=(o.loaded?o.loaded.bytes:0)+r.loaded,l=(o.loaded?o.loaded.duration:0)+s;o.loaded={bytes:a,duration:l},o.realBitrate=Math.round(8*a/l)}if(t.bitrateTest){let s={stats:r,frag:t,part:n,id:t.type};this.onFragBuffered(v.FRAG_BUFFERED,s),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){let{frag:n,part:r}=t,s=r!=null&&r.stats.loaded?r.stats:n.stats;if(s.aborted||this.ignoreFragment(n))return;let o=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,s.loaded),s.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==K.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){let{maxAutoLevel:e,minAutoLevel:t}=this.hls,n=this.getBwEstimate(),r=this.hls.config.maxStarvationDelay,s=this.findBestLevel(n,t,e,0,r,1,1);if(s>-1)return s;let o=this.hls.firstLevel,a=Math.min(Math.max(o,t),e);return D.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${o} clamped to ${a}`),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){let e=this.forcedAutoLevel,n=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(e!==-1&&(!n||!r||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;let s=n&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){let o=this.hls.levels;if(o.length>Math.max(e,s)&&o[e].loadError<=o[s].loadError)return e}return this._nextAutoLevel=s,this.nextAutoLevelKey=this.getAutoLevelKey(),s}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){let{fragCurrent:e,partCurrent:t,hls:n}=this,{maxAutoLevel:r,config:s,minAutoLevel:o}=n,a=t?t.duration:e?e.duration:0,l=this.getBwEstimate(),c=this.getStarvationDelay(),u=s.abrBandWidthFactor,d=s.abrBandWidthUpFactor;if(c){let g=this.findBestLevel(l,o,r,c,0,u,d);if(g>=0)return g}let h=a?Math.min(a,s.maxStarvationDelay):s.maxStarvationDelay;if(!c){let g=this.bitrateTestDelay;g&&(h=(a?Math.min(a,s.maxLoadingDelay):s.maxLoadingDelay)-g,D.info(`[abr] bitrate test took ${Math.round(1e3*g)}ms, set first fragment max fetchDuration to ${Math.round(1e3*h)} ms`),u=d=1)}let f=this.findBestLevel(l,o,r,c,h,u,d);if(D.info(`[abr] ${c?"rebuffering expected":"buffer is empty"}, optimal quality level ${f}`),f>-1)return f;let p=n.levels[o],m=n.levels[n.loadLevel];return p?.bitrate<m?.bitrate?o:n.loadLevel}getStarvationDelay(){let e=this.hls,t=e.media;if(!t)return 1/0;let n=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,r=e.mainForwardBufferInfo;return(r?r.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,n,r,s,o,a){var l;let c=r+s,u=this.lastLoadedFragLevel,d=u===-1?this.hls.firstLevel:u,{fragCurrent:h,partCurrent:f}=this,{levels:p,allAudioTracks:m,loadLevel:g,config:y}=this.hls;if(p.length===1)return 0;let _=p[d],b=!!(_!=null&&(l=_.details)!=null&&l.live),S=g===-1||u===-1,E,x="SDR",w=_?.frameRate||0,{audioPreference:R,videoPreference:B}=y,I=this.audioTracksByGroup||(this.audioTracksByGroup=RF(m));if(S){if(this.firstSelection!==-1)return this.firstSelection;let J=this.codecTiers||(this.codecTiers=MF(p,I,t,n)),A=AF(J,x,e,R,B),{codecSet:F,videoRanges:U,minFramerate:k,minBitrate:P,preferHDR:ae}=A;E=F,x=ae?U[U.length-1]:U[0],w=k,e=Math.max(e,P),D.log(`[abr] picked start tier ${JSON.stringify(A)}`)}else E=_?.codecSet,x=_?.videoRange;let O=f?f.duration:h?h.duration:0,Y=this.bwEstimator.getEstimateTTFB()/1e3,$=[];for(let J=n;J>=t;J--){var ee;let A=p[J],F=J>d;if(!A)continue;if(y.useMediaCapabilities&&!A.supportedResult&&!A.supportedPromise){let ie=navigator.mediaCapabilities;typeof ie?.decodingInfo=="function"&&SF(A,I,x,w,e,R)?(A.supportedPromise=TF(A,I,ie),A.supportedPromise.then($e=>{if(!this.hls)return;A.supportedResult=$e;let Ye=this.hls.levels,xe=Ye.indexOf(A);$e.error?D.warn(`[abr] MediaCapabilities decodingInfo error: "${$e.error}" for level ${xe} ${JSON.stringify($e)}`):$e.supported||(D.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${xe} ${JSON.stringify($e)}`),xe>-1&&Ye.length>1&&(D.log(`[abr] Removing unsupported level ${xe}`),this.hls.removeLevel(xe)))})):A.supportedResult=eS}if(E&&A.codecSet!==E||x&&A.videoRange!==x||F&&w>A.frameRate||!F&&w>0&&w<A.frameRate||A.supportedResult&&!((ee=A.supportedResult.decodingInfoResults)!=null&&ee[0].smooth)){$.push(J);continue}let U=A.details,k=(f?U?.partTarget:U?.averagetargetduration)||O,P;F?P=a*e:P=o*e;let ae=O&&r>=O*2&&s===0?p[J].averageBitrate:p[J].maxBitrate,z=this.getTimeToLoadFrag(Y,P,ae*k,U===void 0);if(P>=ae&&(J===u||A.loadError===0&&A.fragmentError===0)&&(z<=Y||!H(z)||b&&!this.bitrateTestDelay||z<c)){let ie=this.forcedAutoLevel;return J!==g&&(ie===-1||ie!==g)&&($.length&&D.trace(`[abr] Skipped level(s) ${$.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${p[$[0]].codecs}" ${p[$[0]].videoRange}; not compatible with "${_.codecs}" ${x}`),D.info(`[abr] switch candidate:${d}->${J} adjustedbw(${Math.round(P)})-bitrate=${Math.round(P-ae)} ttfb:${Y.toFixed(1)} avgDuration:${k.toFixed(1)} maxFetchDuration:${c.toFixed(1)} fetchDuration:${z.toFixed(1)} firstSelection:${S} codecSet:${E} videoRange:${x} hls.loadLevel:${g}`)),S&&(this.firstSelection=J),J}}return-1}set nextAutoLevel(e){let{maxAutoLevel:t,minAutoLevel:n}=this.hls,r=Math.min(Math.max(e,n),t);this._nextAutoLevel!==r&&(this.nextAutoLevelKey="",this._nextAutoLevel=r)}},Qm=class{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}},it={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"},Xm=class{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){let{hls:e}=this;e.on(v.BUFFER_APPENDED,this.onBufferAppended,this),e.on(v.FRAG_BUFFERED,this.onFragBuffered,this),e.on(v.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){let{hls:e}=this;e.off(v.BUFFER_APPENDED,this.onBufferAppended,this),e.off(v.FRAG_BUFFERED,this.onFragBuffered,this),e.off(v.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){let n=this.activePartLists[t];if(n)for(let r=n.length;r--;){let s=n[r];if(!s)break;let o=s.end;if(s.start<=e&&o!==null&&e<=o)return s}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){let{fragments:n}=this,r=Object.keys(n);for(let s=r.length;s--;){let o=n[r[s]];if(o?.body.type===t&&o.buffered){let a=o.body;if(a.start<=e&&e<=a.end)return a}}return null}detectEvictedFragments(e,t,n,r){this.timeRanges&&(this.timeRanges[e]=t);let s=r?.fragment.sn||-1;Object.keys(this.fragments).forEach(o=>{let a=this.fragments[o];if(!a||s>=a.body.sn)return;if(!a.buffered&&!a.loaded){a.body.type===n&&this.removeFragment(a.body);return}let l=a.range[e];l&&l.time.some(c=>{let u=!this.isTimeBuffered(c.startPTS,c.endPTS,t);return u&&this.removeFragment(a.body),u})})}detectPartialFragments(e){let t=this.timeRanges,{frag:n,part:r}=e;if(!t||n.sn==="initSegment")return;let s=gs(n),o=this.fragments[s];if(!o||o.buffered&&n.gap)return;let a=!n.relurl;Object.keys(t).forEach(l=>{let c=n.elementaryStreams[l];if(!c)return;let u=t[l],d=a||c.partial===!0;o.range[l]=this.getBufferedTimes(n,r,d,u)}),o.loaded=null,Object.keys(o.range).length?(o.buffered=!0,(o.body.endList=n.endList||o.body.endList)&&(this.endListFragments[o.body.type]=o),tu(o)||this.removeParts(n.sn-1,n.type)):this.removeFragment(o.body)}removeParts(e,t){let n=this.activePartLists[t];n&&(this.activePartLists[t]=n.filter(r=>r.fragment.sn>=e))}fragBuffered(e,t){let n=gs(e),r=this.fragments[n];!r&&t&&(r=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,r.buffered=!0)}getBufferedTimes(e,t,n,r){let s={time:[],partial:n},o=e.start,a=e.end,l=e.minEndPTS||a,c=e.maxStartPTS||o;for(let u=0;u<r.length;u++){let d=r.start(u)-this.bufferPadding,h=r.end(u)+this.bufferPadding;if(c>=d&&l<=h){s.time.push({startPTS:Math.max(o,r.start(u)),endPTS:Math.min(a,r.end(u))});break}else if(o<h&&a>d){let f=Math.max(o,r.start(u)),p=Math.min(a,r.end(u));p>f&&(s.partial=!0,s.time.push({startPTS:f,endPTS:p}))}else if(a<=d)break}return s}getPartialFragment(e){let t=null,n,r,s,o=0,{bufferPadding:a,fragments:l}=this;return Object.keys(l).forEach(c=>{let u=l[c];u&&tu(u)&&(r=u.body.start-a,s=u.body.end+a,e>=r&&e<=s&&(n=Math.min(e-r,s-e),o<=n&&(t=u.body,o=n)))}),t}isEndListAppended(e){let t=this.endListFragments[e];return t!==void 0&&(t.buffered||tu(t))}getState(e){let t=gs(e),n=this.fragments[t];return n?n.buffered?tu(n)?it.PARTIAL:it.OK:it.APPENDING:it.NOT_LOADED}isTimeBuffered(e,t,n){let r,s;for(let o=0;o<n.length;o++){if(r=n.start(o)-this.bufferPadding,s=n.end(o)+this.bufferPadding,e>=r&&t<=s)return!0;if(t<=r)return!1}return!1}onFragLoaded(e,t){let{frag:n,part:r}=t;if(n.sn==="initSegment"||n.bitrateTest)return;let s=r?null:t,o=gs(n);this.fragments[o]={body:n,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){let{frag:n,part:r,timeRanges:s}=t;if(n.sn==="initSegment")return;let o=n.type;if(r){let a=this.activePartLists[o];a||(this.activePartLists[o]=a=[]),a.push(r)}this.timeRanges=s,Object.keys(s).forEach(a=>{let l=s[a];this.detectEvictedFragments(a,l,o,r)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){let t=gs(e);return!!this.fragments[t]}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,n,r,s){r&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{let a=this.fragments[o];if(!a)return;let l=a.body;l.type!==n||r&&!l.gap||l.start<t&&l.end>e&&(a.buffered||s)&&this.removeFragment(l)})}removeFragment(e){let t=gs(e);e.stats.loaded=0,e.clearElementaryStreamInfo();let n=this.activePartLists[e.type];if(n){let r=e.sn;this.activePartLists[e.type]=n.filter(s=>s.fragment.sn!==r)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}};function tu(i){var e,t,n;return i.buffered&&(i.body.gap||((e=i.range.video)==null?void 0:e.partial)||((t=i.range.audio)==null?void 0:t.partial)||((n=i.range.audiovideo)==null?void 0:n.partial))}function gs(i){return`${i.type}_${i.level}_${i.sn}`}var OF={length:0,start:()=>0,end:()=>0},Fe=class i{static isBuffered(e,t){try{if(e){let n=i.getBuffered(e);for(let r=0;r<n.length;r++)if(t>=n.start(r)&&t<=n.end(r))return!0}}catch{}return!1}static bufferInfo(e,t,n){try{if(e){let r=i.getBuffered(e),s=[],o;for(o=0;o<r.length;o++)s.push({start:r.start(o),end:r.end(o)});return this.bufferedInfo(s,t,n)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,n){t=Math.max(0,t),e.sort(function(c,u){let d=c.start-u.start;return d||u.end-c.end});let r=[];if(n)for(let c=0;c<e.length;c++){let u=r.length;if(u){let d=r[u-1].end;e[c].start-d<n?e[c].end>d&&(r[u-1].end=e[c].end):r.push(e[c])}else r.push(e[c])}else r=e;let s=0,o,a=t,l=t;for(let c=0;c<r.length;c++){let u=r[c].start,d=r[c].end;if(t+n>=u&&t<d)a=u,l=d,s=l-t;else if(t+n<u){o=u;break}}return{len:s,start:a||0,end:l||0,nextStart:o}}static getBuffered(e){try{return e.buffered}catch(t){return D.log("failed to get media.buffered",t),OF}}},la=class{constructor(e,t,n,r=0,s=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=nu(),this.buffering={audio:nu(),video:nu(),audiovideo:nu()},this.level=e,this.sn=t,this.id=n,this.size=r,this.part=s,this.partial=o}};function nu(){return{start:0,executeStart:0,executeEnd:0,end:0}}function uu(i,e){for(let n=0,r=i.length;n<r;n++){var t;if(((t=i[n])==null?void 0:t.cc)===e)return i[n]}return null}function NF(i,e,t){return!!(e&&(t.endCC>t.startCC||i&&i.cc<t.startCC))}function PF(i,e){let t=i.fragments,n=e.fragments;if(!n.length||!t.length){D.log("No fragments to align");return}let r=uu(t,n[0].cc);if(!r||r&&!r.startPTS){D.log("No frag in previous level to align on");return}return r}function fw(i,e){if(i){let t=i.start+e;i.start=i.startPTS=t,i.endPTS=t+i.duration}}function tS(i,e){let t=e.fragments;for(let n=0,r=t.length;n<r;n++)fw(t[n],i);e.fragmentHint&&fw(e.fragmentHint,i),e.alignedSliding=!0}function FF(i,e,t){e&&(BF(i,t,e),!t.alignedSliding&&e&&xu(t,e),!t.alignedSliding&&e&&!t.skippedSegments&&Qw(e,t))}function BF(i,e,t){if(NF(i,t,e)){let n=PF(t,e);n&&H(n.start)&&(D.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),tS(n.start,e))}}function xu(i,e){if(!i.hasProgramDateTime||!e.hasProgramDateTime)return;let t=i.fragments,n=e.fragments;if(!t.length||!n.length)return;let r,s,o=Math.min(e.endCC,i.endCC);e.startCC<o&&i.startCC<o&&(r=uu(n,o),s=uu(t,o)),(!r||!s)&&(r=n[Math.floor(n.length/2)],s=uu(t,r.cc)||t[Math.floor(t.length/2)]);let a=r.programDateTime,l=s.programDateTime;if(!a||!l)return;let c=(l-a)/1e3-(s.start-r.start);tS(c,i)}var pw=Math.pow(2,17),Zm=class{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){let n=e.url;if(!n)return Promise.reject(new hn({type:Z.NETWORK_ERROR,details:T.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();let r=this.config,s=r.fLoader,o=r.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(f=>f[0]==="GAP")){l(gw(e));return}else e.gap=!1;let c=this.loader=e.loader=s?new s(r):new o(r),u=mw(e),d=uw(r.fragLoadPolicy.default),h={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:pw};e.stats=c.stats,c.load(u,h,{onSuccess:(f,p,m,g)=>{this.resetLoader(e,c);let y=f.data;m.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(y.slice(0,16)),y=y.slice(16)),a({frag:e,part:null,payload:y,networkDetails:g})},onError:(f,p,m,g)=>{this.resetLoader(e,c),l(new hn({type:Z.NETWORK_ERROR,details:T.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:rt({url:n,data:void 0},f),error:new Error(`HTTP Error ${f.code} ${f.text}`),networkDetails:m,stats:g}))},onAbort:(f,p,m)=>{this.resetLoader(e,c),l(new hn({type:Z.NETWORK_ERROR,details:T.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:m,stats:f}))},onTimeout:(f,p,m)=>{this.resetLoader(e,c),l(new hn({type:Z.NETWORK_ERROR,details:T.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:m,stats:f}))},onProgress:(f,p,m,g)=>{t&&t({frag:e,part:null,payload:m,networkDetails:g})}})})}loadPart(e,t,n){this.abort();let r=this.config,s=r.fLoader,o=r.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){l(gw(e,t));return}let c=this.loader=e.loader=s?new s(r):new o(r),u=mw(e,t),d=uw(r.fragLoadPolicy.default),h={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:pw};t.stats=c.stats,c.load(u,h,{onSuccess:(f,p,m,g)=>{this.resetLoader(e,c),this.updateStatsFromPart(e,t);let y={frag:e,part:t,payload:f.data,networkDetails:g};n(y),a(y)},onError:(f,p,m,g)=>{this.resetLoader(e,c),l(new hn({type:Z.NETWORK_ERROR,details:T.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:rt({url:u.url,data:void 0},f),error:new Error(`HTTP Error ${f.code} ${f.text}`),networkDetails:m,stats:g}))},onAbort:(f,p,m)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,c),l(new hn({type:Z.NETWORK_ERROR,details:T.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:m,stats:f}))},onTimeout:(f,p,m)=>{this.resetLoader(e,c),l(new hn({type:Z.NETWORK_ERROR,details:T.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:m,stats:f}))}})})}updateStatsFromPart(e,t){let n=e.stats,r=t.stats,s=r.total;if(n.loaded+=r.loaded,s){let l=Math.round(e.duration/t.duration),c=Math.min(Math.round(n.loaded/s),l),d=(l-c)*Math.round(n.loaded/c);n.total=n.loaded+d}else n.total=Math.max(n.loaded,n.total);let o=n.loading,a=r.loading;o.start?o.first+=a.first-a.start:(o.start=a.start,o.first=a.first),o.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}};function mw(i,e=null){let t=e||i,n={frag:i,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},r=t.byteRangeStartOffset,s=t.byteRangeEndOffset;if(H(r)&&H(s)){var o;let a=r,l=s;if(i.sn==="initSegment"&&((o=i.decryptdata)==null?void 0:o.method)==="AES-128"){let c=s-r;c%16&&(l=s+(16-c%16)),r!==0&&(n.resetIV=!0,a=r-16)}n.rangeStart=a,n.rangeEnd=l}return n}function gw(i,e){let t=new Error(`GAP ${i.gap?"tag":"attribute"} found`),n={type:Z.MEDIA_ERROR,details:T.FRAG_GAP,fatal:!1,frag:i,error:t,networkDetails:null};return e&&(n.part=e),(e||i).stats.aborted=!0,new hn(n)}var hn=class extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}},Jm=class{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}},eg=class{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}};function VF(i){let e=i.byteLength,t=e&&new DataView(i.buffer).getUint8(e-1);return t?gr(i,0,e-t):i}var tg=class{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){let t=new DataView(e),n=new Uint32Array(4);for(let r=0;r<4;r++)n[r]=t.getUint32(r*4);return n}initTable(){let e=this.sBox,t=this.invSBox,n=this.subMix,r=n[0],s=n[1],o=n[2],a=n[3],l=this.invSubMix,c=l[0],u=l[1],d=l[2],h=l[3],f=new Uint32Array(256),p=0,m=0,g=0;for(g=0;g<256;g++)g<128?f[g]=g<<1:f[g]=g<<1^283;for(g=0;g<256;g++){let y=m^m<<1^m<<2^m<<3^m<<4;y=y>>>8^y&255^99,e[p]=y,t[y]=p;let _=f[p],b=f[_],S=f[b],E=f[y]*257^y*16843008;r[p]=E<<24|E>>>8,s[p]=E<<16|E>>>16,o[p]=E<<8|E>>>24,a[p]=E,E=S*16843009^b*65537^_*257^p*16843008,c[y]=E<<24|E>>>8,u[y]=E<<16|E>>>16,d[y]=E<<8|E>>>24,h[y]=E,p?(p=_^f[f[f[S^_]]],m^=f[f[m]]):p=m=1}}expandKey(e){let t=this.uint8ArrayToUint32Array_(e),n=!0,r=0;for(;r<t.length&&n;)n=t[r]===this.key[r],r++;if(n)return;this.key=t;let s=this.keySize=t.length;if(s!==4&&s!==6&&s!==8)throw new Error("Invalid aes key size="+s);let o=this.ksRows=(s+6+1)*4,a,l,c=this.keySchedule=new Uint32Array(o),u=this.invKeySchedule=new Uint32Array(o),d=this.sBox,h=this.rcon,f=this.invSubMix,p=f[0],m=f[1],g=f[2],y=f[3],_,b;for(a=0;a<o;a++){if(a<s){_=c[a]=t[a];continue}b=_,a%s===0?(b=b<<8|b>>>24,b=d[b>>>24]<<24|d[b>>>16&255]<<16|d[b>>>8&255]<<8|d[b&255],b^=h[a/s|0]<<24):s>6&&a%s===4&&(b=d[b>>>24]<<24|d[b>>>16&255]<<16|d[b>>>8&255]<<8|d[b&255]),c[a]=_=(c[a-s]^b)>>>0}for(l=0;l<o;l++)a=o-l,l&3?b=c[a]:b=c[a-4],l<4||a<=4?u[l]=b:u[l]=p[d[b>>>24]]^m[d[b>>>16&255]]^g[d[b>>>8&255]]^y[d[b&255]],u[l]=u[l]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,n){let r=this.keySize+6,s=this.invKeySchedule,o=this.invSBox,a=this.invSubMix,l=a[0],c=a[1],u=a[2],d=a[3],h=this.uint8ArrayToUint32Array_(n),f=h[0],p=h[1],m=h[2],g=h[3],y=new Int32Array(e),_=new Int32Array(y.length),b,S,E,x,w,R,B,I,O,Y,$,ee,J,A,F=this.networkToHostOrderSwap;for(;t<y.length;){for(O=F(y[t]),Y=F(y[t+1]),$=F(y[t+2]),ee=F(y[t+3]),w=O^s[0],R=ee^s[1],B=$^s[2],I=Y^s[3],J=4,A=1;A<r;A++)b=l[w>>>24]^c[R>>16&255]^u[B>>8&255]^d[I&255]^s[J],S=l[R>>>24]^c[B>>16&255]^u[I>>8&255]^d[w&255]^s[J+1],E=l[B>>>24]^c[I>>16&255]^u[w>>8&255]^d[R&255]^s[J+2],x=l[I>>>24]^c[w>>16&255]^u[R>>8&255]^d[B&255]^s[J+3],w=b,R=S,B=E,I=x,J=J+4;b=o[w>>>24]<<24^o[R>>16&255]<<16^o[B>>8&255]<<8^o[I&255]^s[J],S=o[R>>>24]<<24^o[B>>16&255]<<16^o[I>>8&255]<<8^o[w&255]^s[J+1],E=o[B>>>24]<<24^o[I>>16&255]<<16^o[w>>8&255]<<8^o[R&255]^s[J+2],x=o[I>>>24]<<24^o[w>>16&255]<<16^o[R>>8&255]<<8^o[B&255]^s[J+3],_[t]=F(b^f),_[t+1]=F(x^p),_[t+2]=F(E^m),_[t+3]=F(S^g),f=O,p=Y,m=$,g=ee,t=t+4}return _.buffer}},UF=16,ca=class{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{let n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){let{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;let n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?VF(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,n){return this.useSoftware?new Promise((r,s)=>{this.softwareDecrypt(new Uint8Array(e),t,n);let o=this.flush();o?r(o.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,n)}softwareDecrypt(e,t,n){let{currentIV:r,currentResult:s,remainderData:o}=this;this.logOnce("JS AES decrypt"),o&&(e=qt(o,e),this.remainderData=null);let a=this.getValidChunk(e);if(!a.length)return null;r&&(n=r);let l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new tg),l.expandKey(t);let c=s;return this.currentResult=l.decrypt(a.buffer,0,n),this.currentIV=gr(a,-16).buffer,c||null}webCryptoDecrypt(e,t,n){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,n));this.key=t,this.fastAesKey=new eg(this.subtle,t)}return this.fastAesKey.expandKey().then(r=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new Jm(this.subtle,new Uint8Array(n)).decrypt(e.buffer,r)):Promise.reject(new Error("web crypto not initialized"))).catch(r=>(D.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(e,t,n)))}onWebCryptoError(e,t,n){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,n);let r=this.flush();if(r)return r.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e,n=e.length-e.length%UF;return n!==e.length&&(t=gr(e,0,n),this.remainderData=gr(e,n)),t}logOnce(e){this.logEnabled&&(D.log(`[decrypter]: ${e}`),this.logEnabled=!1)}},jF={toString:function(i){let e="",t=i.length;for(let n=0;n<t;n++)e+=`[${i.start(n).toFixed(3)}-${i.end(n).toFixed(3)}]`;return e}},M={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},ua=class extends Qm{constructor(e,t,n,r,s){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=M.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=s,this.logPrefix=r,this.log=D.log.bind(D,`${r}:`),this.warn=D.warn.bind(D,`${r}:`),this.hls=e,this.fragmentLoader=new Zm(e.config),this.keyLoader=n,this.fragmentTracker=t,this.config=e.config,this.decrypter=new ca(e.config),e.on(v.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);let e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=M.STOPPED}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;let n=t.partList;if(n!=null&&n.length){let s=n[n.length-1];return Fe.isBuffered(this.media,s.start+s.duration/2)}let r=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(r)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}onMediaAttached(e,t){let n=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("ended",this.onvended);let r=this.config;this.levels&&r.autoStartLoad&&this.state===M.STOPPED&&this.startLoad(r.startPosition)}onMediaDetaching(){let e=this.media;e!=null&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){let{config:e,fragCurrent:t,media:n,mediaBuffer:r,state:s}=this,o=n?n.currentTime:0,a=Fe.bufferInfo(r||n,o,e.maxBufferHole);if(this.log(`media seeking to ${H(o)?o.toFixed(3):o}, state: ${s}`),this.state===M.ENDED)this.resetLoadingState();else if(t){let l=e.maxFragLookUpTolerance,c=t.start-l,u=t.start+t.duration+l;if(!a.len||u<a.start||c>a.end){let d=o>u;(o<c||d)&&(d&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}n&&(this.fragmentTracker.removeFragmentsInRange(o,1/0,this.playlistType,!0),this.lastCurrentTime=o),!this.loadedmetadata&&!a.len&&(this.nextLoadPosition=this.startPosition=o),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(v.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=M.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,n){this._loadFragForPlayback(e,t,n)}_loadFragForPlayback(e,t,n){let r=s=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${s.part?" p: "+s.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(s)};this._doFragLoad(e,t,n,r).then(s=>{if(!s)return;let o=this.state;if(this.fragContextChanged(e)){(o===M.FRAG_LOADING||!this.fragCurrent&&o===M.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=M.IDLE);return}"payload"in s&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(v.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s)}).catch(s=>{this.state===M.STOPPED||this.state===M.ERROR||(this.warn(`Frag error: ${s?.message||s}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;let{fragmentTracker:n}=this;if(n.getState(e)===it.APPENDING){let s=e.type,o=this.getFwdBufferInfo(this.mediaBuffer,s),a=Math.max(e.duration,o?o.len:this.config.maxBufferLength),l=this.backtrackFragment;((l?e.sn-l.sn:0)===1||this.reduceMaxBufferLength(a,e.duration))&&n.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===it.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){let t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,n=null){if(!(e-t))return;let r={startOffset:e,endOffset:t,type:n};this.hls.trigger(v.BUFFER_FLUSHING,r)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(n=>{if(!n||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{let{hls:r}=this,{payload:s}=n,o=e.decryptdata;if(s&&s.byteLength>0&&o!=null&&o.key&&o.iv&&o.method==="AES-128"){let a=self.performance.now();return this.decrypter.decrypt(new Uint8Array(s),o.key.buffer,o.iv.buffer).catch(l=>{throw r.trigger(v.ERROR,{type:Z.MEDIA_ERROR,details:T.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:e}),l}).then(l=>{let c=self.performance.now();return r.trigger(v.FRAG_DECRYPTED,{frag:e,payload:l,stats:{tstart:a,tdecrypt:c}}),n.payload=l,this.completeInitSegmentLoad(n)})}return this.completeInitSegmentLoad(n)}).catch(n=>{this.state===M.STOPPED||this.state===M.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){let{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");let n=e.frag.stats;this.state=M.IDLE,e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){let{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){var n,r,s,o;let a=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===K.MAIN?"level":"track"} ${e.level} (frag:[${((n=e.startPTS)!=null?n:NaN).toFixed(3)}-${((r=e.endPTS)!=null?r:NaN).toFixed(3)}] > buffer:${a?jF.toString(Fe.getBuffered(a)):"(detached)"})`),e.sn!=="initSegment"){var l;if(e.type!==K.SUBTITLE){let u=e.elementaryStreams;if(!Object.keys(u).some(d=>!!u[d])){this.state=M.IDLE;return}}let c=(l=this.levels)==null?void 0:l[e.level];c!=null&&c.fragmentError&&(this.log(`Resetting level fragment error count of ${c.fragmentError} on frag buffered`),c.fragmentError=0)}this.state=M.IDLE,a&&(!this.loadedmetadata&&e.type==K.MAIN&&a.buffered.length&&((s=this.fragCurrent)==null?void 0:s.sn)===((o=this.fragPrevious)==null?void 0:o.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){let{transmuxer:t}=this;if(!t)return;let{frag:n,part:r,partsLoaded:s}=e,o=!s||s.length===0||s.some(l=>!l),a=new la(n.level,n.sn,n.stats.chunkCount+1,0,r?r.index:-1,!o);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,n=null,r){var s;let o=t?.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let a=null;if(e.encrypted&&!((s=e.decryptdata)!=null&&s.key)?(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level}`),this.state=M.KEY_LOADING,this.fragCurrent=e,a=this.keyLoader.load(e).then(u=>{if(!this.fragContextChanged(u.frag))return this.hls.trigger(v.KEY_LOADED,u),this.state===M.KEY_LOADING&&(this.state=M.IDLE),u}),this.hls.trigger(v.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(a=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&o.encryptedFragments.length&&this.keyLoader.loadClear(e,o.encryptedFragments),n=Math.max(e.start,n||0),this.config.lowLatencyMode&&e.sn!=="initSegment"){let u=o.partList;if(u&&r){n>e.end&&o.fragmentHint&&(e=o.fragmentHint);let d=this.getNextPart(u,e,n);if(d>-1){let h=u[d];this.log(`Loading part sn: ${e.sn} p: ${h.index} cc: ${e.cc} of playlist [${o.startSN}-${o.endSN}] parts [0-${d}-${u.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=h.start+h.duration,this.state=M.FRAG_LOADING;let f;return a?f=a.then(p=>!p||this.fragContextChanged(p.frag)?null:this.doFragPartsLoad(e,h,t,r)).catch(p=>this.handleFragLoadError(p)):f=this.doFragPartsLoad(e,h,t,r).catch(p=>this.handleFragLoadError(p)),this.hls.trigger(v.FRAG_LOADING,{frag:e,part:h,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):f}else if(!e.url||this.loadedEndOfParts(u,n))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${o?"of ["+o.startSN+"-"+o.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(n.toFixed(3))}`),H(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=M.FRAG_LOADING;let l=this.config.progressive,c;return l&&a?c=a.then(u=>!u||this.fragContextChanged(u?.frag)?null:this.fragmentLoader.load(e,r)).catch(u=>this.handleFragLoadError(u)):c=Promise.all([this.fragmentLoader.load(e,l?r:void 0),a]).then(([u])=>(!l&&u&&r&&r(u),u)).catch(u=>this.handleFragLoadError(u)),this.hls.trigger(v.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):c}doFragPartsLoad(e,t,n,r){return new Promise((s,o)=>{var a;let l=[],c=(a=n.details)==null?void 0:a.partList,u=d=>{this.fragmentLoader.loadPart(e,d,r).then(h=>{l[d.index]=h;let f=h.part;this.hls.trigger(v.FRAG_LOADED,h);let p=lw(n,e.sn,d.index+1)||Xw(c,e.sn,d.index+1);if(p)u(p);else return s({frag:e,part:f,partsLoaded:l})}).catch(o)};u(t)})}handleFragLoadError(e){if("data"in e){let t=e.data;e.data&&t.details===T.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(v.ERROR,t)}else this.hls.trigger(v.ERROR,{type:Z.OTHER_ERROR,details:T.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){let t=this.getCurrentContext(e);if(!t||this.state!==M.PARSING){!this.fragCurrent&&this.state!==M.STOPPED&&this.state!==M.ERROR&&(this.state=M.IDLE);return}let{frag:n,part:r,level:s}=t,o=self.performance.now();n.stats.parsing.end=o,r&&(r.stats.parsing.end=o),this.updateLevelTiming(n,r,s,e.partial)}getCurrentContext(e){let{levels:t,fragCurrent:n}=this,{level:r,sn:s,part:o}=e;if(!(t!=null&&t[r]))return this.warn(`Levels object was unset while buffering fragment ${s} of level ${r}. The current chunk will not be buffered.`),null;let a=t[r],l=o>-1?lw(a,s,o):null,c=l?l.fragment:yF(a,s,n);return c?(n&&n!==c&&(c.stats=n.stats),{frag:c,part:l,level:a}):null}bufferFragmentData(e,t,n,r,s){var o;if(!e||this.state!==M.PARSING)return;let{data1:a,data2:l}=e,c=a;if(a&&l&&(c=qt(a,l)),!((o=c)!=null&&o.length))return;let u={type:e.type,frag:t,part:n,chunkMeta:r,parent:t.type,data:c};if(this.hls.trigger(v.BUFFER_APPENDING,u),e.dropped&&e.independent&&!n){if(s)return;this.flushBufferGap(t)}}flushBufferGap(e){let t=this.media;if(!t)return;if(!Fe.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}let n=t.currentTime,r=Fe.bufferInfo(t,n,0),s=e.duration,o=Math.min(this.config.maxFragLookUpTolerance*2,s*.25),a=Math.max(Math.min(e.start-o,r.end-o),n+o);e.start-a>o&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){let n=this.getLoadPosition();return H(n)?this.getFwdBufferInfoAtPos(e,n,t):null}getFwdBufferInfoAtPos(e,t,n){let{config:{maxBufferHole:r}}=this,s=Fe.bufferInfo(e,t,r);if(s.len===0&&s.nextStart!==void 0){let o=this.fragmentTracker.getBufferedFrag(t,n);if(o&&s.nextStart<o.end)return Fe.bufferInfo(e,t,Math.max(s.nextStart,r))}return s}getMaxBufferLength(e){let{config:t}=this,n;return e?n=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):n=t.maxBufferLength,Math.min(n,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){let n=this.config,r=Math.max(Math.min(e-t,n.maxBufferLength),t),s=Math.max(e-t*3,n.maxMaxBufferLength/2,r);return s>=r?(n.maxMaxBufferLength=s,this.warn(`Reduce max buffer length to ${s}s`),!0):!1}getAppendedFrag(e,t=K.MAIN){let n=this.fragmentTracker.getAppendedFrag(e,K.MAIN);return n&&"fragment"in n?n.fragment:n}getNextFragment(e,t){let n=t.fragments,r=n.length;if(!r)return null;let{config:s}=this,o=n[0].start,a;if(t.live){let l=s.initialLiveManifestSize;if(r<l)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${l})`),null;(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<o)&&(a=this.getInitialLiveFragment(t,n),this.startPosition=this.nextLoadPosition=a?this.hls.liveSyncPosition||a.start:e)}else e<=o&&(a=n[0]);if(!a){let l=s.lowLatencyMode?t.partEnd:t.fragmentEnd;a=this.getFragmentAtPosition(e,l,t)}return this.mapToInitFragWhenRequired(a)}isLoopLoading(e,t){let n=this.fragmentTracker.getState(e);return(n===it.OK||n===it.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,n,r,s){let o=e.gap,a=this.getNextFragment(this.nextLoadPosition,t);if(a===null)return a;if(e=a,o&&e&&!e.gap&&n.nextStart){let l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,r);if(l!==null&&n.len+l.len>=s)return this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,n){let r=-1,s=!1,o=!0;for(let a=0,l=e.length;a<l;a++){let c=e[a];if(o=o&&!c.independent,r>-1&&n<c.start)break;let u=c.loaded;u?r=-1:(s||c.independent||o)&&c.fragment===t&&(r=a),s=u}return r}loadedEndOfParts(e,t){let n=e[e.length-1];return n&&t>n.start&&n.loaded}getInitialLiveFragment(e,t){let n=this.fragPrevious,r=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),r=_F(t,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){let s=n.sn+1;if(s>=e.startSN&&s<=e.endSN){let o=t[s-e.startSN];n.cc===o.cc&&(r=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}r||(r=wF(t,n.cc),r&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`))}}else{let s=this.hls.liveSyncPosition;s!==null&&(r=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r}getFragmentAtPosition(e,t,n){let{config:r}=this,{fragPrevious:s}=this,{fragments:o,endSN:a}=n,{fragmentHint:l}=n,{maxFragLookUpTolerance:c}=r,u=n.partList,d=!!(r.lowLatencyMode&&u!=null&&u.length&&l);d&&l&&!this.bitrateTest&&(o=o.concat(l),a=l.sn);let h;if(e<t){let f=e>t-c?0:c;h=Tu(s,o,e,f)}else h=o[o.length-1];if(h){let f=h.sn-n.startSN,p=this.fragmentTracker.getState(h);if((p===it.OK||p===it.PARTIAL&&h.gap)&&(s=h),s&&h.sn===s.sn&&(!d||u[0].fragment.sn>h.sn)&&s&&h.level===s.level){let g=o[f+1];h.sn<a&&this.fragmentTracker.getState(g)!==it.OK?h=g:h=null}}return h}synchronizeToLiveEdge(e){let{config:t,media:n}=this;if(!n)return;let r=this.hls.liveSyncPosition,s=n.currentTime,o=e.fragments[0].start,a=e.edge,l=s>=o-t.maxFragLookUpTolerance&&s<=a;if(r!==null&&n.duration>r&&(s<r||!l)){let c=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!l&&n.readyState<4||s<a-c)&&(this.loadedmetadata||(this.nextLoadPosition=r),n.readyState&&(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${r.toFixed(3)}`),n.currentTime=r))}}alignPlaylists(e,t,n){let r=e.fragments.length;if(!r)return this.warn("No fragments in live playlist"),0;let s=e.fragments[0].start,o=!t,a=e.alignedSliding&&H(s);if(o||!a&&!s){let{fragPrevious:l}=this;FF(l,n,e);let c=e.fragments[0].start;return this.log(`Live playlist sliding: ${c.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${l?l.sn:"na"} fragments: ${r}`),c}return s}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let n=this.startPosition;if(n<t&&(n=-1),n===-1||this.lastCurrentTime===-1){let r=this.startTimeOffset!==null,s=r?this.startTimeOffset:e.startTimeOffset;s!==null&&H(s)?(n=t+s,s<0&&(n+=e.totalduration),n=Math.min(Math.max(t,n),t+e.totalduration),this.log(`Start time offset ${s} found in ${r?"multivariant":"media"} playlist, adjust startPosition to ${n}`),this.startPosition=n):e.live?n=this.hls.liveSyncPosition||t:this.startPosition=n=0,this.lastCurrentTime=n}this.nextLoadPosition=n}getLoadPosition(){let{media:e}=this,t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&e.sn!=="initSegment"&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==M.FRAG_LOADING_WAITING_RETRY)&&(this.state=M.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){let u=this.getCurrentContext(t.chunkMeta);u&&(t.frag=u.frag)}let n=t.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){var r;this.warn(`Frag load error must match current frag to retry ${n.url} > ${(r=this.fragCurrent)==null?void 0:r.url}`);return}let s=t.details===T.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(n,!0);let o=t.errorAction,{action:a,retryCount:l=0,retryConfig:c}=o||{};if(o&&a===nt.RetryRequest&&c){this.resetStartWhenNotLoaded(this.levelLastLoaded);let u=Wg(c,l);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${l+1}/${c.maxNumRetry} in ${u}ms`),o.resolved=!0,this.retryDate=self.performance.now()+u,this.state=M.FRAG_LOADING_WAITING_RETRY}else if(c&&o)if(this.resetFragmentErrors(e),l<c.maxNumRetry)!s&&a!==nt.RemoveAlternatePermanently&&(o.resolved=!0);else{D.warn(`${t.details} reached or exceeded max retry (${l})`);return}else o?.action===nt.SendAlternateToPenaltyBox?this.state=M.WAITING_LEVEL:this.state=M.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===M.PARSING||this.state===M.PARSED){let t=e.frag,n=e.parent,r=this.getFwdBufferInfo(this.mediaBuffer,n),s=r&&r.len>.5;s&&this.reduceMaxBufferLength(r.len,t?.duration||10);let o=!s;return o&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${n} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),o}return!1}resetFragmentErrors(e){e===K.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==M.STOPPED&&(this.state=M.IDLE)}afterBufferFlushed(e,t,n){if(!e)return;let r=Fe.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,n),this.state===M.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=M.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;let t=e?e.details:null;t!=null&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,n,r){var s;let o=n.details;if(!o){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((l,c)=>{let u=e.elementaryStreams[c];if(u){let d=u.endPTS-u.startPTS;if(d<=0)return this.warn(`Could not parse fragment ${e.sn} ${c} duration reliably (${d})`),l||!1;let h=r?0:Yw(o,e,u.startPTS,u.endPTS,u.startDTS,u.endDTS);return this.hls.trigger(v.LEVEL_PTS_UPDATED,{details:o,level:n,drift:h,type:c,frag:e,start:u.startPTS,end:u.endPTS}),!0}return l},!1)&&((s=this.transmuxer)==null?void 0:s.error)===null){let l=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(n.fragmentError===0&&(n.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(l.message),this.hls.trigger(v.ERROR,{type:Z.MEDIA_ERROR,details:T.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of level "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=M.PARSED,this.hls.trigger(v.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){let t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}},Iu=class{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){let{chunks:e,dataLength:t}=this,n;if(e.length)e.length===1?n=e[0]:n=$F(e,t);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}};function $F(i,e){let t=new Uint8Array(e),n=0;for(let r=0;r<i.length;r++){let s=i[r];t.set(s,n),n+=s.length}return t}function HF(){return typeof __HLS_WORKER_BUNDLE__=="function"}function GF(){let i=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(i);return{worker:new self.Worker(e),objectURL:e}}function zF(i){let e=new self.URL(i,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}function Nn(i="",e=9e4){return{type:i,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}var da=class{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,n,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,n){}demux(e,t){this.cachedData&&(e=qt(this.cachedData,e),this.cachedData=null);let n=ra(e,0),r=n?n.length:0,s,o=this._audioTrack,a=this._id3Track,l=n?zg(n):void 0,c=e.length;for((this.basePTS===null||this.frameIndex===0&&H(l))&&(this.basePTS=WF(l,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:fn.audioId3,duration:Number.POSITIVE_INFINITY});r<c;){if(this.canParse(e,r)){let u=this.appendFrame(o,e,r);u?(this.frameIndex++,this.lastPTS=u.sample.pts,r+=u.length,s=r):r=c}else TP(e,r)?(n=ra(e,r),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:fn.audioId3,duration:Number.POSITIVE_INFINITY}),r+=n.length,s=r):r++;if(r===c&&s!==c){let u=gr(e,s);this.cachedData?this.cachedData=qt(this.cachedData,u):this.cachedData=u}}return{audioTrack:o,videoTrack:Nn(),id3Track:a,textTrack:Nn()}}demuxSampleAes(e,t,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){let t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:Nn(),id3Track:this._id3Track,textTrack:Nn()}}destroy(){}},WF=(i,e,t)=>{if(H(i))return i*90;let n=t?t.baseTime*9e4/t.timescale:0;return e*9e4+n};function qF(i,e,t,n){let r,s,o,a,l=navigator.userAgent.toLowerCase(),c=n,u=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];r=((e[t+2]&192)>>>6)+1;let d=(e[t+2]&60)>>>2;if(d>u.length-1){let h=new Error(`invalid ADTS sampling index:${d}`);i.emit(v.ERROR,v.ERROR,{type:Z.MEDIA_ERROR,details:T.FRAG_PARSING_ERROR,fatal:!0,error:h,reason:h.message});return}return o=(e[t+2]&1)<<2,o|=(e[t+3]&192)>>>6,D.log(`manifest codec:${n}, ADTS type:${r}, samplingIndex:${d}`),/firefox/i.test(l)?d>=6?(r=5,a=new Array(4),s=d-3):(r=2,a=new Array(2),s=d):l.indexOf("android")!==-1?(r=2,a=new Array(2),s=d):(r=5,a=new Array(4),n&&(n.indexOf("mp4a.40.29")!==-1||n.indexOf("mp4a.40.5")!==-1)||!n&&d>=6?s=d-3:((n&&n.indexOf("mp4a.40.2")!==-1&&(d>=6&&o===1||/vivaldi/i.test(l))||!n&&o===1)&&(r=2,a=new Array(2)),s=d)),a[0]=r<<3,a[0]|=(d&14)>>1,a[1]|=(d&1)<<7,a[1]|=o<<3,r===5&&(a[1]|=(s&14)>>1,a[2]=(s&1)<<7,a[2]|=8,a[3]=0),{config:a,samplerate:u[d],channelCount:o,codec:"mp4a.40."+r,manifestCodec:c}}function nS(i,e){return i[e]===255&&(i[e+1]&246)===240}function iS(i,e){return i[e+1]&1?7:9}function qg(i,e){return(i[e+3]&3)<<11|i[e+4]<<3|(i[e+5]&224)>>>5}function KF(i,e){return e+5<i.length}function Cu(i,e){return e+1<i.length&&nS(i,e)}function YF(i,e){return KF(i,e)&&nS(i,e)&&qg(i,e)<=i.length-e}function QF(i,e){if(Cu(i,e)){let t=iS(i,e);if(e+t>=i.length)return!1;let n=qg(i,e);if(n<=t)return!1;let r=e+n;return r===i.length||Cu(i,r)}return!1}function rS(i,e,t,n,r){if(!i.samplerate){let s=qF(e,t,n,r);if(!s)return;i.config=s.config,i.samplerate=s.samplerate,i.channelCount=s.channelCount,i.codec=s.codec,i.manifestCodec=s.manifestCodec,D.log(`parsed codec:${i.codec}, rate:${s.samplerate}, channels:${s.channelCount}`)}}function sS(i){return 1024*9e4/i}function XF(i,e){let t=iS(i,e);if(e+t<=i.length){let n=qg(i,e)-t;if(n>0)return{headerLength:t,frameLength:n}}}function oS(i,e,t,n,r){let s=sS(i.samplerate),o=n+r*s,a=XF(e,t),l;if(a){let{frameLength:d,headerLength:h}=a,f=h+d,p=Math.max(0,t+f-e.length);p?(l=new Uint8Array(f-h),l.set(e.subarray(t+h,e.length),0)):l=e.subarray(t+h,t+f);let m={unit:l,pts:o};return p||i.samples.push(m),{sample:m,length:f,missing:p}}let c=e.length-t;return l=new Uint8Array(c),l.set(e.subarray(t,e.length),0),{sample:{unit:l,pts:o},length:c,missing:-1}}var iu=null,ZF=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],JF=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],e1=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],t1=[0,1,1,4];function aS(i,e,t,n,r){if(t+24>e.length)return;let s=lS(e,t);if(s&&t+s.frameLength<=e.length){let o=s.samplesPerFrame*9e4/s.sampleRate,a=n+r*o,l={unit:e.subarray(t,t+s.frameLength),pts:a,dts:a};return i.config=[],i.channelCount=s.channelCount,i.samplerate=s.sampleRate,i.samples.push(l),{sample:l,length:s.frameLength,missing:0}}}function lS(i,e){let t=i[e+1]>>3&3,n=i[e+1]>>1&3,r=i[e+2]>>4&15,s=i[e+2]>>2&3;if(t!==1&&r!==0&&r!==15&&s!==3){let o=i[e+2]>>1&1,a=i[e+3]>>6,l=t===3?3-n:n===3?3:4,c=ZF[l*14+r-1]*1e3,d=JF[(t===3?0:t===2?1:2)*3+s],h=a===3?1:2,f=e1[t][n],p=t1[n],m=f*8*p,g=Math.floor(f*c/d+o)*p;if(iu===null){let b=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);iu=b?parseInt(b[1]):0}return!!iu&&iu<=87&&n===2&&c>=224e3&&a===0&&(i[e+3]=i[e+3]|128),{sampleRate:d,channelCount:h,frameLength:g,samplesPerFrame:m}}}function Kg(i,e){return i[e]===255&&(i[e+1]&224)===224&&(i[e+1]&6)!==0}function cS(i,e){return e+1<i.length&&Kg(i,e)}function n1(i,e){return Kg(i,e)&&4<=i.length-e}function uS(i,e){if(e+1<i.length&&Kg(i,e)){let n=lS(i,e),r=4;n!=null&&n.frameLength&&(r=n.frameLength);let s=e+r;return s===i.length||cS(i,s)}return!1}var ng=class extends da{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let t=ra(e,0),n=t?.length||0;if(uS(e,n))return!1;for(let r=e.length;n<r;n++)if(QF(e,n))return D.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return YF(e,t)}appendFrame(e,t,n){rS(e,this.observer,t,n,e.manifestCodec);let r=oS(e,t,n,this.basePTS,this.frameIndex);if(r&&r.missing===0)return r}},i1=/\/emsg[-/]ID3/i,ig=class{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,n,r){let s=this.videoTrack=Nn("video",1),o=this.audioTrack=Nn("audio",1),a=this.txtTrack=Nn("text",1);if(this.id3Track=Nn("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;let l=jw(e);if(l.video){let{id:c,timescale:u,codec:d}=l.video;s.id=c,s.timescale=a.timescale=u,s.codec=d}if(l.audio){let{id:c,timescale:u,codec:d}=l.audio;o.id=c,o.timescale=u,o.codec=d}a.id=Bw.text,s.sampleDuration=0,s.duration=o.duration=r}resetContiguity(){this.remainderData=null}static probe(e){return OP(e)}demux(e,t){this.timeOffset=t;let n=e,r=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=qt(this.remainderData,e));let a=$P(n);this.remainderData=a.remainder,r.samples=a.valid||new Uint8Array}else r.samples=n;let o=this.extractID3Track(r,t);return s.samples=GD(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){let e=this.timeOffset,t=this.videoTrack,n=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;let r=this.extractID3Track(t,this.timeOffset);return n.samples=GD(e,t),{videoTrack:t,audioTrack:Nn(),id3Track:r,textTrack:Nn()}}extractID3Track(e,t){let n=this.id3Track;if(e.samples.length){let r=oe(e.samples,["emsg"]);r&&r.forEach(s=>{let o=zP(s);if(i1.test(o.schemeIdUri)){let a=H(o.presentationTime)?o.presentationTime/o.timeScale:t+o.presentationTimeDelta/o.timeScale,l=o.eventDuration===4294967295?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);let c=o.payload;n.samples.push({data:c,len:c.byteLength,dts:a,pts:a,type:fn.emsg,duration:l})}})}return n}demuxSampleAes(e,t,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}},dS=(i,e)=>{let t=0,n=5;e+=n;let r=new Uint32Array(1),s=new Uint32Array(1),o=new Uint8Array(1);for(;n>0;){o[0]=i[e];let a=Math.min(n,8),l=8-a;s[0]=4278190080>>>24+l<<l,r[0]=(o[0]&s[0])>>l,t=t?t<<a|r[0]:r[0],e+=1,n-=a}return t},rg=class extends da{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,n){let r=hS(e,t,n,this.basePTS,this.frameIndex);if(r!==-1)return{sample:e.samples[e.samples.length-1],length:r,missing:0}}static probe(e){if(!e)return!1;let t=ra(e,0);if(!t)return!1;let n=t.length;return e[n]===11&&e[n+1]===119&&zg(t)!==void 0&&dS(e,n)<16}};function hS(i,e,t,n,r){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;let s=e[t+4]>>6;if(s>=3)return-1;let a=[48e3,44100,32e3][s],l=e[t+4]&63,u=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][l*3+s]*2;if(t+u>e.length)return-1;let d=e[t+6]>>5,h=0;d===2?h+=2:(d&1&&d!==1&&(h+=2),d&4&&(h+=2));let f=(e[t+6]<<8|e[t+7])>>12-h&1,m=[2,1,2,3,3,4,4,5][d]+f,g=e[t+5]>>3,y=e[t+5]&7,_=new Uint8Array([s<<6|g<<1|y>>2,(y&3)<<6|d<<3|f<<2|l>>4,l<<4&224]),b=1536/a*9e4,S=n+r*b,E=e.subarray(t,t+u);return i.config=_,i.channelCount=m,i.samplerate=a,i.samples.push({unit:E,pts:S}),u}var sg=class{constructor(){this.VideoSample=null}createVideoSample(e,t,n,r){return{key:e,frame:!1,pts:t,dts:n,units:[],debug:r,length:0}}getLastNalUnit(e){var t;let n=this.VideoSample,r;if((!n||n.units.length===0)&&(n=e[e.length-1]),(t=n)!=null&&t.units){let s=n.units;r=s[s.length-1]}return r}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){let n=t.samples,r=n.length;if(r){let s=n[r-1];e.pts=s.pts,e.dts=s.dts}else{t.dropped++;return}}t.samples.push(e)}e.debug.length&&D.log(e.pts+"/"+e.dts+":"+e.debug)}},Au=class{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){let e=this.data,t=this.bytesAvailable,n=e.byteLength-t,r=new Uint8Array(4),s=Math.min(4,t);if(s===0)throw new Error("no bytes available");r.set(e.subarray(n,n+s)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=s*8,this.bytesAvailable-=s}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e),n=this.word>>>32-t;if(e>32&&D.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?n<<t|this.readBits(t):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){let e=this.skipLZ();return this.readBits(e+1)-1}readEG(){let e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t=8,n=8,r;for(let s=0;s<e;s++)n!==0&&(r=this.readEG(),n=(t+r+256)%256),t=n===0?t:n}readSPS(){let e=0,t=0,n=0,r=0,s,o,a,l=this.readUByte.bind(this),c=this.readBits.bind(this),u=this.readUEG.bind(this),d=this.readBoolean.bind(this),h=this.skipBits.bind(this),f=this.skipEG.bind(this),p=this.skipUEG.bind(this),m=this.skipScalingList.bind(this);l();let g=l();if(c(5),h(3),l(),p(),g===100||g===110||g===122||g===244||g===44||g===83||g===86||g===118||g===128){let x=u();if(x===3&&h(1),p(),p(),h(1),d())for(o=x!==3?8:12,a=0;a<o;a++)d()&&(a<6?m(16):m(64))}p();let y=u();if(y===0)u();else if(y===1)for(h(1),f(),f(),s=u(),a=0;a<s;a++)f();p(),h(1);let _=u(),b=u(),S=c(1);S===0&&h(1),h(1),d()&&(e=u(),t=u(),n=u(),r=u());let E=[1,1];if(d()&&d())switch(l()){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:{E=[l()<<8|l(),l()<<8|l()];break}}return{width:Math.ceil((_+1)*16-e*2-t*2),height:(2-S)*(b+1)*16-(S?2:4)*(n+r),pixelRatio:E}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}},og=class extends sg{parseAVCPES(e,t,n,r,s){let o=this.parseAVCNALu(e,n.data),a=this.VideoSample,l,c=!1;n.data=null,a&&o.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"")),o.forEach(u=>{var d;switch(u.type){case 1:{let m=!1;l=!0;let g=u.data;if(c&&g.length>4){let y=new Au(g).readSliceType();(y===2||y===4||y===7||y===9)&&(m=!0)}if(m){var h;(h=a)!=null&&h.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),a.frame=!0,a.key=m;break}case 5:l=!0,(d=a)!=null&&d.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts,"")),a.key=!0,a.frame=!0;break;case 6:{l=!0,Hw(u.data,1,n.pts,t.samples);break}case 7:{var f,p;l=!0,c=!0;let m=u.data,y=new Au(m).readSPS();if(!e.sps||e.width!==y.width||e.height!==y.height||((f=e.pixelRatio)==null?void 0:f[0])!==y.pixelRatio[0]||((p=e.pixelRatio)==null?void 0:p[1])!==y.pixelRatio[1]){e.width=y.width,e.height=y.height,e.pixelRatio=y.pixelRatio,e.sps=[m],e.duration=s;let _=m.subarray(1,4),b="avc1.";for(let S=0;S<3;S++){let E=_[S].toString(16);E.length<2&&(E="0"+E),b+=E}e.codec=b}break}case 8:l=!0,e.pps=[u.data];break;case 9:l=!0,e.audFound=!0,a&&this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts,"");break;case 12:l=!0;break;default:l=!1,a&&(a.debug+="unknown NAL "+u.type+" ");break}a&&l&&a.units.push(u)}),r&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}parseAVCNALu(e,t){let n=t.byteLength,r=e.naluState||0,s=r,o=[],a=0,l,c,u,d=-1,h=0;for(r===-1&&(d=0,h=t[0]&31,r=0,a=1);a<n;){if(l=t[a++],!r){r=l?0:1;continue}if(r===1){r=l?0:2;continue}if(!l)r=3;else if(l===1){if(c=a-r-1,d>=0){let f={data:t.subarray(d,c),type:h};o.push(f)}else{let f=this.getLastNalUnit(e.samples);f&&(s&&a<=4-s&&f.state&&(f.data=f.data.subarray(0,f.data.byteLength-s)),c>0&&(f.data=qt(f.data,t.subarray(0,c)),f.state=0))}a<n?(u=t[a]&31,d=a,h=u,r=0):r=-1}else r=0}if(d>=0&&r>=0){let f={data:t.subarray(d,n),type:h,state:r};o.push(f)}if(o.length===0){let f=this.getLastNalUnit(e.samples);f&&(f.data=qt(f.data,t))}return e.naluState=r,o}},ag=class{constructor(e,t,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new ca(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,n){let r=e[t].unit;if(r.length<=16)return;let s=r.subarray(16,r.length-r.length%16),o=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(o).then(a=>{let l=new Uint8Array(a);r.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,n)})}decryptAacSamples(e,t,n){for(;;t++){if(t>=e.length){n();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){let t=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(t),r=0;for(let s=32;s<e.length-16;s+=160,r+=16)n.set(e.subarray(s,s+16),r);return n}getAvcDecryptedUnit(e,t){let n=new Uint8Array(t),r=0;for(let s=32;s<e.length-16;s+=160,r+=16)e.set(n.subarray(r,r+16),s);return e}decryptAvcSample(e,t,n,r,s){let o=Gw(s.data),a=this.getAvcEncryptedData(o);this.decryptBuffer(a.buffer).then(l=>{s.data=this.getAvcDecryptedUnit(o,l),this.decrypter.isSync()||this.decryptAvcSamples(e,t,n+1,r)})}decryptAvcSamples(e,t,n,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,n=0){if(t>=e.length){r();return}let s=e[t].units;for(;!(n>=s.length);n++){let o=s[n];if(!(o.data.length<=48||o.type!==1&&o.type!==5)&&(this.decryptAvcSample(e,t,n,r,o),!this.decrypter.isSync()))return}}}},tt=188,lg=class i{constructor(e,t,n){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.videoParser=new og}static probe(e){let t=i.syncOffset(e);return t>0&&D.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),t!==-1}static syncOffset(e){let t=e.length,n=Math.min(tt*5,t-tt)+1,r=0;for(;r<n;){let s=!1,o=-1,a=0;for(let l=r;l<t;l+=tt)if(e[l]===71&&(t-l===tt||e[l+tt]===71)){if(a++,o===-1&&(o=l,o!==0&&(n=Math.min(o+tt*99,e.length-tt)+1)),s||(s=cg(e,l)===0),s&&a>1&&(o===0&&a>2||l+tt>n))return o}else{if(a)return-1;break}r++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:Bw[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,n,r){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=i.createTrack("video"),this._audioTrack=i.createTrack("audio",r),this._id3Track=i.createTrack("id3"),this._txtTrack=i.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=n,this._duration=r}resetTimeStamp(){}resetContiguity(){let{_audioTrack:e,_videoTrack:t,_id3Track:n}=this;e&&(e.pesData=null),t&&(t.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,n=!1,r=!1){n||(this.sampleAes=null);let s,o=this._videoTrack,a=this._audioTrack,l=this._id3Track,c=this._txtTrack,u=o.pid,d=o.pesData,h=a.pid,f=l.pid,p=a.pesData,m=l.pesData,g=null,y=this.pmtParsed,_=this._pmtId,b=e.length;if(this.remainderData&&(e=qt(this.remainderData,e),b=e.length,this.remainderData=null),b<tt&&!r)return this.remainderData=e,{audioTrack:a,videoTrack:o,id3Track:l,textTrack:c};let S=Math.max(0,i.syncOffset(e));b-=(b-S)%tt,b<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,b,e.buffer.byteLength-b));let E=0;for(let w=S;w<b;w+=tt)if(e[w]===71){let R=!!(e[w+1]&64),B=cg(e,w),I=(e[w+3]&48)>>4,O;if(I>1){if(O=w+5+e[w+4],O===w+tt)continue}else O=w+4;switch(B){case u:R&&(d&&(s=vs(d))&&this.videoParser.parseAVCPES(o,c,s,!1,this._duration),d={data:[],size:0}),d&&(d.data.push(e.subarray(O,w+tt)),d.size+=w+tt-O);break;case h:if(R){if(p&&(s=vs(p)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,s);break;case"mp3":this.parseMPEGPES(a,s);break;case"ac3":this.parseAC3PES(a,s);break}p={data:[],size:0}}p&&(p.data.push(e.subarray(O,w+tt)),p.size+=w+tt-O);break;case f:R&&(m&&(s=vs(m))&&this.parseID3PES(l,s),m={data:[],size:0}),m&&(m.data.push(e.subarray(O,w+tt)),m.size+=w+tt-O);break;case 0:R&&(O+=e[O]+1),_=this._pmtId=r1(e,O);break;case _:{R&&(O+=e[O]+1);let Y=s1(e,O,this.typeSupported,n,this.observer);u=Y.videoPid,u>0&&(o.pid=u,o.segmentCodec=Y.segmentVideoCodec),h=Y.audioPid,h>0&&(a.pid=h,a.segmentCodec=Y.segmentAudioCodec),f=Y.id3Pid,f>0&&(l.pid=f),g!==null&&!y&&(D.warn(`MPEG-TS PMT found at ${w} after unknown PID '${g}'. Backtracking to sync byte @${S} to parse all TS packets.`),g=null,w=S-188),y=this.pmtParsed=!0;break}case 17:case 8191:break;default:g=B;break}}else E++;E>0&&Ru(this.observer,new Error(`Found ${E} TS packet/s that do not start with 0x47`)),o.pesData=d,a.pesData=p,l.pesData=m;let x={audioTrack:a,videoTrack:o,id3Track:l,textTrack:c};return r&&this.extractRemainingSamples(x),x}flush(){let{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){let{audioTrack:t,videoTrack:n,id3Track:r,textTrack:s}=e,o=n.pesData,a=t.pesData,l=r.pesData,c;if(o&&(c=vs(o))?(this.videoParser.parseAVCPES(n,s,c,!0,this._duration),n.pesData=null):n.pesData=o,a&&(c=vs(a))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,c);break;case"mp3":this.parseMPEGPES(t,c);break;case"ac3":this.parseAC3PES(t,c);break}t.pesData=null}else a!=null&&a.size&&D.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;l&&(c=vs(l))?(this.parseID3PES(r,c),r.pesData=null):r.pesData=l}demuxSampleAes(e,t,n){let r=this.demux(e,n,!0,!this.config.progressive),s=this.sampleAes=new ag(this.observer,this.config,t);return this.decrypt(r,s)}decrypt(e,t){return new Promise(n=>{let{audioTrack:r,videoTrack:s}=e;r.samples&&r.segmentCodec==="aac"?t.decryptAacSamples(r.samples,0,()=>{s.samples?t.decryptAvcSamples(s.samples,0,0,()=>{n(e)}):n(e)}):s.samples&&t.decryptAvcSamples(s.samples,0,0,()=>{n(e)})})}destroy(){this._duration=0}parseAACPES(e,t){let n=0,r=this.aacOverFlow,s=t.data;if(r){this.aacOverFlow=null;let d=r.missing,h=r.sample.unit.byteLength;if(d===-1)s=qt(r.sample.unit,s);else{let f=h-d;r.sample.unit.set(s.subarray(0,d),f),e.samples.push(r.sample),n=r.missing}}let o,a;for(o=n,a=s.length;o<a-1&&!Cu(s,o);o++);if(o!==n){let d,h=o<a-1;if(h?d=`AAC PES did not start with ADTS header,offset:${o}`:d="No ADTS header found in AAC PES",Ru(this.observer,new Error(d),h),!h)return}rS(e,this.observer,s,o,this.audioCodec);let l;if(t.pts!==void 0)l=t.pts;else if(r){let d=sS(e.samplerate);l=r.sample.pts+d}else{D.warn("[tsdemuxer]: AAC PES unknown PTS");return}let c=0,u;for(;o<a;)if(u=oS(e,s,o,l,c),o+=u.length,u.missing){this.aacOverFlow=u;break}else for(c++;o<a-1&&!Cu(s,o);o++);}parseMPEGPES(e,t){let n=t.data,r=n.length,s=0,o=0,a=t.pts;if(a===void 0){D.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;o<r;)if(cS(n,o)){let l=aS(e,n,o,a,s);if(l)o+=l.length,s++;else break}else o++}parseAC3PES(e,t){{let n=t.data,r=t.pts;if(r===void 0){D.warn("[tsdemuxer]: AC3 PES unknown PTS");return}let s=n.length,o=0,a=0,l;for(;a<s&&(l=hS(e,n,a,r,o++))>0;)a+=l}}parseID3PES(e,t){if(t.pts===void 0){D.warn("[tsdemuxer]: ID3 PES unknown PTS");return}let n=Ke({},t,{type:this._videoTrack?fn.emsg:fn.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}};function cg(i,e){return((i[e+1]&31)<<8)+i[e+2]}function r1(i,e){return(i[e+10]&31)<<8|i[e+11]}function s1(i,e,t,n,r){let s={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=(i[e+1]&15)<<8|i[e+2],a=e+3+o-4,l=(i[e+10]&15)<<8|i[e+11];for(e+=12+l;e<a;){let c=cg(i,e),u=(i[e+3]&15)<<8|i[e+4];switch(i[e]){case 207:if(!n){Sm("ADTS AAC");break}case 15:s.audioPid===-1&&(s.audioPid=c);break;case 21:s.id3Pid===-1&&(s.id3Pid=c);break;case 219:if(!n){Sm("H.264");break}case 27:s.videoPid===-1&&(s.videoPid=c,s.segmentVideoCodec="avc");break;case 3:case 4:!t.mpeg&&!t.mp3?D.log("MPEG audio found, not supported in this browser"):s.audioPid===-1&&(s.audioPid=c,s.segmentAudioCodec="mp3");break;case 193:if(!n){Sm("AC-3");break}case 129:t.ac3?s.audioPid===-1&&(s.audioPid=c,s.segmentAudioCodec="ac3"):D.log("AC-3 audio found, not supported in this browser");break;case 6:if(s.audioPid===-1&&u>0){let d=e+5,h=u;for(;h>2;){switch(i[d]){case 106:t.ac3!==!0?D.log("AC-3 audio found, not supported in this browser for now"):(s.audioPid=c,s.segmentAudioCodec="ac3");break}let p=i[d+1]+2;d+=p,h-=p}}break;case 194:case 135:return Ru(r,new Error("Unsupported EC-3 in M2TS found")),s;case 36:return Ru(r,new Error("Unsupported HEVC in M2TS found")),s}e+=u+5}return s}function Ru(i,e,t){D.warn(`parsing error: ${e.message}`),i.emit(v.ERROR,v.ERROR,{type:Z.MEDIA_ERROR,details:T.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function Sm(i){D.log(`${i} with AES-128-CBC encryption found in unencrypted stream`)}function vs(i){let e=0,t,n,r,s,o,a=i.data;if(!i||i.size===0)return null;for(;a[0].length<19&&a.length>1;)a[0]=qt(a[0],a[1]),a.splice(1,1);if(t=a[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(n=(t[4]<<8)+t[5],n&&n>i.size-6)return null;let c=t[7];c&192&&(s=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,c&64?(o=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,s-o>60*9e4&&(D.warn(`${Math.round((s-o)/9e4)}s delta between PTS and DTS, align them`),s=o)):o=s),r=t[8];let u=r+9;if(i.size<=u)return null;i.size-=u;let d=new Uint8Array(i.size);for(let h=0,f=a.length;h<f;h++){t=a[h];let p=t.byteLength;if(u)if(u>p){u-=p;continue}else t=t.subarray(u),p-=u,u=0;d.set(t,e),e+=p}return n&&(n-=r+3),{data:d,pts:s,dts:o,len:n}}return null}var ug=class extends da{resetInitSegment(e,t,n,r){super.resetInitSegment(e,t,n,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let t=ra(e,0),n=t?.length||0;if(t&&e[n]===11&&e[n+1]===119&&zg(t)!==void 0&&dS(e,n)<=16)return!1;for(let r=e.length;n<r;n++)if(uS(e,n))return D.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return n1(e,t)}appendFrame(e,t,n){if(this.basePTS!==null)return aS(e,t,n,this.basePTS,this.frameIndex)}},Mu=class{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}},Di=Math.pow(2,32)-1,ys=(()=>{class i{static init(){i.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let t;for(t in i.types)i.types.hasOwnProperty(t)&&(i.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);let n=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);i.HDLR_TYPES={video:n,audio:r};let s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),o=new Uint8Array([0,0,0,0,0,0,0,0]);i.STTS=i.STSC=i.STCO=o,i.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),i.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),i.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),i.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);let a=new Uint8Array([105,115,111,109]),l=new Uint8Array([97,118,99,49]),c=new Uint8Array([0,0,0,1]);i.FTYP=i.box(i.types.ftyp,a,c,a,l),i.DINF=i.box(i.types.dinf,i.box(i.types.dref,s))}static box(t,...n){let r=8,s=n.length,o=s;for(;s--;)r+=n[s].byteLength;let a=new Uint8Array(r);for(a[0]=r>>24&255,a[1]=r>>16&255,a[2]=r>>8&255,a[3]=r&255,a.set(t,4),s=0,r=8;s<o;s++)a.set(n[s],r),r+=n[s].byteLength;return a}static hdlr(t){return i.box(i.types.hdlr,i.HDLR_TYPES[t])}static mdat(t){return i.box(i.types.mdat,t)}static mdhd(t,n){n*=t;let r=Math.floor(n/(Di+1)),s=Math.floor(n%(Di+1));return i.box(i.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,r>>24,r>>16&255,r>>8&255,r&255,s>>24,s>>16&255,s>>8&255,s&255,85,196,0,0]))}static mdia(t){return i.box(i.types.mdia,i.mdhd(t.timescale,t.duration),i.hdlr(t.type),i.minf(t))}static mfhd(t){return i.box(i.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255]))}static minf(t){return t.type==="audio"?i.box(i.types.minf,i.box(i.types.smhd,i.SMHD),i.DINF,i.stbl(t)):i.box(i.types.minf,i.box(i.types.vmhd,i.VMHD),i.DINF,i.stbl(t))}static moof(t,n,r){return i.box(i.types.moof,i.mfhd(t),i.traf(r,n))}static moov(t){let n=t.length,r=[];for(;n--;)r[n]=i.trak(t[n]);return i.box.apply(null,[i.types.moov,i.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(i.mvex(t)))}static mvex(t){let n=t.length,r=[];for(;n--;)r[n]=i.trex(t[n]);return i.box.apply(null,[i.types.mvex,...r])}static mvhd(t,n){n*=t;let r=Math.floor(n/(Di+1)),s=Math.floor(n%(Di+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,r>>24,r>>16&255,r>>8&255,r&255,s>>24,s>>16&255,s>>8&255,s&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return i.box(i.types.mvhd,o)}static sdtp(t){let n=t.samples||[],r=new Uint8Array(4+n.length),s,o;for(s=0;s<n.length;s++)o=n[s].flags,r[s+4]=o.dependsOn<<4|o.isDependedOn<<2|o.hasRedundancy;return i.box(i.types.sdtp,r)}static stbl(t){return i.box(i.types.stbl,i.stsd(t),i.box(i.types.stts,i.STTS),i.box(i.types.stsc,i.STSC),i.box(i.types.stsz,i.STSZ),i.box(i.types.stco,i.STCO))}static avc1(t){let n=[],r=[],s,o,a;for(s=0;s<t.sps.length;s++)o=t.sps[s],a=o.byteLength,n.push(a>>>8&255),n.push(a&255),n=n.concat(Array.prototype.slice.call(o));for(s=0;s<t.pps.length;s++)o=t.pps[s],a=o.byteLength,r.push(a>>>8&255),r.push(a&255),r=r.concat(Array.prototype.slice.call(o));let l=i.box(i.types.avcC,new Uint8Array([1,n[3],n[4],n[5],255,224|t.sps.length].concat(n).concat([t.pps.length]).concat(r))),c=t.width,u=t.height,d=t.pixelRatio[0],h=t.pixelRatio[1];return i.box(i.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,c>>8&255,c&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),l,i.box(i.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),i.box(i.types.pasp,new Uint8Array([d>>24,d>>16&255,d>>8&255,d&255,h>>24,h>>16&255,h>>8&255,h&255])))}static esds(t){let n=t.config.length;return new Uint8Array([0,0,0,0,3,23+n,0,1,0,4,15+n,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([n]).concat(t.config).concat([6,1,2]))}static audioStsd(t){let n=t.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,n>>8&255,n&255,0,0])}static mp4a(t){return i.box(i.types.mp4a,i.audioStsd(t),i.box(i.types.esds,i.esds(t)))}static mp3(t){return i.box(i.types[".mp3"],i.audioStsd(t))}static ac3(t){return i.box(i.types["ac-3"],i.audioStsd(t),i.box(i.types.dac3,t.config))}static stsd(t){return t.type==="audio"?t.segmentCodec==="mp3"&&t.codec==="mp3"?i.box(i.types.stsd,i.STSD,i.mp3(t)):t.segmentCodec==="ac3"?i.box(i.types.stsd,i.STSD,i.ac3(t)):i.box(i.types.stsd,i.STSD,i.mp4a(t)):i.box(i.types.stsd,i.STSD,i.avc1(t))}static tkhd(t){let n=t.id,r=t.duration*t.timescale,s=t.width,o=t.height,a=Math.floor(r/(Di+1)),l=Math.floor(r%(Di+1));return i.box(i.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,n>>24&255,n>>16&255,n>>8&255,n&255,0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,l>>24,l>>16&255,l>>8&255,l&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,s&255,0,0,o>>8&255,o&255,0,0]))}static traf(t,n){let r=i.sdtp(t),s=t.id,o=Math.floor(n/(Di+1)),a=Math.floor(n%(Di+1));return i.box(i.types.traf,i.box(i.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255])),i.box(i.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,a>>24,a>>16&255,a>>8&255,a&255])),i.trun(t,r.length+16+20+8+16+8+8),r)}static trak(t){return t.duration=t.duration||4294967295,i.box(i.types.trak,i.tkhd(t),i.mdia(t))}static trex(t){let n=t.id;return i.box(i.types.trex,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(t,n){let r=t.samples||[],s=r.length,o=12+16*s,a=new Uint8Array(o),l,c,u,d,h,f;for(n+=8+o,a.set([t.type==="video"?1:0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,s&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255],0),l=0;l<s;l++)c=r[l],u=c.duration,d=c.size,h=c.flags,f=c.cts,a.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,d>>>24&255,d>>>16&255,d>>>8&255,d&255,h.isLeading<<2|h.dependsOn,h.isDependedOn<<6|h.hasRedundancy<<4|h.paddingValue<<1|h.isNonSync,h.degradPrio&61440,h.degradPrio&15,f>>>24&255,f>>>16&255,f>>>8&255,f&255],12+16*l);return i.box(i.types.trun,a)}static initSegment(t){i.types||i.init();let n=i.moov(t);return qt(i.FTYP,n)}}return i.types=void 0,i.HDLR_TYPES=void 0,i.STTS=void 0,i.STSC=void 0,i.STCO=void 0,i.STSZ=void 0,i.VMHD=void 0,i.SMHD=void 0,i.STSD=void 0,i.FTYP=void 0,i.DINF=void 0,i})(),fS=9e4;function Yg(i,e,t=1,n=!1){let r=i*e*t;return n?Math.round(r):r}function o1(i,e,t=1,n=!1){return Yg(i,e,1/t,n)}function Jo(i,e=!1){return Yg(i,1e3,1/fS,e)}function a1(i,e=1){return Yg(i,fS,1/e)}var l1=10*1e3,vw=1024,c1=1152,u1=1536,bs=null,Tm=null,Ss=class{constructor(e,t,n,r=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=n,this.ISGenerated=!1,bs===null){let o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);bs=o?parseInt(o[1]):0}if(Tm===null){let s=navigator.userAgent.match(/Safari\/(\d+)/i);Tm=s?parseInt(s[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){D.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){D.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){D.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1,n=e.reduce((r,s)=>{let o=s.pts-r;return o<-4294967296?(t=!0,Wt(r,s.pts)):o>0?r:s.pts},e[0].pts);return t&&D.debug("PTS rollover detected"),n}remux(e,t,n,r,s,o,a,l){let c,u,d,h,f,p,m=s,g=s,y=e.pid>-1,_=t.pid>-1,b=t.samples.length,S=e.samples.length>0,E=a&&b>0||b>1;if((!y||S)&&(!_||E)||this.ISGenerated||a){if(this.ISGenerated){var w,R,B,I;let ee=this.videoTrackConfig;ee&&(t.width!==ee.width||t.height!==ee.height||((w=t.pixelRatio)==null?void 0:w[0])!==((R=ee.pixelRatio)==null?void 0:R[0])||((B=t.pixelRatio)==null?void 0:B[1])!==((I=ee.pixelRatio)==null?void 0:I[1]))&&this.resetInitSegment()}else d=this.generateIS(e,t,s,o);let O=this.isVideoContiguous,Y=-1,$;if(E&&(Y=d1(t.samples),!O&&this.config.forceKeyFrameOnDiscontinuity))if(p=!0,Y>0){D.warn(`[mp4-remuxer]: Dropped ${Y} out of ${b} video samples due to a missing keyframe`);let ee=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(Y),t.dropped+=Y,g+=(t.samples[0].pts-ee)/t.inputTimeScale,$=g}else Y===-1&&(D.warn(`[mp4-remuxer]: No keyframe found out of ${b} video samples`),p=!1);if(this.ISGenerated){if(S&&E){let ee=this.getVideoStartPts(t.samples),A=(Wt(e.samples[0].pts,ee)-ee)/t.inputTimeScale;m+=Math.max(0,A),g+=Math.max(0,-A)}if(S){if(e.samplerate||(D.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),d=this.generateIS(e,t,s,o)),u=this.remuxAudio(e,m,this.isAudioContiguous,o,_||E||l===K.AUDIO?g:void 0),E){let ee=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(D.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),d=this.generateIS(e,t,s,o)),c=this.remuxVideo(t,g,O,ee)}}else E&&(c=this.remuxVideo(t,g,O,0));c&&(c.firstKeyFrame=Y,c.independent=Y!==-1,c.firstKeyFramePTS=$)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(f=pS(n,s,this._initPTS,this._initDTS)),r.samples.length&&(h=mS(r,s,this._initPTS))),{audio:u,video:c,initSegment:d,independent:p,text:h,id3:f}}generateIS(e,t,n,r){let s=e.samples,o=t.samples,a=this.typeSupported,l={},c=this._initPTS,u=!c||r,d="audio/mp4",h,f,p;if(u&&(h=f=1/0),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":a.mpeg?(d="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}l.audio={id:"audio",container:d,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&a.mpeg?new Uint8Array(0):ys.initSegment([e]),metadata:{channelCount:e.channelCount}},u&&(p=e.inputTimeScale,!c||p!==c.timescale?h=f=s[0].pts-Math.round(p*n):u=!1)}if(t.sps&&t.pps&&o.length){if(t.timescale=t.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:ys.initSegment([t]),metadata:{width:t.width,height:t.height}},u)if(p=t.inputTimeScale,!c||p!==c.timescale){let m=this.getVideoStartPts(o),g=Math.round(p*n);f=Math.min(f,Wt(o[0].dts,m)-g),h=Math.min(h,m-g)}else u=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(l).length)return this.ISGenerated=!0,u?(this._initPTS={baseTime:h,timescale:p},this._initDTS={baseTime:f,timescale:p}):h=p=void 0,{tracks:l,initPTS:h,timescale:p}}remuxVideo(e,t,n,r){let s=e.inputTimeScale,o=e.samples,a=[],l=o.length,c=this._initPTS,u=this.nextAvcDts,d=8,h=this.videoSampleDuration,f,p,m=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,y=!1;if(!n||u===null){let k=t*s,P=o[0].pts-Wt(o[0].dts,o[0].pts);bs&&u!==null&&Math.abs(k-P-u)<15e3?n=!0:u=k-P}let _=c.baseTime*s/c.timescale;for(let k=0;k<l;k++){let P=o[k];P.pts=Wt(P.pts-_,u),P.dts=Wt(P.dts-_,u),P.dts<o[k>0?k-1:k].dts&&(y=!0)}y&&o.sort(function(k,P){let ae=k.dts-P.dts,z=k.pts-P.pts;return ae||z}),f=o[0].dts,p=o[o.length-1].dts;let b=p-f,S=b?Math.round(b/(l-1)):h||e.inputTimeScale/30;if(n){let k=f-u,P=k>S,ae=k<-1;if((P||ae)&&(P?D.warn(`AVC: ${Jo(k,!0)} ms (${k}dts) hole between fragments detected at ${t.toFixed(3)}`):D.warn(`AVC: ${Jo(-k,!0)} ms (${k}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!ae||u>=o[0].pts||bs)){f=u;let z=o[0].pts-k;if(P)o[0].dts=f,o[0].pts=z;else for(let me=0;me<o.length&&!(o[me].dts>z);me++)o[me].dts-=k,o[me].pts-=k;D.log(`Video: Initial PTS/DTS adjusted: ${Jo(z,!0)}/${Jo(f,!0)}, delta: ${Jo(k,!0)} ms`)}}f=Math.max(0,f);let E=0,x=0,w=f;for(let k=0;k<l;k++){let P=o[k],ae=P.units,z=ae.length,me=0;for(let ie=0;ie<z;ie++)me+=ae[ie].data.length;x+=me,E+=z,P.length=me,P.dts<w?(P.dts=w,w+=S/4|0||1):w=P.dts,m=Math.min(P.pts,m),g=Math.max(P.pts,g)}p=o[l-1].dts;let R=x+4*E+8,B;try{B=new Uint8Array(R)}catch(k){this.observer.emit(v.ERROR,v.ERROR,{type:Z.MUX_ERROR,details:T.REMUX_ALLOC_ERROR,fatal:!1,error:k,bytes:R,reason:`fail allocating video mdat ${R}`});return}let I=new DataView(B.buffer);I.setUint32(0,R),B.set(ys.types.mdat,4);let O=!1,Y=Number.POSITIVE_INFINITY,$=Number.POSITIVE_INFINITY,ee=Number.NEGATIVE_INFINITY,J=Number.NEGATIVE_INFINITY;for(let k=0;k<l;k++){let P=o[k],ae=P.units,z=0;for(let $e=0,Ye=ae.length;$e<Ye;$e++){let xe=ae[$e],xt=xe.data,lt=xe.data.byteLength;I.setUint32(d,lt),d+=4,B.set(xt,d),d+=lt,z+=4+lt}let me;if(k<l-1)h=o[k+1].dts-P.dts,me=o[k+1].pts-P.pts;else{let $e=this.config,Ye=k>0?P.dts-o[k-1].dts:S;if(me=k>0?P.pts-o[k-1].pts:S,$e.stretchShortVideoTrack&&this.nextAudioPts!==null){let xe=Math.floor($e.maxBufferHole*s),xt=(r?m+r*s:this.nextAudioPts)-P.pts;xt>xe?(h=xt-Ye,h<0?h=Ye:O=!0,D.log(`[mp4-remuxer]: It is approximately ${xt/90} ms to the next segment; using duration ${h/90} ms for the last video frame.`)):h=Ye}else h=Ye}let ie=Math.round(P.pts-P.dts);Y=Math.min(Y,h),ee=Math.max(ee,h),$=Math.min($,me),J=Math.max(J,me),a.push(new ku(P.key,h,z,ie))}if(a.length){if(bs){if(bs<70){let k=a[0].flags;k.dependsOn=2,k.isNonSync=0}}else if(Tm&&J-$<ee-Y&&S/ee<.025&&a[0].cts===0){D.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let k=f;for(let P=0,ae=a.length;P<ae;P++){let z=k+a[P].duration,me=k+a[P].cts;if(P<ae-1){let ie=z+a[P+1].cts;a[P].duration=ie-me}else a[P].duration=P?a[P-1].duration:S;a[P].cts=0,k=z}}}h=O||!h?S:h,this.nextAvcDts=u=p+h,this.videoSampleDuration=h,this.isVideoContiguous=!0;let U={data1:ys.moof(e.sequenceNumber++,f,Ke({},e,{samples:a})),data2:B,startPTS:m/s,endPTS:(g+h)/s,startDTS:f/s,endDTS:u/s,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:e.dropped};return e.samples=[],e.dropped=0,U}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return c1;case"ac3":return u1;default:return vw}}remuxAudio(e,t,n,r,s){let o=e.inputTimeScale,a=e.samplerate?e.samplerate:o,l=o/a,c=this.getSamplesPerFrame(e),u=c*l,d=this._initPTS,h=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,f=[],p=s!==void 0,m=e.samples,g=h?0:8,y=this.nextAudioPts||-1,_=t*o,b=d.baseTime*o/d.timescale;if(this.isAudioContiguous=n=n||m.length&&y>0&&(r&&Math.abs(_-y)<9e3||Math.abs(Wt(m[0].pts-b,_)-y)<20*u),m.forEach(function(A){A.pts=Wt(A.pts-b,_)}),!n||y<0){if(m=m.filter(A=>A.pts>=0),!m.length)return;s===0?y=0:r&&!p?y=Math.max(0,_):y=m[0].pts}if(e.segmentCodec==="aac"){let A=this.config.maxAudioFramesDrift;for(let F=0,U=y;F<m.length;F++){let k=m[F],P=k.pts,ae=P-U,z=Math.abs(1e3*ae/o);if(ae<=-A*u&&p)F===0&&(D.warn(`Audio frame @ ${(P/o).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*ae/o)} ms.`),this.nextAudioPts=y=U=P);else if(ae>=A*u&&z<l1&&p){let me=Math.round(ae/u);U=P-me*u,U<0&&(me--,U+=u),F===0&&(this.nextAudioPts=y=U),D.warn(`[mp4-remuxer]: Injecting ${me} audio frame @ ${(U/o).toFixed(3)}s due to ${Math.round(1e3*ae/o)} ms gap.`);for(let ie=0;ie<me;ie++){let $e=Math.max(U,0),Ye=Mu.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);Ye||(D.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Ye=k.unit.subarray()),m.splice(F,0,{unit:Ye,pts:$e}),U+=u,F++}}k.pts=U,U+=u}}let S=null,E=null,x,w=0,R=m.length;for(;R--;)w+=m[R].unit.byteLength;for(let A=0,F=m.length;A<F;A++){let U=m[A],k=U.unit,P=U.pts;if(E!==null){let z=f[A-1];z.duration=Math.round((P-E)/l)}else if(n&&e.segmentCodec==="aac"&&(P=y),S=P,w>0){w+=g;try{x=new Uint8Array(w)}catch(z){this.observer.emit(v.ERROR,v.ERROR,{type:Z.MUX_ERROR,details:T.REMUX_ALLOC_ERROR,fatal:!1,error:z,bytes:w,reason:`fail allocating audio mdat ${w}`});return}h||(new DataView(x.buffer).setUint32(0,w),x.set(ys.types.mdat,4))}else return;x.set(k,g);let ae=k.byteLength;g+=ae,f.push(new ku(!0,c,ae,0)),E=P}let B=f.length;if(!B)return;let I=f[f.length-1];this.nextAudioPts=y=E+l*I.duration;let O=h?new Uint8Array(0):ys.moof(e.sequenceNumber++,S/l,Ke({},e,{samples:f}));e.samples=[];let Y=S/o,$=y/o,J={data1:O,data2:x,startPTS:Y,endPTS:$,startDTS:Y,endDTS:$,type:"audio",hasAudio:!0,hasVideo:!1,nb:B};return this.isAudioContiguous=!0,J}remuxEmptyAudio(e,t,n,r){let s=e.inputTimeScale,o=e.samplerate?e.samplerate:s,a=s/o,l=this.nextAudioPts,c=this._initDTS,u=c.baseTime*9e4/c.timescale,d=(l!==null?l:r.startDTS*s)+u,h=r.endDTS*s+u,f=a*vw,p=Math.ceil((h-d)/f),m=Mu.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(D.warn("[mp4-remuxer]: remux empty Audio"),!m){D.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}let g=[];for(let y=0;y<p;y++){let _=d+y*f;g.push({unit:m,pts:_,dts:_})}return e.samples=g,this.remuxAudio(e,t,n,!1)}};function Wt(i,e){let t;if(e===null)return i;for(e<i?t=-8589934592:t=8589934592;Math.abs(i-e)>4294967296;)i+=t;return i}function d1(i){for(let e=0;e<i.length;e++)if(i[e].key)return e;return-1}function pS(i,e,t,n){let r=i.samples.length;if(!r)return;let s=i.inputTimeScale;for(let a=0;a<r;a++){let l=i.samples[a];l.pts=Wt(l.pts-t.baseTime*s/t.timescale,e*s)/s,l.dts=Wt(l.dts-n.baseTime*s/n.timescale,e*s)/s}let o=i.samples;return i.samples=[],{samples:o}}function mS(i,e,t){let n=i.samples.length;if(!n)return;let r=i.inputTimeScale;for(let o=0;o<n;o++){let a=i.samples[o];a.pts=Wt(a.pts-t.baseTime*r/t.timescale,e*r)/r}i.samples.sort((o,a)=>o.pts-a.pts);let s=i.samples;return i.samples=[],{samples:s}}var ku=class{constructor(e,t,n,r){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=n,this.cts=r,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}},dg=class{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,n,r){this.audioCodec=t,this.videoCodec=n,this.generateInitSegment(FP(e,r)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:n}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}let r=this.initData=jw(e);r.audio&&(t=yw(r.audio,Ae.AUDIO)),r.video&&(n=yw(r.video,Ae.VIDEO));let s={};r.audio&&r.video?s.audiovideo={container:"video/mp4",codec:t+","+n,initSegment:e,id:"main"}:r.audio?s.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:r.video?s.video={container:"video/mp4",codec:n,initSegment:e,id:"main"}:D.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=s}remux(e,t,n,r,s,o){var a,l;let{initPTS:c,lastEndTime:u}=this,d={audio:void 0,video:void 0,text:r,id3:n,initSegment:void 0};H(u)||(u=this.lastEndTime=s||0);let h=t.samples;if(!(h!=null&&h.length))return d;let f={initPTS:void 0,timescale:1},p=this.initData;if((a=p)!=null&&a.length||(this.generateInitSegment(h),p=this.initData),!((l=p)!=null&&l.length))return D.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(f.tracks=this.initTracks,this.emitInitSegment=!1);let m=VP(h,p),g=BP(p,h),y=g===null?s:g;(h1(c,y,s,m)||f.timescale!==c.timescale&&o)&&(f.initPTS=y-s,c&&c.timescale===1&&D.warn(`Adjusting initPTS by ${f.initPTS-c.baseTime}`),this.initPTS=c={baseTime:f.initPTS,timescale:1});let _=e?y-c.baseTime/c.timescale:u,b=_+m;jP(p,h,c.baseTime/c.timescale),m>0?this.lastEndTime=b:(D.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());let S=!!p.audio,E=!!p.video,x="";S&&(x+="audio"),E&&(x+="video");let w={data1:h,startPTS:_,startDTS:_,endPTS:b,endDTS:b,type:x,hasAudio:S,hasVideo:E,nb:1,dropped:0};return d.audio=w.type==="audio"?w:void 0,d.video=w.type!=="audio"?w:void 0,d.initSegment=f,d.id3=pS(n,s,c,c),r.samples.length&&(d.text=mS(r,s,c)),d}};function h1(i,e,t,n){if(i===null)return!0;let r=Math.max(n,1),s=e-i.baseTime/i.timescale;return Math.abs(s-t)>r}function yw(i,e){let t=i?.codec;if(t&&t.length>4)return t;if(e===Ae.AUDIO){if(t==="ec-3"||t==="ac-3"||t==="alac")return t;if(t==="fLaC"||t==="Opus")return _u(t,!1);let n="mp4a.40.5";return D.info(`Parsed audio codec "${t}" or audio object type not handled. Using "${n}"`),n}return D.warn(`Unhandled video codec "${t}"`),t==="hvc1"||t==="hev1"?"hvc1.1.6.L120.90":t==="av01"?"av01.0.04M.08":"avc1.42e01e"}var ni;try{ni=self.performance.now.bind(self.performance)}catch{D.debug("Unable to use Performance API on this environment"),ni=xs?.Date.now}var du=[{demux:ig,remux:dg},{demux:lg,remux:Ss},{demux:ng,remux:Ss},{demux:ug,remux:Ss}];du.splice(2,0,{demux:rg,remux:Ss});var Lu=class{constructor(e,t,n,r,s){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=n,this.vendor=r,this.id=s}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,n,r){let s=n.transmuxing;s.executeStart=ni();let o=new Uint8Array(e),{currentTransmuxState:a,transmuxConfig:l}=this;r&&(this.currentTransmuxState=r);let{contiguous:c,discontinuity:u,trackSwitch:d,accurateTimeOffset:h,timeOffset:f,initSegmentChange:p}=r||a,{audioCodec:m,videoCodec:g,defaultInitPts:y,duration:_,initSegmentData:b}=l,S=f1(o,t);if(S&&S.method==="AES-128"){let R=this.getDecrypter();if(R.isSync()){let B=R.softwareDecrypt(o,S.key.buffer,S.iv.buffer);if(n.part>-1&&(B=R.flush()),!B)return s.executeEnd=ni(),xm(n);o=new Uint8Array(B)}else return this.decryptionPromise=R.webCryptoDecrypt(o,S.key.buffer,S.iv.buffer).then(B=>{let I=this.push(B,null,n);return this.decryptionPromise=null,I}),this.decryptionPromise}let E=this.needsProbing(u,d);if(E){let R=this.configureTransmuxer(o);if(R)return D.warn(`[transmuxer] ${R.message}`),this.observer.emit(v.ERROR,v.ERROR,{type:Z.MEDIA_ERROR,details:T.FRAG_PARSING_ERROR,fatal:!1,error:R,reason:R.message}),s.executeEnd=ni(),xm(n)}(u||d||p||E)&&this.resetInitSegment(b,m,g,_,t),(u||p||E)&&this.resetInitialTimestamp(y),c||this.resetContiguity();let x=this.transmux(o,S,f,h,n),w=this.currentTransmuxState;return w.contiguous=!0,w.discontinuity=!1,w.trackSwitch=!1,s.executeEnd=ni(),x}flush(e){let t=e.transmuxing;t.executeStart=ni();let{decrypter:n,currentTransmuxState:r,decryptionPromise:s}=this;if(s)return s.then(()=>this.flush(e));let o=[],{timeOffset:a}=r;if(n){let d=n.flush();d&&o.push(this.push(d,null,e))}let{demuxer:l,remuxer:c}=this;if(!l||!c)return t.executeEnd=ni(),[xm(e)];let u=l.flush(a);return hu(u)?u.then(d=>(this.flushRemux(o,d,e),o)):(this.flushRemux(o,u,e),o)}flushRemux(e,t,n){let{audioTrack:r,videoTrack:s,id3Track:o,textTrack:a}=t,{accurateTimeOffset:l,timeOffset:c}=this.currentTransmuxState;D.log(`[transmuxer.ts]: Flushed fragment ${n.sn}${n.part>-1?" p: "+n.part:""} of level ${n.level}`);let u=this.remuxer.remux(r,s,o,a,c,l,!0,this.id);e.push({remuxResult:u,chunkMeta:n}),n.transmuxing.executeEnd=ni()}resetInitialTimestamp(e){let{demuxer:t,remuxer:n}=this;!t||!n||(t.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){let{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,n,r,s){let{demuxer:o,remuxer:a}=this;!o||!a||(o.resetInitSegment(e,t,n,r),a.resetInitSegment(e,t,n,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,n,r,s){let o;return t&&t.method==="SAMPLE-AES"?o=this.transmuxSampleAes(e,t,n,r,s):o=this.transmuxUnencrypted(e,n,r,s),o}transmuxUnencrypted(e,t,n,r){let{audioTrack:s,videoTrack:o,id3Track:a,textTrack:l}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,o,a,l,t,n,!1,this.id),chunkMeta:r}}transmuxSampleAes(e,t,n,r,s){return this.demuxer.demuxSampleAes(e,t,n).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,n,r,!1,this.id),chunkMeta:s}))}configureTransmuxer(e){let{config:t,observer:n,typeSupported:r,vendor:s}=this,o;for(let h=0,f=du.length;h<f;h++){var a;if((a=du[h].demux)!=null&&a.probe(e)){o=du[h];break}}if(!o)return new Error("Failed to find demuxer by probing fragment data");let l=this.demuxer,c=this.remuxer,u=o.remux,d=o.demux;(!c||!(c instanceof u))&&(this.remuxer=new u(n,t,r,s)),(!l||!(l instanceof d))&&(this.demuxer=new d(n,t,r),this.probe=d.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new ca(this.config)),e}};function f1(i,e){let t=null;return i.byteLength>0&&e?.key!=null&&e.iv!==null&&e.method!=null&&(t=e),t}var xm=i=>({remuxResult:{},chunkMeta:i});function hu(i){return"then"in i&&i.then instanceof Function}var hg=class{constructor(e,t,n,r,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=n,this.duration=r,this.defaultInitPts=s||null}},fg=class{constructor(e,t,n,r,s,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=n,this.trackSwitch=r,this.timeOffset=s,this.initSegmentChange=o}},gS={exports:{}};(function(i){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function r(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function s(l,c,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new r(u,d||l,h),p=t?t+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)e.call(u,d)&&c.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=t?t+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,p=new Array(f);h<f;h++)p[h]=d[h].fn;return p},a.prototype.listenerCount=function(c){var u=t?t+c:c,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(c,u,d,h,f,p){var m=t?t+c:c;if(!this._events[m])return!1;var g=this._events[m],y=arguments.length,_,b;if(g.fn){switch(g.once&&this.removeListener(c,g.fn,void 0,!0),y){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,d),!0;case 4:return g.fn.call(g.context,u,d,h),!0;case 5:return g.fn.call(g.context,u,d,h,f),!0;case 6:return g.fn.call(g.context,u,d,h,f,p),!0}for(b=1,_=new Array(y-1);b<y;b++)_[b-1]=arguments[b];g.fn.apply(g.context,_)}else{var S=g.length,E;for(b=0;b<S;b++)switch(g[b].once&&this.removeListener(c,g[b].fn,void 0,!0),y){case 1:g[b].fn.call(g[b].context);break;case 2:g[b].fn.call(g[b].context,u);break;case 3:g[b].fn.call(g[b].context,u,d);break;case 4:g[b].fn.call(g[b].context,u,d,h);break;default:if(!_)for(E=1,_=new Array(y-1);E<y;E++)_[E-1]=arguments[E];g[b].fn.apply(g[b].context,_)}}return!0},a.prototype.on=function(c,u,d){return s(this,c,u,d,!1)},a.prototype.once=function(c,u,d){return s(this,c,u,d,!0)},a.prototype.removeListener=function(c,u,d,h){var f=t?t+c:c;if(!this._events[f])return this;if(!u)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!h||p.once)&&(!d||p.context===d)&&o(this,f);else{for(var m=0,g=[],y=p.length;m<y;m++)(p[m].fn!==u||h&&!p[m].once||d&&p[m].context!==d)&&g.push(p[m]);g.length?this._events[f]=g.length===1?g[0]:g:o(this,f)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=t?t+c:c,this._events[u]&&o(this,u)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,i.exports=a})(gS);var p1=gS.exports,Qg=aP(p1),Ou=class{constructor(e,t,n,r){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;let s=e.config;this.hls=e,this.id=t,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=n,this.onFlush=r;let o=(c,u)=>{u=u||{},u.frag=this.frag,u.id=this.id,c===v.ERROR&&(this.error=u.error),this.hls.trigger(c,u)};this.observer=new Qg,this.observer.on(v.FRAG_DECRYPTED,o),this.observer.on(v.ERROR,o);let a=vr(s.preferManagedMediaSource)||{isTypeSupported:()=>!1},l={mpeg:a.isTypeSupported("audio/mpeg"),mp3:a.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:a.isTypeSupported('audio/mp4; codecs="ac-3"')};if(this.useWorker&&typeof Worker<"u"&&(s.workerPath||HF())){try{s.workerPath?(D.log(`loading Web Worker ${s.workerPath} for "${t}"`),this.workerContext=zF(s.workerPath)):(D.log(`injecting Web Worker for "${t}"`),this.workerContext=GF()),this.onwmsg=d=>this.onWorkerMessage(d);let{worker:u}=this.workerContext;u.addEventListener("message",this.onwmsg),u.onerror=d=>{let h=new Error(`${d.message}  (${d.filename}:${d.lineno})`);s.enableWorker=!1,D.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(v.ERROR,{type:Z.OTHER_ERROR,details:T.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:h})},u.postMessage({cmd:"init",typeSupported:l,vendor:"",id:t,config:JSON.stringify(s)})}catch(u){D.warn(`Error setting up "${t}" Web Worker, fallback to inline`,u),this.resetWorker(),this.error=null,this.transmuxer=new Lu(this.observer,l,s,"",t)}return}this.transmuxer=new Lu(this.observer,l,s,"",t)}resetWorker(){if(this.workerContext){let{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{let t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}let e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,n,r,s,o,a,l,c,u){var d,h;c.transmuxing.start=self.performance.now();let{transmuxer:f}=this,p=o?o.start:s.start,m=s.decryptdata,g=this.frag,y=!(g&&s.cc===g.cc),_=!(g&&c.level===g.level),b=g?c.sn-g.sn:-1,S=this.part?c.part-this.part.index:-1,E=b===0&&c.id>1&&c.id===g?.stats.chunkCount,x=!_&&(b===1||b===0&&(S===1||E&&S<=0)),w=self.performance.now();(_||b||s.stats.parsing.start===0)&&(s.stats.parsing.start=w),o&&(S||!x)&&(o.stats.parsing.start=w);let R=!(g&&((d=s.initSegment)==null?void 0:d.url)===((h=g.initSegment)==null?void 0:h.url)),B=new fg(y,x,l,_,p,R);if(!x||y||R){D.log(`[transmuxer-interface, ${s.type}]: Starting new transmux session for sn: ${c.sn} p: ${c.part} level: ${c.level} id: ${c.id}
        discontinuity: ${y}
        trackSwitch: ${_}
        contiguous: ${x}
        accurateTimeOffset: ${l}
        timeOffset: ${p}
        initSegmentChange: ${R}`);let I=new hg(n,r,t,a,u);this.configureTransmuxer(I)}if(this.frag=s,this.part=o,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:m,chunkMeta:c,state:B},e instanceof ArrayBuffer?[e]:[]);else if(f){let I=f.push(e,m,c,B);hu(I)?(f.async=!0,I.then(O=>{this.handleTransmuxComplete(O)}).catch(O=>{this.transmuxerError(O,c,"transmuxer-interface push error")})):(f.async=!1,this.handleTransmuxComplete(I))}}flush(e){e.transmuxing.start=self.performance.now();let{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let n=t.flush(e);hu(n)||t.async?(hu(n)||(n=Promise.resolve(n)),n.then(s=>{this.handleFlushResult(s,e)}).catch(s=>{this.transmuxerError(s,e,"transmuxer-interface flush error")})):this.handleFlushResult(n,e)}}transmuxerError(e,t,n){this.hls&&(this.error=e,this.hls.trigger(v.ERROR,{type:Z.MEDIA_ERROR,details:T.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,t){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(t)}onWorkerMessage(e){let t=e.data;if(!(t!=null&&t.event)){D.warn(`worker message received with no ${t?"event name":"data"}`);return}let n=this.hls;if(this.hls)switch(t.event){case"init":{var r;let s=(r=this.workerContext)==null?void 0:r.objectURL;s&&self.URL.revokeObjectURL(s);break}case"transmuxComplete":{this.handleTransmuxComplete(t.data);break}case"flush":{this.onFlush(t.data);break}case"workerLog":D[t.data.logType]&&D[t.data.logType](t.data.message);break;default:{t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,n.trigger(t.event,t.data);break}}}configureTransmuxer(e){let{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}};function vS(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!Is(i[t].attrs,e[t].attrs))return!1;return!0}function Is(i,e,t){let n=i["STABLE-RENDITION-ID"];return n&&!t?n===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(r=>i[r]!==e[r])}function pg(i,e){return e.label.toLowerCase()===i.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(i.lang||"").toLowerCase())}var bw=100,mg=class extends ua{constructor(e,t,n){super(e,t,n,"[audio-stream-controller]",K.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){let{hls:e}=this;e.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.LEVEL_LOADED,this.onLevelLoaded,this),e.on(v.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(v.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(v.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(v.ERROR,this.onError,this),e.on(v.BUFFER_RESET,this.onBufferReset,this),e.on(v.BUFFER_CREATED,this.onBufferCreated,this),e.on(v.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(v.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(v.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(v.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){let{hls:e}=this;e.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.LEVEL_LOADED,this.onLevelLoaded,this),e.off(v.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(v.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(v.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(v.ERROR,this.onError,this),e.off(v.BUFFER_RESET,this.onBufferReset,this),e.off(v.BUFFER_CREATED,this.onBufferCreated,this),e.off(v.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(v.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(v.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(v.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:s}){if(n==="main"){let o=t.cc;this.initPTS[t.cc]={baseTime:r,timescale:s},this.log(`InitPTS for cc: ${o} found from main: ${r}`),this.videoTrackCC=o,this.state===M.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=M.STOPPED;return}let t=this.lastCurrentTime;this.stopLoad(),this.setInterval(bw),t>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=M.IDLE):(this.loadedmetadata=!1,this.state=M.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case M.IDLE:this.doTickIdle();break;case M.WAITING_TRACK:{var e;let{levels:n,trackId:r}=this,s=n==null||(e=n[r])==null?void 0:e.details;if(s){if(this.waitForCdnTuneIn(s))break;this.state=M.WAITING_INIT_PTS}break}case M.FRAG_LOADING_WAITING_RETRY:{var t;let n=performance.now(),r=this.retryDate;if(!r||n>=r||(t=this.media)!=null&&t.seeking){let{levels:s,trackId:o}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(s?.[o]||null),this.state=M.IDLE}break}case M.WAITING_INIT_PTS:{let n=this.waitingData;if(n){let{frag:r,part:s,cache:o,complete:a}=n;if(this.initPTS[r.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=M.FRAG_LOADING;let l=o.flush(),c={frag:r,part:s,payload:l,networkDetails:null};this._handleFragmentLoadProgress(c),a&&super._handleFragmentLoadComplete(c)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${r.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{let l=this.getLoadPosition(),c=Fe.bufferInfo(this.mediaBuffer,l,this.config.maxBufferHole);Wm(c.end,this.config.maxFragLookUpTolerance,r)<0&&(this.log(`Waiting fragment cc (${r.cc}) @ ${r.start} cancelled because another fragment at ${c.end} is needed`),this.clearWaitingFragment())}}else this.state=M.IDLE}}this.onTickEnd()}clearWaitingFragment(){let e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=M.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){let{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){let{hls:e,levels:t,media:n,trackId:r}=this,s=e.config;if(!n&&(this.startFragRequested||!s.startFragPrefetch)||!(t!=null&&t[r]))return;let o=t[r],a=o.details;if(!a||a.live&&this.levelLastLoaded!==o||this.waitForCdnTuneIn(a)){this.state=M.WAITING_TRACK;return}let l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,Ae.AUDIO,K.AUDIO));let c=this.getFwdBufferInfo(l,K.AUDIO);if(c===null)return;let{bufferedTrack:u,switchingTrack:d}=this;if(!d&&this._streamEnded(c,a)){e.trigger(v.BUFFER_EOS,{type:"audio"}),this.state=M.ENDED;return}let h=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,K.MAIN),f=c.len,p=this.getMaxBufferLength(h?.len),m=a.fragments,g=m[0].start,y=this.flushing?this.getLoadPosition():c.end;if(d&&n){let E=this.getLoadPosition();u&&!Is(d.attrs,u.attrs)&&(y=E),a.PTSKnown&&E<g&&(c.end>g||c.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=g+.05)}if(f>=p&&!d&&y<m[m.length-1].start)return;let _=this.getNextFragment(y,a),b=!1;if(_&&this.isLoopLoading(_,y)&&(b=!!_.gap,_=this.getNextFragmentLoopLoading(_,a,c,K.MAIN,p)),!_){this.bufferFlushed=!0;return}let S=h&&_.start>h.end+a.targetduration;if(S||!(h!=null&&h.len)&&c.len){let E=this.getAppendedFrag(_.start,K.MAIN);if(E===null||(b||(b=!!E.gap||!!S&&h.len===0),S&&!b||b&&c.nextStart&&c.nextStart<E.end))return}this.loadFragment(_,o,y)}getMaxBufferLength(e){let t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(n=>new Si(n))}onAudioTrackSwitching(e,t){let n=!!t.url;this.trackId=t.id;let{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),n?this.setInterval(bw):this.resetTransmuxer(),n?(this.switchingTrack=t,this.state=M.IDLE,this.flushAudioIfNeeded(t)):(this.switchingTrack=null,this.bufferedTrack=t,this.state=M.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(v.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var n;if(this.mainDetails==null){this.cachedTrackLoadedData=t;return}let{levels:r}=this,{details:s,id:o}=t;if(!r){this.warn(`Audio tracks were reset while loading level ${o}`);return}this.log(`Audio track ${o} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`);let a=r[o],l=0;if(s.live||(n=a.details)!=null&&n.live){this.checkLiveUpdate(s);let u=this.mainDetails;if(s.deltaUpdateFailed||!u)return;if(!a.details&&s.hasProgramDateTime&&u.hasProgramDateTime)xu(s,u),l=s.fragments[0].start;else{var c;l=this.alignPlaylists(s,a.details,(c=this.levelLastLoaded)==null?void 0:c.details)}}a.details=s,this.levelLastLoaded=a,!this.startFragRequested&&(this.mainDetails||!s.live)&&this.setStartPosition(this.mainDetails||s,l),this.state===M.WAITING_TRACK&&!this.waitForCdnTuneIn(s)&&(this.state=M.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;let{frag:n,part:r,payload:s}=e,{config:o,trackId:a,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}let c=l[a];if(!c){this.warn("Audio track is undefined on fragment load progress");return}let u=c.details;if(!u){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}let d=o.defaultAudioCodec||c.audioCodec||"mp4a.40.2",h=this.transmuxer;h||(h=this.transmuxer=new Ou(this.hls,K.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));let f=this.initPTS[n.cc],p=(t=n.initSegment)==null?void 0:t.data;if(f!==void 0){let g=r?r.index:-1,y=g!==-1,_=new la(n.level,n.sn,n.stats.chunkCount,s.byteLength,g,y);h.push(s,p,d,"",n,r,u.totalduration,!1,_,f)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${u.startSN} ,${u.endSN}],track ${a}`);let{cache:m}=this.waitingData=this.waitingData||{frag:n,part:r,cache:new Iu,complete:!1};m.push(new Uint8Array(s)),this.waitingVideoCC=this.videoTrackCC,this.state=M.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){let n=t.tracks.audio;n&&(this.mediaBuffer=n.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){let{frag:n,part:r}=t;if(n.type!==K.AUDIO){if(!this.loadedmetadata&&n.type===K.MAIN){let s=this.videoBuffer||this.media;s&&Fe.getBuffered(s).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(n.sn!=="initSegment"){this.fragPrevious=n;let s=this.switchingTrack;s&&(this.bufferedTrack=s,this.switchingTrack=null,this.hls.trigger(v.AUDIO_TRACK_SWITCHED,rt({},s)))}this.fragBufferedComplete(n,r)}onError(e,t){var n;if(t.fatal){this.state=M.ERROR;return}switch(t.details){case T.FRAG_GAP:case T.FRAG_PARSING_ERROR:case T.FRAG_DECRYPT_ERROR:case T.FRAG_LOAD_ERROR:case T.FRAG_LOAD_TIMEOUT:case T.KEY_LOAD_ERROR:case T.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(K.AUDIO,t);break;case T.AUDIO_TRACK_LOAD_ERROR:case T.AUDIO_TRACK_LOAD_TIMEOUT:case T.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===M.WAITING_TRACK&&((n=t.context)==null?void 0:n.type)===De.AUDIO_TRACK&&(this.state=M.IDLE);break;case T.BUFFER_APPEND_ERROR:case T.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="audio")return;if(t.details===T.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case T.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==Ae.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==Ae.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===M.ENDED&&(this.state=M.IDLE);let n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,t,K.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;let n="audio",{hls:r}=this,{remuxResult:s,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a){this.resetWhenMissingContext(o);return}let{frag:l,part:c,level:u}=a,{details:d}=u,{audio:h,text:f,id3:p,initSegment:m}=s;if(this.fragContextChanged(l)||!d){this.fragmentTracker.removeFragment(l);return}if(this.state=M.PARSING,this.switchingTrack&&h&&this.completeAudioSwitch(this.switchingTrack),m!=null&&m.tracks){let g=l.initSegment||l;this._bufferInitSegment(u,m.tracks,g,o),r.trigger(v.FRAG_PARSING_INIT_SEGMENT,{frag:g,id:n,tracks:m.tracks})}if(h){let{startPTS:g,endPTS:y,startDTS:_,endDTS:b}=h;c&&(c.elementaryStreams[Ae.AUDIO]={startPTS:g,endPTS:y,startDTS:_,endDTS:b}),l.setElementaryStreamInfo(Ae.AUDIO,g,y,_,b),this.bufferFragmentData(h,l,c,o)}if(p!=null&&(t=p.samples)!=null&&t.length){let g=Ke({id:n,frag:l,details:d},p);r.trigger(v.FRAG_PARSING_METADATA,g)}if(f){let g=Ke({id:n,frag:l,details:d},f);r.trigger(v.FRAG_PARSING_USERDATA,g)}}_bufferInitSegment(e,t,n,r){if(this.state!==M.PARSING)return;t.video&&delete t.video;let s=t.audio;if(!s)return;s.id="audio";let o=e.audioCodec;this.log(`Init audio buffer, container:${s.container}, codecs[level/parsed]=[${o}/${s.codec}]`),o&&o.split(",").length===1&&(s.levelCodec=o),this.hls.trigger(v.BUFFER_CODECS,t);let a=s.initSegment;if(a!=null&&a.byteLength){let l={type:"audio",frag:n,part:null,chunkMeta:r,parent:n.type,data:a};this.hls.trigger(v.BUFFER_APPENDING,l)}this.tickImmediate()}loadFragment(e,t,n){let r=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||r===it.NOT_LOADED||r===it.PARTIAL){var s;if(e.sn==="initSegment")this._loadInitSegment(e,t);else if((s=t.details)!=null&&s.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=M.WAITING_INIT_PTS;let o=this.mainDetails;o&&o.fragments[0].start!==t.details.fragments[0].start&&xu(t.details,o)}else this.startFragRequested=!0,super.loadFragment(e,t,n)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){let{media:t,bufferedTrack:n}=this,r=n?.attrs,s=e.attrs;t&&r&&(r.CHANNELS!==s.CHANNELS||n.name!==e.name||n.lang!==e.lang)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}completeAudioSwitch(e){let{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(v.AUDIO_TRACK_SWITCHED,rt({},e))}},gg=class extends aa{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){let{hls:e}=this;e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.MANIFEST_PARSED,this.onManifestParsed,this),e.on(v.LEVEL_LOADING,this.onLevelLoading,this),e.on(v.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(v.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(v.ERROR,this.onError,this)}unregisterListeners(){let{hls:e}=this;e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.MANIFEST_PARSED,this.onManifestParsed,this),e.off(v.LEVEL_LOADING,this.onLevelLoading,this),e.off(v.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(v.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(v.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){let{id:n,groupId:r,details:s}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==r){this.warn(`Audio track with id:${n} and group:${r} not found in active group ${o?.groupId}`);return}let a=o.details;o.details=t.details,this.log(`Audio track ${n} "${o.name}" lang:${o.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){let t=this.hls.levels[e];if(!t)return;let n=t.audioGroups||null,r=this.groupIds,s=this.currentTrack;if(!n||r?.length!==n?.length||n!=null&&n.some(a=>r?.indexOf(a)===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;let a=this.tracks.filter(h=>!n||n.indexOf(h.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(h=>h.default)&&(this.selectDefaultTrack=!1),a.forEach((h,f)=>{h.id=f});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=a;let l=this.hls.config.audioPreference;if(!s&&l){let h=Pn(l,a,ms);if(h>-1)s=a[h];else{let f=Pn(l,this.tracks);s=this.tracks[f]}}let c=this.findTrackId(s);c===-1&&s&&(c=this.findTrackId(null));let u={audioTracks:a};this.log(`Updating audio tracks, ${a.length} track(s) found in group(s): ${n?.join(",")}`),this.hls.trigger(v.AUDIO_TRACKS_UPDATED,u);let d=this.trackId;if(c!==-1&&d===-1)this.setAudioTrack(c);else if(a.length&&d===-1){var o;let h=new Error(`No audio track selected for current audio group-ID(s): ${(o=this.groupIds)==null?void 0:o.join(",")} track count: ${a.length}`);this.warn(h.message),this.hls.trigger(v.ERROR,{type:Z.MEDIA_ERROR,details:T.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:h})}}else this.shouldReloadPlaylist(s)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===De.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&(this.requestScheduled=-1,this.checkRetry(t))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){let t=this.hls;if(t.config.audioPreference=e,e){let n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){let r=this.currentTrack;if(r&&ws(e,r,ms))return r;let s=Pn(e,this.tracksInGroup,ms);if(s>-1){let o=this.tracksInGroup[s];return this.setAudioTrack(s),o}else if(r){let o=t.loadLevel;o===-1&&(o=t.firstAutoLevel);let a=LF(e,t.levels,n,o,ms);if(a===-1)return null;t.nextLoadLevel=a}if(e.channels||e.audioCodec){let o=Pn(e,n);if(o>-1)return n[o]}}}return null}setAudioTrack(e){let t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;let n=this.currentTrack,r=t[e],s=r.details&&!r.details.live;if(e===this.trackId&&r===n&&s||(this.log(`Switching to audio-track ${e} "${r.name}" lang:${r.lang} group:${r.groupId} channels:${r.channels}`),this.trackId=e,this.currentTrack=r,this.hls.trigger(v.AUDIO_TRACK_SWITCHING,rt({},r)),s))return;let o=this.switchParams(r.url,n?.details,r.details);this.loadPlaylist(o)}findTrackId(e){let t=this.tracksInGroup;for(let n=0;n<t.length;n++){let r=t[n];if(!(this.selectDefaultTrack&&!r.default)&&(!e||ws(e,r,ms)))return n}if(e){let{name:n,lang:r,assocLang:s,characteristics:o,audioCodec:a,channels:l}=e;for(let c=0;c<t.length;c++){let u=t[c];if(ws({name:n,lang:r,assocLang:s,characteristics:o,audioCodec:a,channels:l},u,ms))return c}for(let c=0;c<t.length;c++){let u=t[c];if(Is(e.attrs,u.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return c}for(let c=0;c<t.length;c++){let u=t[c];if(Is(e.attrs,u.attrs,["LANGUAGE"]))return c}}return-1}loadPlaylist(e){let t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){super.loadPlaylist();let n=t.id,r=t.groupId,s=t.url;if(e)try{s=e.addDirectives(s)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`loading audio-track playlist ${n} "${t.name}" lang:${t.lang} group:${r}`),this.clearTimer(),this.hls.trigger(v.AUDIO_TRACK_LOADING,{url:s,id:n,groupId:r,deliveryDirectives:e||null})}}},_w=500,vg=class extends ua{constructor(e,t,n){super(e,t,n,"[subtitle-stream-controller]",K.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){let{hls:e}=this;e.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.LEVEL_LOADED,this.onLevelLoaded,this),e.on(v.ERROR,this.onError,this),e.on(v.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(v.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(v.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(v.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(v.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(v.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){let{hls:e}=this;e.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.LEVEL_LOADED,this.onLevelLoaded,this),e.off(v.ERROR,this.onError,this),e.off(v.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(v.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(v.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(v.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(v.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(v.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=M.IDLE,this.setInterval(_w),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){let{frag:n,success:r}=t;if(this.fragPrevious=n,this.state=M.IDLE,!r)return;let s=this.tracksBuffered[this.currentTrackId];if(!s)return;let o,a=n.start;for(let c=0;c<s.length;c++)if(a>=s[c].start&&a<=s[c].end){o=s[c];break}let l=n.start+n.duration;o?o.end=l:(o={start:a,end:l},s.push(o)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null)}onBufferFlushing(e,t){let{startOffset:n,endOffset:r}=t;if(n===0&&r!==Number.POSITIVE_INFINITY){let s=r-1;if(s<=0)return;t.endOffsetSubtitles=Math.max(0,s),this.tracksBuffered.forEach(o=>{for(let a=0;a<o.length;){if(o[a].end<=s){o.shift();continue}else if(o[a].start<s)o[a].start=s;else break;a++}}),this.fragmentTracker.removeFragmentsInRange(n,s,K.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===K.MAIN){var n;(n=this.media)!=null&&n.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){let n=t.frag;n?.type===K.SUBTITLE&&(t.details===T.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==M.STOPPED&&(this.state=M.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&vS(this.levels,t)){this.levels=t.map(n=>new Si(n));return}this.tracksBuffered=[],this.levels=t.map(n=>{let r=new Si(n);return this.tracksBuffered[r.id]=[],r}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,K.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var n;if(this.currentTrackId=t.id,!((n=this.levels)!=null&&n.length)||this.currentTrackId===-1){this.clearInterval();return}let r=this.levels[this.currentTrackId];r!=null&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.setInterval(_w)}onSubtitleTrackLoaded(e,t){var n;let{currentTrackId:r,levels:s}=this,{details:o,id:a}=t;if(!s){this.warn(`Subtitle tracks were reset while loading level ${a}`);return}let l=s[a];if(a>=s.length||!l)return;this.log(`Subtitle track ${a} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let c=0;if(o.live||(n=l.details)!=null&&n.live){let d=this.mainDetails;if(o.deltaUpdateFailed||!d)return;let h=d.fragments[0];if(!l.details)o.hasProgramDateTime&&d.hasProgramDateTime?(xu(o,d),c=o.fragments[0].start):h&&(c=h.start,zm(o,c));else{var u;c=this.alignPlaylists(o,l.details,(u=this.levelLastLoaded)==null?void 0:u.details),c===0&&h&&(c=h.start,zm(o,c))}}l.details=o,this.levelLastLoaded=l,a===r&&(!this.startFragRequested&&(this.mainDetails||!o.live)&&this.setStartPosition(this.mainDetails||o,c),this.tick(),o.live&&!this.fragCurrent&&this.media&&this.state===M.IDLE&&(Tu(null,o.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0)))}_handleFragmentLoadComplete(e){let{frag:t,payload:n}=e,r=t.decryptdata,s=this.hls;if(!this.fragContextChanged(t)&&n&&n.byteLength>0&&r!=null&&r.key&&r.iv&&r.method==="AES-128"){let o=performance.now();this.decrypter.decrypt(new Uint8Array(n),r.key.buffer,r.iv.buffer).catch(a=>{throw s.trigger(v.ERROR,{type:Z.MEDIA_ERROR,details:T.FRAG_DECRYPT_ERROR,fatal:!1,error:a,reason:a.message,frag:t}),a}).then(a=>{let l=performance.now();s.trigger(v.FRAG_DECRYPTED,{frag:t,payload:a,stats:{tstart:o,tdecrypt:l}})}).catch(a=>{this.warn(`${a.name}: ${a.message}`),this.state=M.IDLE})}}doTick(){if(!this.media){this.state=M.IDLE;return}if(this.state===M.IDLE){let{currentTrackId:e,levels:t}=this,n=t?.[e];if(!n||!t.length||!n.details)return;let{config:r}=this,s=this.getLoadPosition(),o=Fe.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],s,r.maxBufferHole),{end:a,len:l}=o,c=this.getFwdBufferInfo(this.media,K.MAIN),u=n.details,d=this.getMaxBufferLength(c?.len)+u.levelTargetDuration;if(l>d)return;let h=u.fragments,f=h.length,p=u.edge,m=null,g=this.fragPrevious;if(a<p){let y=r.maxFragLookUpTolerance,_=a>p-y?0:y;m=Tu(g,h,Math.max(h[0].start,a),_),!m&&g&&g.start<h[0].start&&(m=h[0])}else m=h[f-1];if(!m)return;if(m=this.mapToInitFragWhenRequired(m),m.sn!=="initSegment"){let y=m.sn-u.startSN,_=h[y-1];_&&_.cc===m.cc&&this.fragmentTracker.getState(_)===it.NOT_LOADED&&(m=_)}this.fragmentTracker.getState(m)===it.NOT_LOADED&&this.loadFragment(m,n,a)}}getMaxBufferLength(e){let t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,n){this.fragCurrent=e,e.sn==="initSegment"?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,n))}get mediaBufferTimeRanges(){return new yg(this.tracksBuffered[this.currentTrackId]||[])}},yg=class{constructor(e){this.buffered=void 0;let t=(n,r,s)=>{if(r=r>>>0,r>s-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${s})`);return e[r][n]};this.buffered={get length(){return e.length},end(n){return t("end",n,e.length)},start(n){return t("start",n,e.length)}}}},bg=class extends aa{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null,n=lu(this.media.textTracks);for(let s=0;s<n.length;s++)if(n[s].mode==="hidden")t=n[s];else if(n[s].mode==="showing"){t=n[s];break}let r=this.findTrackForTextTrack(t);this.subtitleTrack!==r&&this.setSubtitleTrack(r)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){let{hls:e}=this;e.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.MANIFEST_PARSED,this.onManifestParsed,this),e.on(v.LEVEL_LOADING,this.onLevelLoading,this),e.on(v.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(v.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(v.ERROR,this.onError,this)}unregisterListeners(){let{hls:e}=this;e.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.MANIFEST_PARSED,this.onManifestParsed,this),e.off(v.LEVEL_LOADING,this.onLevelLoading,this),e.off(v.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(v.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(v.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),lu(this.media.textTracks).forEach(t=>{_s(t)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){let{id:n,groupId:r,details:s}=t,o=this.tracksInGroup[n];if(!o||o.groupId!==r){this.warn(`Subtitle track with id:${n} and group:${r} not found in active group ${o?.groupId}`);return}let a=o.details;o.details=t.details,this.log(`Subtitle track ${n} "${o.name}" lang:${o.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),n===this.trackId&&this.playlistLoaded(n,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){let t=this.hls.levels[e];if(!t)return;let n=t.subtitleGroups||null,r=this.groupIds,s=this.currentTrack;if(!n||r?.length!==n?.length||n!=null&&n.some(o=>r?.indexOf(o)===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;let o=this.tracks.filter(u=>!n||n.indexOf(u.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(u=>u.default)&&(this.selectDefaultTrack=!1),o.forEach((u,d)=>{u.id=d});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=o;let a=this.hls.config.subtitlePreference;if(!s&&a){this.selectDefaultTrack=!1;let u=Pn(a,o);if(u>-1)s=o[u];else{let d=Pn(a,this.tracks);s=this.tracks[d]}}let l=this.findTrackId(s);l===-1&&s&&(l=this.findTrackId(null));let c={subtitleTracks:o};this.log(`Updating subtitle tracks, ${o.length} track(s) found in "${n?.join(",")}" group-id`),this.hls.trigger(v.SUBTITLE_TRACKS_UPDATED,c),l!==-1&&this.trackId===-1&&this.setSubtitleTrack(l)}else this.shouldReloadPlaylist(s)&&this.setSubtitleTrack(this.trackId)}findTrackId(e){let t=this.tracksInGroup,n=this.selectDefaultTrack;for(let r=0;r<t.length;r++){let s=t[r];if(!(n&&!s.default||!n&&!e)&&(!e||ws(s,e)))return r}if(e){for(let r=0;r<t.length;r++){let s=t[r];if(Is(e.attrs,s.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return r}for(let r=0;r<t.length;r++){let s=t[r];if(Is(e.attrs,s.attrs,["LANGUAGE"]))return r}}return-1}findTrackForTextTrack(e){if(e){let t=this.tracksInGroup;for(let n=0;n<t.length;n++){let r=t[n];if(pg(r,e))return n}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===De.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){let t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){let n=this.currentTrack;if(n&&ws(e,n))return n;let r=Pn(e,this.tracksInGroup);if(r>-1){let s=this.tracksInGroup[r];return this.setSubtitleTrack(r),s}else{if(n)return null;{let s=Pn(e,t);if(s>-1)return t[s]}}}}return null}loadPlaylist(e){super.loadPlaylist();let t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){let n=t.id,r=t.groupId,s=t.url;if(e)try{s=e.addDirectives(s)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`Loading subtitle playlist for id ${n}`),this.hls.trigger(v.SUBTITLE_TRACK_LOADING,{url:s,id:n,groupId:r,deliveryDirectives:e||null})}}toggleTrackModes(){let{media:e}=this;if(!e)return;let t=lu(e.textTracks),n=this.currentTrack,r;if(n&&(r=t.filter(s=>pg(n,s))[0],r||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(t).forEach(s=>{s.mode!=="disabled"&&s!==r&&(s.mode="disabled")}),r){let s=this.subtitleDisplay?"showing":"hidden";r.mode!==s&&(r.mode=s)}}setSubtitleTrack(e){let t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!H(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;let n=this.currentTrack,r=t[e]||null;if(this.trackId=e,this.currentTrack=r,this.toggleTrackModes(),!r){this.hls.trigger(v.SUBTITLE_TRACK_SWITCH,{id:e});return}let s=!!r.details&&!r.details.live;if(e===this.trackId&&r===n&&s)return;this.log(`Switching to subtitle-track ${e}`+(r?` "${r.name}" lang:${r.lang} group:${r.groupId}`:""));let{id:o,groupId:a="",name:l,type:c,url:u}=r;this.hls.trigger(v.SUBTITLE_TRACK_SWITCH,{id:o,groupId:a,name:l,type:c,url:u});let d=this.switchParams(r.url,n?.details,r.details);this.loadPlaylist(d)}},_g=class{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t,n){let r=this.queues[t];r.push(e),r.length===1&&!n&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t,n=new Promise(s=>{t=s}),r={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(r,e),n}executeNext(e){let t=this.queues[e];if(t.length){let n=t[0];try{n.execute()}catch(r){D.warn(`[buffer-operation-queue]: Exception executing "${e}" SourceBuffer operation: ${r}`),n.onError(r);let s=this.buffers[e];s!=null&&s.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}},Ew=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,Eg=class{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=n=>{this.hls&&this.hls.pauseBuffering()},this._onStartStreaming=n=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{let{media:n,mediaSource:r}=this;this.log("Media source opened"),n&&(n.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(v.MEDIA_ATTACHED,{media:n,mediaSource:r})),r&&r.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{let{mediaSrc:n,_objectUrl:r}=this;n!==r&&D.error(`Media element src was set while attaching MediaSource (${r} > ${n})`)},this.hls=e;let t="[buffer-controller]";this.appendSource=ZP(vr(e.config.preferManagedMediaSource)),this.log=D.log.bind(D,t),this.warn=D.warn.bind(D,t),this.error=D.error.bind(D,t),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){let{hls:e}=this;e.on(v.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.MANIFEST_PARSED,this.onManifestParsed,this),e.on(v.BUFFER_RESET,this.onBufferReset,this),e.on(v.BUFFER_APPENDING,this.onBufferAppending,this),e.on(v.BUFFER_CODECS,this.onBufferCodecs,this),e.on(v.BUFFER_EOS,this.onBufferEos,this),e.on(v.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(v.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(v.FRAG_PARSED,this.onFragParsed,this),e.on(v.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){let{hls:e}=this;e.off(v.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.MANIFEST_PARSED,this.onManifestParsed,this),e.off(v.BUFFER_RESET,this.onBufferReset,this),e.off(v.BUFFER_APPENDING,this.onBufferAppending,this),e.off(v.BUFFER_CODECS,this.onBufferCodecs,this),e.off(v.BUFFER_EOS,this.onBufferEos,this),e.off(v.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(v.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(v.FRAG_PARSED,this.onFragParsed,this),e.off(v.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new _g(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){let n=this.media=t.media,r=vr(this.appendSource);if(n&&r){var s;let o=this.mediaSource=new r;this.log(`created media source: ${(s=o.constructor)==null?void 0:s.name}`),o.addEventListener("sourceopen",this._onMediaSourceOpen),o.addEventListener("sourceended",this._onMediaSourceEnded),o.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(o.addEventListener("startstreaming",this._onStartStreaming),o.addEventListener("endstreaming",this._onEndStreaming));let a=this._objectUrl=self.URL.createObjectURL(o);if(this.appendSource)try{n.removeAttribute("src");let l=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||l&&o instanceof l,Dw(n),m1(n,a),n.load()}catch{n.src=a}else n.src=a;n.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){let{media:e,mediaSource:t,_objectUrl:n}=this;if(t){if(this.log("media source detaching"),t.readyState==="open")try{t.endOfStream()}catch(r){this.warn(`onMediaDetaching: ${r.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming)),e&&(e.removeEventListener("emptied",this._onMediaEmptied),n&&self.URL.revokeObjectURL(n),this.mediaSrc===n?(e.removeAttribute("src"),this.appendSource&&Dw(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(v.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{this.resetBuffer(e)}),this._initSourceBuffer()}resetBuffer(e){let t=this.sourceBuffer[e];try{if(t){var n;this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,(n=this.mediaSource)!=null&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(t)}}catch(r){this.warn(`onBufferReset ${e}`,r)}}onBufferCodecs(e,t){let n=this.getSourceBufferTypes().length,r=Object.keys(t);if(r.forEach(o=>{if(n){let l=this.tracks[o];if(l&&typeof l.buffer.changeType=="function"){var a;let{id:c,codec:u,levelCodec:d,container:h,metadata:f}=t[o],p=KD(l.codec,l.levelCodec),m=p?.replace(Ew,"$1"),g=KD(u,d),y=(a=g)==null?void 0:a.replace(Ew,"$1");if(g&&m!==y){o.slice(0,5)==="audio"&&(g=_u(g,this.appendSource));let _=`${h};codecs=${g}`;this.appendChangeType(o,_),this.log(`switching codec ${p} to ${g}`),this.tracks[o]={buffer:l.buffer,codec:u,container:h,levelCodec:d,metadata:f,id:c}}}}else this.pendingTracks[o]=t[o]}),n)return;let s=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==s&&(this.log(`${s} bufferCodec event(s) expected ${r.join(",")}`),this.bufferCodecEventsExpected=s),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks()}appendChangeType(e,t){let{operationQueue:n}=this,r={execute:()=>{let s=this.sourceBuffer[e];s&&(this.log(`changing ${e} sourceBuffer type to ${t}`),s.changeType(t)),n.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:s=>{this.warn(`Failed to change ${e} SourceBuffer type`,s)}};n.append(r,e,!!this.pendingTracks[e])}onBufferAppending(e,t){let{hls:n,operationQueue:r,tracks:s}=this,{data:o,type:a,frag:l,part:c,chunkMeta:u}=t,d=u.buffering[a],h=self.performance.now();d.start=h;let f=l.stats.buffering,p=c?c.stats.buffering:null;f.start===0&&(f.start=h),p&&p.start===0&&(p.start=h);let m=s.audio,g=!1;a==="audio"&&m?.container==="audio/mpeg"&&(g=!this.lastMpegAudioChunk||u.id===1||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);let y=l.start,_={execute:()=>{if(d.executeStart=self.performance.now(),g){let b=this.sourceBuffer[a];if(b){let S=y-b.timestampOffset;Math.abs(S)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${y} (delta: ${S}) sn: ${l.sn})`),b.timestampOffset=y)}}this.appendExecutor(o,a)},onStart:()=>{},onComplete:()=>{let b=self.performance.now();d.executeEnd=d.end=b,f.first===0&&(f.first=b),p&&p.first===0&&(p.first=b);let{sourceBuffer:S}=this,E={};for(let x in S)E[x]=Fe.getBuffered(S[x]);this.appendErrors[a]=0,a==="audio"||a==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(v.BUFFER_APPENDED,{type:a,frag:l,part:c,chunkMeta:u,parent:l.type,timeRanges:E})},onError:b=>{let S={type:Z.MEDIA_ERROR,parent:l.type,details:T.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:l,part:c,chunkMeta:u,error:b,err:b,fatal:!1};if(b.code===DOMException.QUOTA_EXCEEDED_ERR)S.details=T.BUFFER_FULL_ERROR;else{let E=++this.appendErrors[a];S.details=T.BUFFER_APPEND_ERROR,this.warn(`Failed ${E}/${n.config.appendErrorMaxRetry} times to append segment in "${a}" sourceBuffer`),E>=n.config.appendErrorMaxRetry&&(S.fatal=!0)}n.trigger(v.ERROR,S)}};r.append(_,a,!!this.pendingTracks[a])}onBufferFlushing(e,t){let{operationQueue:n}=this,r=s=>({execute:this.removeExecutor.bind(this,s,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(v.BUFFER_FLUSHED,{type:s})},onError:o=>{this.warn(`Failed to remove from ${s} SourceBuffer`,o)}});t.type?n.append(r(t.type),t.type):this.getSourceBufferTypes().forEach(s=>{n.append(r(s),s)})}onFragParsed(e,t){let{frag:n,part:r}=t,s=[],o=r?r.elementaryStreams:n.elementaryStreams;o[Ae.AUDIOVIDEO]?s.push("audiovideo"):(o[Ae.AUDIO]&&s.push("audio"),o[Ae.VIDEO]&&s.push("video"));let a=()=>{let l=self.performance.now();n.stats.buffering.end=l,r&&(r.stats.buffering.end=l);let c=r?r.stats:n.stats;this.hls.trigger(v.FRAG_BUFFERED,{frag:n,part:r,stats:c,id:n.type})};s.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(a,s)}onFragChanged(e,t){this.trimBuffers()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((r,s)=>{let o=this.sourceBuffer[s];return o&&(!t.type||t.type===s)&&(o.ending=!0,o.ended||(o.ended=!0,this.log(`${s} sourceBuffer now EOS`))),r&&!!(!o||o.ended)},!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(s=>{let o=this.sourceBuffer[s];o&&(o.ending=!1)});let{mediaSource:r}=this;if(!r||r.readyState!=="open"){r&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${r.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),r.endOfStream()}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){let{hls:e,details:t,media:n}=this;if(!n||t===null||!this.getSourceBufferTypes().length)return;let s=e.config,o=n.currentTime,a=t.levelTargetDuration,l=t.live&&s.liveBackBufferLength!==null?s.liveBackBufferLength:s.backBufferLength;if(H(l)&&l>0){let c=Math.max(l,a),u=Math.floor(o/a)*a-c;this.flushBackBuffer(o,a,u)}if(H(s.frontBufferFlushThreshold)&&s.frontBufferFlushThreshold>0){let c=Math.max(s.maxBufferLength,s.frontBufferFlushThreshold),u=Math.max(c,a),d=Math.floor(o/a)*a+u;this.flushFrontBuffer(o,a,d)}}flushBackBuffer(e,t,n){let{details:r,sourceBuffer:s}=this;this.getSourceBufferTypes().forEach(a=>{let l=s[a];if(l){let c=Fe.getBuffered(l);if(c.length>0&&n>c.start(0)){if(this.hls.trigger(v.BACK_BUFFER_REACHED,{bufferEnd:n}),r!=null&&r.live)this.hls.trigger(v.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(l.ended&&c.end(c.length-1)-e<t*2){this.log(`Cannot flush ${a} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(v.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:a})}}})}flushFrontBuffer(e,t,n){let{sourceBuffer:r}=this;this.getSourceBufferTypes().forEach(o=>{let a=r[o];if(a){let l=Fe.getBuffered(a),c=l.length;if(c<2)return;let u=l.start(c-1),d=l.end(c-1);if(n>u||e>=u&&e<=d)return;if(a.ended&&e-d<2*t){this.log(`Cannot flush ${o} front buffer while SourceBuffer is in ended state`);return}this.hls.trigger(v.BUFFER_FLUSHING,{startOffset:u,endOffset:1/0,type:o})}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;let{details:e,hls:t,media:n,mediaSource:r}=this,s=e.fragments[0].start+e.totalduration,o=n.duration,a=H(r.duration)?r.duration:0;e.live&&t.config.liveDurationInfinity?(r.duration=1/0,this.updateSeekableRange(e)):(s>a&&s>o||!H(o))&&(this.log(`Updating Media Source duration to ${s.toFixed(3)}`),r.duration=s)}updateSeekableRange(e){let t=this.mediaSource,n=e.fragments;if(n.length&&e.live&&t!=null&&t.setLiveSeekableRange){let s=Math.max(0,n[0].start),o=Math.max(s,s+e.totalduration);this.log(`Media Source duration is set to ${t.duration}. Setting seekable range to ${s}-${o}.`),t.setLiveSeekableRange(s,o)}}checkPendingTracks(){let{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:n}=this,r=Object.keys(n).length;if(r&&(!e||r===2||"audiovideo"in n)){this.createSourceBuffers(n),this.pendingTracks={};let s=this.getSourceBufferTypes();if(s.length)this.hls.trigger(v.BUFFER_CREATED,{tracks:this.tracks}),s.forEach(o=>{t.executeNext(o)});else{let o=new Error("could not create source buffer for media codec(s)");this.hls.trigger(v.ERROR,{type:Z.MEDIA_ERROR,details:T.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:o,reason:o.message})}}}createSourceBuffers(e){let{sourceBuffer:t,mediaSource:n}=this;if(!n)throw Error("createSourceBuffers called when mediaSource was null");for(let s in e)if(!t[s]){var r;let o=e[s];if(!o)throw Error(`source buffer exists for track ${s}, however track does not`);let a=((r=o.levelCodec)==null?void 0:r.indexOf(","))===-1?o.levelCodec:o.codec;a&&s.slice(0,5)==="audio"&&(a=_u(a,this.appendSource));let l=`${o.container};codecs=${a}`;this.log(`creating sourceBuffer(${l})`);try{let c=t[s]=n.addSourceBuffer(l),u=s;this.addBufferListener(u,"updatestart",this._onSBUpdateStart),this.addBufferListener(u,"updateend",this._onSBUpdateEnd),this.addBufferListener(u,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(u,"bufferedchange",(d,h)=>{let f=h.removedRanges;f!=null&&f.length&&this.hls.trigger(v.BUFFER_FLUSHED,{type:s})}),this.tracks[s]={buffer:c,codec:a,container:o.container,levelCodec:o.levelCodec,metadata:o.metadata,id:o.id}}catch(c){this.error(`error while trying to add sourceBuffer: ${c.message}`),this.hls.trigger(v.ERROR,{type:Z.MEDIA_ERROR,details:T.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:c,sourceBufferName:s,mimeType:l})}}}get mediaSrc(){var e,t;let n=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return n?.src}_onSBUpdateStart(e){let{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}let{operationQueue:n}=this;n.current(e).onComplete(),n.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){var n;let r=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(n=this.mediaSource)==null?void 0:n.readyState}`);this.error(`${r}`,t),this.hls.trigger(v.ERROR,{type:Z.MEDIA_ERROR,details:T.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:r,fatal:!1});let s=this.operationQueue.current(e);s&&s.onError(r)}removeExecutor(e,t,n){let{media:r,mediaSource:s,operationQueue:o,sourceBuffer:a}=this,l=a[e];if(!r||!s||!l){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),o.shiftAndExecuteNext(e);return}let c=H(r.duration)?r.duration:1/0,u=H(s.duration)?s.duration:1/0,d=Math.max(0,t),h=Math.min(n,c,u);h>d&&(!l.ending||l.ended)?(l.ended=!1,this.log(`Removing [${d},${h}] from the ${e} SourceBuffer`),l.remove(d,h)):o.shiftAndExecuteNext(e)}appendExecutor(e,t){let n=this.sourceBuffer[t];if(!n){if(!this.pendingTracks[t])throw new Error(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);return}n.ended=!1,n.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}let{operationQueue:n}=this,r=t.map(s=>n.appendBlocker(s));Promise.all(r).then(()=>{e(),t.forEach(s=>{let o=this.sourceBuffer[s];o!=null&&o.updating||n.shiftAndExecuteNext(s)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,n){let r=this.sourceBuffer[e];if(!r)return;let s=n.bind(this,e);this.listeners[e].push({event:t,listener:s}),r.addEventListener(t,s)}removeBufferListeners(e){let t=this.sourceBuffer[e];t&&this.listeners[e].forEach(n=>{t.removeEventListener(n.event,n.listener)})}};function Dw(i){let e=i.querySelectorAll("source");[].slice.call(e).forEach(t=>{i.removeChild(t)})}function m1(i,e){let t=self.document.createElement("source");t.type="video/mp4",t.src=e,i.appendChild(t)}var g1={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},yS=i=>String.fromCharCode(g1[i]||i),dn=15,ti=100,v1={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},y1={17:2,18:4,21:6,22:8,23:10,19:13,20:15},b1={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},_1={25:2,26:4,29:6,30:8,31:10,27:13,28:15},E1=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],Dg=class{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){let n=typeof t=="function"?t():t;D.log(`${this.time} [${e}] ${n}`)}}},fr=function(e){let t=[];for(let n=0;n<e.length;n++)t.push(e[n].toString(16));return t},Nu=class{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){let t=["foreground","underline","italics","background","flash"];for(let n=0;n<t.length;n++){let r=t[n];e.hasOwnProperty(r)&&(this[r]=e[r])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}},wg=class{constructor(){this.uchar=" ",this.penState=new Nu}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}},Sg=class{constructor(e){this.chars=[],this.pos=0,this.currPenState=new Nu,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<ti;t++)this.chars.push(new wg);this.logger=e}equals(e){for(let t=0;t<ti;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<ti;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<ti;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>ti&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=ti)}moveCursor(e){let t=this.pos+e;if(e>1)for(let n=this.pos+1;n<t+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();let t=yS(e);if(this.pos>=ti){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<ti;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){let e=[],t=!0;for(let n=0;n<ti;n++){let r=this.chars[n].uchar;r!==" "&&(t=!1),e.push(r)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}},ia=class{constructor(e){this.rows=[],this.currRow=dn-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<dn;t++)this.rows.push(new Sg(e));this.logger=e}reset(){for(let e=0;e<dn;e++)this.rows[e].clear();this.currRow=dn-1}equals(e){let t=!0;for(let n=0;n<dn;n++)if(!this.rows[n].equals(e.rows[n])){t=!1;break}return t}copy(e){for(let t=0;t<dn;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<dn;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let a=0;a<dn;a++)this.rows[a].clear();let s=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){let a=o.rows[s].cueStartTime,l=this.logger.time;if(a!==null&&l!==null&&a<l)for(let c=0;c<this.nrRollUpRows;c++)this.rows[t-this.nrRollUpRows+c+1].copy(o.rows[s+c])}}this.currRow=t;let n=this.rows[this.currRow];if(e.indent!==null){let s=e.indent,o=Math.max(s-1,0);n.setCursor(e.indent),e.color=n.chars[o].penState.foreground}let r={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(r)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());let e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;let t=[],n="",r=-1;for(let s=0;s<dn;s++){let o=this.rows[s].getTextString();o&&(r=s+1,e?t.push("Row "+r+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(e?n="["+t.join(" | ")+"]":n=t.join(`
`)),n}getTextAndFormat(){return this.rows}},Pu=class{constructor(e,t,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new ia(n),this.nonDisplayedMemory=new ia(n),this.lastOutputScreen=new ia(n),this.currRollUpRow=this.displayedMemory.rows[dn-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[dn-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);let t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){let e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){let t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{let n=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[n]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){let t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}},Fu=class{constructor(e,t,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=w1(),this.logger=void 0;let r=this.logger=new Dg;this.channels=[null,new Pu(e,t,r),new Pu(e+1,n,r)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let n=0;n<t.length;n+=2){let r=t[n]&127,s=t[n+1]&127,o=!1,a=null;if(r===0&&s===0)continue;this.logger.log(3,()=>"["+fr([t[n],t[n+1]])+"] -> ("+fr([r,s])+")");let l=this.cmdHistory;if(r>=16&&r<=31){if(D1(r,s,l)){ru(null,null,l),this.logger.log(3,()=>"Repeated command ("+fr([r,s])+") is dropped");continue}ru(r,s,this.cmdHistory),o=this.parseCmd(r,s),o||(o=this.parseMidrow(r,s)),o||(o=this.parsePAC(r,s)),o||(o=this.parseBackgroundAttributes(r,s))}else ru(null,null,l);if(!o&&(a=this.parseChars(r,s),a)){let u=this.currentChannel;u&&u>0?this.channels[u].insertChars(a):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!o&&!a&&this.logger.log(2,()=>"Couldn't parse cleaned data "+fr([r,s])+" orig: "+fr([t[n],t[n+1]]))}}parseCmd(e,t){let n=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=33&&t<=35;if(!(n||r))return!1;let s=e===20||e===21||e===23?1:2,o=this.channels[s];return e===20||e===21||e===28||e===29?t===32?o.ccRCL():t===33?o.ccBS():t===34?o.ccAOF():t===35?o.ccAON():t===36?o.ccDER():t===37?o.ccRU(2):t===38?o.ccRU(3):t===39?o.ccRU(4):t===40?o.ccFON():t===41?o.ccRDC():t===42?o.ccTR():t===43?o.ccRTD():t===44?o.ccEDM():t===45?o.ccCR():t===46?o.ccENM():t===47&&o.ccEOC():o.ccTO(t-32),this.currentChannel=s,!0}parseMidrow(e,t){let n=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;let r=this.channels[n];return r?(r.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+fr([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let n,r=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,s=(e===16||e===24)&&t>=64&&t<=95;if(!(r||s))return!1;let o=e<=23?1:2;t>=64&&t<=95?n=o===1?v1[e]:b1[e]:n=o===1?y1[e]:_1[e];let a=this.channels[o];return a?(a.setPAC(this.interpretPAC(n,t)),this.currentChannel=o,!0):!1}interpretPAC(e,t){let n,r={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?n=t-96:n=t-64,r.underline=(n&1)===1,n<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(r.italics=!0,r.color="white"):r.indent=Math.floor((n-16)/2)*4,r}parseChars(e,t){let n,r=null,s=null;if(e>=25?(n=2,s=e-8):(n=1,s=e),s>=17&&s<=19){let o;s===17?o=t+80:s===18?o=t+112:o=t+144,this.logger.log(2,()=>"Special char '"+yS(o)+"' in channel "+n),r=[o]}else e>=32&&e<=127&&(r=t===0?[e]:[e,t]);return r&&this.logger.log(3,()=>"Char codes =  "+fr(r).join(",")),r}parseBackgroundAttributes(e,t){let n=(e===16||e===24)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=45&&t<=47;if(!(n||r))return!1;let s,o={};e===16||e===24?(s=Math.floor((t-32)/2),o.background=E1[s],t%2===1&&(o.background=o.background+"_semi")):t===45?o.background="transparent":(o.foreground="black",t===47&&(o.underline=!0));let a=e<=23?1:2;return this.channels[a].setBkgData(o),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){let t=this.channels[e];t&&t.reset()}ru(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){let n=this.channels[t];n&&n.cueSplitAtTime(e)}}};function ru(i,e,t){t.a=i,t.b=e}function D1(i,e,t){return t.a===i&&t.b===e}function w1(){return{a:null,b:null}}var Es=class{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}},Xg=function(){if(xs!=null&&xs.VTTCue)return self.VTTCue;let i=["","lr","rl"],e=["start","middle","end","left","right"];function t(a,l){if(typeof l!="string"||!Array.isArray(a))return!1;let c=l.toLowerCase();return~a.indexOf(c)?c:!1}function n(a){return t(i,a)}function r(a){return t(e,a)}function s(a,...l){let c=1;for(;c<arguments.length;c++){let u=arguments[c];for(let d in u)a[d]=u[d]}return a}function o(a,l,c){let u=this,d={enumerable:!0};u.hasBeenReset=!1;let h="",f=!1,p=a,m=l,g=c,y=null,_="",b=!0,S="auto",E="start",x=50,w="middle",R=50,B="middle";Object.defineProperty(u,"id",s({},d,{get:function(){return h},set:function(I){h=""+I}})),Object.defineProperty(u,"pauseOnExit",s({},d,{get:function(){return f},set:function(I){f=!!I}})),Object.defineProperty(u,"startTime",s({},d,{get:function(){return p},set:function(I){if(typeof I!="number")throw new TypeError("Start time must be set to a number.");p=I,this.hasBeenReset=!0}})),Object.defineProperty(u,"endTime",s({},d,{get:function(){return m},set:function(I){if(typeof I!="number")throw new TypeError("End time must be set to a number.");m=I,this.hasBeenReset=!0}})),Object.defineProperty(u,"text",s({},d,{get:function(){return g},set:function(I){g=""+I,this.hasBeenReset=!0}})),Object.defineProperty(u,"region",s({},d,{get:function(){return y},set:function(I){y=I,this.hasBeenReset=!0}})),Object.defineProperty(u,"vertical",s({},d,{get:function(){return _},set:function(I){let O=n(I);if(O===!1)throw new SyntaxError("An invalid or illegal string was specified.");_=O,this.hasBeenReset=!0}})),Object.defineProperty(u,"snapToLines",s({},d,{get:function(){return b},set:function(I){b=!!I,this.hasBeenReset=!0}})),Object.defineProperty(u,"line",s({},d,{get:function(){return S},set:function(I){if(typeof I!="number"&&I!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");S=I,this.hasBeenReset=!0}})),Object.defineProperty(u,"lineAlign",s({},d,{get:function(){return E},set:function(I){let O=r(I);if(!O)throw new SyntaxError("An invalid or illegal string was specified.");E=O,this.hasBeenReset=!0}})),Object.defineProperty(u,"position",s({},d,{get:function(){return x},set:function(I){if(I<0||I>100)throw new Error("Position must be between 0 and 100.");x=I,this.hasBeenReset=!0}})),Object.defineProperty(u,"positionAlign",s({},d,{get:function(){return w},set:function(I){let O=r(I);if(!O)throw new SyntaxError("An invalid or illegal string was specified.");w=O,this.hasBeenReset=!0}})),Object.defineProperty(u,"size",s({},d,{get:function(){return R},set:function(I){if(I<0||I>100)throw new Error("Size must be between 0 and 100.");R=I,this.hasBeenReset=!0}})),Object.defineProperty(u,"align",s({},d,{get:function(){return B},set:function(I){let O=r(I);if(!O)throw new SyntaxError("An invalid or illegal string was specified.");B=O,this.hasBeenReset=!0}})),u.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o}(),Tg=class{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}};function bS(i){function e(n,r,s,o){return(n|0)*3600+(r|0)*60+(s|0)+parseFloat(o||0)}let t=i.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}var xg=class{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,n){return n?this.has(e)?this.values[e]:t[n]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,n){for(let r=0;r<n.length;++r)if(t===n[r]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){let n=parseFloat(t);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}};function _S(i,e,t,n){let r=n?i.split(n):[i];for(let s in r){if(typeof r[s]!="string")continue;let o=r[s].split(t);if(o.length!==2)continue;let a=o[0],l=o[1];e(a,l)}}var Ig=new Xg(0,0,""),su=Ig.align==="middle"?"middle":"center";function S1(i,e,t){let n=i;function r(){let a=bS(i);if(a===null)throw new Error("Malformed timestamp: "+n);return i=i.replace(/^[^\sa-zA-Z-]+/,""),a}function s(a,l){let c=new xg;_S(a,function(h,f){let p;switch(h){case"region":for(let m=t.length-1;m>=0;m--)if(t[m].id===f){c.set(h,t[m].region);break}break;case"vertical":c.alt(h,f,["rl","lr"]);break;case"line":p=f.split(","),c.integer(h,p[0]),c.percent(h,p[0])&&c.set("snapToLines",!1),c.alt(h,p[0],["auto"]),p.length===2&&c.alt("lineAlign",p[1],["start",su,"end"]);break;case"position":p=f.split(","),c.percent(h,p[0]),p.length===2&&c.alt("positionAlign",p[1],["start",su,"end","line-left","line-right","auto"]);break;case"size":c.percent(h,f);break;case"align":c.alt(h,f,["start",su,"end","left","right"]);break}},/:/,/\s/),l.region=c.get("region",null),l.vertical=c.get("vertical","");let u=c.get("line","auto");u==="auto"&&Ig.line===-1&&(u=-1),l.line=u,l.lineAlign=c.get("lineAlign","start"),l.snapToLines=c.get("snapToLines",!0),l.size=c.get("size",100),l.align=c.get("align",su);let d=c.get("position","auto");d==="auto"&&Ig.position===50&&(d=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=d}function o(){i=i.replace(/^\s+/,"")}if(o(),e.startTime=r(),o(),i.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);i=i.slice(3),o(),e.endTime=r(),o(),s(i,e)}function ES(i){return i.replace(/<br(?: \/)?>/gi,`
`)}var Cg=class{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new Tg,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){let t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function n(){let s=t.buffer,o=0;for(s=ES(s);o<s.length&&s[o]!=="\r"&&s[o]!==`
`;)++o;let a=s.slice(0,o);return s[o]==="\r"&&++o,s[o]===`
`&&++o,t.buffer=s.slice(o),a}function r(s){_S(s,function(o,a){},/:/)}try{let s="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;s=n();let a=s.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(a!=null&&a[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let o=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:s=n(),t.state){case"HEADER":/:/.test(s)?r(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new Xg(0,0,""),t.state="CUE",s.indexOf("-->")===-1){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{S1(s,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{let a=s.indexOf("-->")!==-1;if(!s||a&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){let e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}},T1=/\r\n|\n\r|\n|\r/g,Im=function(e,t,n=0){return e.slice(n,n+t.length)===t},x1=function(e){let t=parseInt(e.slice(-3)),n=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!H(t)||!H(n)||!H(r)||!H(s))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*n,t+=60*1e3*r,t+=60*60*1e3*s,t},Cm=function(e){let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return(t>>>0).toString()};function Zg(i,e,t){return Cm(i.toString())+Cm(e.toString())+Cm(t)}var I1=function(e,t,n){let r=e[t],s=e[r.prevCC];if(!s||!s.new&&r.new){e.ccOffset=e.presentationOffset=r.start,r.new=!1;return}for(;(o=s)!=null&&o.new;){var o;e.ccOffset+=r.start-s.start,r.new=!1,r=s,s=e[r.prevCC]}e.presentationOffset=n};function C1(i,e,t,n,r,s,o){let a=new Cg,l=Fn(new Uint8Array(i)).trim().replace(T1,`
`).split(`
`),c=[],u=e?a1(e.baseTime,e.timescale):0,d="00:00.000",h=0,f=0,p,m=!0;a.oncue=function(g){let y=t[n],_=t.ccOffset,b=(h-u)/9e4;if(y!=null&&y.new&&(f!==void 0?_=t.ccOffset=y.start:I1(t,n,b)),b){if(!e){p=new Error("Missing initPTS for VTT MPEGTS");return}_=b-t.presentationOffset}let S=g.endTime-g.startTime,E=Wt((g.startTime+_-f)*9e4,r*9e4)/9e4;g.startTime=Math.max(E,0),g.endTime=Math.max(E+S,0);let x=g.text.trim();g.text=decodeURIComponent(encodeURIComponent(x)),g.id||(g.id=Zg(g.startTime,g.endTime,x)),g.endTime>0&&c.push(g)},a.onparsingerror=function(g){p=g},a.onflush=function(){if(p){o(p);return}s(c)},l.forEach(g=>{if(m)if(Im(g,"X-TIMESTAMP-MAP=")){m=!1,g.slice(16).split(",").forEach(y=>{Im(y,"LOCAL:")?d=y.slice(6):Im(y,"MPEGTS:")&&(h=parseInt(y.slice(7)))});try{f=x1(d)/1e3}catch(y){p=y}return}else g===""&&(m=!1);a.parse(g+`
`)}),a.flush()}var Am="stpp.ttml.im1t",DS=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,wS=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,A1={left:"start",center:"center",right:"end",start:"start",end:"end"};function ww(i,e,t,n){let r=oe(new Uint8Array(i),["mdat"]);if(r.length===0){n(new Error("Could not parse IMSC1 mdat"));return}let s=r.map(a=>Fn(a)),o=o1(e.baseTime,1,e.timescale);try{s.forEach(a=>t(R1(a,o)))}catch(a){n(a)}}function R1(i,e){let r=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");let s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(s).reduce((d,h)=>(d[h]=r.getAttribute(`ttp:${h}`)||s[h],d),{}),a=r.getAttribute("xml:space")!=="preserve",l=Sw(Rm(r,"styling","style")),c=Sw(Rm(r,"layout","region")),u=Rm(r,"body","[begin]");return[].map.call(u,d=>{let h=SS(d,a);if(!h||!d.hasAttribute("begin"))return null;let f=km(d.getAttribute("begin"),o),p=km(d.getAttribute("dur"),o),m=km(d.getAttribute("end"),o);if(f===null)throw Tw(d);if(m===null){if(p===null)throw Tw(d);m=f+p}let g=new Xg(f-e,m-e,h);g.id=Zg(g.startTime,g.endTime,g.text);let y=c[d.getAttribute("region")],_=l[d.getAttribute("style")],b=M1(y,_,l),{textAlign:S}=b;if(S){let E=A1[S];E&&(g.lineAlign=E),g.align=S}return Ke(g,b),g}).filter(d=>d!==null)}function Rm(i,e,t){let n=i.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function Sw(i){return i.reduce((e,t)=>{let n=t.getAttribute("xml:id");return n&&(e[n]=t),e},{})}function SS(i,e){return[].slice.call(i.childNodes).reduce((t,n,r)=>{var s;return n.nodeName==="br"&&r?t+`
`:(s=n.childNodes)!=null&&s.length?SS(n,e):e?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function M1(i,e,t){let n="http://www.w3.org/ns/ttml#styling",r=null,s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=i!=null&&i.hasAttribute("style")?i.getAttribute("style"):null;return o&&t.hasOwnProperty(o)&&(r=t[o]),s.reduce((a,l)=>{let c=Mm(e,n,l)||Mm(i,n,l)||Mm(r,n,l);return c&&(a[l]=c),a},{})}function Mm(i,e,t){return i&&i.hasAttributeNS(e,t)?i.getAttributeNS(e,t):null}function Tw(i){return new Error(`Could not parse ttml timestamp ${i}`)}function km(i,e){if(!i)return null;let t=bS(i);return t===null&&(DS.test(i)?t=k1(i,e):wS.test(i)&&(t=L1(i,e))),t}function k1(i,e){let t=DS.exec(i),n=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+n/e.frameRate}function L1(i,e){let t=wS.exec(i),n=Number(t[1]);switch(t[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}var Ag=class{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Iw(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(v.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(v.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(v.FRAG_LOADING,this.onFragLoading,this),e.on(v.FRAG_LOADED,this.onFragLoaded,this),e.on(v.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(v.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(v.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(v.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(v.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){let{hls:e}=this;e.off(v.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(v.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(v.FRAG_LOADING,this.onFragLoading,this),e.off(v.FRAG_LOADED,this.onFragLoaded,this),e.off(v.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(v.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(v.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(v.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(v.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){let e=new Es(this,"textTrack1"),t=new Es(this,"textTrack2"),n=new Es(this,"textTrack3"),r=new Es(this,"textTrack4");this.cea608Parser1=new Fu(1,e,t),this.cea608Parser2=new Fu(3,n,r)}}addCues(e,t,n,r,s){let o=!1;for(let a=s.length;a--;){let l=s[a],c=O1(l[0],l[1],t,n);if(c>=0&&(l[0]=Math.min(l[0],t),l[1]=Math.max(l[1],n),o=!0,c/(n-t)>.5))return}if(o||s.push([t,n]),this.config.renderTextTracksNatively){let a=this.captionsTracks[e];this.Cues.newCue(a,t,n,r)}else{let a=this.Cues.newCue(null,t,n,r);this.hls.trigger(v.CUES_PARSED,{type:"captions",cues:a,track:e})}}onInitPtsFound(e,{frag:t,id:n,initPTS:r,timescale:s}){let{unparsedVttFrags:o}=this;n==="main"&&(this.initPTS[t.cc]={baseTime:r,timescale:s}),o.length&&(this.unparsedVttFrags=[],o.forEach(a=>{this.onFragLoaded(v.FRAG_LOADED,a)}))}getExistingTrack(e,t){let{media:n}=this;if(n)for(let r=0;r<n.textTracks.length;r++){let s=n.textTracks[r];if(xw(s,{name:e,lang:t,attrs:{}}))return s}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;let{captionsProperties:t,captionsTracks:n,media:r}=this,{label:s,languageCode:o}=t[e],a=this.getExistingTrack(s,o);if(a)n[e]=a,_s(n[e]),qw(n[e],r);else{let l=this.createTextTrack("captions",s,o);l&&(l[e]=!0,n[e]=l)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;let t=this.captionsProperties[e];if(!t)return;let n=t.label,r={_id:e,label:n,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(v.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,t,n){let r=this.media;if(r)return r.addTextTrack(e,t,n)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){let{captionsTracks:e}=this;Object.keys(e).forEach(t=>{_s(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Iw(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){let{media:e}=this;if(!e)return;let t=e.textTracks;if(t)for(let n=0;n<t.length;n++)_s(t[n])}onSubtitleTracksUpdated(e,t){let n=t.subtitleTracks||[],r=n.some(s=>s.textCodec===Am);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){if(vS(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){let o=this.media,a=o?lu(o.textTracks):null;if(this.tracks.forEach((l,c)=>{let u;if(a){let d=null;for(let h=0;h<a.length;h++)if(a[h]&&xw(a[h],l)){d=a[h],a[h]=null;break}d&&(u=d)}if(u)_s(u);else{let d=TS(l);u=this.createTextTrack(d,l.name,l.lang),u&&(u.mode="disabled")}u&&this.textTracks.push(u)}),a!=null&&a.length){let l=a.filter(c=>c!==null).map(c=>c.label);l.length&&D.warn(`Media element contains unused subtitle tracks: ${l.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){let o=this.tracks.map(a=>({label:a.name,kind:a.type.toLowerCase(),default:a.default,subtitleTrack:a}));this.hls.trigger(v.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(n=>{let r=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!r)return;let s=`textTrack${r[1]}`,o=this.captionsProperties[s];o&&(o.label=n.name,n.lang&&(o.languageCode=n.lang),o.media=n)})}closedCaptionsForLevel(e){let t=this.hls.levels[e.level];return t?.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===K.MAIN){var n,r;let{cea608Parser1:s,cea608Parser2:o,lastSn:a}=this,{cc:l,sn:c}=t.frag,u=(n=(r=t.part)==null?void 0:r.index)!=null?n:-1;s&&o&&(c!==a+1||c===a&&u!==this.lastPartIndex+1||l!==this.lastCc)&&(s.reset(),o.reset()),this.lastCc=l,this.lastSn=c,this.lastPartIndex=u}}onFragLoaded(e,t){let{frag:n,payload:r}=t;if(n.type===K.SUBTITLE)if(r.byteLength){let s=n.decryptdata,o="stats"in t;if(s==null||!s.encrypted||o){let a=this.tracks[n.level],l=this.vttCCs;l[n.cc]||(l[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),a&&a.textCodec===Am?this._parseIMSC1(n,r):this._parseVTTs(t)}}else this.hls.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){let n=this.hls;ww(t,this.initPTS[e.cc],r=>{this._appendCues(r,e.level),n.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},r=>{D.log(`Failed to parse IMSC1: ${r}`),n.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:r})})}_parseVTTs(e){var t;let{frag:n,payload:r}=e,{initPTS:s,unparsedVttFrags:o}=this,a=s.length-1;if(!s[n.cc]&&a===-1){o.push(e);return}let l=this.hls,c=(t=n.initSegment)!=null&&t.data?qt(n.initSegment.data,new Uint8Array(r)):r;C1(c,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,u=>{this._appendCues(u,n.level),l.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},u=>{let d=u.message==="Missing initPTS for VTT MPEGTS";d?o.push(e):this._fallbackToIMSC1(n,r),D.log(`Failed to parse VTT cue: ${u}`),!(d&&a>n.cc)&&l.trigger(v.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:u})})}_fallbackToIMSC1(e,t){let n=this.tracks[e.level];n.textCodec||ww(t,this.initPTS[e.cc],()=>{n.textCodec=Am,this._parseIMSC1(e,t)},()=>{n.textCodec="wvtt"})}_appendCues(e,t){let n=this.hls;if(this.config.renderTextTracksNatively){let r=this.textTracks[t];if(!r||r.mode==="disabled")return;e.forEach(s=>Kw(r,s))}else{let r=this.tracks[t];if(!r)return;let s=r.default?"default":"subtitles"+t;n.trigger(v.CUES_PARSED,{type:"subtitles",cues:e,track:s})}}onFragDecrypted(e,t){let{frag:n}=t;n.type===K.SUBTITLE&&this.onFragLoaded(v.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){this.initCea608Parsers();let{cea608Parser1:n,cea608Parser2:r}=this;if(!this.enabled||!n||!r)return;let{frag:s,samples:o}=t;if(!(s.type===K.MAIN&&this.closedCaptionsForLevel(s)==="NONE"))for(let a=0;a<o.length;a++){let l=o[a].bytes;if(l){let c=this.extractCea608Data(l);n.addData(o[a].pts,c[0]),r.addData(o[a].pts,c[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:n,endOffsetSubtitles:r,type:s}){let{media:o}=this;if(!(!o||o.currentTime<n)){if(!s||s==="video"){let{captionsTracks:a}=this;Object.keys(a).forEach(l=>Um(a[l],t,n))}if(this.config.renderTextTracksNatively&&t===0&&r!==void 0){let{textTracks:a}=this;Object.keys(a).forEach(l=>Um(a[l],t,r))}}}extractCea608Data(e){let t=[[],[]],n=e[0]&31,r=2;for(let s=0;s<n;s++){let o=e[r++],a=127&e[r++],l=127&e[r++];if(a===0&&l===0)continue;if((4&o)!==0){let u=3&o;(u===0||u===1)&&(t[u].push(a),t[u].push(l))}}return t}};function TS(i){return i.characteristics&&/transcribes-spoken-dialog/gi.test(i.characteristics)&&/describes-music-and-sound/gi.test(i.characteristics)?"captions":"subtitles"}function xw(i,e){return!!i&&i.kind===TS(e)&&pg(e,i)}function O1(i,e,t,n){return Math.min(e,n)-Math.max(i,t)}function Iw(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}var Rg=class i{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){let{hls:e}=this;e.on(v.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(v.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(v.MANIFEST_PARSED,this.onManifestParsed,this),e.on(v.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(v.BUFFER_CODECS,this.onBufferCodecs,this),e.on(v.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){let{hls:e}=this;e.off(v.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(v.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(v.MANIFEST_PARSED,this.onManifestParsed,this),e.off(v.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(v.BUFFER_CODECS,this.onBufferCodecs,this),e.off(v.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){let n=this.hls.levels[t.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){let n=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,n.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&H(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}let e=this.hls.levels;if(e.length){let t=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&D.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=n,t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){let t=this.hls.levels;if(!t.length)return-1;let n=t.filter((r,s)=>this.isLevelAllowed(r)&&s<=e);return this.clientRect=null,i.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;let e=this.media,t={width:0,height:0};if(e){let n=e.getBoundingClientRect();t.width=n.width,t.height=n.height,!t.width&&!t.height&&(t.width=n.right-n.left||e.width||0,t.height=n.bottom-n.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return e}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,t,n){if(!(e!=null&&e.length))return-1;let r=(a,l)=>l?a.width!==l.width||a.height!==l.height:!0,s=e.length-1,o=Math.max(t,n);for(let a=0;a<e.length;a+=1){let l=e[a];if((l.width>=o||l.height>=o)&&r(l,e[a+1])){s=a;break}}return s}},Mg=class{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(v.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(v.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){let n=this.hls.config;if(n.capLevelOnFPSDrop){let r=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=r,r&&typeof r.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,n){let r=performance.now();if(t){if(this.lastTime){let s=r-this.lastTime,o=n-this.lastDroppedFrames,a=t-this.lastDecodedFrames,l=1e3*o/s,c=this.hls;if(c.trigger(v.FPS_DROP,{currentDropped:o,currentDecoded:a,totalDroppedFrames:n}),l>0&&o>c.config.fpsDroppedMonitoringThreshold*a){let u=c.currentLevel;D.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(c.autoLevelCapping===-1||c.autoLevelCapping>=u)&&(u=u-1,c.trigger(v.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:c.currentLevel}),c.autoLevelCapping=u,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=n,this.lastDecodedFrames=t}}checkFPSInterval(){let e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){let t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}},ou="[eme]",N1=(()=>{class i{constructor(t){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=i.CDMCleanupPromise?[i.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=D.debug.bind(D,ou),this.log=D.log.bind(D,ou),this.warn=D.warn.bind(D,ou),this.error=D.error.bind(D,ou),this.hls=t,this.config=t.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();let t=this.config;t.requestMediaKeySystemAccessFunc=null,t.licenseXhrSetup=t.licenseResponseCallback=void 0,t.drmSystems=t.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(v.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(v.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(v.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(v.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(v.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(v.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(t){let{drmSystems:n,widevineLicenseUrl:r}=this.config,s=n[t];if(s)return s.licenseUrl;if(t===Ne.WIDEVINE&&r)return r;throw new Error(`no license server URL configured for key-system "${t}"`)}getServerCertificateUrl(t){let{drmSystems:n}=this.config,r=n[t];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${t}"]`)}attemptKeySystemAccess(t){let n=this.hls.levels,r=(a,l,c)=>!!a&&c.indexOf(a)===l,s=n.map(a=>a.audioCodec).filter(r),o=n.map(a=>a.videoCodec).filter(r);return s.length+o.length===0&&o.push("avc1.42e01e"),new Promise((a,l)=>{let c=u=>{let d=u.shift();this.getMediaKeysPromise(d,s,o).then(h=>a({keySystem:d,mediaKeys:h})).catch(h=>{u.length?c(u):h instanceof St?l(h):l(new St({type:Z.KEY_SYSTEM_ERROR,details:T.KEY_SYSTEM_NO_ACCESS,error:h,fatal:!0},h.message))})};c(t)})}requestMediaKeySystemAccess(t,n){let{requestMediaKeySystemAccessFunc:r}=this.config;if(typeof r!="function"){let s=`Configured requestMediaKeySystemAccess is not a function ${r}`;return Ow===null&&self.location.protocol==="http:"&&(s=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(s))}return r(t,n)}getMediaKeysPromise(t,n,r){let s=wP(t,n,r,this.config.drmSystemOptions),o=this.keySystemAccessPromises[t],a=o?.keySystemAccess;if(!a){this.log(`Requesting encrypted media "${t}" key-system access with config: ${JSON.stringify(s)}`),a=this.requestMediaKeySystemAccess(t,s);let l=this.keySystemAccessPromises[t]={keySystemAccess:a};return a.catch(c=>{this.log(`Failed to obtain access to key-system "${t}": ${c}`)}),a.then(c=>{this.log(`Access for key-system "${c.keySystem}" obtained`);let u=this.fetchServerCertificate(t);return this.log(`Create media-keys for "${t}"`),l.mediaKeys=c.createMediaKeys().then(d=>(this.log(`Media-keys created for "${t}"`),u.then(h=>h?this.setMediaKeysServerCertificate(d,t,h):d))),l.mediaKeys.catch(d=>{this.error(`Failed to create media-keys for "${t}"}: ${d}`)}),l.mediaKeys})}return a.then(()=>o.mediaKeys)}createMediaKeySessionContext({decryptdata:t,keySystem:n,mediaKeys:r}){this.log(`Creating key-system session "${n}" keyId: ${On.hexDump(t.keyId||[])}`);let s=r.createSession(),o={decryptdata:t,keySystem:n,mediaKeys:r,mediaKeysSession:s,keyStatus:"status-pending"};return this.mediaKeySessions.push(o),o}renewKeySession(t){let n=t.decryptdata;if(n.pssh){let r=this.createMediaKeySessionContext(t),s=this.getKeyIdString(n),o="cenc";this.keyIdToKeySessionPromise[s]=this.generateRequestWithPreferredKeySession(r,o,n.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(t)}getKeyIdString(t){if(!t)throw new Error("Could not read keyId of undefined decryptdata");if(t.keyId===null)throw new Error("keyId is null");return On.hexDump(t.keyId)}updateKeySession(t,n){var r;let s=t.mediaKeysSession;return this.log(`Updating key-session "${s.sessionId}" for keyID ${On.hexDump(((r=t.decryptdata)==null?void 0:r.keyId)||[])}
      } (data length: ${n&&n.byteLength})`),s.update(n)}selectKeySystemFormat(t){let n=Object.keys(t.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${t.sn} ${t.type}: ${t.level}) key formats ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)),this.keyFormatPromise}getKeyFormatPromise(t){return new Promise((n,r)=>{let s=mm(this.config),o=t.map(UD).filter(a=>!!a&&s.indexOf(a)!==-1);return this.getKeySystemSelectionPromise(o).then(({keySystem:a})=>{let l=$D(a);l?n(l):r(new Error(`Unable to find format for key-system "${a}"`))}).catch(r)})}loadKey(t){let n=t.keyInfo.decryptdata,r=this.getKeyIdString(n),s=`(keyId: ${r} format: "${n.keyFormat}" method: ${n.method} uri: ${n.uri})`;this.log(`Starting session for key ${s}`);let o=this.keyIdToKeySessionPromise[r];return o||(o=this.keyIdToKeySessionPromise[r]=this.getKeySystemForKeyPromise(n).then(({keySystem:a,mediaKeys:l})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${t.frag.sn} ${t.frag.type}: ${t.frag.level} using key ${s}`),this.attemptSetMediaKeys(a,l).then(()=>{this.throwIfDestroyed();let c=this.createMediaKeySessionContext({keySystem:a,mediaKeys:l,decryptdata:n});return this.generateRequestWithPreferredKeySession(c,"cenc",n.pssh,"playlist-key")}))),o.catch(a=>this.handleError(a))),o}throwIfDestroyed(t="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(t){this.hls&&(this.error(t.message),t instanceof St?this.hls.trigger(v.ERROR,t.data):this.hls.trigger(v.ERROR,{type:Z.KEY_SYSTEM_ERROR,details:T.KEY_SYSTEM_NO_KEYS,error:t,fatal:!0}))}getKeySystemForKeyPromise(t){let n=this.getKeyIdString(t),r=this.keyIdToKeySessionPromise[n];if(!r){let s=UD(t.keyFormat),o=s?[s]:mm(this.config);return this.attemptKeySystemAccess(o)}return r}getKeySystemSelectionPromise(t){if(t.length||(t=mm(this.config)),t.length===0)throw new St({type:Z.KEY_SYSTEM_ERROR,details:T.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(t)}_onMediaEncrypted(t){let{initDataType:n,initData:r}=t,s=`"${t.type}" event: init data type: "${n}"`;if(this.debug(s),r===null)return;let o,a;if(n==="sinf"&&this.config.drmSystems[Ne.FAIRPLAY]){let h=Ze(new Uint8Array(r));try{let f=Hg(JSON.parse(h).sinf),p=$w(new Uint8Array(f));if(!p)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");o=p.subarray(8,24),a=Ne.FAIRPLAY}catch(f){this.warn(`${s} Failed to parse sinf: ${f}`);return}}else{let h=KP(r),f=h.filter(p=>p.systemId===ea.WIDEVINE)[0];if(!f){h.length===0||h.some(p=>!p.systemId)?this.warn(`${s} contains incomplete or invalid pssh data`):this.log(`ignoring ${s} for ${h.map(p=>jD(p.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(a=jD(f.systemId),f.version===0&&f.data){let p=f.data.length-22;o=f.data.subarray(p,p+16)}}if(!a||!o)return;let l=On.hexDump(o),{keyIdToKeySessionPromise:c,mediaKeySessions:u}=this,d=c[l];for(let h=0;h<u.length;h++){let f=u[h],p=f.decryptdata;if(!p.keyId)continue;let m=On.hexDump(p.keyId);if(l===m||p.uri.replace(/-/g,"").indexOf(l)!==-1){if(d=c[m],p.pssh)break;delete c[m],p.pssh=new Uint8Array(r),p.keyId=o,d=c[l]=d.then(()=>this.generateRequestWithPreferredKeySession(f,n,r,"encrypted-event-key-match"));break}}d||(d=c[l]=this.getKeySystemSelectionPromise([a]).then(({keySystem:h,mediaKeys:f})=>{var p;this.throwIfDestroyed();let m=new sa("ISO-23001-7",l,(p=$D(h))!=null?p:"");return m.pssh=new Uint8Array(r),m.keyId=o,this.attemptSetMediaKeys(h,f).then(()=>{this.throwIfDestroyed();let g=this.createMediaKeySessionContext({decryptdata:m,keySystem:h,mediaKeys:f});return this.generateRequestWithPreferredKeySession(g,n,r,"encrypted-event-no-match")})})),d.catch(h=>this.handleError(h))}_onWaitingForKey(t){this.log(`"${t.type}" event`)}attemptSetMediaKeys(t,n){let r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${t}"`);let s=Promise.all(r).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(n)});return this.setMediaKeysQueue.push(s),s.then(()=>{this.log(`Media-keys set for "${t}"`),r.push(s),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(o=>r.indexOf(o)===-1)})}generateRequestWithPreferredKeySession(t,n,r,s){var o,a;let l=(o=this.config.drmSystems)==null||(a=o[t.keySystem])==null?void 0:a.generateRequest;if(l)try{let m=l.call(this.hls,n,r,t);if(!m)throw new Error("Invalid response from configured generateRequest filter");n=m.initDataType,r=t.decryptdata.pssh=m.initData?new Uint8Array(m.initData):null}catch(m){var c;if(this.warn(m.message),(c=this.hls)!=null&&c.config.debug)throw m}if(r===null)return this.log(`Skipping key-session request for "${s}" (no initData)`),Promise.resolve(t);let u=this.getKeyIdString(t.decryptdata);this.log(`Generating key-session request for "${s}": ${u} (init data type: ${n} length: ${r?r.byteLength:null})`);let d=new Qg,h=t._onmessage=m=>{let g=t.mediaKeysSession;if(!g){d.emit("error",new Error("invalid state"));return}let{messageType:y,message:_}=m;this.log(`"${y}" message event for session "${g.sessionId}" message size: ${_.byteLength}`),y==="license-request"||y==="license-renewal"?this.renewLicense(t,_).catch(b=>{this.handleError(b),d.emit("error",b)}):y==="license-release"?t.keySystem===Ne.FAIRPLAY&&(this.updateKeySession(t,Fm("acknowledged")),this.removeSession(t)):this.warn(`unhandled media key message type "${y}"`)},f=t._onkeystatuseschange=m=>{if(!t.mediaKeysSession){d.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(t);let y=t.keyStatus;d.emit("keyStatus",y),y==="expired"&&(this.warn(`${t.keySystem} expired for key ${u}`),this.renewKeySession(t))};t.mediaKeysSession.addEventListener("message",h),t.mediaKeysSession.addEventListener("keystatuseschange",f);let p=new Promise((m,g)=>{d.on("error",g),d.on("keyStatus",y=>{y.startsWith("usable")?m():y==="output-restricted"?g(new St({type:Z.KEY_SYSTEM_ERROR,details:T.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):y==="internal-error"?g(new St({type:Z.KEY_SYSTEM_ERROR,details:T.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${y}"`)):y==="expired"?g(new Error("key expired while generating request")):this.warn(`unhandled key status change "${y}"`)})});return t.mediaKeysSession.generateRequest(n,r).then(()=>{var m;this.log(`Request generated for key-session "${(m=t.mediaKeysSession)==null?void 0:m.sessionId}" keyId: ${u}`)}).catch(m=>{throw new St({type:Z.KEY_SYSTEM_ERROR,details:T.KEY_SYSTEM_NO_SESSION,error:m,fatal:!1},`Error generating key-session request: ${m}`)}).then(()=>p).catch(m=>{throw d.removeAllListeners(),this.removeSession(t),m}).then(()=>(d.removeAllListeners(),t))}onKeyStatusChange(t){t.mediaKeysSession.keyStatuses.forEach((n,r)=>{this.log(`key status change "${n}" for keyStatuses keyId: ${On.hexDump("buffer"in r?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r))} session keyId: ${On.hexDump(new Uint8Array(t.decryptdata.keyId||[]))} uri: ${t.decryptdata.uri}`),t.keyStatus=n})}fetchServerCertificate(t){let n=this.config,r=n.loader,s=new r(n),o=this.getServerCertificateUrl(t);return o?(this.log(`Fetching server certificate for "${t}"`),new Promise((a,l)=>{let c={responseType:"arraybuffer",url:o},u=n.certLoadPolicy.default,d={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},h={onSuccess:(f,p,m,g)=>{a(f.data)},onError:(f,p,m,g)=>{l(new St({type:Z.KEY_SYSTEM_ERROR,details:T.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:m,response:rt({url:c.url,data:void 0},f)},`"${t}" certificate request failed (${o}). Status: ${f.code} (${f.text})`))},onTimeout:(f,p,m)=>{l(new St({type:Z.KEY_SYSTEM_ERROR,details:T.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:m,response:{url:c.url,data:void 0}},`"${t}" certificate request timed out (${o})`))},onAbort:(f,p,m)=>{l(new Error("aborted"))}};s.load(c,d,h)})):Promise.resolve()}setMediaKeysServerCertificate(t,n,r){return new Promise((s,o)=>{t.setServerCertificate(r).then(a=>{this.log(`setServerCertificate ${a?"success":"not supported by CDM"} (${r?.byteLength}) on "${n}"`),s(t)}).catch(a=>{o(new St({type:Z.KEY_SYSTEM_ERROR,details:T.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:a,fatal:!0},a.message))})})}renewLicense(t,n){return this.requestLicense(t,new Uint8Array(n)).then(r=>this.updateKeySession(t,new Uint8Array(r)).catch(s=>{throw new St({type:Z.KEY_SYSTEM_ERROR,details:T.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:s,fatal:!0},s.message)}))}unpackPlayReadyKeyMessage(t,n){let r=String.fromCharCode.apply(null,new Uint16Array(n.buffer));if(!r.includes("PlayReadyKeyMessage"))return t.setRequestHeader("Content-Type","text/xml; charset=utf-8"),n;let s=new DOMParser().parseFromString(r,"application/xml"),o=s.querySelectorAll("HttpHeader");if(o.length>0){let d;for(let h=0,f=o.length;h<f;h++){var a,l;d=o[h];let p=(a=d.querySelector("name"))==null?void 0:a.textContent,m=(l=d.querySelector("value"))==null?void 0:l.textContent;p&&m&&t.setRequestHeader(p,m)}}let c=s.querySelector("Challenge"),u=c?.textContent;if(!u)throw new Error("Cannot find <Challenge> in key message");return Fm(atob(u))}setupLicenseXHR(t,n,r,s){let o=this.config.licenseXhrSetup;return o?Promise.resolve().then(()=>{if(!r.decryptdata)throw new Error("Key removed");return o.call(this.hls,t,n,r,s)}).catch(a=>{if(!r.decryptdata)throw a;return t.open("POST",n,!0),o.call(this.hls,t,n,r,s)}).then(a=>(t.readyState||t.open("POST",n,!0),{xhr:t,licenseChallenge:a||s})):(t.open("POST",n,!0),Promise.resolve({xhr:t,licenseChallenge:s}))}requestLicense(t,n){let r=this.config.keyLoadPolicy.default;return new Promise((s,o)=>{let a=this.getLicenseServerUrl(t.keySystem);this.log(`Sending license request to URL: ${a}`);let l=new XMLHttpRequest;l.responseType="arraybuffer",l.onreadystatechange=()=>{if(!this.hls||!t.mediaKeysSession)return o(new Error("invalid state"));if(l.readyState===4)if(l.status===200){this._requestLicenseFailureCount=0;let c=l.response;this.log(`License received ${c instanceof ArrayBuffer?c.byteLength:c}`);let u=this.config.licenseResponseCallback;if(u)try{c=u.call(this.hls,l,a,t)}catch(d){this.error(d)}s(c)}else{let c=r.errorRetry,u=c?c.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||l.status>=400&&l.status<500)o(new St({type:Z.KEY_SYSTEM_ERROR,details:T.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:l,response:{url:a,data:void 0,code:l.status,text:l.statusText}},`License Request XHR failed (${a}). Status: ${l.status} (${l.statusText})`));else{let d=u-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${d} attempts left`),this.requestLicense(t,n).then(s,o)}}},t.licenseXhr&&t.licenseXhr.readyState!==XMLHttpRequest.DONE&&t.licenseXhr.abort(),t.licenseXhr=l,this.setupLicenseXHR(l,a,t,n).then(({xhr:c,licenseChallenge:u})=>{t.keySystem==Ne.PLAYREADY&&(u=this.unpackPlayReadyKeyMessage(c,u)),c.send(u)})})}onMediaAttached(t,n){if(!this.config.emeEnabled)return;let r=n.media;this.media=r,r.addEventListener("encrypted",this.onMediaEncrypted),r.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){let t=this.media,n=this.mediaKeySessions;t&&(t.removeEventListener("encrypted",this.onMediaEncrypted),t.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},sa.clearKeyUriToKeyIdMap();let r=n.length;i.CDMCleanupPromise=Promise.all(n.map(s=>this.removeSession(s)).concat(t?.setMediaKeys(null).catch(s=>{this.log(`Could not clear media keys: ${s}`)}))).then(()=>{r&&(this.log("finished closing key sessions and clearing media keys"),n.length=0)}).catch(s=>{this.log(`Could not close sessions and clear media keys: ${s}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(t,{sessionKeys:n}){if(!(!n||!this.config.emeEnabled)&&!this.keyFormatPromise){let r=n.reduce((s,o)=>(s.indexOf(o.keyFormat)===-1&&s.push(o.keyFormat),s),[]);this.log(`Selecting key-system from session-keys ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)}}removeSession(t){let{mediaKeysSession:n,licenseXhr:r}=t;if(n){this.log(`Remove licenses and keys and close session ${n.sessionId}`),t._onmessage&&(n.removeEventListener("message",t._onmessage),t._onmessage=void 0),t._onkeystatuseschange&&(n.removeEventListener("keystatuseschange",t._onkeystatuseschange),t._onkeystatuseschange=void 0),r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),t.mediaKeysSession=t.decryptdata=t.licenseXhr=void 0;let s=this.mediaKeySessions.indexOf(t);return s>-1&&this.mediaKeySessions.splice(s,1),n.remove().catch(o=>{this.log(`Could not remove session: ${o}`)}).then(()=>n.close()).catch(o=>{this.log(`Could not close session: ${o}`)})}}}return i.CDMCleanupPromise=void 0,i})(),St=class extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}},gt=function(i){return i.MANIFEST="m",i.AUDIO="a",i.VIDEO="v",i.MUXED="av",i.INIT="i",i.CAPTION="c",i.TIMED_TEXT="tt",i.KEY="k",i.OTHER="o",i}(gt||{}),xS=function(i){return i.DASH="d",i.HLS="h",i.SMOOTH="s",i.OTHER="o",i}(xS||{}),Ds=function(i){return i.OBJECT="CMCD-Object",i.REQUEST="CMCD-Request",i.SESSION="CMCD-Session",i.STATUS="CMCD-Status",i}(Ds||{}),P1={[Ds.OBJECT]:["br","d","ot","tb"],[Ds.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[Ds.SESSION]:["cid","pr","sf","sid","st","v"],[Ds.STATUS]:["bs","rtp"]},ha=class i{constructor(e,t){this.value=void 0,this.params=void 0,Array.isArray(e)&&(e=e.map(n=>n instanceof i?n:new i(n))),this.value=e,this.params=t}},Bu=class{constructor(e){this.description=void 0,this.description=e}},F1="Dict";function B1(i){return Array.isArray(i)?JSON.stringify(i):i instanceof Map?"Map{}":i instanceof Set?"Set{}":typeof i=="object"?JSON.stringify(i):String(i)}function V1(i,e,t,n){return new Error(`failed to ${i} "${B1(e)}" as ${t}`,{cause:n})}var Cw="Bare Item",U1="Boolean",j1="Byte Sequence",$1="Decimal",H1="Integer";function G1(i){return i<-999999999999999||999999999999999<i}var z1=/[\x00-\x1f\x7f]+/,W1="Token",q1="Key";function Bn(i,e,t){return V1("serialize",i,e,t)}function K1(i){if(typeof i!="boolean")throw Bn(i,U1);return i?"?1":"?0"}function Y1(i){return btoa(String.fromCharCode(...i))}function Q1(i){if(ArrayBuffer.isView(i)===!1)throw Bn(i,j1);return`:${Y1(i)}:`}function IS(i){if(G1(i))throw Bn(i,H1);return i.toString()}function X1(i){return`@${IS(i.getTime()/1e3)}`}function CS(i,e){if(i<0)return-CS(-i,e);let t=Math.pow(10,e);if(Math.abs(i*t%1-.5)<Number.EPSILON){let r=Math.floor(i*t);return(r%2===0?r:r+1)/t}else return Math.round(i*t)/t}function Z1(i){let e=CS(i,3);if(Math.floor(Math.abs(e)).toString().length>12)throw Bn(i,$1);let t=e.toString();return t.includes(".")?t:`${t}.0`}var J1="String";function eB(i){if(z1.test(i))throw Bn(i,J1);return`"${i.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function tB(i){return i.description||i.toString().slice(7,-1)}function Aw(i){let e=tB(i);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw Bn(e,W1);return e}function kg(i){switch(typeof i){case"number":if(!H(i))throw Bn(i,Cw);return Number.isInteger(i)?IS(i):Z1(i);case"string":return eB(i);case"symbol":return Aw(i);case"boolean":return K1(i);case"object":if(i instanceof Date)return X1(i);if(i instanceof Uint8Array)return Q1(i);if(i instanceof Bu)return Aw(i);default:throw Bn(i,Cw)}}function Lg(i){if(/^[a-z*][a-z0-9\-_.*]*$/.test(i)===!1)throw Bn(i,q1);return i}function Jg(i){return i==null?"":Object.entries(i).map(([e,t])=>t===!0?`;${Lg(e)}`:`;${Lg(e)}=${kg(t)}`).join("")}function AS(i){return i instanceof ha?`${kg(i.value)}${Jg(i.params)}`:kg(i)}function nB(i){return`(${i.value.map(AS).join(" ")})${Jg(i.params)}`}function iB(i,e={whitespace:!0}){if(typeof i!="object")throw Bn(i,F1);let t=i instanceof Map?i.entries():Object.entries(i),n=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([r,s])=>{s instanceof ha||(s=new ha(s));let o=Lg(r);return s.value===!0?o+=Jg(s.params):(o+="=",Array.isArray(s.value)?o+=nB(s):o+=AS(s)),o}).join(`,${n}`)}function rB(i,e){return iB(i,e)}var sB=i=>i==="ot"||i==="sf"||i==="st",oB=i=>typeof i=="number"?H(i):i!=null&&i!==""&&i!==!1;function aB(i,e){let t=new URL(i),n=new URL(e);if(t.origin!==n.origin)return i;let r=t.pathname.split("/").slice(1),s=n.pathname.split("/").slice(1,-1);for(;r[0]===s[0];)r.shift(),s.shift();for(;s.length;)s.shift(),r.unshift("..");return r.join("/")}function lB(){try{return crypto.randomUUID()}catch{try{let e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{let s=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(r=="x"?s:s&3|8).toString(16)})}}}var fu=i=>Math.round(i),cB=(i,e)=>(e!=null&&e.baseUrl&&(i=aB(i,e.baseUrl)),encodeURIComponent(i)),au=i=>fu(i/100)*100,uB={br:fu,d:fu,bl:au,dl:au,mtp:au,nor:cB,rtp:au,tb:fu};function dB(i,e){let t={};if(i==null||typeof i!="object")return t;let n=Object.keys(i).sort(),r=Ke({},uB,e?.formatters),s=e?.filter;return n.forEach(o=>{if(s!=null&&s(o))return;let a=i[o],l=r[o];l&&(a=l(a,e)),!(o==="v"&&a===1)&&(o=="pr"&&a===1||oB(a)&&(sB(o)&&typeof a=="string"&&(a=new Bu(a)),t[o]=a))}),t}function RS(i,e={}){return i?rB(dB(i,e),Ke({whitespace:!1},e)):""}function hB(i,e={}){if(!i)return{};let t=Object.entries(i),n=Object.entries(P1).concat(Object.entries(e?.customHeaderMap||{})),r=t.reduce((s,o)=>{var a,l;let[c,u]=o,d=((a=n.find(h=>h[1].includes(c)))==null?void 0:a[0])||Ds.REQUEST;return(l=s[d])!=null||(s[d]={}),s[d][c]=u,s},{});return Object.entries(r).reduce((s,[o,a])=>(s[o]=RS(a,e),s),{})}function fB(i,e,t){return Ke(i,hB(e,t))}var pB="CMCD";function mB(i,e={}){if(!i)return"";let t=RS(i,e);return`${pB}=${encodeURIComponent(t)}`}var Rw=/CMCD=[^&#]+/;function gB(i,e,t){let n=mB(e,t);if(!n)return i;if(Rw.test(i))return i.replace(Rw,n);let r=i.includes("?")?"&":"?";return`${i}${r}${n}`}var Og=class{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=r=>{try{this.apply(r,{ot:gt.MANIFEST,su:!this.initialized})}catch(s){D.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=r=>{try{let s=r.frag,o=this.hls.levels[s.level],a=this.getObjectType(s),l={d:s.duration*1e3,ot:a};(a===gt.VIDEO||a===gt.AUDIO||a==gt.MUXED)&&(l.br=o.bitrate/1e3,l.tb=this.getTopBandwidth(a)/1e3,l.bl=this.getBufferLength(a)),this.apply(r,l)}catch(s){D.warn("Could not generate segment CMCD data.",s)}},this.hls=e;let t=this.config=e.config,{cmcd:n}=t;n!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||lB(),this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){let e=this.hls;e.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(v.MEDIA_DETACHED,this.onMediaDetached,this),e.on(v.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){let e=this.hls;e.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(v.MEDIA_DETACHED,this.onMediaDetached,this),e.off(v.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var n,r;this.audioBuffer=(n=t.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(r=t.tracks.video)==null?void 0:r.buffer}createData(){var e;return{v:1,sf:xS.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Ke(t,this.createData());let n=t.ot===gt.INIT||t.ot===gt.VIDEO||t.ot===gt.MUXED;this.starved&&n&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);let{includeKeys:r}=this;r&&(t=Object.keys(t).reduce((s,o)=>(r.includes(o)&&(s[o]=t[o]),s),{})),this.useHeaders?(e.headers||(e.headers={}),fB(e.headers,t)):e.url=gB(e.url,t)}getObjectType(e){let{type:t}=e;if(t==="subtitle")return gt.TIMED_TEXT;if(e.sn==="initSegment")return gt.INIT;if(t==="audio")return gt.AUDIO;if(t==="main")return this.hls.audioTracks.length?gt.VIDEO:gt.MUXED}getTopBandwidth(e){let t=0,n,r=this.hls;if(e===gt.AUDIO)n=r.audioTracks;else{let s=r.maxAutoLevel,o=s>-1?s+1:r.levels.length;n=r.levels.slice(0,o)}for(let s of n)s.bitrate>t&&(t=s.bitrate);return t>0?t:NaN}getBufferLength(e){let t=this.hls.media,n=e===gt.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!t?NaN:Fe.bufferInfo(n,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){let{pLoader:e}=this.config,t=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,a){t(s),this.loader.load(s,o,a)}}}createFragmentLoader(){let{fLoader:e}=this.config,t=this.applyFragmentData,n=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new n(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,a){t(s),this.loader.load(s,o,a)}}}},vB=3e5,Ng=class{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=D.log.bind(D,"[content-steering]:"),this.registerListeners()}registerListeners(){let e=this.hls;e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(v.MANIFEST_PARSED,this.onManifestParsed,this),e.on(v.ERROR,this.onError,this)}unregisterListeners(){let e=this.hls;e&&(e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(v.MANIFEST_PARSED,this.onManifestParsed,this),e.off(v.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){let e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){let t=this.levels;t&&(this.levels=t.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){let{contentSteering:n}=t;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){let{errorAction:n}=t;if(n?.action===nt.SendAlternateToPenaltyBox&&n.flags===un.MoveAllAlternatesMatchingHost){let r=this.levels,s=this.pathwayPriority,o=this.pathwayId;if(t.context){let{groupId:a,pathwayId:l,type:c}=t.context;a&&r?o=this.getPathwayForGroupId(a,c,o):l&&(o=l)}o in this.penalizedPathways||(this.penalizedPathways[o]=performance.now()),!s&&r&&(s=r.reduce((a,l)=>(a.indexOf(l.pathwayId)===-1&&a.push(l.pathwayId),a),[])),s&&s.length>1&&(this.updatePathwayPriority(s),n.resolved=this.pathwayId!==o),n.resolved||D.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${o} levels: ${r&&r.length} priorities: ${JSON.stringify(s)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){let n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),t=this.getLevelsForPathway(n),this.pathwayId=n}return t.length!==e.length?(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t):e}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let t,n=this.penalizedPathways,r=performance.now();Object.keys(n).forEach(s=>{r-n[s]>vB&&delete n[s]});for(let s=0;s<e.length;s++){let o=e[s];if(o in n)continue;if(o===this.pathwayId)return;let a=this.hls.nextLoadLevel,l=this.hls.levels[a];if(t=this.getLevelsForPathway(o),t.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,Zw(t),this.hls.trigger(v.LEVELS_UPDATED,{levels:t});let c=this.hls.levels[a];l&&c&&this.levels&&(c.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&c.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${c.bitrate}`),this.hls.nextLoadLevel=a);break}}}getPathwayForGroupId(e,t,n){let r=this.getLevelsForPathway(n).concat(this.levels||[]);for(let s=0;s<r.length;s++)if(t===De.AUDIO_TRACK&&r[s].hasAudioGroup(e)||t===De.SUBTITLE_TRACK&&r[s].hasSubtitleGroup(e))return r[s].pathwayId;return n}clonePathways(e){let t=this.levels;if(!t)return;let n={},r={};e.forEach(s=>{let{ID:o,"BASE-ID":a,"URI-REPLACEMENT":l}=s;if(t.some(u=>u.pathwayId===o))return;let c=this.getLevelsForPathway(a).map(u=>{let d=new Ve(u.attrs);d["PATHWAY-ID"]=o;let h=d.AUDIO&&`${d.AUDIO}_clone_${o}`,f=d.SUBTITLES&&`${d.SUBTITLES}_clone_${o}`;h&&(n[d.AUDIO]=h,d.AUDIO=h),f&&(r[d.SUBTITLES]=f,d.SUBTITLES=f);let p=MS(u.uri,d["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l),m=new Si({attrs:d,audioCodec:u.audioCodec,bitrate:u.bitrate,height:u.height,name:u.name,url:p,videoCodec:u.videoCodec,width:u.width});if(u.audioGroups)for(let g=1;g<u.audioGroups.length;g++)m.addGroupId("audio",`${u.audioGroups[g]}_clone_${o}`);if(u.subtitleGroups)for(let g=1;g<u.subtitleGroups.length;g++)m.addGroupId("text",`${u.subtitleGroups[g]}_clone_${o}`);return m});t.push(...c),Mw(this.audioTracks,n,l,o),Mw(this.subtitleTracks,r,l,o)})}loadSteeringManifest(e){let t=this.hls.config,n=t.loader;this.loader&&this.loader.destroy(),this.loader=new n(t);let r;try{r=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(r.protocol!=="data:"){let u=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;r.searchParams.set("_HLS_pathway",this.pathwayId),r.searchParams.set("_HLS_throughput",""+u)}let s={responseType:"json",url:r.href},o=t.steeringManifestLoadPolicy.default,a=o.errorRetry||o.timeoutRetry||{},l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},c={onSuccess:(u,d,h,f)=>{this.log(`Loaded steering manifest: "${r}"`);let p=u.data;if(p.VERSION!==1){this.log(`Steering VERSION ${p.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=p.TTL;let{"RELOAD-URI":m,"PATHWAY-CLONES":g,"PATHWAY-PRIORITY":y}=p;if(m)try{this.uri=new self.URL(m,r).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${m}`);return}this.scheduleRefresh(this.uri||h.url),g&&this.clonePathways(g);let _={steeringManifest:p,url:r.toString()};this.hls.trigger(v.STEERING_MANIFEST_LOADED,_),y&&this.updatePathwayPriority(y)},onError:(u,d,h,f)=>{if(this.log(`Error loading steering manifest: ${u.code} ${u.text} (${d.url})`),this.stopLoad(),u.code===410){this.enabled=!1,this.log(`Steering manifest ${d.url} no longer available`);return}let p=this.timeToLoad*1e3;if(u.code===429){let m=this.loader;if(typeof m?.getResponseHeader=="function"){let g=m.getResponseHeader("Retry-After");g&&(p=parseFloat(g)*1e3)}this.log(`Steering manifest ${d.url} rate limited`);return}this.scheduleRefresh(this.uri||d.url,p)},onTimeout:(u,d,h)=>{this.log(`Timeout loading steering manifest (${d.url})`),this.scheduleRefresh(this.uri||d.url)}};this.log(`Requesting steering manifest: ${r}`),this.loader.load(s,l,c)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var n;let r=(n=this.hls)==null?void 0:n.media;if(r&&!r.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}};function Mw(i,e,t,n){i&&Object.keys(e).forEach(r=>{let s=i.filter(o=>o.groupId===r).map(o=>{let a=Ke({},o);return a.details=void 0,a.attrs=new Ve(a.attrs),a.url=a.attrs.URI=MS(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),a.groupId=a.attrs["GROUP-ID"]=e[r],a.attrs["PATHWAY-ID"]=n,a});i.push(...s)})}function MS(i,e,t,n){let{HOST:r,PARAMS:s,[t]:o}=n,a;e&&(a=o?.[e],a&&(i=a));let l=new self.URL(i);return r&&!a&&(l.host=r),s&&Object.keys(s).sort().forEach(c=>{c&&l.searchParams.set(c,s[c])}),l.href}var yB=/^age:\s*[\d.]+\s*$/im,Vu=class{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new Ts,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){let e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=n,this.loadInternal()}loadInternal(){let{config:e,context:t}=this;if(!e||!t)return;let n=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;let s=this.xhrSetup;s?Promise.resolve().then(()=>{if(!(this.loader!==n||this.stats.aborted))return s(n,t.url)}).catch(o=>{if(!(this.loader!==n||this.stats.aborted))return n.open("GET",t.url,!0),s(n,t.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,t,e)}).catch(o=>{this.callbacks.onError({code:n.status,text:o.message},t,n,r)}):this.openAndSendXhr(n,t,e)}openAndSendXhr(e,t,n){e.readyState||e.open("GET",t.url,!0);let r=t.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:o}=n.loadPolicy;if(r)for(let a in r)e.setRequestHeader(a,r[a]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),n.timeout=s&&H(s)?s:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){let{context:e,loader:t,stats:n}=this;if(!e||!t)return;let r=t.readyState,s=this.config;if(!n.aborted&&r>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),r===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;let o=t.status,a=t.responseType!=="text";if(o>=200&&o<300&&(a&&t.response||t.responseText!==null)){n.loading.end=Math.max(self.performance.now(),n.loading.first);let l=a?t.response:t.responseText,c=t.responseType==="arraybuffer"?l.byteLength:l.length;if(n.loaded=n.total=c,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first),!this.callbacks)return;let u=this.callbacks.onProgress;if(u&&u(n,e,l,t),!this.callbacks)return;let d={url:t.responseURL,data:l,code:o};this.callbacks.onSuccess(d,n,e,t)}else{let l=s.loadPolicy.errorRetry,c=n.retry,u={url:e.url,data:void 0,code:o};Su(l,c,!1,u)?this.retry(l):(D.error(`${o} while loading ${e.url}`),this.callbacks.onError({code:o,text:t.statusText},e,t,n))}}}loadtimeout(){if(!this.config)return;let e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(Su(e,t,!0))this.retry(e);else{var n;D.warn(`timeout while loading ${(n=this.context)==null?void 0:n.url}`);let r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}retry(e){let{context:t,stats:n}=this;this.retryDelay=Wg(e,n.retry),n.retry++,D.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t?.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){let t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&yB.test(this.loader.getAllResponseHeaders())){let t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}};function bB(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}var _B=/(\d+)-(\d+)\/(\d+)/,Uu=class{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||SB,this.controller=new self.AbortController,this.stats=new Ts}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,n){let r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();let s=EB(e,this.controller.signal),o=n.onProgress,a=e.responseType==="arraybuffer",l=a?"byteLength":"length",{maxTimeToFirstByteMs:c,maxLoadTimeMs:u}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=n,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=c&&H(c)?c:u,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(r,e,this.response)},t.timeout),self.fetch(this.request).then(d=>{this.response=this.loader=d;let h=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=u,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),n.onTimeout(r,e,this.response)},u-(h-r.loading.start)),!d.ok){let{status:f,statusText:p}=d;throw new Pg(p||"fetch, bad network response",f,d)}return r.loading.first=h,r.total=wB(d.headers)||r.total,o&&H(t.highWaterMark)?this.loadProgressively(d,r,e,t.highWaterMark,o):a?d.arrayBuffer():e.responseType==="json"?d.json():d.text()}).then(d=>{let h=this.response;if(!h)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);let f=d[l];f&&(r.loaded=r.total=f);let p={url:h.url,data:d,code:h.status};o&&!H(t.highWaterMark)&&o(r,e,d,h),n.onSuccess(p,r,e,h)}).catch(d=>{if(self.clearTimeout(this.requestTimeout),r.aborted)return;let h=d&&d.code||0,f=d?d.message:null;n.onError({code:h,text:f},e,d?d.details:null,r)})}getCacheAge(){let e=null;if(this.response){let t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,n,r=0,s){let o=new Iu,a=e.body.getReader(),l=()=>a.read().then(c=>{if(c.done)return o.dataLength&&s(t,n,o.flush(),e),Promise.resolve(new ArrayBuffer(0));let u=c.value,d=u.length;return t.loaded+=d,d<r||o.dataLength?(o.push(u),o.dataLength>=r&&s(t,n,o.flush(),e)):s(t,n,u,e),l()}).catch(()=>Promise.reject());return l()}};function EB(i,e){let t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Ke({},i.headers))};return i.rangeEnd&&t.headers.set("Range","bytes="+i.rangeStart+"-"+String(i.rangeEnd-1)),t}function DB(i){let e=_B.exec(i);if(e)return parseInt(e[2])-parseInt(e[1])+1}function wB(i){let e=i.get("Content-Range");if(e){let n=DB(e);if(H(n))return n}let t=i.get("Content-Length");if(t)return parseInt(t)}function SB(i,e){return new self.Request(i.url,e)}var Pg=class extends Error{constructor(e,t,n){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=n}},TB=/\s/,xB={newCue(i,e,t,n){let r=[],s,o,a,l,c,u=self.VTTCue||self.TextTrackCue;for(let h=0;h<n.rows.length;h++)if(s=n.rows[h],a=!0,l=0,c="",!s.isEmpty()){var d;for(let m=0;m<s.chars.length;m++)TB.test(s.chars[m].uchar)&&a?l++:(c+=s.chars[m].uchar,a=!1);s.cueStartTime=e,e===t&&(t+=1e-4),l>=16?l--:l++;let f=ES(c.trim()),p=Zg(e,t,f);i!=null&&(d=i.cues)!=null&&d.getCueById(p)||(o=new u(e,t,f),o.id=p,o.line=h+1,o.align="left",o.position=10+Math.min(80,Math.floor(l*8/32)*10),r.push(o))}return i&&r.length&&(r.sort((h,f)=>h.line==="auto"||f.line==="auto"?0:h.line>8&&f.line>8?f.line-h.line:h.line-f.line),r.forEach(h=>Kw(i,h))),r}},IB={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},kS=rt(rt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Vu,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:Ym,bufferController:Eg,capLevelController:Rg,errorController:qm,fpsController:Mg,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Ow,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:IB},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},CB()),{},{subtitleStreamController:vg,subtitleTrackController:bg,timelineController:Ag,audioStreamController:mg,audioTrackController:gg,emeController:N1,cmcdController:Og,contentSteeringController:Ng});function CB(){return{cueHandler:xB,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function AB(i,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');let t=Fg(i),n=["manifest","level","frag"],r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return n.forEach(s=>{let o=`${s==="level"?"playlist":s}LoadPolicy`,a=e[o]===void 0,l=[];r.forEach(c=>{let u=`${s}Loading${c}`,d=e[u];if(d!==void 0&&a){l.push(u);let h=t[o].default;switch(e[o]={default:h},c){case"TimeOut":h.maxLoadTimeMs=d,h.maxTimeToFirstByteMs=d;break;case"MaxRetry":h.errorRetry.maxNumRetry=d,h.timeoutRetry.maxNumRetry=d;break;case"RetryDelay":h.errorRetry.retryDelayMs=d,h.timeoutRetry.retryDelayMs=d;break;case"MaxRetryTimeout":h.errorRetry.maxRetryDelayMs=d,h.timeoutRetry.maxRetryDelayMs=d;break}}}),l.length&&D.warn(`hls.js config: "${l.join('", "')}" setting(s) are deprecated, use "${o}": ${JSON.stringify(e[o])}`)}),rt(rt({},t),e)}function Fg(i){return i&&typeof i=="object"?Array.isArray(i)?i.map(Fg):Object.keys(i).reduce((e,t)=>(e[t]=Fg(i[t]),e),{}):i}function RB(i){let e=i.loader;e!==Uu&&e!==Vu?(D.log("[config]: Custom loader detected, cannot enable progressive streaming"),i.progressive=!1):bB()&&(i.loader=Uu,i.progressive=!0,i.enableSoftwareAES=!0,D.log("[config]: Progressive streaming enabled, using FetchLoader"))}var Lm,Bg=class extends aa{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){let{hls:e}=this;e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(v.LEVEL_LOADED,this.onLevelLoaded,this),e.on(v.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(v.FRAG_BUFFERED,this.onFragBuffered,this),e.on(v.ERROR,this.onError,this)}_unregisterListeners(){let{hls:e}=this;e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(v.LEVEL_LOADED,this.onLevelLoaded,this),e.off(v.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(v.FRAG_BUFFERED,this.onFragBuffered,this),e.off(v.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){let n=this.hls.config.preferManagedMediaSource,r=[],s={},o={},a=!1,l=!1,c=!1;t.levels.forEach(u=>{var d,h;let f=u.attrs,{audioCodec:p,videoCodec:m}=u;((d=p)==null?void 0:d.indexOf("mp4a.40.34"))!==-1&&(Lm||(Lm=/chrome|firefox/i.test(navigator.userAgent)),Lm&&(u.audioCodec=p=void 0)),p&&(u.audioCodec=p=_u(p,n)),((h=m)==null?void 0:h.indexOf("avc1"))===0&&(m=u.videoCodec=nF(m));let{width:g,height:y,unknownCodecs:_}=u;if(a||(a=!!(g&&y)),l||(l=!!m),c||(c=!!p),_!=null&&_.length||p&&!bm(p,"audio",n)||m&&!bm(m,"video",n))return;let{CODECS:b,"FRAME-RATE":S,"HDCP-LEVEL":E,"PATHWAY-ID":x,RESOLUTION:w,"VIDEO-RANGE":R}=f,I=`${`${x||"."}-`}${u.bitrate}-${w}-${S}-${b}-${R}-${E}`;if(s[I])if(s[I].uri!==u.url&&!u.attrs["PATHWAY-ID"]){let O=o[I]+=1;u.attrs["PATHWAY-ID"]=new Array(O+1).join(".");let Y=new Si(u);s[I]=Y,r.push(Y)}else s[I].addGroupId("audio",f.AUDIO),s[I].addGroupId("text",f.SUBTITLES);else{let O=new Si(u);s[I]=O,o[I]=1,r.push(O)}}),this.filterAndSortMediaOptions(r,t,a,l,c)}filterAndSortMediaOptions(e,t,n,r,s){let o=[],a=[],l=e;if((n||r)&&s&&(l=l.filter(({videoCodec:p,videoRange:m,width:g,height:y})=>(!!p||!!(g&&y))&&hF(m))),l.length===0){Promise.resolve().then(()=>{if(this.hls){t.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(t.levels[0].attrs)}`);let p=new Error("no level with compatible codecs found in manifest");this.hls.trigger(v.ERROR,{type:Z.MEDIA_ERROR,details:T.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:p,reason:p.message})}});return}if(t.audioTracks){let{preferManagedMediaSource:p}=this.hls.config;o=t.audioTracks.filter(m=>!m.audioCodec||bm(m.audioCodec,"audio",p)),kw(o)}t.subtitles&&(a=t.subtitles,kw(a));let c=l.slice(0);l.sort((p,m)=>{if(p.attrs["HDCP-LEVEL"]!==m.attrs["HDCP-LEVEL"])return(p.attrs["HDCP-LEVEL"]||"")>(m.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&p.height!==m.height)return p.height-m.height;if(p.frameRate!==m.frameRate)return p.frameRate-m.frameRate;if(p.videoRange!==m.videoRange)return Eu.indexOf(p.videoRange)-Eu.indexOf(m.videoRange);if(p.videoCodec!==m.videoCodec){let g=qD(p.videoCodec),y=qD(m.videoCodec);if(g!==y)return y-g}if(p.uri===m.uri&&p.codecSet!==m.codecSet){let g=bu(p.codecSet),y=bu(m.codecSet);if(g!==y)return y-g}return p.averageBitrate!==m.averageBitrate?p.averageBitrate-m.averageBitrate:0});let u=c[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==c.length)){for(let p=0;p<c.length;p++)if(c[p].pathwayId===l[0].pathwayId){u=c[p];break}}this._levels=l;for(let p=0;p<l.length;p++)if(l[p]===u){var d;this._firstLevel=p;let m=u.bitrate,g=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${m}`),((d=this.hls.userConfig)==null?void 0:d.abrEwmaDefaultEstimate)===void 0){let y=Math.min(m,this.hls.config.abrEwmaDefaultEstimateMax);y>g&&g===kS.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=y)}break}let h=s&&!r,f={levels:l,audioTracks:o,subtitleTracks:a,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:s,video:r,altAudio:!h&&o.some(p=>!!p.url)};this.hls.trigger(v.MANIFEST_PARSED,f),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){let t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){let u=new Error("invalid level idx"),d=e<0;if(this.hls.trigger(v.ERROR,{type:Z.OTHER_ERROR,details:T.LEVEL_SWITCH_ERROR,level:e,fatal:d,error:u,reason:u.message}),d)return;e=Math.min(e,t.length-1)}let n=this.currentLevelIndex,r=this.currentLevel,s=r?r.attrs["PATHWAY-ID"]:void 0,o=t[e],a=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,n===e&&o.details&&r&&s===a)return;this.log(`Switching to level ${e} (${o.height?o.height+"p ":""}${o.videoRange?o.videoRange+" ":""}${o.codecSet?o.codecSet+" ":""}@${o.bitrate})${a?" with Pathway "+a:""} from level ${n}${s?" with Pathway "+s:""}`);let l={level:e,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds};this.hls.trigger(v.LEVEL_SWITCHING,l);let c=o.details;if(!c||c.live){let u=this.switchParams(o.uri,r?.details,c);this.loadPlaylist(u)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){let e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===De.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===K.MAIN){let n=t.elementaryStreams;if(!Object.keys(n).some(s=>!!n[s]))return;let r=this._levels[t.level];r!=null&&r.loadError&&(this.log(`Resetting level error count of ${r.loadError} on frag buffered`),r.loadError=0)}}onLevelLoaded(e,t){var n;let{level:r,details:s}=t,o=this._levels[r];if(!o){var a;this.warn(`Invalid level index ${r}`),(a=t.deliveryDirectives)!=null&&a.skip&&(s.deltaUpdateFailed=!0);return}r===this.currentLevelIndex?(o.fragmentError===0&&(o.loadError=0),this.playlistLoaded(r,t,o.details)):(n=t.deliveryDirectives)!=null&&n.skip&&(s.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist();let t=this.currentLevelIndex,n=this.currentLevel;if(n&&this.shouldLoadPlaylist(n)){let r=n.uri;if(e)try{r=e.addDirectives(r)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}let s=n.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${e?.msn!==void 0?" at sn "+e.msn+" part "+e.part:""} with${s?" Pathway "+s:""} ${r}`),this.clearTimer(),this.hls.trigger(v.LEVEL_LOADING,{url:r,level:t,pathwayId:n.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;let n=this._levels.filter((r,s)=>s!==e?!0:(this.steering&&this.steering.removeLevel(r),r===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,r.details&&r.details.fragments.forEach(o=>o.level=-1)),!1));Zw(n),this._levels=n,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(v.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){let{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(v.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}};function kw(i){let e={};i.forEach(t=>{let n=t.groupId||"";t.id=e[n]=e[n]||0,e[n]++})}var Vg=class{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(let n in this.keyUriToKeyInfo){let r=this.keyUriToKeyInfo[n].loader;if(r){var t;if(e&&e!==((t=r.context)==null?void 0:t.frag.type))return;r.abort()}}}detach(){for(let e in this.keyUriToKeyInfo){let t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(let e in this.keyUriToKeyInfo){let t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=T.KEY_LOAD_ERROR,n,r,s){return new hn({type:Z.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:s,error:n,networkDetails:r})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){let{sn:n,cc:r}=e;for(let s=0;s<t.length;s++){let o=t[s];if(r<=o.cc&&(n==="initSegment"||o.sn==="initSegment"||n<o.sn)){this.emeController.selectKeySystemFormat(o).then(a=>{o.setKeyFormat(a)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var n,r;t&&e.setKeyFormat(t);let s=e.decryptdata;if(!s){let c=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,T.KEY_LOAD_ERROR,c))}let o=s.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,T.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));let a=this.keyUriToKeyInfo[o];if((n=a)!=null&&n.decryptdata.key)return s.key=a.decryptdata.key,Promise.resolve({frag:e,keyInfo:a});if((r=a)!=null&&r.keyLoadPromise){var l;switch((l=a.mediaKeySessionContext)==null?void 0:l.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return a.keyLoadPromise.then(c=>(s.key=c.keyInfo.decryptdata.key,{frag:e,keyInfo:a}))}}switch(a=this.keyUriToKeyInfo[o]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return s.keyFormat==="identity"?this.loadKeyHTTP(a,e):this.loadKeyEME(a,e);case"AES-128":return this.loadKeyHTTP(a,e);default:return Promise.reject(this.createKeyLoadError(e,T.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(e,t){let n={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){let r=this.emeController.loadKey(n);if(r)return(e.keyLoadPromise=r.then(s=>(e.mediaKeySessionContext=s,n))).catch(s=>{throw e.keyLoadPromise=null,s})}return Promise.resolve(n)}loadKeyHTTP(e,t){let n=this.config,r=n.loader,s=new r(n);return t.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((o,a)=>{let l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},c=n.keyLoadPolicy.default,u={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(h,f,p,m)=>{let{frag:g,keyInfo:y,url:_}=p;if(!g.decryptdata||y!==this.keyUriToKeyInfo[_])return a(this.createKeyLoadError(g,T.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),m));y.decryptdata.key=g.decryptdata.key=new Uint8Array(h.data),g.keyLoader=null,y.loader=null,o({frag:g,keyInfo:y})},onError:(h,f,p,m)=>{this.resetLoader(f),a(this.createKeyLoadError(t,T.KEY_LOAD_ERROR,new Error(`HTTP Error ${h.code} loading key ${h.text}`),p,rt({url:l.url,data:void 0},h)))},onTimeout:(h,f,p)=>{this.resetLoader(f),a(this.createKeyLoadError(t,T.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),p))},onAbort:(h,f,p)=>{this.resetLoader(f),a(this.createKeyLoadError(t,T.INTERNAL_ABORTED,new Error("key loading aborted"),p))}};s.load(l,u,d)})}resetLoader(e){let{frag:t,keyInfo:n,url:r}=e,s=n.loader;t.keyLoader===s&&(t.keyLoader=null,n.loader=null),delete this.keyUriToKeyInfo[r],s&&s.destroy()}};function LS(){return self.SourceBuffer||self.WebKitSourceBuffer}function OS(){if(!vr())return!1;let e=LS();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function MB(){if(!OS())return!1;let i=vr();return typeof i?.isTypeSupported=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>i.isTypeSupported(oa(e,"video")))||["mp4a.40.2","fLaC"].some(e=>i.isTypeSupported(oa(e,"audio"))))}function kB(){var i;let e=LS();return typeof(e==null||(i=e.prototype)==null?void 0:i.changeType)=="function"}var LB=250,pu=2,OB=.1,NB=.05,Ug=class{constructor(e,t,n,r){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=n,this.hls=r}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){let{config:n,media:r,stalled:s}=this;if(r===null)return;let{currentTime:o,seeking:a}=r,l=this.seeking&&!a,c=!this.seeking&&a;if(this.seeking=a,o!==e){if(this.moved=!0,a||(this.nudgeRetry=0),s!==null){if(this.stallReported){let g=self.performance.now()-s;D.warn(`playback not stuck anymore @${o}, after ${Math.round(g)}ms`),this.stallReported=!1}this.stalled=null}return}if(c||l){this.stalled=null;return}if(r.paused&&!a||r.ended||r.playbackRate===0||!Fe.getBuffered(r).length){this.nudgeRetry=0;return}let u=Fe.bufferInfo(r,o,0),d=u.nextStart||0;if(a){let g=u.len>pu,y=!d||t&&t.start<=o||d-o>pu&&!this.fragmentTracker.getPartialFragment(o);if(g||y)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var h;if(!(u.len>0)&&!d)return;let y=Math.max(d,u.start||0)-o,_=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,S=(_==null||(h=_.details)==null?void 0:h.live)?_.details.targetduration*2:pu,E=this.fragmentTracker.getPartialFragment(o);if(y>0&&(y<=S||E)){r.paused||this._trySkipBufferHole(E);return}}let f=self.performance.now();if(s===null){this.stalled=f;return}let p=f-s;if(!a&&p>=LB&&(this._reportStall(u),!this.media))return;let m=Fe.bufferInfo(r,o,n.maxBufferHole);this._tryFixBufferStall(m,p)}_tryFixBufferStall(e,t){let{config:n,fragmentTracker:r,media:s}=this;if(s===null)return;let o=s.currentTime,a=r.getPartialFragment(o);a&&(this._trySkipBufferHole(a)||!this.media)||(e.len>n.maxBufferHole||e.nextStart&&e.nextStart-o<n.maxBufferHole)&&t>n.highBufferWatchdogPeriod*1e3&&(D.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){let{hls:t,media:n,stallReported:r}=this;if(!r&&n){this.stallReported=!0;let s=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${JSON.stringify(e)})`);D.warn(s.message),t.trigger(v.ERROR,{type:Z.MEDIA_ERROR,details:T.BUFFER_STALLED_ERROR,fatal:!1,error:s,buffer:e.len})}}_trySkipBufferHole(e){let{config:t,hls:n,media:r}=this;if(r===null)return 0;let s=r.currentTime,o=Fe.bufferInfo(r,s,0),a=s<o.start?o.start:o.nextStart;if(a){let l=o.len<=t.maxBufferHole,c=o.len>0&&o.len<1&&r.readyState<3,u=a-s;if(u>0&&(l||c)){if(u>t.maxBufferHole){let{fragmentTracker:h}=this,f=!1;if(s===0){let p=h.getAppendedFrag(0,K.MAIN);p&&a<p.end&&(f=!0)}if(!f){let p=e||h.getAppendedFrag(s,K.MAIN);if(p){let m=!1,g=p.end;for(;g<a;){let y=h.getPartialFragment(g);if(y)g+=y.duration;else{m=!0;break}}if(m)return 0}}}let d=Math.max(a+NB,s+OB);if(D.warn(`skipping hole, adjusting currentTime from ${s} to ${d}`),this.moved=!0,this.stalled=null,r.currentTime=d,e&&!e.gap){let h=new Error(`fragment loaded with buffer holes, seeking from ${s} to ${d}`);n.trigger(v.ERROR,{type:Z.MEDIA_ERROR,details:T.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:h,reason:h.message,frag:e})}return d}}return 0}_tryNudgeBuffer(){let{config:e,hls:t,media:n,nudgeRetry:r}=this;if(n===null)return;let s=n.currentTime;if(this.nudgeRetry++,r<e.nudgeMaxRetry){let o=s+(r+1)*e.nudgeOffset,a=new Error(`Nudging 'currentTime' from ${s} to ${o}`);D.warn(a.message),n.currentTime=o,t.trigger(v.ERROR,{type:Z.MEDIA_ERROR,details:T.BUFFER_NUDGE_ON_STALL,error:a,fatal:!1})}else{let o=new Error(`Playhead still not moving while enough data buffered @${s} after ${e.nudgeMaxRetry} nudges`);D.error(o.message),t.trigger(v.ERROR,{type:Z.MEDIA_ERROR,details:T.BUFFER_STALLED_ERROR,error:o,fatal:!0})}}},PB=100,jg=class extends ua{constructor(e,t,n){super(e,t,n,"[stream-controller]",K.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){let{hls:e}=this;e.on(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(v.MANIFEST_LOADING,this.onManifestLoading,this),e.on(v.MANIFEST_PARSED,this.onManifestParsed,this),e.on(v.LEVEL_LOADING,this.onLevelLoading,this),e.on(v.LEVEL_LOADED,this.onLevelLoaded,this),e.on(v.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(v.ERROR,this.onError,this),e.on(v.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(v.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(v.BUFFER_CREATED,this.onBufferCreated,this),e.on(v.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(v.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(v.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){let{hls:e}=this;e.off(v.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(v.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(v.MANIFEST_LOADING,this.onManifestLoading,this),e.off(v.MANIFEST_PARSED,this.onManifestParsed,this),e.off(v.LEVEL_LOADED,this.onLevelLoaded,this),e.off(v.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(v.ERROR,this.onError,this),e.off(v.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(v.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(v.BUFFER_CREATED,this.onBufferCreated,this),e.off(v.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(v.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(v.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(e){if(this.levels){let{lastCurrentTime:t,hls:n}=this;if(this.stopLoad(),this.setInterval(PB),this.level=-1,!this.startFragRequested){let r=n.startLevel;r===-1&&(n.config.testBandwidth&&this.levels.length>1?(r=0,this.bitrateTest=!0):r=n.firstAutoLevel),n.nextLoadLevel=r,this.level=n.loadLevel,this.loadedmetadata=!1}t>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=M.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=M.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case M.WAITING_LEVEL:{let{levels:t,level:n}=this,r=t?.[n],s=r?.details;if(s&&(!s.live||this.levelLastLoaded===r)){if(this.waitForCdnTuneIn(s))break;this.state=M.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=M.IDLE;break}break}case M.FRAG_LOADING_WAITING_RETRY:{var e;let t=self.performance.now(),n=this.retryDate;if(!n||t>=n||(e=this.media)!=null&&e.seeking){let{levels:r,level:s}=this,o=r?.[s];this.resetStartWhenNotLoaded(o||null),this.state=M.IDLE}}break}this.state===M.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){let{hls:e,levelLastLoaded:t,levels:n,media:r}=this;if(t===null||!r&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;let s=e.nextLoadLevel;if(!(n!=null&&n[s]))return;let o=n[s],a=this.getMainFwdBufferInfo();if(a===null)return;let l=this.getLevelDetails();if(l&&this._streamEnded(a,l)){let m={};this.altAudio&&(m.type="video"),this.hls.trigger(v.BUFFER_EOS,m),this.state=M.ENDED;return}e.loadLevel!==s&&e.manualLevel===-1&&this.log(`Adapting to level ${s} from level ${this.level}`),this.level=e.nextLoadLevel=s;let c=o.details;if(!c||this.state===M.WAITING_LEVEL||c.live&&this.levelLastLoaded!==o){this.level=s,this.state=M.WAITING_LEVEL;return}let u=a.len,d=this.getMaxBufferLength(o.maxBitrate);if(u>=d)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);let h=this.backtrackFragment?this.backtrackFragment.start:a.end,f=this.getNextFragment(h,c);if(this.couldBacktrack&&!this.fragPrevious&&f&&f.sn!=="initSegment"&&this.fragmentTracker.getState(f)!==it.OK){var p;let g=((p=this.backtrackFragment)!=null?p:f).sn-c.startSN,y=c.fragments[g-1];y&&f.cc===y.cc&&(f=y,this.fragmentTracker.removeFragment(y))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(f&&this.isLoopLoading(f,h)){if(!f.gap){let g=this.audioOnly&&!this.altAudio?Ae.AUDIO:Ae.VIDEO,y=(g===Ae.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;y&&this.afterBufferFlushed(y,g,K.MAIN)}f=this.getNextFragmentLoopLoading(f,c,a,K.MAIN,d)}f&&(f.initSegment&&!f.initSegment.data&&!this.bitrateTest&&(f=f.initSegment),this.loadFragment(f,o,h))}loadFragment(e,t,n){let r=this.fragmentTracker.getState(e);this.fragCurrent=e,r===it.NOT_LOADED||r===it.PARTIAL?e.sn==="initSegment"?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,n)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,K.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){let{levels:e,media:t}=this;if(t!=null&&t.readyState){let n,r=this.getAppendedFrag(t.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);let s=this.getLevelDetails();if(s!=null&&s.live){let a=this.getMainFwdBufferInfo();if(!a||a.len<s.targetduration*2)return}if(!t.paused&&e){let a=this.hls.nextLoadLevel,l=e[a],c=this.fragLastKbps;c&&this.fragCurrent?n=this.fragCurrent.duration*l.maxBitrate/(1e3*c)+1:n=0}else n=0;let o=this.getBufferedFrag(t.currentTime+n);if(o){let a=this.followingBufferedFrag(o);if(a){this.abortCurrentFrag();let l=a.maxStartPTS?a.maxStartPTS:a.start,c=a.duration,u=Math.max(o.end,l+Math.min(Math.max(c-this.config.maxFragLookUpTolerance,c*(this.couldBacktrack?.5:.125)),c*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(u,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){let e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case M.KEY_LOADING:case M.FRAG_LOADING:case M.FRAG_LOADING_WAITING_RETRY:case M.PARSING:case M.PARSED:this.state=M.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);let n=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),n.addEventListener("playing",this.onvplaying),n.addEventListener("seeked",this.onvseeked),this.gapController=new Ug(this.config,n,this.fragmentTracker,this.hls)}onMediaDetaching(){let{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){let e=this.media,t=e?e.currentTime:null;H(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);let n=this.getMainFwdBufferInfo();if(n===null||n.len===0){this.warn(`Main forward buffer length on "seeked" event ${n?n.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(v.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(e,t){let n=!1,r=!1;t.levels.forEach(s=>{let o=s.audioCodec;o&&(n=n||o.indexOf("mp4a.40.2")!==-1,r=r||o.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=n&&r&&!kB(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){let{levels:n}=this;if(!n||this.state!==M.IDLE)return;let r=n[t.level];(!r.details||r.details.live&&this.levelLastLoaded!==r||this.waitForCdnTuneIn(r.details))&&(this.state=M.WAITING_LEVEL)}onLevelLoaded(e,t){var n;let{levels:r}=this,s=t.level,o=t.details,a=o.totalduration;if(!r){this.warn(`Levels were reset while loading level ${s}`);return}this.log(`Level ${s} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${a}`);let l=r[s],c=this.fragCurrent;c&&(this.state===M.FRAG_LOADING||this.state===M.FRAG_LOADING_WAITING_RETRY)&&c.level!==t.level&&c.loader&&this.abortCurrentFrag();let u=0;if(o.live||(n=l.details)!=null&&n.live){var d;if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;u=this.alignPlaylists(o,l.details,(d=this.levelLastLoaded)==null?void 0:d.details)}if(l.details=o,this.levelLastLoaded=l,this.hls.trigger(v.LEVEL_UPDATED,{details:o,level:s}),this.state===M.WAITING_LEVEL){if(this.waitForCdnTuneIn(o))return;this.state=M.IDLE}this.startFragRequested?o.live&&this.synchronizeToLiveEdge(o):this.setStartPosition(o,u),this.tick()}_handleFragmentLoadProgress(e){var t;let{frag:n,part:r,payload:s}=e,{levels:o}=this;if(!o){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}let a=o[n.level],l=a.details;if(!l){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}let c=a.videoCodec,u=l.PTSKnown||!l.live,d=(t=n.initSegment)==null?void 0:t.data,h=this._getAudioCodec(a),f=this.transmuxer=this.transmuxer||new Ou(this.hls,K.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),p=r?r.index:-1,m=p!==-1,g=new la(n.level,n.sn,n.stats.chunkCount,s.byteLength,p,m),y=this.initPTS[n.cc];f.push(s,d,h,c,n,r,l.totalduration,u,g,y)}onAudioTrackSwitching(e,t){let n=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;let o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();let s=this.hls;n&&(s.trigger(v.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),s.trigger(v.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){let n=t.id,r=!!this.hls.audioTracks[n].url;if(r){let s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=r,this.tick()}onBufferCreated(e,t){let n=t.tracks,r,s,o=!1;for(let a in n){let l=n[a];if(l.id==="main"){if(s=a,r=l,a==="video"){let c=n[a];c&&(this.videoBuffer=c.buffer)}}else o=!0}o&&r?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){let{frag:n,part:r}=t;if(n&&n.type!==K.MAIN)return;if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${r?" p: "+r.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===M.PARSED&&(this.state=M.IDLE);return}let s=r?r.stats:n.stats;this.fragLastKbps=Math.round(8*s.total/(s.buffering.end-s.loading.first)),n.sn!=="initSegment"&&(this.fragPrevious=n),this.fragBufferedComplete(n,r)}onError(e,t){var n;if(t.fatal){this.state=M.ERROR;return}switch(t.details){case T.FRAG_GAP:case T.FRAG_PARSING_ERROR:case T.FRAG_DECRYPT_ERROR:case T.FRAG_LOAD_ERROR:case T.FRAG_LOAD_TIMEOUT:case T.KEY_LOAD_ERROR:case T.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(K.MAIN,t);break;case T.LEVEL_LOAD_ERROR:case T.LEVEL_LOAD_TIMEOUT:case T.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===M.WAITING_LEVEL&&((n=t.context)==null?void 0:n.type)===De.LEVEL&&(this.state=M.IDLE);break;case T.BUFFER_APPEND_ERROR:case T.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="main")return;if(t.details===T.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case T.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){let{media:e,gapController:t}=this;if(!(!e||!t||!e.readyState)){if(this.loadedmetadata||!Fe.getBuffered(e).length){let n=this.state!==M.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,n)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=M.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==Ae.AUDIO||this.audioOnly&&!this.altAudio){let n=(t===Ae.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(n,t,K.MAIN),this.tick()}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){let{media:e}=this;if(!e)return;let t=e.currentTime,n=this.startPosition;if(n>=0&&t<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${t}`);return}let r=Fe.getBuffered(e),o=(r.length?r.start(0):0)-n;o>0&&(o<this.config.maxBufferHole||o<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${o} to match buffer start`),n+=o,this.startPosition=n),this.log(`seek to target start position ${n} from current time ${t}`),e.currentTime=n}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(n=>{let{hls:r}=this;if(!n||this.fragContextChanged(e))return;t.fragmentError=0,this.state=M.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;let s=e.stats;s.parsing.start=s.parsing.end=s.buffering.start=s.buffering.end=self.performance.now(),r.trigger(v.FRAG_LOADED,n),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;let n="main",{hls:r}=this,{remuxResult:s,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a){this.resetWhenMissingContext(o);return}let{frag:l,part:c,level:u}=a,{video:d,text:h,id3:f,initSegment:p}=s,{details:m}=u,g=this.altAudio?void 0:s.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=M.PARSING,p){if(p!=null&&p.tracks){let b=l.initSegment||l;this._bufferInitSegment(u,p.tracks,b,o),r.trigger(v.FRAG_PARSING_INIT_SEGMENT,{frag:b,id:n,tracks:p.tracks})}let y=p.initPTS,_=p.timescale;H(y)&&(this.initPTS[l.cc]={baseTime:y,timescale:_},r.trigger(v.INIT_PTS_FOUND,{frag:l,id:n,initPTS:y,timescale:_}))}if(d&&m&&l.sn!=="initSegment"){let y=m.fragments[l.sn-1-m.startSN],_=l.sn===m.startSN,b=!y||l.cc>y.cc;if(s.independent!==!1){let{startPTS:S,endPTS:E,startDTS:x,endDTS:w}=d;if(c)c.elementaryStreams[d.type]={startPTS:S,endPTS:E,startDTS:x,endDTS:w};else if(d.firstKeyFrame&&d.independent&&o.id===1&&!b&&(this.couldBacktrack=!0),d.dropped&&d.independent){let R=this.getMainFwdBufferInfo(),B=(R?R.end:this.getLoadPosition())+this.config.maxBufferHole,I=d.firstKeyFramePTS?d.firstKeyFramePTS:S;if(!_&&B<I-this.config.maxBufferHole&&!b){this.backtrack(l);return}else b&&(l.gap=!0);l.setElementaryStreamInfo(d.type,l.start,E,l.start,w,!0)}else _&&S>pu&&(l.gap=!0);l.setElementaryStreamInfo(d.type,S,E,x,w),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(d,l,c,o,_||b)}else if(_||b)l.gap=!0;else{this.backtrack(l);return}}if(g){let{startPTS:y,endPTS:_,startDTS:b,endDTS:S}=g;c&&(c.elementaryStreams[Ae.AUDIO]={startPTS:y,endPTS:_,startDTS:b,endDTS:S}),l.setElementaryStreamInfo(Ae.AUDIO,y,_,b,S),this.bufferFragmentData(g,l,c,o)}if(m&&f!=null&&(t=f.samples)!=null&&t.length){let y={id:n,frag:l,details:m,samples:f.samples};r.trigger(v.FRAG_PARSING_METADATA,y)}if(m&&h){let y={id:n,frag:l,details:m,samples:h.samples};r.trigger(v.FRAG_PARSING_USERDATA,y)}}_bufferInitSegment(e,t,n,r){if(this.state!==M.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;let{audio:s,video:o,audiovideo:a}=t;if(s){let l=e.audioCodec,c=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){l&&(l.indexOf("mp4a.40.5")!==-1?l="mp4a.40.2":l="mp4a.40.5");let u=s.metadata;u&&"channelCount"in u&&(u.channelCount||1)!==1&&c.indexOf("firefox")===-1&&(l="mp4a.40.5")}l&&l.indexOf("mp4a.40.5")!==-1&&c.indexOf("android")!==-1&&s.container!=="audio/mpeg"&&(l="mp4a.40.2",this.log(`Android: force audio codec to ${l}`)),e.audioCodec&&e.audioCodec!==l&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${l}"`),s.levelCodec=l,s.id="main",this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${l||""}/${e.audioCodec||""}/${s.codec}]`)}o&&(o.levelCodec=e.videoCodec,o.id="main",this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${o.codec}]`)),a&&this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${e.codecs}/${a.codec}]`),this.hls.trigger(v.BUFFER_CODECS,t),Object.keys(t).forEach(l=>{let u=t[l].initSegment;u!=null&&u.byteLength&&this.hls.trigger(v.BUFFER_APPENDING,{type:l,data:u,frag:n,part:null,chunkMeta:r,parent:n.type})}),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,K.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=M.IDLE}checkFragmentChanged(){let e=this.media,t=null;if(e&&e.readyState>1&&e.seeking===!1){let n=e.currentTime;if(Fe.isBuffered(e,n)?t=this.getAppendedFrag(n):Fe.isBuffered(e,n+.1)&&(t=this.getAppendedFrag(n+.1)),t){this.backtrackFragment=null;let r=this.fragPlaying,s=t.level;(!r||t.sn!==r.sn||r.level!==s)&&(this.fragPlaying=t,this.hls.trigger(v.FRAG_CHANGED,{frag:t}),(!r||r.level!==s)&&this.hls.trigger(v.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){let e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){let e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){let e=this.media;if(e){let t=e.currentTime,n=this.currentFrag;if(n&&H(t)&&H(n.programDateTime)){let r=n.programDateTime+(t-n.start)*1e3;return new Date(r)}}return null}get currentLevel(){let e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){let e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}},$u=(()=>{class i{static get version(){return"1.5.15"}static isMSESupported(){return OS()}static isSupported(){return MB()}static getMediaSource(){return vr()}static get Events(){return v}static get ErrorTypes(){return Z}static get ErrorDetails(){return T}static get DefaultConfig(){return i.defaultConfig?i.defaultConfig:kS}static set DefaultConfig(t){i.defaultConfig=t}constructor(t={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new Qg,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,mP(t.debug||!1,"Hls instance");let n=this.config=AB(i.DefaultConfig,t);this.userConfig=t,n.progressive&&RB(n);let{abrController:r,bufferController:s,capLevelController:o,errorController:a,fpsController:l}=n,c=new a(this),u=this.abrController=new r(this),d=this.bufferController=new s(this),h=this.capLevelController=new o(this),f=new l(this),p=new Vm(this),m=new $m(this),g=n.contentSteeringController,y=g?new g(this):null,_=this.levelController=new Bg(this,y),b=new Xm(this),S=new Vg(this.config),E=this.streamController=new jg(this,b,S);h.setStreamController(E),f.setStreamController(E);let x=[p,_,E];y&&x.splice(1,0,y),this.networkControllers=x;let w=[u,d,h,f,m,b];this.audioTrackController=this.createController(n.audioTrackController,x);let R=n.audioStreamController;R&&x.push(new R(this,b,S)),this.subtitleTrackController=this.createController(n.subtitleTrackController,x);let B=n.subtitleStreamController;B&&x.push(new B(this,b,S)),this.createController(n.timelineController,w),S.emeController=this.emeController=this.createController(n.emeController,w),this.cmcdController=this.createController(n.cmcdController,w),this.latencyController=this.createController(Hm,w),this.coreComponents=w,x.push(c);let I=c.onErrorOut;typeof I=="function"&&this.on(v.ERROR,I,c)}createController(t,n){if(t){let r=new t(this);return n&&n.push(r),r}return null}on(t,n,r=this){this._emitter.on(t,n,r)}once(t,n,r=this){this._emitter.once(t,n,r)}removeAllListeners(t){this._emitter.removeAllListeners(t)}off(t,n,r=this,s){this._emitter.off(t,n,r,s)}listeners(t){return this._emitter.listeners(t)}emit(t,n,r){return this._emitter.emit(t,n,r)}trigger(t,n){if(this.config.debug)return this.emit(t,t,n);try{return this.emit(t,t,n)}catch(r){if(D.error("An internal error happened while handling event "+t+'. Error message: "'+r.message+'". Here is a stacktrace:',r),!this.triggeringException){this.triggeringException=!0;let s=t===v.ERROR;this.trigger(v.ERROR,{type:Z.OTHER_ERROR,details:T.INTERNAL_EXCEPTION,fatal:s,event:t,error:r}),this.triggeringException=!1}}return!1}listenerCount(t){return this._emitter.listenerCount(t)}destroy(){D.log("destroy"),this.trigger(v.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(n=>n.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(n=>n.destroy()),this.coreComponents.length=0;let t=this.config;t.xhrSetup=t.fetchSetup=void 0,this.userConfig=null}attachMedia(t){D.log("attachMedia"),this._media=t,this.trigger(v.MEDIA_ATTACHING,{media:t})}detachMedia(){D.log("detachMedia"),this.trigger(v.MEDIA_DETACHING,void 0),this._media=null}loadSource(t){this.stopLoad();let n=this.media,r=this.url,s=this.url=$g.buildAbsoluteURL(self.location.href,t,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,D.log(`loadSource:${s}`),n&&r&&(r!==s||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(n)),this.trigger(v.MANIFEST_LOADING,{url:t})}startLoad(t=-1){D.log(`startLoad(${t})`),this.started=!0,this.networkControllers.forEach(n=>{n.startLoad(t)})}stopLoad(){D.log("stopLoad"),this.started=!1,this.networkControllers.forEach(t=>{t.stopLoad()})}resumeBuffering(){this.started&&this.networkControllers.forEach(t=>{"fragmentLoader"in t&&t.startLoad(-1)})}pauseBuffering(){this.networkControllers.forEach(t=>{"fragmentLoader"in t&&t.stopLoad()})}swapAudioCodec(){D.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){D.log("recoverMediaError");let t=this._media;this.detachMedia(),t&&this.attachMedia(t)}removeLevel(t){this.levelController.removeLevel(t)}get levels(){let t=this.levelController.levels;return t||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(t){D.log(`set currentLevel:${t}`),this.levelController.manualLevel=t,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(t){D.log(`set nextLevel:${t}`),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(t){D.log(`set loadLevel:${t}`),this.levelController.manualLevel=t}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(t){this.levelController.nextLoadLevel=t}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(t){D.log(`set firstLevel:${t}`),this.levelController.firstLevel=t}get startLevel(){let t=this.levelController.startLevel;return t===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:t}set startLevel(t){D.log(`set startLevel:${t}`),t!==-1&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(t){let n=!!t;n!==this.config.capLevelToPlayerSize&&(n?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=n)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){let{bwEstimator:t}=this.abrController;return t?t.getEstimate():NaN}set bandwidthEstimate(t){this.abrController.resetEstimator(t)}get ttfbEstimate(){let{bwEstimator:t}=this.abrController;return t?t.getEstimateTTFB():NaN}set autoLevelCapping(t){this._autoLevelCapping!==t&&(D.log(`set autoLevelCapping:${t}`),this._autoLevelCapping=t,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(t){dF(t)&&this._maxHdcpLevel!==t&&(this._maxHdcpLevel=t,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){let{levels:t,config:{minAutoBitrate:n}}=this;if(!t)return 0;let r=t.length;for(let s=0;s<r;s++)if(t[s].maxBitrate>=n)return s;return 0}get maxAutoLevel(){let{levels:t,autoLevelCapping:n,maxHdcpLevel:r}=this,s;if(n===-1&&t!=null&&t.length?s=t.length-1:s=n,r)for(let o=s;o--;){let a=t[o].attrs["HDCP-LEVEL"];if(a&&a<=r)return o}return s}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(t){this.abrController.nextAutoLevel=t}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(t){var n;return(n=this.audioTrackController)==null?void 0:n.setAudioOption(t)}setSubtitleOption(t){var n;return(n=this.subtitleTrackController)==null||n.setSubtitleOption(t),null}get allAudioTracks(){let t=this.audioTrackController;return t?t.allAudioTracks:[]}get audioTracks(){let t=this.audioTrackController;return t?t.audioTracks:[]}get audioTrack(){let t=this.audioTrackController;return t?t.audioTrack:-1}set audioTrack(t){let n=this.audioTrackController;n&&(n.audioTrack=t)}get allSubtitleTracks(){let t=this.subtitleTrackController;return t?t.allSubtitleTracks:[]}get subtitleTracks(){let t=this.subtitleTrackController;return t?t.subtitleTracks:[]}get subtitleTrack(){let t=this.subtitleTrackController;return t?t.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(t){let n=this.subtitleTrackController;n&&(n.subtitleTrack=t)}get subtitleDisplay(){let t=this.subtitleTrackController;return t?t.subtitleDisplay:!1}set subtitleDisplay(t){let n=this.subtitleTrackController;n&&(n.subtitleDisplay=t)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(t){this.config.lowLatencyMode=t}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}return i.defaultConfig=void 0,i})();var ev=class{constructor(e,t){this._document=t;let n=this._textarea=this._document.createElement("textarea"),r=n.style;r.position="fixed",r.top=r.opacity="0",r.left="-999em",n.setAttribute("aria-hidden","true"),n.value=e,n.readOnly=!0,(this._document.fullscreenElement||this._document.body).appendChild(n)}copy(){let e=this._textarea,t=!1;try{if(e){let n=this._document.activeElement;e.select(),e.setSelectionRange(0,e.value.length),t=this._document.execCommand("copy"),n&&n.focus()}}catch{}return t}destroy(){let e=this._textarea;e&&(e.remove(),this._textarea=void 0)}},FB=(()=>{let e=class e{constructor(n){this._document=n}copy(n){let r=this.beginCopy(n),s=r.copy();return r.destroy(),s}beginCopy(n){return new ev(n,this._document)}};e.\u0275fac=function(r){return new(r||e)(C(de))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),BB=new G("CDK_COPY_TO_CLIPBOARD_CONFIG"),NS=(()=>{let e=class e{constructor(n,r,s){this._clipboard=n,this._ngZone=r,this.text="",this.attempts=1,this.copied=new Pe,this._pending=new Set,s&&s.attempts!=null&&(this.attempts=s.attempts)}copy(n=this.attempts){if(n>1){let r=n,s=this._clipboard.beginCopy(this.text);this._pending.add(s);let o=()=>{let a=s.copy();!a&&--r&&!this._destroyed?this._currentTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(o,1)):(this._currentTimeout=null,this._pending.delete(s),s.destroy(),this.copied.emit(a))};o()}else this.copied.emit(this._clipboard.copy(this.text))}ngOnDestroy(){this._currentTimeout&&clearTimeout(this._currentTimeout),this._pending.forEach(n=>n.destroy()),this._pending.clear(),this._destroyed=!0}};e.\u0275fac=function(r){return new(r||e)(X(FB),X(W),X(BB,8))},e.\u0275dir=Le({type:e,selectors:[["","cdkCopyToClipboard",""]],hostBindings:function(r,s){r&1&&ct("click",function(){return s.copy()})},inputs:{text:[we.None,"cdkCopyToClipboard","text"],attempts:[we.None,"cdkCopyToClipboardAttempts","attempts"]},outputs:{copied:"cdkCopyToClipboardCopied"},standalone:!0});let i=e;return i})(),PS=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ee({type:e}),e.\u0275inj=_e({});let i=e;return i})();function tv(i){i||(Ml(tv),i=L(di));let e=new re(t=>i.onDestroy(t.next.bind(t)));return t=>t.pipe(yt(e))}var iv;try{iv=typeof Intl<"u"&&Intl.v8BreakIterator}catch{iv=!1}var je=(()=>{let e=class e{constructor(n){this._platformId=n,this.isBrowser=this._platformId?f_(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||iv)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}};e.\u0275fac=function(r){return new(r||e)(C(qn))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var fa;function jB(){if(fa==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>fa=!0}))}finally{fa=fa||!1}return fa}function Cs(i){return jB()?i:!!i.capture}var yr;function FS(){if(yr==null){if(typeof document!="object"||!document||typeof Element!="function"||!Element)return yr=!1,yr;if("scrollBehavior"in document.documentElement.style)yr=!0;else{let i=Element.prototype.scrollTo;i?yr=!/\{\s*\[native code\]\s*\}/.test(i.toString()):yr=!1}}return yr}var nv;function $B(){if(nv==null){let i=typeof document<"u"?document.head:null;nv=!!(i&&(i.createShadowRoot||i.attachShadow))}return nv}function BS(i){if($B()){let e=i.getRootNode?i.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}function Kt(i){return i.composedPath?i.composedPath()[0]:i.target}function pa(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function As(i){return Array.isArray(i)?i:[i]}function ze(i){return i==null?"":typeof i=="string"?i:`${i}px`}function ii(i){return i instanceof Me?i.nativeElement:i}var VS=new Set,_r,HB=(()=>{let e=class e{constructor(n,r){this._platform=n,this._nonce=r,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):zB}matchMedia(n){return(this._platform.WEBKIT||this._platform.BLINK)&&GB(n,this._nonce),this._matchMedia(n)}};e.\u0275fac=function(r){return new(r||e)(C(je),C(ao,8))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function GB(i,e){if(!VS.has(i))try{_r||(_r=document.createElement("style"),e&&_r.setAttribute("nonce",e),_r.setAttribute("type","text/css"),document.head.appendChild(_r)),_r.sheet&&(_r.sheet.insertRule(`@media ${i} {body{ }}`,0),VS.add(i))}catch(t){console.error(t)}}function zB(i){return{matches:i==="all"||i==="",media:i,addListener:()=>{},removeListener:()=>{}}}var Hu=(()=>{let e=class e{constructor(n,r){this._mediaMatcher=n,this._zone=r,this._queries=new Map,this._destroySubject=new fe}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(n){return US(As(n)).some(s=>this._registerQuery(s).mql.matches)}observe(n){let s=US(As(n)).map(a=>this._registerQuery(a).observable),o=Lr(s);return o=ri(o.pipe(Pt(1)),o.pipe($s(1),Ka(0))),o.pipe(pe(a=>{let l={matches:!1,breakpoints:{}};return a.forEach(({matches:c,query:u})=>{l.matches=l.matches||c,l.breakpoints[u]=c}),l}))}_registerQuery(n){if(this._queries.has(n))return this._queries.get(n);let r=this._mediaMatcher.matchMedia(n),o={observable:new re(a=>{let l=c=>this._zone.run(()=>a.next(c));return r.addListener(l),()=>{r.removeListener(l)}}).pipe(Pr(r),pe(({matches:a})=>({query:n,matches:a})),yt(this._destroySubject)),mql:r};return this._queries.set(n,o),o}};e.\u0275fac=function(r){return new(r||e)(C(HB),C(W))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function US(i){return i.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}var jS={XSmall:"(max-width: 599.98px)",Small:"(min-width: 600px) and (max-width: 959.98px)",Medium:"(min-width: 960px) and (max-width: 1279.98px)",Large:"(min-width: 1280px) and (max-width: 1919.98px)",XLarge:"(min-width: 1920px)",Handset:"(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)",Tablet:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait), (min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",Web:"(min-width: 840px) and (orientation: portrait), (min-width: 1280px) and (orientation: landscape)",HandsetPortrait:"(max-width: 599.98px) and (orientation: portrait)",TabletPortrait:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait)",WebPortrait:"(min-width: 840px) and (orientation: portrait)",HandsetLandscape:"(max-width: 959.98px) and (orientation: landscape)",TabletLandscape:"(min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",WebLandscape:"(min-width: 1280px) and (orientation: landscape)"};function sv(i){return i.buttons===0||i.detail===0}function ov(i){let e=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0];return!!e&&e.identifier===-1&&(e.radiusX==null||e.radiusX===1)&&(e.radiusY==null||e.radiusY===1)}var qB=new G("cdk-input-modality-detector-options"),KB={ignoreKeys:[18,17,224,91,16]},GS=650,Rs=Cs({passive:!0,capture:!0}),YB=(()=>{let e=class e{get mostRecentModality(){return this._modality.value}constructor(n,r,s,o){this._platform=n,this._mostRecentTarget=null,this._modality=new Qe(null),this._lastTouchMs=0,this._onKeydown=a=>{this._options?.ignoreKeys?.some(l=>l===a.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Kt(a))},this._onMousedown=a=>{Date.now()-this._lastTouchMs<GS||(this._modality.next(sv(a)?"keyboard":"mouse"),this._mostRecentTarget=Kt(a))},this._onTouchstart=a=>{if(ov(a)){this._modality.next("keyboard");return}this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Kt(a)},this._options=N(N({},KB),o),this.modalityDetected=this._modality.pipe($s(1)),this.modalityChanged=this.modalityDetected.pipe(Ya()),n.isBrowser&&r.runOutsideAngular(()=>{s.addEventListener("keydown",this._onKeydown,Rs),s.addEventListener("mousedown",this._onMousedown,Rs),s.addEventListener("touchstart",this._onTouchstart,Rs)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Rs),document.removeEventListener("mousedown",this._onMousedown,Rs),document.removeEventListener("touchstart",this._onTouchstart,Rs))}};e.\u0275fac=function(r){return new(r||e)(C(je),C(W),C(de),C(qB,8))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),QB=new G("liveAnnouncerElement",{providedIn:"root",factory:XB});function XB(){return null}var ZB=new G("LIVE_ANNOUNCER_DEFAULT_OPTIONS"),JB=0,zS=(()=>{let e=class e{constructor(n,r,s,o){this._ngZone=r,this._defaultOptions=o,this._document=s,this._liveElement=n||this._createLiveElement()}announce(n,...r){let s=this._defaultOptions,o,a;return r.length===1&&typeof r[0]=="number"?a=r[0]:[o,a]=r,this.clear(),clearTimeout(this._previousTimeout),o||(o=s&&s.politeness?s.politeness:"polite"),a==null&&s&&(a=s.duration),this._liveElement.setAttribute("aria-live",o),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(l=>this._currentResolve=l)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=n,typeof a=="number"&&(this._previousTimeout=setTimeout(()=>this.clear(),a)),this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){let n="cdk-live-announcer-element",r=this._document.getElementsByClassName(n),s=this._document.createElement("div");for(let o=0;o<r.length;o++)r[o].remove();return s.classList.add(n),s.classList.add("cdk-visually-hidden"),s.setAttribute("aria-atomic","true"),s.setAttribute("aria-live","polite"),s.id=`cdk-live-announcer-${JB++}`,this._document.body.appendChild(s),s}_exposeAnnouncerToModals(n){let r=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let s=0;s<r.length;s++){let o=r[s],a=o.getAttribute("aria-owns");a?a.indexOf(n)===-1&&o.setAttribute("aria-owns",a+" "+n):o.setAttribute("aria-owns",n)}}};e.\u0275fac=function(r){return new(r||e)(C(QB,8),C(W),C(de),C(ZB,8))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var zu=function(i){return i[i.IMMEDIATE=0]="IMMEDIATE",i[i.EVENTUAL=1]="EVENTUAL",i}(zu||{}),eV=new G("cdk-focus-monitor-default-options"),Gu=Cs({passive:!0,capture:!0}),WS=(()=>{let e=class e{constructor(n,r,s,o,a){this._ngZone=n,this._platform=r,this._inputModalityDetector=s,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new fe,this._rootNodeFocusAndBlurListener=l=>{let c=Kt(l);for(let u=c;u;u=u.parentElement)l.type==="focus"?this._onFocus(l,u):this._onBlur(l,u)},this._document=o,this._detectionMode=a?.detectionMode||zu.IMMEDIATE}monitor(n,r=!1){let s=ii(n);if(!this._platform.isBrowser||s.nodeType!==1)return ne();let o=BS(s)||this._getDocument(),a=this._elementInfo.get(s);if(a)return r&&(a.checkChildren=!0),a.subject;let l={checkChildren:r,subject:new fe,rootNode:o};return this._elementInfo.set(s,l),this._registerGlobalListeners(l),l.subject}stopMonitoring(n){let r=ii(n),s=this._elementInfo.get(r);s&&(s.subject.complete(),this._setClasses(r),this._elementInfo.delete(r),this._removeGlobalListeners(s))}focusVia(n,r,s){let o=ii(n),a=this._getDocument().activeElement;o===a?this._getClosestElementsInfo(o).forEach(([l,c])=>this._originChanged(l,r,c)):(this._setOrigin(r),typeof o.focus=="function"&&o.focus(s))}ngOnDestroy(){this._elementInfo.forEach((n,r)=>this.stopMonitoring(r))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(n){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(n)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:n&&this._isLastInteractionFromInputLabel(n)?"mouse":"program"}_shouldBeAttributedToTouch(n){return this._detectionMode===zu.EVENTUAL||!!n?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(n,r){n.classList.toggle("cdk-focused",!!r),n.classList.toggle("cdk-touch-focused",r==="touch"),n.classList.toggle("cdk-keyboard-focused",r==="keyboard"),n.classList.toggle("cdk-mouse-focused",r==="mouse"),n.classList.toggle("cdk-program-focused",r==="program")}_setOrigin(n,r=!1){this._ngZone.runOutsideAngular(()=>{if(this._origin=n,this._originFromTouchInteraction=n==="touch"&&r,this._detectionMode===zu.IMMEDIATE){clearTimeout(this._originTimeoutId);let s=this._originFromTouchInteraction?GS:1;this._originTimeoutId=setTimeout(()=>this._origin=null,s)}})}_onFocus(n,r){let s=this._elementInfo.get(r),o=Kt(n);!s||!s.checkChildren&&r!==o||this._originChanged(r,this._getFocusOrigin(o),s)}_onBlur(n,r){let s=this._elementInfo.get(r);!s||s.checkChildren&&n.relatedTarget instanceof Node&&r.contains(n.relatedTarget)||(this._setClasses(r),this._emitOrigin(s,null))}_emitOrigin(n,r){n.subject.observers.length&&this._ngZone.run(()=>n.subject.next(r))}_registerGlobalListeners(n){if(!this._platform.isBrowser)return;let r=n.rootNode,s=this._rootNodeFocusListenerCount.get(r)||0;s||this._ngZone.runOutsideAngular(()=>{r.addEventListener("focus",this._rootNodeFocusAndBlurListener,Gu),r.addEventListener("blur",this._rootNodeFocusAndBlurListener,Gu)}),this._rootNodeFocusListenerCount.set(r,s+1),++this._monitoredElementCount===1&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(yt(this._stopInputModalityDetector)).subscribe(o=>{this._setOrigin(o,!0)}))}_removeGlobalListeners(n){let r=n.rootNode;if(this._rootNodeFocusListenerCount.has(r)){let s=this._rootNodeFocusListenerCount.get(r);s>1?this._rootNodeFocusListenerCount.set(r,s-1):(r.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Gu),r.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Gu),this._rootNodeFocusListenerCount.delete(r))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(n,r,s){this._setClasses(n,r),this._emitOrigin(s,r),this._lastFocusOrigin=r}_getClosestElementsInfo(n){let r=[];return this._elementInfo.forEach((s,o)=>{(o===n||s.checkChildren&&o.contains(n))&&r.push([o,s])}),r}_isLastInteractionFromInputLabel(n){let{_mostRecentTarget:r,mostRecentModality:s}=this._inputModalityDetector;if(s!=="mouse"||!r||r===n||n.nodeName!=="INPUT"&&n.nodeName!=="TEXTAREA"||n.disabled)return!1;let o=n.labels;if(o){for(let a=0;a<o.length;a++)if(o[a].contains(r))return!0}return!1}};e.\u0275fac=function(r){return new(r||e)(C(W),C(je),C(YB),C(de,8),C(eV,8))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var Er=function(i){return i[i.NONE=0]="NONE",i[i.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",i[i.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",i}(Er||{}),$S="cdk-high-contrast-black-on-white",HS="cdk-high-contrast-white-on-black",rv="cdk-high-contrast-active",qS=(()=>{let e=class e{constructor(n,r){this._platform=n,this._document=r,this._breakpointSubscription=L(Hu).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return Er.NONE;let n=this._document.createElement("div");n.style.backgroundColor="rgb(1,2,3)",n.style.position="absolute",this._document.body.appendChild(n);let r=this._document.defaultView||window,s=r&&r.getComputedStyle?r.getComputedStyle(n):null,o=(s&&s.backgroundColor||"").replace(/ /g,"");switch(n.remove(),o){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return Er.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return Er.BLACK_ON_WHITE}return Er.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let n=this._document.body.classList;n.remove(rv,$S,HS),this._hasCheckedHighContrastMode=!0;let r=this.getHighContrastMode();r===Er.BLACK_ON_WHITE?n.add(rv,$S):r===Er.WHITE_ON_BLACK&&n.add(rv,HS)}}};e.\u0275fac=function(r){return new(r||e)(C(je),C(de))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var tV=new G("cdk-dir-doc",{providedIn:"root",factory:nV});function nV(){return L(de)}var iV=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function rV(i){let e=i?.toLowerCase()||"";return e==="auto"&&typeof navigator<"u"&&navigator?.language?iV.test(navigator.language)?"rtl":"ltr":e==="rtl"?"rtl":"ltr"}var YS=(()=>{let e=class e{constructor(n){if(this.value="ltr",this.change=new Pe,n){let r=n.body?n.body.dir:null,s=n.documentElement?n.documentElement.dir:null;this.value=rV(r||s||"ltr")}}ngOnDestroy(){this.change.complete()}};e.\u0275fac=function(r){return new(r||e)(C(tV,8))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var Ti=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ee({type:e}),e.\u0275inj=_e({});let i=e;return i})();function aV(){return!0}var lV=new G("mat-sanity-checks",{providedIn:"root",factory:aV}),xi=(()=>{let e=class e{constructor(n,r,s){this._sanityChecks=r,this._document=s,this._hasDoneGlobalChecks=!1,n._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(n){return pa()?!1:typeof this._sanityChecks=="boolean"?this._sanityChecks:!!this._sanityChecks[n]}};e.\u0275fac=function(r){return new(r||e)(C(qS),C(lV,8),C(de))},e.\u0275mod=Ee({type:e}),e.\u0275inj=_e({imports:[Ti,Ti]});let i=e;return i})();var Yt=function(i){return i[i.FADING_IN=0]="FADING_IN",i[i.VISIBLE=1]="VISIBLE",i[i.FADING_OUT=2]="FADING_OUT",i[i.HIDDEN=3]="HIDDEN",i}(Yt||{}),cv=class{constructor(e,t,n,r=!1){this._renderer=e,this.element=t,this.config=n,this._animationForciblyDisabledThroughCss=r,this.state=Yt.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}},QS=Cs({passive:!0,capture:!0}),uv=class{constructor(){this._events=new Map,this._delegateEventHandler=e=>{let t=Kt(e);t&&this._events.get(e.type)?.forEach((n,r)=>{(r===t||r.contains(t))&&n.forEach(s=>s.handleEvent(e))})}}addHandler(e,t,n,r){let s=this._events.get(t);if(s){let o=s.get(n);o?o.add(r):s.set(n,new Set([r]))}else this._events.set(t,new Map([[n,new Set([r])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,QS)})}removeHandler(e,t,n){let r=this._events.get(e);if(!r)return;let s=r.get(t);s&&(s.delete(n),s.size===0&&r.delete(t),r.size===0&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,QS)))}},XS={enterDuration:225,exitDuration:150},cV=800,ZS=Cs({passive:!0,capture:!0}),JS=["mousedown","touchstart"],eT=["mouseup","mouseleave","touchend","touchcancel"],ma=class ma{constructor(e,t,n,r){this._target=e,this._ngZone=t,this._platform=r,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=ii(n))}fadeInRipple(e,t,n={}){let r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=N(N({},XS),n.animation);n.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);let o=n.radius||uV(e,t,r),a=e-r.left,l=t-r.top,c=s.enterDuration,u=document.createElement("div");u.classList.add("mat-ripple-element"),u.style.left=`${a-o}px`,u.style.top=`${l-o}px`,u.style.height=`${o*2}px`,u.style.width=`${o*2}px`,n.color!=null&&(u.style.backgroundColor=n.color),u.style.transitionDuration=`${c}ms`,this._containerElement.appendChild(u);let d=window.getComputedStyle(u),h=d.transitionProperty,f=d.transitionDuration,p=h==="none"||f==="0s"||f==="0s, 0s"||r.width===0&&r.height===0,m=new cv(this,u,n,p);u.style.transform="scale3d(1, 1, 1)",m.state=Yt.FADING_IN,n.persistent||(this._mostRecentTransientRipple=m);let g=null;return!p&&(c||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let y=()=>{g&&(g.fallbackTimer=null),clearTimeout(b),this._finishRippleTransition(m)},_=()=>this._destroyRipple(m),b=setTimeout(_,c+100);u.addEventListener("transitionend",y),u.addEventListener("transitioncancel",_),g={onTransitionEnd:y,onTransitionCancel:_,fallbackTimer:b}}),this._activeRipples.set(m,g),(p||!c)&&this._finishRippleTransition(m),m}fadeOutRipple(e){if(e.state===Yt.FADING_OUT||e.state===Yt.HIDDEN)return;let t=e.element,n=N(N({},XS),e.config.animation);t.style.transitionDuration=`${n.exitDuration}ms`,t.style.opacity="0",e.state=Yt.FADING_OUT,(e._animationForciblyDisabledThroughCss||!n.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){let t=ii(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,JS.forEach(n=>{ma._eventManager.addHandler(this._ngZone,n,t,this)}))}handleEvent(e){e.type==="mousedown"?this._onMousedown(e):e.type==="touchstart"?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{eT.forEach(t=>{this._triggerElement.addEventListener(t,this,ZS)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){e.state===Yt.FADING_IN?this._startFadeOutTransition(e):e.state===Yt.FADING_OUT&&this._destroyRipple(e)}_startFadeOutTransition(e){let t=e===this._mostRecentTransientRipple,{persistent:n}=e.config;e.state=Yt.VISIBLE,!n&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){let t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=Yt.HIDDEN,t!==null&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel),t.fallbackTimer!==null&&clearTimeout(t.fallbackTimer)),e.element.remove()}_onMousedown(e){let t=sv(e),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+cV;!this._target.rippleDisabled&&!t&&!n&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!ov(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let t=e.changedTouches;if(t)for(let n=0;n<t.length;n++)this.fadeInRipple(t[n].clientX,t[n].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{let t=e.state===Yt.VISIBLE||e.config.terminateOnPointerUp&&e.state===Yt.FADING_IN;!e.config.persistent&&t&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let e=this._triggerElement;e&&(JS.forEach(t=>ma._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&(eT.forEach(t=>e.removeEventListener(t,this,ZS)),this._pointerUpEventsRegistered=!1))}};ma._eventManager=new uv;var dv=ma;function uV(i,e,t){let n=Math.max(Math.abs(i-t.left),Math.abs(i-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(n*n+r*r)}var rT=new G("mat-ripple-global-options"),dV=(()=>{let e=class e{get disabled(){return this._disabled}set disabled(n){n&&this.fadeOutAllNonPersistent(),this._disabled=n,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(n){this._trigger=n,this._setupTriggerEventsIfEnabled()}constructor(n,r,s,o,a){this._elementRef=n,this._animationMode=a,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=o||{},this._rippleRenderer=new dv(this,r,n,s)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:N(N(N({},this._globalOptions.animation),this._animationMode==="NoopAnimations"?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(n,r=0,s){return typeof n=="number"?this._rippleRenderer.fadeInRipple(n,r,N(N({},this.rippleConfig),s)):this._rippleRenderer.fadeInRipple(0,0,N(N({},this.rippleConfig),n))}};e.\u0275fac=function(r){return new(r||e)(X(Me),X(W),X(je),X(rT,8),X(Tn,8))},e.\u0275dir=Le({type:e,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(r,s){r&2&&Yn("mat-ripple-unbounded",s.unbounded)},inputs:{color:[we.None,"matRippleColor","color"],unbounded:[we.None,"matRippleUnbounded","unbounded"],centered:[we.None,"matRippleCentered","centered"],radius:[we.None,"matRippleRadius","radius"],animation:[we.None,"matRippleAnimation","animation"],disabled:[we.None,"matRippleDisabled","disabled"],trigger:[we.None,"matRippleTrigger","trigger"]},exportAs:["matRipple"],standalone:!0});let i=e;return i})(),sT=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ee({type:e}),e.\u0275inj=_e({imports:[xi,xi]});let i=e;return i})();var tT={capture:!0},nT=["focus","mousedown","mouseenter","touchstart"],av="mat-ripple-loader-uninitialized",lv="mat-ripple-loader-class-name",iT="mat-ripple-loader-centered",Wu="mat-ripple-loader-disabled",oT=(()=>{let e=class e{constructor(){this._document=L(de,{optional:!0}),this._animationMode=L(Tn,{optional:!0}),this._globalRippleOptions=L(rT,{optional:!0}),this._platform=L(je),this._ngZone=L(W),this._hosts=new Map,this._onInteraction=n=>{let r=Kt(n);if(r instanceof HTMLElement){let s=r.closest(`[${av}="${this._globalRippleOptions?.namespace??""}"]`);s&&this._createRipple(s)}},this._ngZone.runOutsideAngular(()=>{for(let n of nT)this._document?.addEventListener(n,this._onInteraction,tT)})}ngOnDestroy(){let n=this._hosts.keys();for(let r of n)this.destroyRipple(r);for(let r of nT)this._document?.removeEventListener(r,this._onInteraction,tT)}configureRipple(n,r){n.setAttribute(av,this._globalRippleOptions?.namespace??""),(r.className||!n.hasAttribute(lv))&&n.setAttribute(lv,r.className||""),r.centered&&n.setAttribute(iT,""),r.disabled&&n.setAttribute(Wu,"")}getRipple(n){return this._hosts.get(n)||this._createRipple(n)}setDisabled(n,r){let s=this._hosts.get(n);if(s){s.disabled=r;return}r?n.setAttribute(Wu,""):n.removeAttribute(Wu)}_createRipple(n){if(!this._document)return;let r=this._hosts.get(n);if(r)return r;n.querySelector(".mat-ripple")?.remove();let s=this._document.createElement("span");s.classList.add("mat-ripple",n.getAttribute(lv)),n.append(s);let o=new dV(new Me(s),this._ngZone,this._platform,this._globalRippleOptions?this._globalRippleOptions:void 0,this._animationMode?this._animationMode:void 0);return o._isInitialized=!0,o.trigger=n,o.centered=n.hasAttribute(iT),o.disabled=n.hasAttribute(Wu),this.attachRipple(n,o),o}attachRipple(n,r){n.removeAttribute(av),this._hosts.set(n,r)}destroyRipple(n){let r=this._hosts.get(n);r&&(r.ngOnDestroy(),this._hosts.delete(n))}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var hV=["mat-button",""],fV=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],pV=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"];var mV=new G("MAT_BUTTON_CONFIG");var gV=[{attribute:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{attribute:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{attribute:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{attribute:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{attribute:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab-base","mat-mdc-fab"]},{attribute:"mat-mini-fab",mdcClasses:["mdc-fab","mat-mdc-fab-base","mdc-fab--mini","mat-mdc-mini-fab"]},{attribute:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}],vV=(()=>{let e=class e{get ripple(){return this._rippleLoader?.getRipple(this._elementRef.nativeElement)}set ripple(n){this._rippleLoader?.attachRipple(this._elementRef.nativeElement,n)}get disableRipple(){return this._disableRipple}set disableRipple(n){this._disableRipple=n,this._updateRippleDisabled()}get disabled(){return this._disabled}set disabled(n){this._disabled=n,this._updateRippleDisabled()}constructor(n,r,s,o){this._elementRef=n,this._platform=r,this._ngZone=s,this._animationMode=o,this._focusMonitor=L(WS),this._rippleLoader=L(oT),this._isFab=!1,this._disableRipple=!1,this._disabled=!1;let a=L(mV,{optional:!0}),l=n.nativeElement,c=l.classList;this.disabledInteractive=a?.disabledInteractive??!1,this.color=a?.color??null,this._rippleLoader?.configureRipple(l,{className:"mat-mdc-button-ripple"});for(let{attribute:u,mdcClasses:d}of gV)l.hasAttribute(u)&&c.add(...d)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(n="program",r){n?this._focusMonitor.focusVia(this._elementRef.nativeElement,n,r):this._elementRef.nativeElement.focus(r)}_getAriaDisabled(){return this.ariaDisabled!=null?this.ariaDisabled:this.disabled&&this.disabledInteractive?!0:null}_getDisabledAttribute(){return this.disabledInteractive||!this.disabled?null:!0}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}};e.\u0275fac=function(r){ef()},e.\u0275dir=Le({type:e,inputs:{color:"color",disableRipple:[we.HasDecoratorInputTransform,"disableRipple","disableRipple",Ht],disabled:[we.HasDecoratorInputTransform,"disabled","disabled",Ht],ariaDisabled:[we.HasDecoratorInputTransform,"aria-disabled","ariaDisabled",Ht],disabledInteractive:[we.HasDecoratorInputTransform,"disabledInteractive","disabledInteractive",Ht]},features:[pi]});let i=e;return i})();var aT=(()=>{let e=class e extends vV{constructor(n,r,s,o){super(n,r,s,o)}};e.\u0275fac=function(r){return new(r||e)(X(Me),X(je),X(W),X(Tn,8))},e.\u0275cmp=nn({type:e,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:14,hostBindings:function(r,s){r&2&&(Kn("disabled",s._getDisabledAttribute())("aria-disabled",s._getAriaDisabled()),Gb(s.color?"mat-"+s.color:""),Yn("mat-mdc-button-disabled",s.disabled)("mat-mdc-button-disabled-interactive",s.disabledInteractive)("_mat-animation-noopable",s._animationMode==="NoopAnimations")("mat-unthemed",!s.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],standalone:!0,features:[At,on],attrs:hV,ngContentSelectors:pV,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-mdc-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(r,s){r&1&&(Ul(fV),Rt(0,"span",0),ts(1),Ue(2,"span",1),ts(3,1),Ge(),ts(4,2),Rt(5,"span",2)(6,"span",3)),r&2&&Yn("mdc-button__ripple",!s._isFab)("mdc-fab__ripple",s._isFab)},styles:['.mat-mdc-button-base{text-decoration:none}.mdc-button{-webkit-user-select:none;user-select:none;position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0);padding:0 8px}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__label{position:relative}.mat-mdc-button{padding:0 var(--mat-text-button-horizontal-padding, 8px);height:var(--mdc-text-button-container-height);font-family:var(--mdc-text-button-label-text-font, var(--mat-app-label-large-font));font-size:var(--mdc-text-button-label-text-size, var(--mat-app-label-large-size));letter-spacing:var(--mdc-text-button-label-text-tracking, var(--mat-app-label-large-tracking));text-transform:var(--mdc-text-button-label-text-transform);font-weight:var(--mdc-text-button-label-text-weight, var(--mat-app-label-large-weight))}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-text-button-with-icon-horizontal-padding, 8px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-offset, 0);margin-left:var(--mat-text-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, 0)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-text-button-ripple-color)}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-state-layer-color, var(--mat-app-primary))}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-disabled-state-layer-color, var(--mat-app-on-surface-variant))}.mat-mdc-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity))}.mat-mdc-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity))}.mat-mdc-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity))}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-text-button-touch-target-display)}.mat-mdc-button,.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mat-app-corner-full))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, var(--mat-app-primary))}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-text-button-disabled-label-text-color)}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-unelevated-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 var(--mat-filled-button-horizontal-padding, 16px);height:var(--mdc-filled-button-container-height);font-family:var(--mdc-filled-button-label-text-font, var(--mat-app-label-large-font));font-size:var(--mdc-filled-button-label-text-size, var(--mat-app-label-large-size));letter-spacing:var(--mdc-filled-button-label-text-tracking, var(--mat-app-label-large-tracking));text-transform:var(--mdc-filled-button-label-text-transform);font-weight:var(--mdc-filled-button-label-text-weight, var(--mat-app-label-large-weight))}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -4px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -4px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-filled-button-ripple-color)}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-state-layer-color, var(--mat-app-on-primary))}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-disabled-state-layer-color, var(--mat-app-on-surface-variant))}.mat-mdc-unelevated-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity))}.mat-mdc-unelevated-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity))}.mat-mdc-unelevated-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity))}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-filled-button-touch-target-display)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, var(--mat-app-on-primary));background-color:var(--mdc-filled-button-container-color, var(--mat-app-primary))}.mat-mdc-unelevated-button,.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mat-app-corner-full))}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-filled-button-disabled-label-text-color);background-color:var(--mdc-filled-button-disabled-container-color)}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 var(--mat-protected-button-horizontal-padding, 16px);box-shadow:var(--mdc-protected-button-container-elevation-shadow, var(--mat-app-level1));height:var(--mdc-protected-button-container-height);font-family:var(--mdc-protected-button-label-text-font, var(--mat-app-label-large-font));font-size:var(--mdc-protected-button-label-text-size, var(--mat-app-label-large-size));letter-spacing:var(--mdc-protected-button-label-text-tracking, var(--mat-app-label-large-tracking));text-transform:var(--mdc-protected-button-label-text-transform);font-weight:var(--mdc-protected-button-label-text-weight, var(--mat-app-label-large-weight))}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -4px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -4px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-protected-button-ripple-color)}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-state-layer-color, var(--mat-app-primary))}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-disabled-state-layer-color, var(--mat-app-on-surface-variant))}.mat-mdc-raised-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity))}.mat-mdc-raised-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity))}.mat-mdc-raised-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity))}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-protected-button-touch-target-display)}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, var(--mat-app-primary));background-color:var(--mdc-protected-button-container-color, var(--mat-app-surface))}.mat-mdc-raised-button,.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mat-app-corner-full))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation-shadow, var(--mat-app-level2))}.mat-mdc-raised-button:focus{box-shadow:var(--mdc-protected-button-focus-container-elevation-shadow, var(--mat-app-level1))}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mdc-protected-button-pressed-container-elevation-shadow, var(--mat-app-level1))}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-protected-button-disabled-label-text-color);background-color:var(--mdc-protected-button-disabled-container-color)}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation-shadow, var(--mat-app-level0))}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1);padding:0 var(--mat-outlined-button-horizontal-padding, 15px);height:var(--mdc-outlined-button-container-height);font-family:var(--mdc-outlined-button-label-text-font, var(--mat-app-label-large-font));font-size:var(--mdc-outlined-button-label-text-size, var(--mat-app-label-large-size));letter-spacing:var(--mdc-outlined-button-label-text-tracking, var(--mat-app-label-large-tracking));text-transform:var(--mdc-outlined-button-label-text-transform);font-weight:var(--mdc-outlined-button-label-text-weight, var(--mat-app-label-large-weight));border-radius:var(--mdc-outlined-button-container-shape, var(--mat-app-corner-full));border-width:var(--mdc-outlined-button-outline-width)}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -4px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -4px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-outlined-button-ripple-color)}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-state-layer-color, var(--mat-app-primary))}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-disabled-state-layer-color, var(--mat-app-on-surface-variant))}.mat-mdc-outlined-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-hover-state-layer-opacity, var(--mat-app-hover-state-layer-opacity))}.mat-mdc-outlined-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-focus-state-layer-opacity, var(--mat-app-focus-state-layer-opacity))}.mat-mdc-outlined-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-pressed-state-layer-opacity, var(--mat-app-pressed-state-layer-opacity))}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-outlined-button-touch-target-display)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, var(--mat-app-primary));border-color:var(--mdc-outlined-button-outline-color, var(--mat-app-outline))}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-outlined-button-disabled-label-text-color);border-color:var(--mdc-outlined-button-disabled-outline-color)}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button .mdc-button__ripple{border-width:var(--mdc-outlined-button-outline-width);border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-button .mat-icon,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-unelevated-button .mat-icon,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-raised-button .mat-icon,.mat-mdc-outlined-button .mdc-button__label,.mat-mdc-outlined-button .mat-icon{z-index:1;position:relative}.mat-mdc-button .mat-mdc-focus-indicator,.mat-mdc-unelevated-button .mat-mdc-focus-indicator,.mat-mdc-raised-button .mat-mdc-focus-indicator,.mat-mdc-outlined-button .mat-mdc-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-raised-button:focus .mat-mdc-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-mdc-focus-indicator::before{content:""}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px}.mat-mdc-unelevated-button .mat-mdc-focus-indicator::before,.mat-mdc-raised-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-mdc-focus-indicator::before{margin:calc(calc(var(--mat-mdc-focus-indicator-border-width, 3px) + 3px)*-1)}',".cdk-high-contrast-active .mat-mdc-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-unelevated-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-raised-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-outlined-button:not(.mdc-button--outlined),.cdk-high-contrast-active .mat-mdc-icon-button{outline:solid 1px}"],encapsulation:2,changeDetection:0});let i=e;return i})();var lT=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ee({type:e}),e.\u0275inj=_e({imports:[xi,sT,xi]});let i=e;return i})();var ga=class{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;e!=null&&(this._attachedHost=null,e.detach())}get isAttached(){return this._attachedHost!=null}setAttachedHost(e){this._attachedHost=e}},Ms=class extends ga{constructor(e,t,n,r,s){super(),this.component=e,this.viewContainerRef=t,this.injector=n,this.componentFactoryResolver=r,this.projectableNodes=s}},ks=class extends ga{constructor(e,t,n,r){super(),this.templateRef=e,this.viewContainerRef=t,this.context=n,this.injector=r}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}},hv=class extends ga{constructor(e){super(),this.element=e instanceof Me?e.nativeElement:e}},Ls=class{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){if(e instanceof Ms)return this._attachedPortal=e,this.attachComponentPortal(e);if(e instanceof ks)return this._attachedPortal=e,this.attachTemplatePortal(e);if(this.attachDomPortal&&e instanceof hv)return this._attachedPortal=e,this.attachDomPortal(e)}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}};var qu=class extends Ls{constructor(e,t,n,r,s){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=n,this._defaultInjector=r,this.attachDomPortal=o=>{this._document;let a=o.element;a.parentNode;let l=this._document.createComment("dom-portal");a.parentNode.insertBefore(l,a),this.outletElement.appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(a,l)})},this._document=s}attachComponentPortal(e){let n=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component),r;return e.viewContainerRef?(r=e.viewContainerRef.createComponent(n,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>r.destroy())):(r=n.create(e.injector||this._defaultInjector||qe.NULL),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(r.hostView),r.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(r)),this._attachedPortal=e,r}attachTemplatePortal(e){let t=e.viewContainerRef,n=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return n.rootNodes.forEach(r=>this.outletElement.appendChild(r)),n.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(n);r!==-1&&t.remove(r)}),this._attachedPortal=e,n}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}};var fv=(()=>{let e=class e extends Ls{constructor(n,r,s){super(),this._componentFactoryResolver=n,this._viewContainerRef=r,this._isInitialized=!1,this.attached=new Pe,this.attachDomPortal=o=>{this._document;let a=o.element;a.parentNode;let l=this._document.createComment("dom-portal");o.setAttachedHost(this),a.parentNode.insertBefore(l,a),this._getRootNode().appendChild(a),this._attachedPortal=o,super.setDisposeFn(()=>{l.parentNode&&l.parentNode.replaceChild(a,l)})},this._document=s}get portal(){return this._attachedPortal}set portal(n){this.hasAttached()&&!n&&!this._isInitialized||(this.hasAttached()&&super.detach(),n&&super.attach(n),this._attachedPortal=n||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(n){n.setAttachedHost(this);let r=n.viewContainerRef!=null?n.viewContainerRef:this._viewContainerRef,o=(n.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(n.component),a=r.createComponent(o,r.length,n.injector||r.injector,n.projectableNodes||void 0);return r!==this._viewContainerRef&&this._getRootNode().appendChild(a.hostView.rootNodes[0]),super.setDisposeFn(()=>a.destroy()),this._attachedPortal=n,this._attachedRef=a,this.attached.emit(a),a}attachTemplatePortal(n){n.setAttachedHost(this);let r=this._viewContainerRef.createEmbeddedView(n.templateRef,n.context,{injector:n.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=n,this._attachedRef=r,this.attached.emit(r),r}_getRootNode(){let n=this._viewContainerRef.element.nativeElement;return n.nodeType===n.ELEMENT_NODE?n:n.parentNode}};e.\u0275fac=function(r){return new(r||e)(X(fi),X(rn),X(de))},e.\u0275dir=Le({type:e,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[we.None,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],standalone:!0,features:[At]});let i=e;return i})();var Ku=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ee({type:e}),e.\u0275inj=_e({});let i=e;return i})();var yV=20,uT=(()=>{let e=class e{constructor(n,r,s){this._ngZone=n,this._platform=r,this._scrolled=new fe,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=s}register(n){this.scrollContainers.has(n)||this.scrollContainers.set(n,n.elementScrolled().subscribe(()=>this._scrolled.next(n)))}deregister(n){let r=this.scrollContainers.get(n);r&&(r.unsubscribe(),this.scrollContainers.delete(n))}scrolled(n=yV){return this._platform.isBrowser?new re(r=>{this._globalSubscription||this._addGlobalListener();let s=n>0?this._scrolled.pipe(qa(n)).subscribe(r):this._scrolled.subscribe(r);return this._scrolledCount++,()=>{s.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):ne()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((n,r)=>this.deregister(r)),this._scrolled.complete()}ancestorScrolled(n,r){let s=this.getAncestorScrollContainers(n);return this.scrolled(r).pipe(Je(o=>!o||s.indexOf(o)>-1))}getAncestorScrollContainers(n){let r=[];return this.scrollContainers.forEach((s,o)=>{this._scrollableContainsElement(o,n)&&r.push(o)}),r}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(n,r){let s=ii(r),o=n.getElementRef().nativeElement;do if(s==o)return!0;while(s=s.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>{let n=this._getWindow();return Us(n.document,"scroll").subscribe(()=>this._scrolled.next())})}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}};e.\u0275fac=function(r){return new(r||e)(C(W),C(je),C(de,8))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var bV=20,pv=(()=>{let e=class e{constructor(n,r,s){this._platform=n,this._change=new fe,this._changeListener=o=>{this._change.next(o)},this._document=s,r.runOutsideAngular(()=>{if(n.isBrowser){let o=this._getWindow();o.addEventListener("resize",this._changeListener),o.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){let n=this._getWindow();n.removeEventListener("resize",this._changeListener),n.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let n={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),n}getViewportRect(){let n=this.getViewportScrollPosition(),{width:r,height:s}=this.getViewportSize();return{top:n.top,left:n.left,bottom:n.top+s,right:n.left+r,height:s,width:r}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let n=this._document,r=this._getWindow(),s=n.documentElement,o=s.getBoundingClientRect(),a=-o.top||n.body.scrollTop||r.scrollY||s.scrollTop||0,l=-o.left||n.body.scrollLeft||r.scrollX||s.scrollLeft||0;return{top:a,left:l}}change(n=bV){return n>0?this._change.pipe(qa(n)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let n=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:n.innerWidth,height:n.innerHeight}:{width:0,height:0}}};e.\u0275fac=function(r){return new(r||e)(C(je),C(W),C(de,8))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var cT=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ee({type:e}),e.\u0275inj=_e({});let i=e;return i})(),mv=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ee({type:e}),e.\u0275inj=_e({imports:[Ti,cT,Ti,cT]});let i=e;return i})();var dT=FS(),gv=class{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){let e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=ze(-this._previousScrollPosition.left),e.style.top=ze(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){let e=this._document.documentElement,t=this._document.body,n=e.style,r=t.style,s=n.scrollBehavior||"",o=r.scrollBehavior||"";this._isEnabled=!1,n.left=this._previousHTMLStyles.left,n.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),dT&&(n.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),dT&&(n.scrollBehavior=s,r.scrollBehavior=o)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;let t=this._document.body,n=this._viewportRuler.getViewportSize();return t.scrollHeight>n.height||t.scrollWidth>n.width}};var vv=class{constructor(e,t,n,r){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=n,this._config=r,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef,this._overlayRef=e}enable(){if(this._scrollSubscription)return;let e=this._scrollDispatcher.scrolled(0).pipe(Je(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{let t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},Yu=class{enable(){}disable(){}attach(){}};function yv(i,e){return e.some(t=>{let n=i.bottom<t.top,r=i.top>t.bottom,s=i.right<t.left,o=i.left>t.right;return n||r||s||o})}function hT(i,e){return e.some(t=>{let n=i.top<t.top,r=i.bottom>t.bottom,s=i.left<t.left,o=i.right>t.right;return n||r||s||o})}var bv=class{constructor(e,t,n,r){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=n,this._config=r,this._scrollSubscription=null}attach(e){this._overlayRef,this._overlayRef=e}enable(){if(!this._scrollSubscription){let e=this._config?this._config.scrollThrottle:0;this._scrollSubscription=this._scrollDispatcher.scrolled(e).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){let t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:n,height:r}=this._viewportRuler.getViewportSize();yv(t,[{width:n,height:r,bottom:r,right:n,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}})}}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},EV=(()=>{let e=class e{constructor(n,r,s,o){this._scrollDispatcher=n,this._viewportRuler=r,this._ngZone=s,this.noop=()=>new Yu,this.close=a=>new vv(this._scrollDispatcher,this._ngZone,this._viewportRuler,a),this.block=()=>new gv(this._viewportRuler,this._document),this.reposition=a=>new bv(this._scrollDispatcher,this._viewportRuler,this._ngZone,a),this._document=o}};e.\u0275fac=function(r){return new(r||e)(C(uT),C(pv),C(W),C(de))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),va=class{constructor(e){if(this.scrollStrategy=new Yu,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){let t=Object.keys(e);for(let n of t)e[n]!==void 0&&(this[n]=e[n])}}};var _v=class{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}};var yT=(()=>{let e=class e{constructor(n){this._attachedOverlays=[],this._document=n}ngOnDestroy(){this.detach()}add(n){this.remove(n),this._attachedOverlays.push(n)}remove(n){let r=this._attachedOverlays.indexOf(n);r>-1&&this._attachedOverlays.splice(r,1),this._attachedOverlays.length===0&&this.detach()}};e.\u0275fac=function(r){return new(r||e)(C(de))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),DV=(()=>{let e=class e extends yT{constructor(n,r){super(n),this._ngZone=r,this._keydownListener=s=>{let o=this._attachedOverlays;for(let a=o.length-1;a>-1;a--)if(o[a]._keydownEvents.observers.length>0){let l=o[a]._keydownEvents;this._ngZone?this._ngZone.run(()=>l.next(s)):l.next(s);break}}}add(n){super.add(n),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}};e.\u0275fac=function(r){return new(r||e)(C(de),C(W,8))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),wV=(()=>{let e=class e extends yT{constructor(n,r,s){super(n),this._platform=r,this._ngZone=s,this._cursorStyleIsSet=!1,this._pointerDownListener=o=>{this._pointerDownEventTarget=Kt(o)},this._clickListener=o=>{let a=Kt(o),l=o.type==="click"&&this._pointerDownEventTarget?this._pointerDownEventTarget:a;this._pointerDownEventTarget=null;let c=this._attachedOverlays.slice();for(let u=c.length-1;u>-1;u--){let d=c[u];if(d._outsidePointerEvents.observers.length<1||!d.hasAttached())continue;if(fT(d.overlayElement,a)||fT(d.overlayElement,l))break;let h=d._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>h.next(o)):h.next(o)}}}add(n){if(super.add(n),!this._isAttached){let r=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(r)):this._addEventListeners(r),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=r.style.cursor,r.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){let n=this._document.body;n.removeEventListener("pointerdown",this._pointerDownListener,!0),n.removeEventListener("click",this._clickListener,!0),n.removeEventListener("auxclick",this._clickListener,!0),n.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(n.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(n){n.addEventListener("pointerdown",this._pointerDownListener,!0),n.addEventListener("click",this._clickListener,!0),n.addEventListener("auxclick",this._clickListener,!0),n.addEventListener("contextmenu",this._clickListener,!0)}};e.\u0275fac=function(r){return new(r||e)(C(de),C(je),C(W,8))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function fT(i,e){let t=typeof ShadowRoot<"u"&&ShadowRoot,n=e;for(;n;){if(n===i)return!0;n=t&&n instanceof ShadowRoot?n.host:n.parentNode}return!1}var bT=(()=>{let e=class e{constructor(n,r){this._platform=r,this._document=n}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let n="cdk-overlay-container";if(this._platform.isBrowser||pa()){let s=this._document.querySelectorAll(`.${n}[platform="server"], .${n}[platform="test"]`);for(let o=0;o<s.length;o++)s[o].remove()}let r=this._document.createElement("div");r.classList.add(n),pa()?r.setAttribute("platform","test"):this._platform.isBrowser||r.setAttribute("platform","server"),this._document.body.appendChild(r),this._containerElement=r}};e.\u0275fac=function(r){return new(r||e)(C(de),C(je))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),Ev=class{constructor(e,t,n,r,s,o,a,l,c,u=!1,d){this._portalOutlet=e,this._host=t,this._pane=n,this._config=r,this._ngZone=s,this._keyboardDispatcher=o,this._document=a,this._location=l,this._outsideClickDispatcher=c,this._animationsDisabled=u,this._injector=d,this._backdropElement=null,this._backdropClick=new fe,this._attachments=new fe,this._detachments=new fe,this._locationChanges=ke.EMPTY,this._backdropClickHandler=h=>this._backdropClick.next(h),this._backdropTransitionendHandler=h=>{this._disposeBackdrop(h.target)},this._keydownEvents=new fe,this._outsidePointerEvents=new fe,this._renders=new fe,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy,this._afterRenderRef=zl(()=>lf(()=>{this._renders.next()},{injector:this._injector}))}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);let t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),co(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),typeof t?.onDestroy=="function"&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();let e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){let e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete(),this._afterRenderRef.destroy(),this._renders.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config=N(N({},this._config),e),this._updateElementSize()}setDirection(e){this._config=Ie(N({},this._config),{direction:e}),this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){let e=this._config.direction;return e?typeof e=="string"?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;let e=this._pane.style;e.width=ze(this._config.width),e.height=ze(this._config.height),e.minWidth=ze(this._config.minWidth),e.minHeight=ze(this._config.minHeight),e.maxWidth=ze(this._config.maxWidth),e.maxHeight=ze(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){let e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let e=this._backdropElement;if(e){if(this._animationsDisabled){this._disposeBackdrop(e);return}e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,n){let r=As(t||[]).filter(s=>!!s);r.length&&(n?e.classList.add(...r):e.classList.remove(...r))}_detachContentWhenEmpty(){this._ngZone.runOutsideAngular(()=>{let e=this._renders.pipe(yt(fd(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||this._pane.children.length===0)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){let e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}},pT="cdk-overlay-connected-position-bounding-box",SV=/([A-Za-z%]+)$/,Dv=class{get positions(){return this._preferredPositions}constructor(e,t,n,r,s){this._viewportRuler=t,this._document=n,this._platform=r,this._overlayContainer=s,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new fe,this._resizeSubscription=ke.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._overlayRef&&this._overlayRef,this._validatePositions(),e.hostElement.classList.add(pT),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition){this.reapplyLastPosition();return}this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let e=this._originRect,t=this._overlayRect,n=this._viewportRect,r=this._containerRect,s=[],o;for(let a of this._preferredPositions){let l=this._getOriginPoint(e,r,a),c=this._getOverlayPoint(l,t,a),u=this._getOverlayFit(c,t,n,a);if(u.isCompletelyWithinViewport){this._isPushed=!1,this._applyPosition(a,l);return}if(this._canFitWithFlexibleDimensions(u,c,n)){s.push({position:a,origin:l,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(l,a)});continue}(!o||o.overlayFit.visibleArea<u.visibleArea)&&(o={overlayFit:u,overlayPoint:c,originPoint:l,position:a,overlayRect:t})}if(s.length){let a=null,l=-1;for(let c of s){let u=c.boundingBoxRect.width*c.boundingBoxRect.height*(c.position.weight||1);u>l&&(l=u,a=c)}this._isPushed=!1,this._applyPosition(a.position,a.origin);return}if(this._canPush){this._isPushed=!0,this._applyPosition(o.position,o.originPoint);return}this._applyPosition(o.position,o.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Dr(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(pT),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;let e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,e.indexOf(this._lastPosition)===-1&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,n){let r;if(n.originX=="center")r=e.left+e.width/2;else{let o=this._isRtl()?e.right:e.left,a=this._isRtl()?e.left:e.right;r=n.originX=="start"?o:a}t.left<0&&(r-=t.left);let s;return n.originY=="center"?s=e.top+e.height/2:s=n.originY=="top"?e.top:e.bottom,t.top<0&&(s-=t.top),{x:r,y:s}}_getOverlayPoint(e,t,n){let r;n.overlayX=="center"?r=-t.width/2:n.overlayX==="start"?r=this._isRtl()?-t.width:0:r=this._isRtl()?0:-t.width;let s;return n.overlayY=="center"?s=-t.height/2:s=n.overlayY=="top"?0:-t.height,{x:e.x+r,y:e.y+s}}_getOverlayFit(e,t,n,r){let s=gT(t),{x:o,y:a}=e,l=this._getOffset(r,"x"),c=this._getOffset(r,"y");l&&(o+=l),c&&(a+=c);let u=0-o,d=o+s.width-n.width,h=0-a,f=a+s.height-n.height,p=this._subtractOverflows(s.width,u,d),m=this._subtractOverflows(s.height,h,f),g=p*m;return{visibleArea:g,isCompletelyWithinViewport:s.width*s.height===g,fitsInViewportVertically:m===s.height,fitsInViewportHorizontally:p==s.width}}_canFitWithFlexibleDimensions(e,t,n){if(this._hasFlexibleDimensions){let r=n.bottom-t.y,s=n.right-t.x,o=mT(this._overlayRef.getConfig().minHeight),a=mT(this._overlayRef.getConfig().minWidth),l=e.fitsInViewportVertically||o!=null&&o<=r,c=e.fitsInViewportHorizontally||a!=null&&a<=s;return l&&c}return!1}_pushOverlayOnScreen(e,t,n){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};let r=gT(t),s=this._viewportRect,o=Math.max(e.x+r.width-s.width,0),a=Math.max(e.y+r.height-s.height,0),l=Math.max(s.top-n.top-e.y,0),c=Math.max(s.left-n.left-e.x,0),u=0,d=0;return r.width<=s.width?u=c||-o:u=e.x<this._viewportMargin?s.left-n.left-e.x:0,r.height<=s.height?d=l||-a:d=e.y<this._viewportMargin?s.top-n.top-e.y:0,this._previousPushAmount={x:u,y:d},{x:e.x+u,y:e.y+d}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._positionChanges.observers.length){let n=this._getScrollVisibility();if(e!==this._lastPosition||!this._lastScrollVisibility||!TV(this._lastScrollVisibility,n)){let r=new _v(e,n);this._positionChanges.next(r)}this._lastScrollVisibility=n}this._lastPosition=e,this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;let t=this._boundingBox.querySelectorAll(this._transformOriginSelector),n,r=e.overlayY;e.overlayX==="center"?n="center":this._isRtl()?n=e.overlayX==="start"?"right":"left":n=e.overlayX==="start"?"left":"right";for(let s=0;s<t.length;s++)t[s].style.transformOrigin=`${n} ${r}`}_calculateBoundingBoxRect(e,t){let n=this._viewportRect,r=this._isRtl(),s,o,a;if(t.overlayY==="top")o=e.y,s=n.height-o+this._viewportMargin;else if(t.overlayY==="bottom")a=n.height-e.y+this._viewportMargin*2,s=n.height-a+this._viewportMargin;else{let f=Math.min(n.bottom-e.y+n.top,e.y),p=this._lastBoundingBoxSize.height;s=f*2,o=e.y-f,s>p&&!this._isInitialRender&&!this._growAfterOpen&&(o=e.y-p/2)}let l=t.overlayX==="start"&&!r||t.overlayX==="end"&&r,c=t.overlayX==="end"&&!r||t.overlayX==="start"&&r,u,d,h;if(c)h=n.width-e.x+this._viewportMargin*2,u=e.x-this._viewportMargin;else if(l)d=e.x,u=n.right-e.x;else{let f=Math.min(n.right-e.x+n.left,e.x),p=this._lastBoundingBoxSize.width;u=f*2,d=e.x-f,u>p&&!this._isInitialRender&&!this._growAfterOpen&&(d=e.x-p/2)}return{top:o,left:d,bottom:a,right:h,width:u,height:s}}_setBoundingBoxStyles(e,t){let n=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));let r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{let s=this._overlayRef.getConfig().maxHeight,o=this._overlayRef.getConfig().maxWidth;r.height=ze(n.height),r.top=ze(n.top),r.bottom=ze(n.bottom),r.width=ze(n.width),r.left=ze(n.left),r.right=ze(n.right),t.overlayX==="center"?r.alignItems="center":r.alignItems=t.overlayX==="end"?"flex-end":"flex-start",t.overlayY==="center"?r.justifyContent="center":r.justifyContent=t.overlayY==="bottom"?"flex-end":"flex-start",s&&(r.maxHeight=ze(s)),o&&(r.maxWidth=ze(o))}this._lastBoundingBoxSize=n,Dr(this._boundingBox.style,r)}_resetBoundingBoxStyles(){Dr(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Dr(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){let n={},r=this._hasExactPosition(),s=this._hasFlexibleDimensions,o=this._overlayRef.getConfig();if(r){let u=this._viewportRuler.getViewportScrollPosition();Dr(n,this._getExactOverlayY(t,e,u)),Dr(n,this._getExactOverlayX(t,e,u))}else n.position="static";let a="",l=this._getOffset(t,"x"),c=this._getOffset(t,"y");l&&(a+=`translateX(${l}px) `),c&&(a+=`translateY(${c}px)`),n.transform=a.trim(),o.maxHeight&&(r?n.maxHeight=ze(o.maxHeight):s&&(n.maxHeight="")),o.maxWidth&&(r?n.maxWidth=ze(o.maxWidth):s&&(n.maxWidth="")),Dr(this._pane.style,n)}_getExactOverlayY(e,t,n){let r={top:"",bottom:""},s=this._getOverlayPoint(t,this._overlayRect,e);if(this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,n)),e.overlayY==="bottom"){let o=this._document.documentElement.clientHeight;r.bottom=`${o-(s.y+this._overlayRect.height)}px`}else r.top=ze(s.y);return r}_getExactOverlayX(e,t,n){let r={left:"",right:""},s=this._getOverlayPoint(t,this._overlayRect,e);this._isPushed&&(s=this._pushOverlayOnScreen(s,this._overlayRect,n));let o;if(this._isRtl()?o=e.overlayX==="end"?"left":"right":o=e.overlayX==="end"?"right":"left",o==="right"){let a=this._document.documentElement.clientWidth;r.right=`${a-(s.x+this._overlayRect.width)}px`}else r.left=ze(s.x);return r}_getScrollVisibility(){let e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),n=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:hT(e,n),isOriginOutsideView:yv(e,n),isOverlayClipped:hT(t,n),isOverlayOutsideView:yv(t,n)}}_subtractOverflows(e,...t){return t.reduce((n,r)=>n-Math.max(r,0),e)}_getNarrowedViewportRect(){let e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+e-this._viewportMargin,bottom:n.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return this._overlayRef.getDirection()==="rtl"}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return t==="x"?e.offsetX==null?this._offsetX:e.offsetX:e.offsetY==null?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&As(e).forEach(t=>{t!==""&&this._appliedPanelClasses.indexOf(t)===-1&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){let e=this._origin;if(e instanceof Me)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();let t=e.width||0,n=e.height||0;return{top:e.y,bottom:e.y+n,left:e.x,right:e.x+t,height:n,width:t}}};function Dr(i,e){for(let t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i}function mT(i){if(typeof i!="number"&&i!=null){let[e,t]=i.split(SV);return!t||t==="px"?parseFloat(e):null}return i||null}function gT(i){return{top:Math.floor(i.top),right:Math.floor(i.right),bottom:Math.floor(i.bottom),left:Math.floor(i.left),width:Math.floor(i.width),height:Math.floor(i.height)}}function TV(i,e){return i===e?!0:i.isOriginClipped===e.isOriginClipped&&i.isOriginOutsideView===e.isOriginOutsideView&&i.isOverlayClipped===e.isOverlayClipped&&i.isOverlayOutsideView===e.isOverlayOutsideView}var vT="cdk-global-overlay-wrapper",wv=class{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){let t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(vT),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;let e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:r,height:s,maxWidth:o,maxHeight:a}=n,l=(r==="100%"||r==="100vw")&&(!o||o==="100%"||o==="100vw"),c=(s==="100%"||s==="100vh")&&(!a||a==="100%"||a==="100vh"),u=this._xPosition,d=this._xOffset,h=this._overlayRef.getConfig().direction==="rtl",f="",p="",m="";l?m="flex-start":u==="center"?(m="center",h?p=d:f=d):h?u==="left"||u==="end"?(m="flex-end",f=d):(u==="right"||u==="start")&&(m="flex-start",p=d):u==="left"||u==="start"?(m="flex-start",f=d):(u==="right"||u==="end")&&(m="flex-end",p=d),e.position=this._cssPosition,e.marginLeft=l?"0":f,e.marginTop=c?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=l?"0":p,t.justifyContent=m,t.alignItems=c?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;let e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,n=t.style;t.classList.remove(vT),n.justifyContent=n.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}},xV=(()=>{let e=class e{constructor(n,r,s,o){this._viewportRuler=n,this._document=r,this._platform=s,this._overlayContainer=o}global(){return new wv}flexibleConnectedTo(n){return new Dv(n,this._viewportRuler,this._document,this._platform,this._overlayContainer)}};e.\u0275fac=function(r){return new(r||e)(C(pv),C(de),C(je),C(bT))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),IV=0,ya=(()=>{let e=class e{constructor(n,r,s,o,a,l,c,u,d,h,f,p){this.scrollStrategies=n,this._overlayContainer=r,this._componentFactoryResolver=s,this._positionBuilder=o,this._keyboardDispatcher=a,this._injector=l,this._ngZone=c,this._document=u,this._directionality=d,this._location=h,this._outsideClickDispatcher=f,this._animationsModuleType=p}create(n){let r=this._createHostElement(),s=this._createPaneElement(r),o=this._createPortalOutlet(s),a=new va(n);return a.direction=a.direction||this._directionality.value,new Ev(o,r,s,a,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,this._animationsModuleType==="NoopAnimations",this._injector.get(Et))}position(){return this._positionBuilder}_createPaneElement(n){let r=this._document.createElement("div");return r.id=`cdk-overlay-${IV++}`,r.classList.add("cdk-overlay-pane"),n.appendChild(r),r}_createHostElement(){let n=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(n),n}_createPortalOutlet(n){return this._appRef||(this._appRef=this._injector.get(mi)),new qu(n,this._componentFactoryResolver,this._appRef,this._injector,this._document)}};e.\u0275fac=function(r){return new(r||e)(C(EV),C(bT),C(fi),C(xV),C(DV),C(qe),C(W),C(de),C(YS),C(Xi),C(wV),C(Tn,8))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var CV=new G("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{let i=L(ya);return()=>i.scrollStrategies.reposition()}});function AV(i){return()=>i.scrollStrategies.reposition()}var RV={provide:CV,deps:[ya],useFactory:AV},_T=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ee({type:e}),e.\u0275inj=_e({providers:[ya,RV],imports:[Ti,Ku,mv,mv]});let i=e;return i})();function kV(i,e){if(i&1){let t=uo();Ue(0,"div",1)(1,"button",2),ct("click",function(){wn(t);let r=qi();return Sn(r.action())}),Dt(2),Ge()()}if(i&2){let t=qi();mt(2),ho(" ",t.data.action," ")}}var LV=["label"];function OV(i,e){}var NV=Math.pow(2,31)-1,ba=class{constructor(e,t){this._overlayRef=t,this._afterDismissed=new fe,this._afterOpened=new fe,this._onAction=new fe,this._dismissedByAction=!1,this.containerInstance=e,e._onExit.subscribe(()=>this._finishDismiss())}dismiss(){this._afterDismissed.closed||this.containerInstance.exit(),clearTimeout(this._durationTimeoutId)}dismissWithAction(){this._onAction.closed||(this._dismissedByAction=!0,this._onAction.next(),this._onAction.complete(),this.dismiss()),clearTimeout(this._durationTimeoutId)}closeWithAction(){this.dismissWithAction()}_dismissAfter(e){this._durationTimeoutId=setTimeout(()=>this.dismiss(),Math.min(e,NV))}_open(){this._afterOpened.closed||(this._afterOpened.next(),this._afterOpened.complete())}_finishDismiss(){this._overlayRef.dispose(),this._onAction.closed||this._onAction.complete(),this._afterDismissed.next({dismissedByAction:this._dismissedByAction}),this._afterDismissed.complete(),this._dismissedByAction=!1}afterDismissed(){return this._afterDismissed}afterOpened(){return this.containerInstance._onEnter}onAction(){return this._onAction}},ET=new G("MatSnackBarData"),Os=class{constructor(){this.politeness="assertive",this.announcementMessage="",this.duration=0,this.data=null,this.horizontalPosition="center",this.verticalPosition="bottom"}},PV=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Le({type:e,selectors:[["","matSnackBarLabel",""]],hostAttrs:[1,"mat-mdc-snack-bar-label","mdc-snackbar__label"],standalone:!0});let i=e;return i})(),FV=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Le({type:e,selectors:[["","matSnackBarActions",""]],hostAttrs:[1,"mat-mdc-snack-bar-actions","mdc-snackbar__actions"],standalone:!0});let i=e;return i})(),BV=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Le({type:e,selectors:[["","matSnackBarAction",""]],hostAttrs:[1,"mat-mdc-snack-bar-action","mdc-snackbar__action"],standalone:!0});let i=e;return i})(),DT=(()=>{let e=class e{constructor(n,r){this.snackBarRef=n,this.data=r}action(){this.snackBarRef.dismissWithAction()}get hasAction(){return!!this.data.action}};e.\u0275fac=function(r){return new(r||e)(X(ba),X(ET))},e.\u0275cmp=nn({type:e,selectors:[["simple-snack-bar"]],hostAttrs:[1,"mat-mdc-simple-snack-bar"],exportAs:["matSnackBar"],standalone:!0,features:[on],decls:3,vars:2,consts:[["matSnackBarLabel",""],["matSnackBarActions",""],["mat-button","","matSnackBarAction","",3,"click"]],template:function(r,s){r&1&&(Ue(0,"div",0),Dt(1),Ge(),Wi(2,kV,3,1,"div",1)),r&2&&(mt(),ho(" ",s.data.message,`
`),mt(),df(2,s.hasAction?2:-1))},dependencies:[aT,PV,FV,BV],styles:[".mat-mdc-simple-snack-bar{display:flex}"],encapsulation:2,changeDetection:0});let i=e;return i})(),VV={snackBarState:VE("state",[Mp("void, hidden",ar({transform:"scale(0.8)",opacity:0})),Mp("visible",ar({transform:"scale(1)",opacity:1})),kp("* => visible",Rp("150ms cubic-bezier(0, 0, 0.2, 1)")),kp("* => void, * => hidden",Rp("75ms cubic-bezier(0.4, 0.0, 1, 1)",ar({opacity:0})))])},UV=0,jV=(()=>{let e=class e extends Ls{constructor(n,r,s,o,a){super(),this._ngZone=n,this._elementRef=r,this._changeDetectorRef=s,this._platform=o,this.snackBarConfig=a,this._document=L(de),this._trackedModals=new Set,this._announceDelay=150,this._destroyed=!1,this._onAnnounce=new fe,this._onExit=new fe,this._onEnter=new fe,this._animationState="void",this._liveElementId=`mat-snack-bar-container-live-${UV++}`,this.attachDomPortal=l=>{this._assertNotAttached();let c=this._portalOutlet.attachDomPortal(l);return this._afterPortalAttached(),c},a.politeness==="assertive"&&!a.announcementMessage?this._live="assertive":a.politeness==="off"?this._live="off":this._live="polite",this._platform.FIREFOX&&(this._live==="polite"&&(this._role="status"),this._live==="assertive"&&(this._role="alert"))}attachComponentPortal(n){this._assertNotAttached();let r=this._portalOutlet.attachComponentPortal(n);return this._afterPortalAttached(),r}attachTemplatePortal(n){this._assertNotAttached();let r=this._portalOutlet.attachTemplatePortal(n);return this._afterPortalAttached(),r}onAnimationEnd(n){let{fromState:r,toState:s}=n;if((s==="void"&&r!=="void"||s==="hidden")&&this._completeExit(),s==="visible"){let o=this._onEnter;this._ngZone.run(()=>{o.next(),o.complete()})}}enter(){this._destroyed||(this._animationState="visible",this._changeDetectorRef.markForCheck(),this._changeDetectorRef.detectChanges(),this._screenReaderAnnounce())}exit(){return this._ngZone.run(()=>{this._animationState="hidden",this._changeDetectorRef.markForCheck(),this._elementRef.nativeElement.setAttribute("mat-exit",""),clearTimeout(this._announceTimeoutId)}),this._onExit}ngOnDestroy(){this._destroyed=!0,this._clearFromModals(),this._completeExit()}_completeExit(){queueMicrotask(()=>{this._onExit.next(),this._onExit.complete()})}_afterPortalAttached(){let n=this._elementRef.nativeElement,r=this.snackBarConfig.panelClass;r&&(Array.isArray(r)?r.forEach(a=>n.classList.add(a)):n.classList.add(r)),this._exposeToModals();let s=this._label.nativeElement,o="mdc-snackbar__label";s.classList.toggle(o,!s.querySelector(`.${o}`))}_exposeToModals(){let n=this._liveElementId,r=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let s=0;s<r.length;s++){let o=r[s],a=o.getAttribute("aria-owns");this._trackedModals.add(o),a?a.indexOf(n)===-1&&o.setAttribute("aria-owns",a+" "+n):o.setAttribute("aria-owns",n)}}_clearFromModals(){this._trackedModals.forEach(n=>{let r=n.getAttribute("aria-owns");if(r){let s=r.replace(this._liveElementId,"").trim();s.length>0?n.setAttribute("aria-owns",s):n.removeAttribute("aria-owns")}}),this._trackedModals.clear()}_assertNotAttached(){this._portalOutlet.hasAttached()}_screenReaderAnnounce(){this._announceTimeoutId||this._ngZone.runOutsideAngular(()=>{this._announceTimeoutId=setTimeout(()=>{let n=this._elementRef.nativeElement.querySelector("[aria-hidden]"),r=this._elementRef.nativeElement.querySelector("[aria-live]");if(n&&r){let s=null;this._platform.isBrowser&&document.activeElement instanceof HTMLElement&&n.contains(document.activeElement)&&(s=document.activeElement),n.removeAttribute("aria-hidden"),r.appendChild(n),s?.focus(),this._onAnnounce.next(),this._onAnnounce.complete()}},this._announceDelay)})}};e.\u0275fac=function(r){return new(r||e)(X(W),X(Me),X(an),X(je),X(Os))},e.\u0275cmp=nn({type:e,selectors:[["mat-snack-bar-container"]],viewQuery:function(r,s){if(r&1&&(Qn(fv,7),Qn(LV,7)),r&2){let o;xn(o=In())&&(s._portalOutlet=o.first),xn(o=In())&&(s._label=o.first)}},hostAttrs:[1,"mdc-snackbar","mat-mdc-snack-bar-container"],hostVars:1,hostBindings:function(r,s){r&1&&ff("@state.done",function(a){return s.onAnimationEnd(a)}),r&2&&hf("@state",s._animationState)},standalone:!0,features:[At,on],decls:6,vars:3,consts:[["label",""],[1,"mdc-snackbar__surface","mat-mdc-snackbar-surface"],[1,"mat-mdc-snack-bar-label"],["aria-hidden","true"],["cdkPortalOutlet",""]],template:function(r,s){r&1&&(Ue(0,"div",1)(1,"div",2,0)(3,"div",3),Wi(4,OV,0,0,"ng-template",4),Ge(),Rt(5,"div"),Ge()()),r&2&&(mt(5),Kn("aria-live",s._live)("role",s._role)("id",s._liveElementId))},dependencies:[fv],styles:[".mat-mdc-snack-bar-container{display:flex;align-items:center;justify-content:center;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0);margin:8px}.mat-mdc-snack-bar-handset .mat-mdc-snack-bar-container{width:100vw}.mat-mdc-snackbar-surface{box-shadow:0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12);display:flex;align-items:center;justify-content:flex-start;box-sizing:border-box;padding-left:0;padding-right:8px}[dir=rtl] .mat-mdc-snackbar-surface{padding-right:0;padding-left:8px}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{min-width:344px;max-width:672px}.mat-mdc-snack-bar-handset .mat-mdc-snackbar-surface{width:100%;min-width:0}.cdk-high-contrast-active .mat-mdc-snackbar-surface{outline:solid 1px}.mat-mdc-snack-bar-container .mat-mdc-snackbar-surface{color:var(--mdc-snackbar-supporting-text-color, var(--mat-app-inverse-on-surface));border-radius:var(--mdc-snackbar-container-shape, var(--mat-app-corner-extra-small));background-color:var(--mdc-snackbar-container-color, var(--mat-app-inverse-surface))}.mdc-snackbar__label{width:100%;flex-grow:1;box-sizing:border-box;margin:0;padding:14px 8px 14px 16px}[dir=rtl] .mdc-snackbar__label{padding-left:8px;padding-right:16px}.mat-mdc-snack-bar-container .mdc-snackbar__label{font-family:var(--mdc-snackbar-supporting-text-font, var(--mat-app-body-medium-font));font-size:var(--mdc-snackbar-supporting-text-size, var(--mat-app-body-medium-size));font-weight:var(--mdc-snackbar-supporting-text-weight, var(--mat-app-body-medium-weight));line-height:var(--mdc-snackbar-supporting-text-line-height, var(--mat-app-body-medium-line-height))}.mat-mdc-snack-bar-actions{display:flex;flex-shrink:0;align-items:center;box-sizing:border-box}.mat-mdc-snack-bar-handset,.mat-mdc-snack-bar-container,.mat-mdc-snack-bar-label{flex:1 1 auto}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled){color:var(--mat-snack-bar-button-color, var(--mat-app-inverse-primary));--mat-text-button-state-layer-color:currentColor;--mat-text-button-ripple-color:currentColor}.mat-mdc-snack-bar-container .mat-mdc-button.mat-mdc-snack-bar-action:not(:disabled) .mat-ripple-element{opacity:.1}"],encapsulation:2,data:{animation:[VV.snackBarState]}});let i=e;return i})();function $V(){return new Os}var HV=new G("mat-snack-bar-default-options",{providedIn:"root",factory:$V}),Sv=(()=>{let e=class e{get _openedSnackBarRef(){let n=this._parentSnackBar;return n?n._openedSnackBarRef:this._snackBarRefAtThisLevel}set _openedSnackBarRef(n){this._parentSnackBar?this._parentSnackBar._openedSnackBarRef=n:this._snackBarRefAtThisLevel=n}constructor(n,r,s,o,a,l){this._overlay=n,this._live=r,this._injector=s,this._breakpointObserver=o,this._parentSnackBar=a,this._defaultConfig=l,this._snackBarRefAtThisLevel=null,this.simpleSnackBarComponent=DT,this.snackBarContainerComponent=jV,this.handsetCssClass="mat-mdc-snack-bar-handset"}openFromComponent(n,r){return this._attach(n,r)}openFromTemplate(n,r){return this._attach(n,r)}open(n,r="",s){let o=N(N({},this._defaultConfig),s);return o.data={message:n,action:r},o.announcementMessage===n&&(o.announcementMessage=void 0),this.openFromComponent(this.simpleSnackBarComponent,o)}dismiss(){this._openedSnackBarRef&&this._openedSnackBarRef.dismiss()}ngOnDestroy(){this._snackBarRefAtThisLevel&&this._snackBarRefAtThisLevel.dismiss()}_attachSnackBarContainer(n,r){let s=r&&r.viewContainerRef&&r.viewContainerRef.injector,o=qe.create({parent:s||this._injector,providers:[{provide:Os,useValue:r}]}),a=new Ms(this.snackBarContainerComponent,r.viewContainerRef,o),l=n.attach(a);return l.instance.snackBarConfig=r,l.instance}_attach(n,r){let s=N(N(N({},new Os),this._defaultConfig),r),o=this._createOverlay(s),a=this._attachSnackBarContainer(o,s),l=new ba(a,o);if(n instanceof tn){let c=new ks(n,null,{$implicit:s.data,snackBarRef:l});l.instance=a.attachTemplatePortal(c)}else{let c=this._createInjector(s,l),u=new Ms(n,void 0,c),d=a.attachComponentPortal(u);l.instance=d.instance}return this._breakpointObserver.observe(jS.HandsetPortrait).pipe(yt(o.detachments())).subscribe(c=>{o.overlayElement.classList.toggle(this.handsetCssClass,c.matches)}),s.announcementMessage&&a._onAnnounce.subscribe(()=>{this._live.announce(s.announcementMessage,s.politeness)}),this._animateSnackBar(l,s),this._openedSnackBarRef=l,this._openedSnackBarRef}_animateSnackBar(n,r){n.afterDismissed().subscribe(()=>{this._openedSnackBarRef==n&&(this._openedSnackBarRef=null),r.announcementMessage&&this._live.clear()}),this._openedSnackBarRef?(this._openedSnackBarRef.afterDismissed().subscribe(()=>{n.containerInstance.enter()}),this._openedSnackBarRef.dismiss()):n.containerInstance.enter(),r.duration&&r.duration>0&&n.afterOpened().subscribe(()=>n._dismissAfter(r.duration))}_createOverlay(n){let r=new va;r.direction=n.direction;let s=this._overlay.position().global(),o=n.direction==="rtl",a=n.horizontalPosition==="left"||n.horizontalPosition==="start"&&!o||n.horizontalPosition==="end"&&o,l=!a&&n.horizontalPosition!=="center";return a?s.left("0"):l?s.right("0"):s.centerHorizontally(),n.verticalPosition==="top"?s.top("0"):s.bottom("0"),r.positionStrategy=s,this._overlay.create(r)}_createInjector(n,r){let s=n&&n.viewContainerRef&&n.viewContainerRef.injector;return qe.create({parent:s||this._injector,providers:[{provide:ba,useValue:r},{provide:ET,useValue:n.data}]})}};e.\u0275fac=function(r){return new(r||e)(C(ya),C(zS),C(qe),C(Hu),C(e,12),C(HV))},e.\u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var wT=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=Ee({type:e}),e.\u0275inj=_e({providers:[Sv],imports:[_T,Ku,lT,xi,DT,xi]});let i=e;return i})();var GV=["video"],zV=["roomIdInput"],WV=["videoInput"];function qV(i,e){if(i&1){let t=uo();Ue(0,"button",16),ct("cdkCopyToClipboardCopied",function(){wn(t);let r=qi();return Sn(r.copy(!0))}),Ue(1,"span",8),Dt(2,"content_copy"),Ge(),Dt(3," Copy URL to room "),Ge()}if(i&2){let t=qi();sn("cdkCopyToClipboard",t.roomUrl)}}var ST=(()=>{let e=class e{constructor(){this.roomId="",this.videoUrl="",this.waitingVideo=!0,this.waitingForSync=!1,this.skipNextMessage=!0,this.userId=this.generateUniqueId(),this.url="https://sync-video-server.onrender.com",this.snackBar=L(Sv),this.activeRoute=L(yi),this.router=L(gc),this.destroyRef=L(di)}get allowJoinRoom(){return this.roomIdInput.nativeElement.value!==this.roomId}get allowPlayVideo(){return this.videoInput.nativeElement.value!==this.videoUrl}get roomUrl(){return`${window.location.origin+window.location.pathname}?room=${this.roomId}`}ngOnInit(){this.connectToRoom(this.roomId),this.activeRoute.queryParams.pipe(tv(this.destroyRef)).subscribe(n=>{n&&n.room?this.onRoomIdChange(n.room):this.roomId||this.onRoomIdChange(this.generateUniqueId())})}ngOnDestroy(){this.eventSource&&this.eventSource.close(),this.hls&&this.hls.destroy()}syncVideo(n){if(n.videoUrl&&(!this.videoUrl?.length||n.type==="load"&&(this.videoUrl!==n.videoUrl||this.waitingVideo))){this.loadVideo(n.videoUrl,n.time);return}if(n.type==="play"){this.playVideo(n.time,n);return}else if(n.type==="pause"){this.pauseVideo(n);return}else if(n.type==="seek"){this.seekVideo(n.time,n);return}}loadVideo(n,r=0){this.hls&&this.hls.destroy(),this.videoUrl=n,$u.isSupported()?(this.hls=new $u,this.hls.loadSource(n),this.hls.attachMedia(this.videoElement.nativeElement),this.hls.on($u.Events.MANIFEST_PARSED,()=>{this.videoElement.nativeElement.currentTime=r;let s=this.videoElement.nativeElement.play();s!==void 0&&s.then().catch(()=>{this.videoElement.nativeElement.muted=!0,this.videoElement.nativeElement.play()})})):this.videoElement.nativeElement.canPlayType("application/vnd.apple.mpegurl")&&(this.videoElement.nativeElement.src=n,this.videoElement.nativeElement.addEventListener("loadedmetadata",()=>{let s=this.videoElement.nativeElement.play();s!==void 0&&s.then().catch(()=>{this.videoElement.nativeElement.muted=!0,this.videoElement.nativeElement.play()})})),this.waitingVideo=!1,this.waitingForSync=!1}playManual(n=!0){this.videoElement.nativeElement.play(),n&&this.sendCommand("play",this.videoElement.nativeElement.currentTime,this.videoUrl)}pauseManual(n=!0){this.videoElement.nativeElement.pause(),n&&this.sendCommand("pause",this.videoElement.nativeElement.currentTime,this.videoUrl)}playVideo(n,r){if(this.userId===r.userId)return;let s=this.videoElement.nativeElement;s&&(s.currentTime=n,s.play())}pauseVideo(n){if(this.userId===n.userId)return;let r=this.videoElement.nativeElement;r&&r.pause()}seekVideo(n,r){if(this.userId===r.userId)return;let s=this.videoElement.nativeElement;s&&(s.currentTime=n)}onRoomIdChange(n){this.roomId=n,this.connectToRoom(n)}onVideoUrlChange(n){this.waitingVideo=!0,this.videoUrl=n,this.sendCommand("load",0,n)}connectToRoom(n){this.eventSource&&this.eventSource.close();let r=new URL(`${this.url}/events/${n}`);r.searchParams.append("userId",this.userId),this.eventSource=new EventSource(r),this.skipNextMessage=!0,this.waitingForSync=!0,this.eventSource.onmessage=s=>{let o=JSON.parse(s.data);if(this.skipNextMessage&&o.type==="new-user"){this.skipNextMessage=!1;return}if(o.type==="new-user"&&!this.skipNextMessage){this.sendCommand("new-state",this.videoElement.nativeElement.currentTime,this.videoUrl);return}if(o.type==="new-state"&&this.waitingForSync){this.loadVideo(o.videoUrl,o.time);return}this.syncVideo(o)}}sendCommand(n,r,s){fetch(`${this.url}/command`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomId:this.roomId,userId:this.userId,type:n,time:r,videoUrl:s})})}reset(){this.pauseManual(!1),this.videoUrl="",this.onRoomIdChange(this.generateUniqueId()),this.router.navigate(["/"]),this.videoElement.nativeElement&&(this.videoElement.nativeElement.src="")}generateUniqueId(){return Math.random().toString(36).substring(2,15)}copy(n=!1){this.snackBar.open(n?"Room link copied successfully!":"RoomId copied successfully!","Close",{duration:2e3})}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=nn({type:e,selectors:[["app-root"]],viewQuery:function(r,s){if(r&1&&(Qn(GV,7),Qn(zV,7),Qn(WV,7)),r&2){let o;xn(o=In())&&(s.videoElement=o.first),xn(o=In())&&(s.roomIdInput=o.first),xn(o=In())&&(s.videoInput=o.first)}},standalone:!0,features:[on],decls:26,vars:9,consts:[["roomIdInput",""],["videoInput",""],["video",""],[1,"container"],[1,"input-group"],["for","room-id"],["id","room-id","type","text","placeholder","Enter Room ID",1,"input",3,"ngModel","readonly"],[1,"button",3,"cdkCopyToClipboardCopied","cdkCopyToClipboard"],[1,"material-icons"],[1,"button",3,"click","disabled"],["for","video-url"],["id","video-url","type","text","placeholder","Enter Video URL",1,"input",3,"ngModel","readonly"],["controls","",1,"video-player",3,"play","pause"],[1,"btn-group"],["class","button reset-btn",3,"cdkCopyToClipboard","cdkCopyToClipboardCopied",4,"ngIf"],[1,"button","reset-btn",3,"click","disabled"],[1,"button","reset-btn",3,"cdkCopyToClipboardCopied","cdkCopyToClipboard"]],template:function(r,s){if(r&1){let o=uo();Ue(0,"div",3)(1,"div",4)(2,"label",5),Dt(3,"Room ID:"),Ge(),Rt(4,"input",6,0),Ue(6,"button",7),ct("cdkCopyToClipboardCopied",function(){return wn(o),Sn(s.copy(!1))}),Ue(7,"span",8),Dt(8,"content_copy"),Ge()(),Ue(9,"button",9),ct("click",function(){wn(o);let l=pf(5);return Sn(s.onRoomIdChange(l.value))}),Dt(10,"Join"),Ge()(),Ue(11,"div",4)(12,"label",10),Dt(13,"Video URL:"),Ge(),Rt(14,"input",11,1),Ue(16,"button",9),ct("click",function(){wn(o);let l=pf(15);return Sn(s.onVideoUrlChange(l.value))}),Dt(17,"Play"),Ge()(),Ue(18,"div")(19,"video",12,2),ct("play",function(){return wn(o),Sn(s.playManual())})("pause",function(){return wn(o),Sn(s.pauseManual())}),Dt(21," Your browser does not support the video tag. "),Ge()(),Ue(22,"div",13),Wi(23,qV,4,1,"button",14),Ue(24,"button",15),ct("click",function(){return wn(o),Sn(s.reset())}),Dt(25,"Reset"),Ge()()()}r&2&&(mt(4),sn("ngModel",s.roomId)("readonly",s.videoUrl!==""),mt(2),sn("cdkCopyToClipboard",s.roomId),mt(3),sn("disabled",!s.allowJoinRoom),mt(5),sn("ngModel",s.videoUrl)("readonly",s.videoUrl!==""),mt(2),sn("disabled",!s.allowPlayVideo),mt(7),sn("ngIf",s.videoUrl),mt(),sn("disabled",!s.videoUrl))},dependencies:[wT,FD,Qc,OD,pm,Ql,h_,PS,NS],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;background-color:var(--color-surface-mixed-100);color:var(--color-primary-600)}.input-group[_ngcontent-%COMP%]{margin-bottom:20px;display:flex;gap:8px;align-items:center}.input[_ngcontent-%COMP%]{padding:10px;margin-right:10px;border:none;border-radius:4px;background-color:#1e1e1e;color:#fff}.input[_ngcontent-%COMP%]::placeholder{color:#bbb}.button[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:8px;background-color:var(--color-primary-400);color:var(--color-surface-mixed-100);font-size:14px;font-weight:600;cursor:pointer;transition:background-color .3s;height:32px}.button[_ngcontent-%COMP%]:not([disabled]):hover{background-color:var(--color-primary-300)}.button[disabled][_ngcontent-%COMP%]{background-color:var(--color-surface-mixed-300);color:#fff;cursor:not-allowed}.reset-btn[_ngcontent-%COMP%]{margin-top:16px}.video-player[_ngcontent-%COMP%]{border-radius:4px;box-shadow:0 4px 10px #00000080;width:min(600px,60vw);max-width:min(600px,60vw)}.btn-group[_ngcontent-%COMP%]{display:flex;gap:8px}"]});let i=e;return i})();E_(ST,vD).catch(i=>console.error(i));
